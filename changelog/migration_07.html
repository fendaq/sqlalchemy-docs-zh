<h1><span class="yiyi-st" id="yiyi-109">SQLAlchemy 0.7&#x6709;&#x54EA;&#x4E9B;&#x65B0;&#x7279;&#x6027;&#xFF1F;<a class="headerlink" href="#what-s-new-in-sqlalchemy-0-7" title="Permalink to this headline">&#xB6;</a></span></h1><div class="admonition-about-this-document admonition"><p class="first admonition-title"><span class="yiyi-st" id="yiyi-110">&#x5173;&#x4E8E;&#x672C;&#x6587;&#x6863;</span></p><p><span class="yiyi-st" id="yiyi-111">&#x672C;&#x6587;&#x6863;&#x4ECB;&#x7ECD;&#x4E86;2012&#x5E74;5&#x6708;5&#x65E5;&#x53D1;&#x5E03;&#x7684;SQLAlchemy&#x7248;&#x672C;0.6&#x548C;2012&#x5E74;10&#x6708;&#x53D1;&#x5E03;&#x7684;SQLAlchemy&#x7248;&#x672C;0.7&#x4E4B;&#x95F4;&#x7684;&#x66F4;&#x6539;&#x3002;</span></p><p class="last"><span class="yiyi-st" id="yiyi-112">&#x6587;&#x4EF6;&#x65E5;&#x671F;&#xFF1A;2011&#x5E74;7&#x6708;27&#x65E5;</span></p></div><div class="section" id="introduction"><h2><span class="yiyi-st" id="yiyi-113">&#x5F15;&#x8A00;<a class="headerlink" href="#introduction" title="Permalink to this headline">&#xB6; T0&gt;</a></span></h2><p><span class="yiyi-st" id="yiyi-114">&#x672C;&#x6307;&#x5357;&#x4ECB;&#x7ECD;&#x4E86;SQLAlchemy 0.7&#x7248;&#x4E2D;&#x7684;&#x65B0;&#x589E;&#x529F;&#x80FD;&#xFF0C;&#x5E76;&#x4ECB;&#x7ECD;&#x4E86;&#x5F71;&#x54CD;&#x7528;&#x6237;&#x5C06;&#x5176;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x4ECE;0.6&#x7CFB;&#x5217;SQLAlchemy&#x8FC1;&#x79FB;&#x5230;0.7&#x7684;&#x66F4;&#x6539;&#x3002;</span></p><p><span class="yiyi-st" id="yiyi-115">&#x5728;&#x5C3D;&#x53EF;&#x80FD;&#x9AD8;&#x7684;&#x7A0B;&#x5EA6;&#x4E0A;&#xFF0C;&#x8FDB;&#x884C;&#x66F4;&#x6539;&#x7684;&#x65B9;&#x5F0F;&#x4E0D;&#x4F1A;&#x4E2D;&#x65AD;&#x4E0E;&#x4E3A;0.6&#x6784;&#x5EFA;&#x7684;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x7684;&#x517C;&#x5BB9;&#x6027;&#x3002;</span><span class="yiyi-st" id="yiyi-116">&#x8FD9;&#x4E9B;&#x5FC5;&#x987B;&#x4E0D;&#x662F;&#x5411;&#x540E;&#x517C;&#x5BB9;&#x7684;&#x66F4;&#x6539;&#x5F88;&#x5C11;&#xFF0C;&#x9664;&#x4E86;&#x4E00;&#x4E2A;&#x4E4B;&#x5916;&#xFF0C;&#x5BF9;&#x53EF;&#x53D8;&#x5C5E;&#x6027;&#x9ED8;&#x8BA4;&#x503C;&#x7684;&#x66F4;&#x6539;&#x90FD;&#x4F1A;&#x5F71;&#x54CD;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x7684;&#x6781;&#x5C0F;&#x90E8;&#x5206; - &#x8BB8;&#x591A;&#x66F4;&#x6539;&#x90FD;&#x6D89;&#x53CA;&#x975E;&#x516C;&#x5171;API&#x548C;&#x67D0;&#x4E9B;&#x7528;&#x6237;&#x53EF;&#x80FD;&#x5DF2;&#x65E0;&#x8BB0;&#x5F55;&#x7684;&#x9ED1;&#x5BA2;&#x653B;&#x51FB;&#x8BD5;&#x56FE;&#x4F7F;&#x7528;&#x3002;</span></p><p><span class="yiyi-st" id="yiyi-117">&#x8FD8;&#x8BB0;&#x5F55;&#x4E86;&#x7B2C;&#x4E8C;&#x7C7B;&#x751A;&#x81F3;&#x66F4;&#x5C0F;&#x7684;&#x975E;&#x5411;&#x540E;&#x517C;&#x5BB9;&#x66F4;&#x6539;&#x3002;</span><span class="yiyi-st" id="yiyi-118">&#x8FD9;&#x7C7B;&#x66F4;&#x6539;&#x5C06;&#x81F3;&#x5C11;&#x4ECE;0.5&#x7248;&#x672C;&#x5F00;&#x59CB;&#x88AB;&#x5F03;&#x7528;&#x7684;&#x90A3;&#x4E9B;&#x529F;&#x80FD;&#x548C;&#x884C;&#x4E3A;&#x89C6;&#x4E3A;&#x5DF2;&#x5F03;&#x7528;&#xFF0C;&#x5E76;&#x4E14;&#x81EA;&#x4ECE;&#x5F03;&#x7528;&#x4EE5;&#x6765;&#x4E00;&#x76F4;&#x63D0;&#x51FA;&#x8B66;&#x544A;&#x3002;</span><span class="yiyi-st" id="yiyi-119">&#x8FD9;&#x4E9B;&#x66F4;&#x6539;&#x53EA;&#x4F1A;&#x5F71;&#x54CD;&#x4ECD;&#x5728;&#x4F7F;&#x7528;0.4&#x6216;&#x65E9;&#x671F;0.5&#x6837;&#x5F0F;API&#x7684;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x3002;</span><span class="yiyi-st" id="yiyi-120">&#x968F;&#x7740;&#x9879;&#x76EE;&#x7684;&#x6210;&#x719F;&#xFF0C;&#x6211;&#x4EEC;&#x5BF9;0.x&#x7EA7;&#x522B;&#x7248;&#x672C;&#x7684;&#x8FD9;&#x4E9B;&#x53D8;&#x5316;&#x8D8A;&#x6765;&#x8D8A;&#x5C11;&#xFF0C;&#x8FD9;&#x662F;&#x6211;&#x4EEC;API&#x7684;&#x4EA7;&#x54C1;&#x5177;&#x6709;&#x8D8A;&#x6765;&#x8D8A;&#x5C11;&#x7684;&#x7279;&#x6027;&#xFF0C;&#x8FD9;&#x4E9B;&#x7279;&#x6027;&#x5BF9;&#x4E8E;&#x4ED6;&#x4EEC;&#x8981;&#x89E3;&#x51B3;&#x7684;&#x7528;&#x4F8B;&#x800C;&#x8A00;&#x5E76;&#x4E0D;&#x7406;&#x60F3;&#x3002;</span></p><p><span class="yiyi-st" id="yiyi-121">SQLAlchemy 0.7&#x4E2D;&#x5DF2;&#x7ECF;&#x53D6;&#x4EE3;&#x4E86;&#x4E00;&#x7CFB;&#x5217;&#x73B0;&#x6709;&#x529F;&#x80FD;&#x3002;</span><span class="yiyi-st" id="yiyi-122">&#x201C;&#x88AB;&#x53D6;&#x4EE3;&#x201D;&#x548C;&#x201C;&#x4E0D;&#x63A8;&#x8350;&#x201D;&#x8FD9;&#x4E24;&#x4E2A;&#x672F;&#x8BED;&#x4E4B;&#x95F4;&#x6CA1;&#x6709;&#x592A;&#x5927;&#x533A;&#x522B;&#xFF0C;&#x53EA;&#x662F;&#x524D;&#x8005;&#x5BF9;&#x65E7;&#x529F;&#x80FD;&#x7684;&#x5EFA;&#x8BAE;&#x592A;&#x5F31;&#x4E86;&#x3002;</span><span class="yiyi-st" id="yiyi-123">&#x5728;0.7&#x4E2D;&#xFF0C;&#x50CF;<code class="docutils literal"><span class="pre">synonym</span></code>&#x548C;<code class="docutils literal"><span class="pre">comparable_property</span></code>&#x4EE5;&#x53CA;&#x6240;&#x6709;<code class="docutils literal"><span class="pre">Extension</span></code>&#x548C;&#x5176;&#x4ED6;&#x4E8B;&#x4EF6;&#x7C7B;&#x7684;&#x529F;&#x80FD;&#x5DF2;&#x88AB;&#x53D6;&#x4EE3;&#x3002;</span><span class="yiyi-st" id="yiyi-124">&#x4F46;&#x662F;&#x8FD9;&#x4E9B;&#x201C;&#x88AB;&#x53D6;&#x4EE3;&#x201D;&#x7684;&#x529F;&#x80FD;&#x5DF2;&#x7ECF;&#x88AB;&#x91CD;&#x65B0;&#x5B9E;&#x73B0;&#xFF0C;&#x56E0;&#x6B64;&#x5B83;&#x4EEC;&#x7684;&#x5B9E;&#x73B0;&#x5927;&#x90E8;&#x5206;&#x90FD;&#x662F;&#x5728;&#x6838;&#x5FC3;ORM&#x4EE3;&#x7801;&#x4E4B;&#x5916;&#x751F;&#x5B58;&#xFF0C;&#x6240;&#x4EE5;&#x5B83;&#x4EEC;&#x7EE7;&#x7EED;&#x201C;&#x5F98;&#x5F8A;&#x201D;&#x4E0D;&#x4F1A;&#x5F71;&#x54CD;SQLAlchemy&#x8FDB;&#x4E00;&#x6B65;&#x7CBE;&#x7B80;&#x548C;&#x4F18;&#x5316;&#x5176;&#x5185;&#x90E8;&#x7684;&#x80FD;&#x529B;&#xFF0C;&#x6211;&#x4EEC;&#x5E0C;&#x671B;&#x5B83;&#x4EEC;&#x4FDD;&#x6301;&#x4E0D;&#x53D8;&#x5728;&#x53EF;&#x9884;&#x89C1;&#x7684;&#x672A;&#x6765;API&#x5185;&#x3002;</span></p></div><div class="section" id="new-features"><h2><span class="yiyi-st" id="yiyi-125">&#x65B0;&#x529F;&#x80FD;<a class="headerlink" href="#new-features" title="Permalink to this headline">&#xB6;</a></span></h2><div class="section" id="new-event-system"><h3><span class="yiyi-st" id="yiyi-126">&#x65B0;&#x4E8B;&#x4EF6;&#x7CFB;&#x7EDF;<a class="headerlink" href="#new-event-system" title="Permalink to this headline">&#xB6;</a></span></h3><p><span class="yiyi-st" id="yiyi-127">SQLAlchemy&#x5F88;&#x65E9;&#x5C31;&#x5F00;&#x59CB;&#x4F7F;&#x7528;<code class="docutils literal"><span class="pre">MapperExtension</span></code>&#x7C7B;&#xFF0C;&#x8BE5;&#x7C7B;&#x63D0;&#x4F9B;&#x4E86;&#x6620;&#x5C04;&#x5668;&#x6301;&#x4E45;&#x5316;&#x5468;&#x671F;&#x7684;&#x94A9;&#x5B50;&#x3002;</span><span class="yiyi-st" id="yiyi-128">&#x968F;&#x7740;SQLAlchemy&#x8FC5;&#x901F;&#x53D8;&#x5F97;&#x66F4;&#x52A0;&#x7EC4;&#x4EF6;&#x5316;&#xFF0C;&#x5C06;&#x6620;&#x5C04;&#x5668;&#x63A8;&#x8FDB;&#x5230;&#x66F4;&#x52A0;&#x5173;&#x6CE8;&#x7684;&#x914D;&#x7F6E;&#x89D2;&#x8272;&#x4E2D;&#xFF0C;&#x5F39;&#x51FA;&#x4E86;&#x66F4;&#x591A;&#x7684;&#x201C;&#x6269;&#x5C55;&#x201D;&#xFF0C;&#x201C;&#x4FA6;&#x542C;&#x5668;&#x201D;&#x548C;&#x201C;&#x4EE3;&#x7406;&#x201D;&#x7C7B;&#xFF0C;&#x4EE5;&#x7279;&#x6B8A;&#x65B9;&#x5F0F;&#x89E3;&#x51B3;&#x5404;&#x79CD;&#x6D3B;&#x52A8;&#x62E6;&#x622A;&#x7528;&#x4F8B;&#x3002;</span><span class="yiyi-st" id="yiyi-129">Part of this was driven by the divergence of activities; <code class="docutils literal"><span class="pre">ConnectionProxy</span></code> objects wanted to provide a system of rewriting statements and parameters; <code class="docutils literal"><span class="pre">AttributeExtension</span></code> provided a system of replacing incoming values, and <code class="docutils literal"><span class="pre">DDL</span></code> objects had events that could be switched off of dialect-sensitive callables.</span></p><p><span class="yiyi-st" id="yiyi-130">0.7&#x4F7F;&#x7528;&#x5168;&#x65B0;&#x7684;&#x7EDF;&#x4E00;&#x65B9;&#x6CD5;&#x91CD;&#x65B0;&#x5B9E;&#x73B0;&#x4E86;&#x6240;&#x6709;&#x8FD9;&#x4E9B;&#x63D2;&#x4EF6;&#x70B9;&#xFF0C;&#x8BE5;&#x65B9;&#x6CD5;&#x4FDD;&#x7559;&#x4E86;&#x4E0D;&#x540C;&#x7CFB;&#x7EDF;&#x7684;&#x6240;&#x6709;&#x529F;&#x80FD;&#xFF0C;&#x63D0;&#x4F9B;&#x4E86;&#x66F4;&#x5927;&#x7684;&#x7075;&#x6D3B;&#x6027;&#x548C;&#x66F4;&#x5C11;&#x7684;&#x6837;&#x677F;&#xFF0C;&#x6027;&#x80FD;&#x66F4;&#x597D;&#xFF0C;&#x5E76;&#x4E14;&#x65E0;&#x9700;&#x4E3A;&#x6BCF;&#x4E2A;&#x4E8B;&#x4EF6;&#x5B50;&#x7CFB;&#x7EDF;&#x5B66;&#x4E60;&#x622A;&#x7136;&#x4E0D;&#x540C;&#x7684;API &#x3002;</span><span class="yiyi-st" id="yiyi-131">The pre-existing classes <code class="docutils literal"><span class="pre">MapperExtension</span></code>, <code class="docutils literal"><span class="pre">SessionExtension</span></code>, <code class="docutils literal"><span class="pre">AttributeExtension</span></code>, <code class="docutils literal"><span class="pre">ConnectionProxy</span></code>, <code class="docutils literal"><span class="pre">PoolListener</span></code> as well as the <code class="docutils literal"><span class="pre">DDLElement.execute_at</span></code> method are deprecated and now implemented in terms of the new system - these APIs remain fully functional and are expected to remain in place for the foreseeable future.</span></p><p><span class="yiyi-st" id="yiyi-132">&#x65B0;&#x65B9;&#x6CD5;&#x4F7F;&#x7528;&#x547D;&#x540D;&#x4E8B;&#x4EF6;&#x548C;&#x7528;&#x6237;&#x5B9A;&#x4E49;&#x7684;&#x53EF;&#x8C03;&#x53C2;&#x6570;&#x5C06;&#x6D3B;&#x52A8;&#x4E0E;&#x4E8B;&#x4EF6;&#x76F8;&#x5173;&#x8054;&#x3002;</span><span class="yiyi-st" id="yiyi-133">API&#x7684;&#x5916;&#x89C2;&#x548C;&#x611F;&#x89C9;&#x53D7;&#x5230;JQuery&#xFF0C;Blinker&#x548C;Hibernate&#x7B49;&#x591A;&#x79CD;&#x6765;&#x6E90;&#x7684;&#x9A71;&#x52A8;&#xFF0C;&#x5E76;&#x4E14;&#x5728;&#x4E0E;&#x51E0;&#x5341;&#x4E2A;&#x7528;&#x6237;&#x5728;Twitter&#x4E0A;&#x7684;&#x4F1A;&#x8BAE;&#x671F;&#x95F4;&#x8FDB;&#x884C;&#x4E86;&#x51E0;&#x6B21;&#x8FDB;&#x4E00;&#x6B65;&#x4FEE;&#x6539;&#xFF0C;&#x8FD9;&#x4E9B;&#x7528;&#x6237;&#x4F3C;&#x4E4E;&#x6BD4;&#x90AE;&#x4EF6;&#x5217;&#x8868;&#x7684;&#x54CD;&#x5E94;&#x7387;&#x9AD8;&#x5F97;&#x591A;&#x8FD9;&#x6837;&#x7684;&#x95EE;&#x9898;&#x3002;</span></p><p><span class="yiyi-st" id="yiyi-134">&#x5B83;&#x8FD8;&#x5177;&#x6709;&#x76EE;&#x6807;&#x89C4;&#x8303;&#x7684;&#x5F00;&#x653E;&#x5F0F;&#x7CFB;&#x7EDF;&#xFF0C;&#x5141;&#x8BB8;&#x5C06;&#x4E8B;&#x4EF6;&#x4E0E;API&#x7C7B;&#x76F8;&#x5173;&#x8054;&#xFF0C;&#x4F8B;&#x5982;&#x6240;&#x6709;<code class="docutils literal"><span class="pre">Session</span></code>&#x6216;<code class="docutils literal"><span class="pre">Engine</span></code>&#x5BF9;&#x8C61;&#x4E0E;API&#x7C7B;&#x7684;&#x7279;&#x5B9A;&#x5B9E;&#x4F8B;&#xFF0C;&#x6BD4;&#x5982;&#x9488;&#x5BF9;&#x7279;&#x5B9A;&#x7684;<code class="docutils literal"><span class="pre">Pool</span></code>&#x6216;<code class="docutils literal"><span class="pre">Mapper</span></code>&#xFF0C;&#x4EE5;&#x53CA;&#x76F8;&#x5173;&#x5BF9;&#x8C61;&#xFF08;&#x5982;&#x6620;&#x5C04;&#x7684;&#x7528;&#x6237;&#x5B9A;&#x4E49;&#x7C7B;&#xFF09;&#xFF0C;&#x6216;&#x8005;&#x7279;&#x5B9A;&#x4E8E;&#x7279;&#x5B9A;&#x5C5E;&#x6027;&#x6620;&#x5C04;&#x7236;&#x7C7B;&#x7684;&#x7279;&#x5B9A;&#x5B50;&#x7C7B;&#x3002;</span><span class="yiyi-st" id="yiyi-135">&#x5355;&#x72EC;&#x7684;&#x76D1;&#x542C;&#x5668;&#x5B50;&#x7CFB;&#x7EDF;&#x53EF;&#x4EE5;&#x5C06;&#x5305;&#x88C5;&#x5E94;&#x7528;&#x5230;&#x4F20;&#x5165;&#x7684;&#x7528;&#x6237;&#x5B9A;&#x4E49;&#x7684;&#x76D1;&#x542C;&#x5668;&#x51FD;&#x6570;&#x4E2D;&#xFF0C;&#x8FD9;&#x4E9B;&#x51FD;&#x6570;&#x4FEE;&#x6539;&#x4E86;&#x5B83;&#x4EEC;&#x7684;&#x8C03;&#x7528;&#x65B9;&#x5F0F; - &#x6620;&#x5C04;&#x5668;&#x4E8B;&#x4EF6;&#x53EF;&#x4EE5;&#x63A5;&#x6536;&#x6B63;&#x5728;&#x88AB;&#x64CD;&#x4F5C;&#x7684;&#x5BF9;&#x8C61;&#x7684;&#x5B9E;&#x4F8B;&#x6216;&#x5176;&#x5E95;&#x5C42;&#x7684;<code class="docutils literal"><span class="pre">InstanceState</span></code>&#x5BF9;&#x8C61;&#x3002;</span><span class="yiyi-st" id="yiyi-136">&#x5C5E;&#x6027;&#x4E8B;&#x4EF6;&#x53EF;&#x4EE5;&#x9009;&#x62E9;&#x662F;&#x5426;&#x6709;&#x8FD4;&#x56DE;&#x65B0;&#x503C;&#x7684;&#x8D23;&#x4EFB;&#x3002;</span></p><p><span class="yiyi-st" id="yiyi-137">&#x73B0;&#x5728;&#x6709;&#x51E0;&#x4E2A;&#x7CFB;&#x7EDF;&#x57FA;&#x4E8E;&#x65B0;&#x7684;&#x4E8B;&#x4EF6;API&#xFF0C;&#x5305;&#x62EC;&#x65B0;&#x7684;&#x201C;&#x53EF;&#x53D8;&#x5C5E;&#x6027;&#x201D;API&#x4EE5;&#x53CA;&#x590D;&#x5408;&#x5C5E;&#x6027;&#x3002;</span><span class="yiyi-st" id="yiyi-138">&#x5BF9;&#x4E8B;&#x4EF6;&#x7684;&#x5F3A;&#x8C03;&#x4E5F;&#x5BFC;&#x81F4;&#x4E86;&#x4E00;&#x4E9B;&#x65B0;&#x7684;&#x4E8B;&#x4EF6;&#x7684;&#x5F15;&#x5165;&#xFF0C;&#x5305;&#x62EC;&#x5C5E;&#x6027;&#x5230;&#x671F;&#x548C;&#x5237;&#x65B0;&#x64CD;&#x4F5C;&#xFF0C;&#x9178;&#x6D17;&#x52A0;&#x8F7D;/&#x8F6C;&#x50A8;&#x64CD;&#x4F5C;&#xFF0C;&#x5B8C;&#x6210;&#x7684;&#x6620;&#x5C04;&#x5668;&#x6784;&#x5EFA;&#x64CD;&#x4F5C;&#x3002;</span></p><div class="admonition seealso"><p class="first admonition-title"><span class="yiyi-st" id="yiyi-139">&#x4E5F;&#x53EF;&#x4EE5;&#x770B;&#x770B;</span></p><p class="last"><span class="yiyi-st" id="yiyi-140"><a class="reference internal" href="core_event.html"><span>Events</span></a></span></p></div><p><span class="yiyi-st" id="yiyi-141"><a class="reference external" href="http://www.sqlalchemy.org/trac/ticket/1902">&#xFF03;1902  T0&gt;</a></span></p></div><div class="section" id="hybrid-attributes-implements-supersedes-synonym-comparable-property"><h3><span class="yiyi-st" id="yiyi-142">Hybrid&#x5C5E;&#x6027;&#xFF0C;implements / supersedes&#x540C;&#x4E49;&#x8BCD;()&#xFF0C;comparable_property()<a class="headerlink" href="#hybrid-attributes-implements-supersedes-synonym-comparable-property" title="Permalink to this headline">&#xB6;</a></span></h3><p><span class="yiyi-st" id="yiyi-143">&#x201C;&#x6D3E;&#x751F;&#x5C5E;&#x6027;&#x201D;&#x793A;&#x4F8B;&#x73B0;&#x5728;&#x5DF2;&#x7ECF;&#x53D8;&#x6210;&#x5B98;&#x65B9;&#x6269;&#x5C55;&#x3002;</span><span class="yiyi-st" id="yiyi-144"><code class="docutils literal"><span class="pre">synonym()</span></code>&#x7684;&#x5178;&#x578B;&#x7528;&#x4F8B;&#x662F;&#x63D0;&#x4F9B;&#x5BF9;&#x6620;&#x5C04;&#x5217;&#x7684;&#x63CF;&#x8FF0;&#x7B26;&#x8BBF;&#x95EE;&#xFF1B; <code class="docutils literal"><span class="pre">comparable_property()</span></code>&#x7684;&#x7528;&#x4F8B;&#x5E94;&#x8BE5;&#x80FD;&#x591F;&#x4ECE;&#x4EFB;&#x4F55;&#x63CF;&#x8FF0;&#x7B26;&#x4E2D;&#x8FD4;&#x56DE;&#x4E00;&#x4E2A;<code class="docutils literal"><span class="pre">PropComparator</span></code>&#x3002;</span><span class="yiyi-st" id="yiyi-145">&#x5728;&#x5B9E;&#x8DF5;&#x4E2D;&#xFF0C;&#x201C;&#x6D3E;&#x751F;&#x201D;&#x7684;&#x65B9;&#x6CD5;&#x66F4;&#x5BB9;&#x6613;&#x4F7F;&#x7528;&#xFF0C;&#x66F4;&#x5177;&#x53EF;&#x6269;&#x5C55;&#x6027;&#xFF0C;&#x5728;&#x51E0;&#x5341;&#x884C;&#x7EAF;Python&#x4E2D;&#x5B9E;&#x73B0;&#xFF0C;&#x51E0;&#x4E4E;&#x4E0D;&#x9700;&#x8981;&#x5BFC;&#x5165;&#xFF0C;&#x5E76;&#x4E14;&#x4E0D;&#x9700;&#x8981;ORM&#x5185;&#x6838;&#x751A;&#x81F3;&#x4E0D;&#x9700;&#x8981;&#x77E5;&#x9053;&#x5B83;&#x3002;</span><span class="yiyi-st" id="yiyi-146">&#x8BE5;&#x529F;&#x80FD;&#x73B0;&#x5728;&#x79F0;&#x4E3A;&#x201C;&#x6DF7;&#x5408;&#x5C5E;&#x6027;&#x201D;&#x6269;&#x5C55;&#x3002;</span></p><p><span class="yiyi-st" id="yiyi-147"><code class="docutils literal"><span class="pre">synonym()</span></code> and <code class="docutils literal"><span class="pre">comparable_property()</span></code> are still part of the ORM, though their implementations have been moved outwards, building on an approach that is similar to that of the hybrid extension, so that the core ORM mapper/query/property modules aren&#x2019;t really aware of them otherwise.</span></p><div class="admonition seealso"><p class="first admonition-title"><span class="yiyi-st" id="yiyi-148">&#x4E5F;&#x53EF;&#x4EE5;&#x770B;&#x770B;</span></p><p class="last"><span class="yiyi-st" id="yiyi-149"><a class="reference internal" href="orm_extensions_hybrid.html"><span>Hybrid Attributes</span></a></span></p></div><p><span class="yiyi-st" id="yiyi-150"><a class="reference external" href="http://www.sqlalchemy.org/trac/ticket/1903">&#xFF03;1903  T0&gt;</a></span></p></div><div class="section" id="speed-enhancements"><h3><span class="yiyi-st" id="yiyi-151">&#x901F;&#x5EA6;&#x589E;&#x5F3A;<a class="headerlink" href="#speed-enhancements" title="Permalink to this headline">&#xB6;</a></span></h3><p><span class="yiyi-st" id="yiyi-152">&#x6309;&#x7167;&#x6240;&#x6709;&#x4E3B;&#x8981;SQLA&#x7248;&#x672C;&#x7684;&#x4E60;&#x60EF;&#xFF0C;&#x901A;&#x8FC7;&#x5185;&#x90E8;&#x5E7F;&#x6CDB;&#x4F20;&#x9012;&#x6765;&#x51CF;&#x5C11;&#x5F00;&#x9500;&#x548C;&#x547C;&#x53EB;&#x8BA1;&#x6570;&#xFF0C;&#x8FD9;&#x8FDB;&#x4E00;&#x6B65;&#x51CF;&#x5C11;&#x4E86;&#x5E38;&#x89C1;&#x573A;&#x666F;&#x4E2D;&#x6240;&#x9700;&#x7684;&#x5DE5;&#x4F5C;&#x3002;</span><span class="yiyi-st" id="yiyi-153">&#x6B64;&#x7248;&#x672C;&#x7684;&#x4EAE;&#x70B9;&#x5305;&#x62EC;&#xFF1A;</span></p><ul class="simple"><li><span class="yiyi-st" id="yiyi-154">&#x5BF9;&#x4E8E;&#x4E3B;&#x952E;&#x5DF2;&#x7ECF;&#x5B58;&#x5728;&#x7684;&#x884C;&#xFF0C;&#x5237;&#x65B0;&#x8FC7;&#x7A0B;&#x73B0;&#x5728;&#x5C06;INSERT&#x8BED;&#x53E5;&#x6346;&#x7ED1;&#x5230;&#x63D0;&#x4F9B;&#x7ED9;<code class="docutils literal"><span class="pre">cursor.executemany()</span></code>&#x7684;&#x6279;&#x5904;&#x7406;&#x4E2D;&#x3002;</span><span class="yiyi-st" id="yiyi-155">&#x7279;&#x522B;&#x662F;&#xFF0C;&#x8FD9;&#x901A;&#x5E38;&#x9002;&#x7528;&#x4E8E;&#x8FDE;&#x63A5;&#x8868;&#x7EE7;&#x627F;&#x914D;&#x7F6E;&#x4E0A;&#x7684;&#x201C;&#x5B50;&#x201D;&#x8868;&#xFF0C;&#x8FD9;&#x610F;&#x5473;&#x7740;&#x5BF9;&#x4E8E;&#x8FDE;&#x63A5;&#x8868;&#x5BF9;&#x8C61;&#x7684;&#x5927;&#x6279;&#x91CF;&#x63D2;&#x5165;&#xFF0C;&#x5BF9;<code class="docutils literal"><span class="pre">cursor.execute</span></code>&#x7684;&#x8C03;&#x7528;&#x6B21;&#x6570;&#x53EF;&#x4EE5;&#x51CF;&#x534A;&#xFF0C;&#x5141;&#x8BB8;&#x5BF9;&#x4F20;&#x9012;&#x7ED9;<code class="docutils literal"><span class="pre">cursor.executemany()</span></code>&#x7684;&#x8BED;&#x53E5;&#x8FDB;&#x884C;&#x672C;&#x5730;DBAPI&#x4F18;&#x5316;&#xFF08;&#x4F8B;&#x5982;&#x91CD;&#x65B0;&#x4F7F;&#x7528;&#x9884;&#x51C6;&#x5907;&#x8BED;&#x53E5;&#xFF09;&#x3002;</span></li><li><span class="yiyi-st" id="yiyi-156">&#x5728;&#x8BBF;&#x95EE;&#x5DF2;&#x52A0;&#x8F7D;&#x7684;&#x76F8;&#x5173;&#x5BF9;&#x8C61;&#x7684;&#x591A;&#x5BF9;&#x4E00;&#x5F15;&#x7528;&#x65F6;&#x8C03;&#x7528;&#x7684;&#x4EE3;&#x7801;&#x8DEF;&#x5F84;&#x5DF2;&#x5927;&#x5927;&#x7B80;&#x5316;&#x3002;</span><span class="yiyi-st" id="yiyi-157">&#x76F4;&#x63A5;&#x68C0;&#x67E5;&#x8EAB;&#x4EFD;&#x6620;&#x5C04;&#x800C;&#x4E0D;&#x9700;&#x8981;&#x9996;&#x5148;&#x751F;&#x6210;&#x65B0;&#x7684;<code class="docutils literal"><span class="pre">Query</span></code>&#x5BF9;&#x8C61;&#xFF0C;&#x8FD9;&#x5728;&#x9700;&#x8981;&#x8BBF;&#x95EE;&#x7684;&#x6570;&#x5343;&#x4E2A;&#x5185;&#x5B58;&#x4E2D;&#x7684;&#x591A;&#x5BF9;&#x4E00;&#x7684;&#x60C5;&#x51B5;&#x4E0B;&#x662F;&#x6602;&#x8D35;&#x7684;&#x3002;</span><span class="yiyi-st" id="yiyi-158">&#x6784;&#x9020;&#x7684;&#x6BCF;&#x4E2A;&#x8C03;&#x7528;&#x201C;&#x52A0;&#x8F7D;&#x5668;&#x201D;&#x5BF9;&#x8C61;&#x7684;&#x7528;&#x6CD5;&#x4E5F;&#x4E0D;&#x518D;&#x7528;&#x4E8E;&#x5927;&#x591A;&#x6570;&#x60F0;&#x6027;&#x5C5E;&#x6027;&#x52A0;&#x8F7D;&#x3002;</span></li><li><span class="yiyi-st" id="yiyi-159">&#x5F53;&#x6620;&#x5C04;&#x5668;&#x5185;&#x90E8;&#x8BBF;&#x95EE;flush&#x4E2D;&#x7684;&#x6620;&#x5C04;&#x5C5E;&#x6027;&#x65F6;&#xFF0C;&#x7EC4;&#x5408;&#x7684;&#x91CD;&#x5199;&#x5141;&#x8BB8;&#x66F4;&#x77ED;&#x7684;&#x4EE3;&#x7801;&#x8DEF;&#x5F84;&#x3002;</span></li><li><span class="yiyi-st" id="yiyi-160">&#x5F53;&#x201C;&#x4FDD;&#x5B58;&#x66F4;&#x65B0;&#x201D;&#x548C;&#x5176;&#x4ED6;&#x7EA7;&#x8054;&#x64CD;&#x4F5C;&#x9700;&#x8981;&#x5728;&#x4E0E;&#x5C5E;&#x6027;&#x5173;&#x8054;&#x7684;&#x6570;&#x636E;&#x6210;&#x5458;&#x7684;&#x5168;&#x90E8;&#x8303;&#x56F4;&#x5185;&#x7EA7;&#x8054;&#x65F6;&#xFF0C;&#x65B0;&#x7684;&#x5185;&#x8054;&#x5C5E;&#x6027;&#x8BBF;&#x95EE;&#x529F;&#x80FD;&#x53D6;&#x4EE3;&#x4E86;&#x4E4B;&#x524D;&#x201C;&#x5386;&#x53F2;&#x201D;&#x7684;&#x7528;&#x6CD5;&#x3002;</span><span class="yiyi-st" id="yiyi-161">&#x8FD9;&#x53EF;&#x4EE5;&#x964D;&#x4F4E;&#x4E3A;&#x6B64;&#x901F;&#x5EA6;&#x5173;&#x952E;&#x64CD;&#x4F5C;&#x751F;&#x6210;&#x65B0;&#x7684;<code class="docutils literal"><span class="pre">History</span></code>&#x5BF9;&#x8C61;&#x7684;&#x5F00;&#x9500;&#x3002;</span></li><li><span class="yiyi-st" id="yiyi-162">&#x5185;&#x8054;&#x7684;<code class="docutils literal"><span class="pre">ExecutionContext</span></code>&#xFF0C;&#x4E0E;&#x8BED;&#x53E5;&#x6267;&#x884C;&#x76F8;&#x5BF9;&#x5E94;&#x7684;&#x5BF9;&#x8C61;&#x5DF2;&#x88AB;&#x5185;&#x8054;&#x548C;&#x7B80;&#x5316;&#x3002;</span></li><li><span class="yiyi-st" id="yiyi-163">&#x73B0;&#x5728;&#x7F13;&#x5B58;&#x6BCF;&#x4E2A;&#x8BED;&#x53E5;&#x6267;&#x884C;&#x7684;&#x7C7B;&#x578B;&#x751F;&#x6210;&#x7684;<code class="docutils literal"><span class="pre">bind_processor()</span></code>&#x548C;<code class="docutils literal"><span class="pre">result_processor()</span></code>&#x53EF;&#x8C03;&#x96C6;&#xFF08;&#x4ED4;&#x7EC6;&#x5730;&#x907F;&#x514D;ad-hoc&#x7C7B;&#x578B;&#x548C;&#x65B9;&#x8A00;&#x7684;&#x5185;&#x5B58;&#x6CC4;&#x6F0F;&#xFF09;&#x4E3A;&#x4E86;&#x8FD9;&#x79CD;&#x7C7B;&#x578B;&#x7684;&#x751F;&#x547D;&#x5468;&#x671F;&#xFF0C;&#x8FDB;&#x4E00;&#x6B65;&#x51CF;&#x5C11;&#x4E86;&#x6BCF;&#x4E2A;&#x8BED;&#x53E5;&#x7684;&#x8C03;&#x7528;&#x5F00;&#x9500;&#x3002;</span></li><li><span class="yiyi-st" id="yiyi-164">&#x8BED;&#x53E5;&#x7684;&#x7279;&#x5B9A;<code class="docutils literal"><span class="pre">Compiled</span></code>&#x5B9E;&#x4F8B;&#x7684;&#x201C;&#x7ED1;&#x5B9A;&#x5904;&#x7406;&#x5668;&#x201D;&#x96C6;&#x5408;&#x4E5F;&#x7F13;&#x5B58;&#x5728;<code class="docutils literal"><span class="pre">Compiled</span></code>&#x5BF9;&#x8C61;&#x4E0A;&#xFF0C;&#x8FDB;&#x4E00;&#x6B65;&#x5229;&#x7528;&#x4E86;flush&#x7684;&#x201C;&#x7F16;&#x8BD1;&#x7F13;&#x5B58;&#x201D;&#x8FDB;&#x7A0B;&#x91CD;&#x65B0;&#x4F7F;&#x7528;INSERT&#xFF0C;UPDATE&#xFF0C;DELETE&#x8BED;&#x53E5;&#x7684;&#x76F8;&#x540C;&#x7F16;&#x8BD1;&#x5F62;&#x5F0F;&#x3002;</span></li></ul><p><span class="yiyi-st" id="yiyi-165">&#x5305;&#x542B;&#x6837;&#x672C;&#x57FA;&#x51C6;&#x6D4B;&#x8BD5;&#x811A;&#x672C;&#x7684;callcount&#x7B80;&#x5316;&#x793A;&#x4F8B;&#x4F4D;&#x4E8E;<a class="reference external" href="http://techspot.zzzeek.org/2010/12/12/a-tale-of-three">http://techspot.zzzeek.org/2010/12/12/a-tale-of-three</a>  - &#x914D;&#x7F6E;&#x6587;&#x4EF6;/</span></p></div><div class="section" id="composites-rewritten"><h3><span class="yiyi-st" id="yiyi-166">&#x590D;&#x5199;&#x91CD;&#x5199;<a class="headerlink" href="#composites-rewritten" title="Permalink to this headline">&#xB6;</a></span></h3><p><span class="yiyi-st" id="yiyi-167">&#x201C;&#x590D;&#x5408;&#x201D;&#x529F;&#x80FD;&#x5DF2;&#x88AB;&#x91CD;&#x5199;&#xFF0C;&#x5982;<code class="docutils literal"><span class="pre">synonym()</span></code>&#x548C;<code class="docutils literal"><span class="pre">comparable_property()</span></code>&#xFF0C;&#x4EE5;&#x4F7F;&#x7528;&#x57FA;&#x4E8E;&#x63CF;&#x8FF0;&#x7B26;&#x548C;&#x4E8B;&#x4EF6;&#x7684;&#x66F4;&#x8F7B;&#x91CF;&#x7EA7;&#x5B9E;&#x73B0;&#xFF0C;&#x800C;&#x4E0D;&#x662F;&#x6784;&#x5EFA;&#x5230;ORM&#x5185;&#x90E8;&#x3002;</span><span class="yiyi-st" id="yiyi-168">&#x8FD9;&#x5141;&#x8BB8;&#x4ECE;&#x6620;&#x5C04;&#x5668;/&#x5DE5;&#x4F5C;&#x5355;&#x5143;&#x7684;&#x5185;&#x90E8;&#x6D88;&#x9664;&#x4E00;&#x4E9B;&#x5EF6;&#x8FDF;&#xFF0C;&#x5E76;&#x4E14;&#x7B80;&#x5316;&#x4E86;&#x7EC4;&#x5408;&#x7684;&#x5DE5;&#x4F5C;&#x3002;</span><span class="yiyi-st" id="yiyi-169">&#x590D;&#x5408;&#x5C5E;&#x6027;&#x73B0;&#x5728;&#x4E0D;&#x518D;&#x9690;&#x85CF;&#x5B83;&#x6784;&#x5EFA;&#x7684;&#x57FA;&#x7840;&#x5217;&#xFF0C;&#x73B0;&#x5728;&#x5B83;&#x4EEC;&#x4ECD;&#x7136;&#x662F;&#x5E38;&#x89C4;&#x5C5E;&#x6027;&#x3002;</span><span class="yiyi-st" id="yiyi-170">&#x590D;&#x5408;&#x6750;&#x6599;&#x4E5F;&#x53EF;&#x4EE5;&#x4F5C;&#x4E3A;<code class="docutils literal"><span class="pre">relationship()</span></code>&#x4EE5;&#x53CA;<code class="docutils literal"><span class="pre">Column()</span></code>&#x5C5E;&#x6027;&#x7684;&#x4EE3;&#x7406;&#x3002;</span></p><p><span class="yiyi-st" id="yiyi-171">&#x4E3B;&#x8981;&#x7684;&#x5411;&#x540E;&#x4E0D;&#x517C;&#x5BB9;&#x7684;&#x590D;&#x5408;&#x53D8;&#x5316;&#x662F;&#x4ED6;&#x4EEC;&#x4E0D;&#x518D;&#x4F7F;&#x7528;<code class="docutils literal"><span class="pre">mutable=True</span></code>&#x7CFB;&#x7EDF;&#x6765;&#x68C0;&#x6D4B;&#x539F;&#x4F4D;&#x7A81;&#x53D8;&#x3002;</span><span class="yiyi-st" id="yiyi-172">&#x8BF7;&#x4F7F;&#x7528;<a class="reference external" href="http://www.sqlalchemy.org/docs/07/orm_extensions_mutable.html">&#x7A81;&#x53D8;&#x8DDF;&#x8E2A;</a>&#x6269;&#x5C55;&#x540D;&#x6765;&#x4E3A;&#x73B0;&#x6709;&#x7684;&#x7EC4;&#x5408;&#x4F7F;&#x7528;&#x60C5;&#x51B5;&#x5EFA;&#x7ACB;&#x5C31;&#x5730;&#x66F4;&#x6539;&#x4E8B;&#x4EF6;&#x3002;</span></p><div class="admonition seealso"><p class="first admonition-title"><span class="yiyi-st" id="yiyi-173">&#x4E5F;&#x53EF;&#x4EE5;&#x770B;&#x770B;</span></p><p><span class="yiyi-st" id="yiyi-174"><a class="reference internal" href="orm_composites.html#mapper-composite"><span>Composite Column Types</span></a></span></p><p class="last"><span class="yiyi-st" id="yiyi-175"><a class="reference internal" href="orm_extensions_mutable.html"><span>Mutation Tracking</span></a></span></p></div><p><span class="yiyi-st" id="yiyi-176"><a class="reference external" href="http://www.sqlalchemy.org/trac/ticket/2008">&#xFF03;2008</a> <a class="reference external" href="http://www.sqlalchemy.org/trac/ticket/2024">&#xFF03;2024</a></span></p></div><div class="section" id="more-succinct-form-of-query-join-target-onclause"><h3><span class="yiyi-st" id="yiyi-177">query.join&#xFF08;target&#xFF0C;onclause&#xFF09;<a class="headerlink" href="#more-succinct-form-of-query-join-target-onclause" title="Permalink to this headline">&#xB6;</a>&#x7684;&#x66F4;&#x7B80;&#x6D01;&#x7684;&#x5F62;&#x5F0F;</span></h3><p><span class="yiyi-st" id="yiyi-178">&#x73B0;&#x5728;&#x4F7F;&#x7528;&#x663E;&#x5F0F;&#x8BED;&#x53E5;&#x5411;&#x76EE;&#x6807;&#x53D1;&#x5E03;<code class="docutils literal"><span class="pre">query.join()</span></code>&#x7684;&#x9ED8;&#x8BA4;&#x65B9;&#x6CD5;&#x662F;&#xFF1A;</span></p><div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">query</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">SomeClass</span><span class="p">,</span> <span class="n">SomeClass</span><span class="o">.</span><span class="n">id</span><span class="o">==</span><span class="n">ParentClass</span><span class="o">.</span><span class="n">some_id</span><span class="p">)</span></pre></div></div><p><span class="yiyi-st" id="yiyi-179">&#x5728;0.6&#x4E2D;&#xFF0C;&#x8FD9;&#x4E2A;&#x7528;&#x6CD5;&#x88AB;&#x8BA4;&#x4E3A;&#x662F;&#x4E00;&#x4E2A;&#x9519;&#x8BEF;&#xFF0C;&#x56E0;&#x4E3A;<code class="docutils literal"><span class="pre">join()</span></code>&#x63A5;&#x53D7;&#x591A;&#x4E2A;&#x5BF9;&#x5E94;&#x4E8E;&#x591A;&#x4E2A;JOIN&#x5B50;&#x53E5;&#x7684;&#x53C2;&#x6570; - &#x4E24;&#x4E2A;&#x53C2;&#x6570;&#x5F62;&#x5F0F;&#x9700;&#x8981;&#x5728;&#x4E00;&#x4E2A;&#x5143;&#x7EC4;&#x4E2D;&#x4EE5;&#x6D88;&#x9664;&#x5355;&#x53C2;&#x6570;&#x548C;&#x53CC;&#x53C2;&#x6570;&#x8FDE;&#x63A5;&#x76EE;&#x6807;&#x3002;</span><span class="yiyi-st" id="yiyi-180">&#x5728;0.6&#x7684;&#x4E2D;&#x95F4;&#xFF0C;&#x6211;&#x4EEC;&#x4E3A;&#x8FD9;&#x79CD;&#x7279;&#x5B9A;&#x7684;&#x8C03;&#x7528;&#x98CE;&#x683C;&#x589E;&#x52A0;&#x4E86;&#x68C0;&#x6D4B;&#x548C;&#x9519;&#x8BEF;&#x6D88;&#x606F;&#xFF0C;&#x56E0;&#x4E3A;&#x5B83;&#x5F88;&#x5E38;&#x89C1;&#x3002;</span><span class="yiyi-st" id="yiyi-181">&#x5728;0.7&#x4E2D;&#xFF0C;&#x7531;&#x4E8E;&#x6211;&#x4EEC;&#x65E0;&#x8BBA;&#x5982;&#x4F55;&#x90FD;&#x5728;&#x68C0;&#x6D4B;&#x786E;&#x5207;&#x7684;&#x6A21;&#x5F0F;&#xFF0C;&#x5E76;&#x4E14;&#x7531;&#x4E8E;&#x4E0D;&#x5FC5;&#x7406;&#x7531;&#x5730;&#x952E;&#x5165;&#x5143;&#x7EC4;&#x662F;&#x975E;&#x5E38;&#x70E6;&#x4EBA;&#x7684;&#xFF0C;&#x6240;&#x4EE5;&#x975E;&#x5143;&#x7EC4;&#x65B9;&#x6CD5;&#x73B0;&#x5728;&#x53D8;&#x6210;&#x4E86;&#x201C;&#x6B63;&#x5E38;&#x201D;&#x7684;&#x65B9;&#x5F0F;&#x3002;</span><span class="yiyi-st" id="yiyi-182">&#x4E0E;&#x5355;&#x8FDE;&#x63A5;&#x60C5;&#x51B5;&#x76F8;&#x6BD4;&#xFF0C;&#x201C;&#x591A;JOIN&#x201D;&#x7528;&#x4F8B;&#x975E;&#x5E38;&#x7F55;&#x89C1;&#xFF0C;&#x5E76;&#x4E14;&#x901A;&#x8FC7;&#x591A;&#x6B21;&#x8C03;&#x7528;<code class="docutils literal"><span class="pre">join()</span></code>&#x53EF;&#x4EE5;&#x66F4;&#x6E05;&#x695A;&#x5730;&#x8868;&#x793A;&#x591A;&#x4E2A;&#x8FDE;&#x63A5;&#x3002;</span></p><p><span class="yiyi-st" id="yiyi-183">&#x5143;&#x7EC4;&#x8868;&#x5355;&#x5C06;&#x4FDD;&#x6301;&#x5411;&#x540E;&#x517C;&#x5BB9;&#x3002;</span></p><p><span class="yiyi-st" id="yiyi-184">&#x8BF7;&#x6CE8;&#x610F;&#xFF0C;<code class="docutils literal"><span class="pre">query.join()</span></code>&#x7684;&#x6240;&#x6709;&#x5176;&#x4ED6;&#x5F62;&#x5F0F;&#x4FDD;&#x6301;&#x4E0D;&#x53D8;&#xFF1A;</span></p><div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">query</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">MyClass</span><span class="o">.</span><span class="n">somerelation</span><span class="p">)</span>
<span class="n">query</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s2">&quot;somerelation&quot;</span><span class="p">)</span>
<span class="n">query</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">MyTarget</span><span class="p">)</span>
<span class="c1"># ... etc</span></pre></div></div><p><span class="yiyi-st" id="yiyi-185"><a class="reference external" href="http://www.sqlalchemy.org/docs/07/orm_tutorial.html#querying-with-joins">&#x4F7F;&#x7528;&#x8FDE;&#x63A5;&#x67E5;&#x8BE2;</a></span></p><p><span class="yiyi-st" id="yiyi-186"><a class="reference external" href="http://www.sqlalchemy.org/trac/ticket/1923">&#xFF03;1923  T0&gt;</a></span></p></div><div class="section" id="mutation-event-extension-supersedes-mutable-true"><h3><span class="yiyi-st" id="yiyi-187">&#x7A81;&#x53D8;&#x4E8B;&#x4EF6;&#x6269;&#x5C55;&#xFF0C;&#x53D6;&#x4EE3;&#x201C;mutable = True&#x201D;<a class="headerlink" href="#mutation-event-extension-supersedes-mutable-true" title="Permalink to this headline">&#xB6;</a></span></h3><p><span class="yiyi-st" id="yiyi-188">&#x4E00;&#x4E2A;&#x65B0;&#x7684;&#x6269;&#x5C55;<a class="reference internal" href="orm_extensions_mutable.html"><span>Mutation Tracking</span></a>&#x63D0;&#x4F9B;&#x4E86;&#x4E00;&#x79CD;&#x673A;&#x5236;&#xFF0C;&#x901A;&#x8FC7;&#x8BE5;&#x673A;&#x5236;&#xFF0C;&#x7528;&#x6237;&#x5B9A;&#x4E49;&#x7684;&#x6570;&#x636E;&#x7C7B;&#x578B;&#x53EF;&#x4EE5;&#x5C06;&#x6539;&#x53D8;&#x4E8B;&#x4EF6;&#x63D0;&#x4F9B;&#x7ED9;&#x62E5;&#x6709;&#x7684;&#x7236;&#x6BCD;&#x6216;&#x7236;&#x6BCD;&#x3002;</span><span class="yiyi-st" id="yiyi-189">The extension includes an approach for scalar database values, such as those managed by <a class="reference internal" href="core_type_basics.html#sqlalchemy.types.PickleType" title="sqlalchemy.types.PickleType"><code class="xref py py-class docutils literal"><span class="pre">PickleType</span></code></a>, <code class="docutils literal"><span class="pre">postgresql.ARRAY</span></code>, or other custom <code class="docutils literal"><span class="pre">MutableType</span></code> classes, as well as an approach for ORM &#x201C;composites&#x201D;, those configured using <a class="reference internal" href="orm_composites.html#sqlalchemy.orm.composite" title="sqlalchemy.orm.composite"><code class="xref py py-func docutils literal"><span class="pre">composite()</span></code></a>.</span></p><div class="admonition seealso"><p class="first admonition-title"><span class="yiyi-st" id="yiyi-190">&#x4E5F;&#x53EF;&#x4EE5;&#x770B;&#x770B;</span></p><p class="last"><span class="yiyi-st" id="yiyi-191"><a class="reference internal" href="orm_extensions_mutable.html"><span>Mutation Tracking</span></a></span></p></div></div><div class="section" id="nulls-first-nulls-last-operators"><h3><span class="yiyi-st" id="yiyi-192">NULLS FIRST / NULLS LAST&#x8FD0;&#x7B97;&#x7B26;<a class="headerlink" href="#nulls-first-nulls-last-operators" title="Permalink to this headline">&#xB6;</a></span></h3><p><span class="yiyi-st" id="yiyi-193">&#x8FD9;&#x4E9B;&#x88AB;&#x5B9E;&#x73B0;&#x4E3A;<code class="docutils literal"><span class="pre">asc()</span></code>&#x548C;<code class="docutils literal"><span class="pre">desc()</span></code>&#x8FD0;&#x7B97;&#x7B26;&#x7684;&#x6269;&#x5C55;&#xFF0C;&#x79F0;&#x4E3A;<code class="docutils literal"><span class="pre">nullsfirst()</span></code>&#x548C;<code class="docutils literal"><span class="pre">nullslast()</span></code></span></p><div class="admonition seealso"><p class="first admonition-title"><span class="yiyi-st" id="yiyi-194">&#x4E5F;&#x53EF;&#x4EE5;&#x770B;&#x770B;</span></p><p><span class="yiyi-st" id="yiyi-195"><a class="reference internal" href="core_sqlelement.html#sqlalchemy.sql.expression.nullsfirst" title="sqlalchemy.sql.expression.nullsfirst"><code class="xref py py-func docutils literal"><span class="pre">nullsfirst()</span></code></a></span></p><p class="last"><span class="yiyi-st" id="yiyi-196"><a class="reference internal" href="core_sqlelement.html#sqlalchemy.sql.expression.nullslast" title="sqlalchemy.sql.expression.nullslast"><code class="xref py py-func docutils literal"><span class="pre">nullslast()</span></code></a></span></p></div><p><span class="yiyi-st" id="yiyi-197"><a class="reference external" href="http://www.sqlalchemy.org/trac/ticket/723">&#xFF03;723  T0&gt;</a></span></p></div><div class="section" id="select-distinct-query-distinct-accepts-args-for-postgresql-distinct-on"><h3><span class="yiyi-st" id="yiyi-198">select.distinct()&#xFF0C;query.distinct()&#x63A5;&#x53D7;PostgreSQL&#x7684;* args DISTINCT ON <a class="headerlink" href="#select-distinct-query-distinct-accepts-args-for-postgresql-distinct-on" title="Permalink to this headline">&#xB6;</a></span></h3><p><span class="yiyi-st" id="yiyi-199">This was already available by passing a list of expressions to the <code class="docutils literal"><span class="pre">distinct</span></code> keyword argument of <code class="docutils literal"><span class="pre">select()</span></code>, the <code class="docutils literal"><span class="pre">distinct()</span></code> method of <code class="docutils literal"><span class="pre">select()</span></code> and <code class="docutils literal"><span class="pre">Query</span></code> now accept positional arguments which are rendered as DISTINCT ON when a Postgresql backend is used.</span></p><p><span class="yiyi-st" id="yiyi-200"><a class="reference external" href="http://www.sqlalchemy.org/docs/07/core_expression_api.html#sqlalchemy.sql.expression.Select.distinct">&#x4E0D;&#x540C;() T0&gt;</a></span></p><p><span class="yiyi-st" id="yiyi-201"><a class="reference external" href="http://www.sqlalchemy.org/docs/07/orm_query.html#sqlalchemy.orm.query.Query.distinct"> Query.distinct() T0&gt;</a></span></p><p><span class="yiyi-st" id="yiyi-202"><a class="reference external" href="http://www.sqlalchemy.org/trac/ticket/1069">&#xFF03;1069  T0&gt;</a></span></p></div><div class="section" id="index-can-be-placed-inline-inside-of-table-table-args"><h3><span class="yiyi-st" id="yiyi-203"><code class="docutils literal"><span class="pre">Index()</span></code>&#x53EF;&#x4EE5;&#x5728;<code class="docutils literal"><span class="pre">Table</span></code>&#xFF0C;<code class="docutils literal"><span class="pre">__table_args__</span></code> <a class="headerlink" href="#index-can-be-placed-inline-inside-of-table-table-args" title="Permalink to this headline">&#xB6;</a></span></h3><p><span class="yiyi-st" id="yiyi-204">Index()&#x6784;&#x9020;&#x53EF;&#x4EE5;&#x4E0E;&#x8868;&#x5B9A;&#x4E49;&#x4E00;&#x8D77;&#x5185;&#x8054;&#x521B;&#x5EFA;&#xFF0C;&#x4F7F;&#x7528;&#x5B57;&#x7B26;&#x4E32;&#x4F5C;&#x4E3A;&#x5217;&#x540D;&#xFF0C;&#x4F5C;&#x4E3A;&#x5728;&#x8868;&#x5916;&#x521B;&#x5EFA;&#x7D22;&#x5F15;&#x7684;&#x66FF;&#x4EE3;&#x65B9;&#x6CD5;&#x3002;</span><span class="yiyi-st" id="yiyi-205">&#x90A3;&#x662F;&#xFF1A;</span></p><div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">Table</span><span class="p">(</span><span class="s1">&apos;mytable&apos;</span><span class="p">,</span> <span class="n">metadata</span><span class="p">,</span>
        <span class="n">Column</span><span class="p">(</span><span class="s1">&apos;id&apos;</span><span class="p">,</span><span class="n">Integer</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="bp">True</span><span class="p">),</span>
        <span class="n">Column</span><span class="p">(</span><span class="s1">&apos;name&apos;</span><span class="p">,</span> <span class="n">String</span><span class="p">(</span><span class="mi">50</span><span class="p">),</span> <span class="n">nullable</span><span class="o">=</span><span class="bp">False</span><span class="p">),</span>
        <span class="n">Index</span><span class="p">(</span><span class="s1">&apos;idx_name&apos;</span><span class="p">,</span> <span class="s1">&apos;name&apos;</span><span class="p">)</span>
<span class="p">)</span></pre></div></div><p><span class="yiyi-st" id="yiyi-206">&#x8FD9;&#x91CC;&#x7684;&#x4E3B;&#x8981;&#x57FA;&#x672C;&#x539F;&#x7406;&#x662F;&#x4E3A;&#x4E86;&#x58F0;&#x660E;<code class="docutils literal"><span class="pre">__table_args__</span></code>&#x7684;&#x597D;&#x5904;&#xFF0C;&#x7279;&#x522B;&#x662F;&#x5728;&#x4E0E;mixin&#x4E00;&#x8D77;&#x4F7F;&#x7528;&#x65F6;&#xFF1A;</span></p><div class="highlight-python"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">HasNameMixin</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="n">name</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="s1">&apos;name&apos;</span><span class="p">,</span> <span class="n">String</span><span class="p">(</span><span class="mi">50</span><span class="p">),</span> <span class="n">nullable</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
    <span class="nd">@declared_attr</span>
    <span class="k">def</span> <span class="nf">__table_args__</span><span class="p">(</span><span class="n">cls</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">Index</span><span class="p">(</span><span class="s1">&apos;name&apos;</span><span class="p">),</span> <span class="p">{})</span>

<span class="k">class</span> <span class="nc">User</span><span class="p">(</span><span class="n">HasNameMixin</span><span class="p">,</span> <span class="n">Base</span><span class="p">):</span>
    <span class="n">__tablename__</span> <span class="o">=</span> <span class="s1">&apos;user&apos;</span>
    <span class="nb">id</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="s1">&apos;id&apos;</span><span class="p">,</span> <span class="n">Integer</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span></pre></div></div><p><span class="yiyi-st" id="yiyi-207"><a class="reference external" href="http://www.sqlalchemy.org/docs/07/core_schema.html#indexes">&#x7D22;&#x5F15; T0&gt;</a></span></p></div><div class="section" id="window-function-sql-construct"><h3><span class="yiyi-st" id="yiyi-208">&#x7A97;&#x53E3;&#x51FD;&#x6570;SQL&#x6784;&#x9020;<a class="headerlink" href="#window-function-sql-construct" title="Permalink to this headline">&#xB6;</a></span></h3><p><span class="yiyi-st" id="yiyi-209">&#x201C;&#x7A97;&#x53E3;&#x51FD;&#x6570;&#x201D;&#x5728;&#x7ED3;&#x679C;&#x96C6;&#x751F;&#x6210;&#x65F6;&#x63D0;&#x4F9B;&#x6709;&#x5173;&#x7ED3;&#x679C;&#x96C6;&#x7684;&#x4FE1;&#x606F;&#x3002;</span><span class="yiyi-st" id="yiyi-210">&#x8FD9;&#x5141;&#x8BB8;&#x9488;&#x5BF9;&#x8BF8;&#x5982;&#x201C;&#x884C;&#x53F7;&#x201D;&#xFF0C;&#x201C;&#x7B49;&#x7EA7;&#x201D;&#x7B49;&#x5404;&#x79CD;&#x4E8B;&#x7269;&#x7684;&#x6807;&#x51C6;&#x3002;</span><span class="yiyi-st" id="yiyi-211">&#x5DF2;&#x77E5;&#x5B83;&#x4EEC;&#x81F3;&#x5C11;&#x7531;Postgresql&#xFF0C;SQL Server&#x548C;Oracle&#x652F;&#x6301;&#xFF0C;&#x53EF;&#x80FD;&#x8FD8;&#x6709;&#x5176;&#x4ED6;&#x652F;&#x6301;&#x3002;</span></p><p><span class="yiyi-st" id="yiyi-212">&#x5BF9;&#x7A97;&#x53E3;&#x51FD;&#x6570;&#x7684;&#x6700;&#x4F73;&#x4ECB;&#x7ECD;&#x5728;Postgresql&#x7684;&#x7AD9;&#x70B9;&#x4E0A;&#xFF0C;&#x4ECE;8.4&#x7248;&#x5F00;&#x59CB;&#x652F;&#x6301;&#x7A97;&#x53E3;&#x51FD;&#x6570;&#xFF1A;</span></p><p><span class="yiyi-st" id="yiyi-213"><a class="reference external" href="http://www.postgresql.org/docs/9.0/static/tutorial">http://www.postgresql.org/docs/9.0/static/tutorial</a>  -  window.html</span></p><p><span class="yiyi-st" id="yiyi-214">SQLAlchemy&#x4F7F;&#x7528;<code class="docutils literal"><span class="pre">over()</span></code>&#x65B9;&#x6CD5;&#x63D0;&#x4F9B;&#x4E00;&#x4E2A;&#x901A;&#x5E38;&#x901A;&#x8FC7;&#x73B0;&#x6709;&#x51FD;&#x6570;&#x5B50;&#x53E5;&#x8C03;&#x7528;&#x7684;&#x7B80;&#x5355;&#x7ED3;&#x6784;&#xFF0C;&#x8BE5;&#x65B9;&#x6CD5;&#x63A5;&#x53D7;<code class="docutils literal"><span class="pre">order_by</span></code>&#x548C;<code class="docutils literal"><span class="pre">partition_by</span></code>&#x5173;&#x952E;&#x5B57;&#x53C2;&#x6570;&#x3002;</span><span class="yiyi-st" id="yiyi-215">&#x4E0B;&#x9762;&#x6211;&#x4EEC;&#x590D;&#x5236;PG&#x6559;&#x7A0B;&#x4E2D;&#x7684;&#x7B2C;&#x4E00;&#x4E2A;&#x4F8B;&#x5B50;&#xFF1A;</span></p><div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sqlalchemy.sql</span> <span class="kn">import</span> <span class="n">table</span><span class="p">,</span> <span class="n">column</span><span class="p">,</span> <span class="n">select</span><span class="p">,</span> <span class="n">func</span>

<span class="n">empsalary</span> <span class="o">=</span> <span class="n">table</span><span class="p">(</span><span class="s1">&apos;empsalary&apos;</span><span class="p">,</span>
                <span class="n">column</span><span class="p">(</span><span class="s1">&apos;depname&apos;</span><span class="p">),</span>
                <span class="n">column</span><span class="p">(</span><span class="s1">&apos;empno&apos;</span><span class="p">),</span>
                <span class="n">column</span><span class="p">(</span><span class="s1">&apos;salary&apos;</span><span class="p">))</span>

<span class="n">s</span> <span class="o">=</span> <span class="n">select</span><span class="p">([</span>
        <span class="n">empsalary</span><span class="p">,</span>
        <span class="n">func</span><span class="o">.</span><span class="n">avg</span><span class="p">(</span><span class="n">empsalary</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">salary</span><span class="p">)</span><span class="o">.</span>
              <span class="n">over</span><span class="p">(</span><span class="n">partition_by</span><span class="o">=</span><span class="n">empsalary</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">depname</span><span class="p">)</span><span class="o">.</span>
              <span class="n">label</span><span class="p">(</span><span class="s1">&apos;avg&apos;</span><span class="p">)</span>
    <span class="p">])</span>

<span class="k">print</span><span class="p">(</span><span class="n">s</span><span class="p">)</span></pre></div></div><p><span class="yiyi-st" id="yiyi-216">SQL&#xFF1A;</span></p><div class="highlight-python"><div class="highlight"><pre><span></span>SELECT empsalary.depname, empsalary.empno, empsalary.salary,
avg(empsalary.salary) OVER (PARTITION BY empsalary.depname) AS avg
FROM empsalary</pre></div></div><p><span class="yiyi-st" id="yiyi-217"><a class="reference external" href="http://www.sqlalchemy.org/docs/07/core_expression_api.html#sqlalchemy.sql.expression.over"> sqlalchemy.sql.expression.over  T0&gt;</a></span></p><p><span class="yiyi-st" id="yiyi-218"><a class="reference external" href="http://www.sqlalchemy.org/trac/ticket/1844">&#xFF03;1844  T0&gt;</a></span></p></div><div class="section" id="execution-options-on-connection-accepts-isolation-level-argument"><h3><span class="yiyi-st" id="yiyi-219">Connection&#x4E0A;&#x7684;execution_options()&#x63A5;&#x53D7;&#x201C;isolation_level&#x201D;&#x53C2;&#x6570;<a class="headerlink" href="#execution-options-on-connection-accepts-isolation-level-argument" title="Permalink to this headline">&#xB6;</a></span></h3><p><span class="yiyi-st" id="yiyi-220">&#x8FD9;&#x4E3A;&#x5355;&#x4E2A;<code class="docutils literal"><span class="pre">Connection</span></code>&#x8BBE;&#x7F6E;&#x4E8B;&#x52A1;&#x9694;&#x79BB;&#x7EA7;&#x522B;&#xFF0C;&#x76F4;&#x5230;<code class="docutils literal"><span class="pre">Connection</span></code>&#x5173;&#x95ED;&#xFF0C;&#x5E76;&#x4E14;&#x5176;&#x57FA;&#x7840;DBAPI&#x8D44;&#x6E90;&#x8FD4;&#x56DE;&#x5230;&#x8FDE;&#x63A5;&#x6C60;&#xFF0C;&#x9694;&#x79BB;&#x7EA7;&#x522B;&#x91CD;&#x7F6E;&#x4E3A;&#x8FDE;&#x63A5;&#x6C60;&#x9ED8;&#x8BA4;&#x3002;</span><span class="yiyi-st" id="yiyi-221">&#x9ED8;&#x8BA4;&#x9694;&#x79BB;&#x7EA7;&#x522B;&#x662F;&#x4F7F;&#x7528;<code class="docutils literal"><span class="pre">create_engine()</span></code>&#x7684;<code class="docutils literal"><span class="pre">isolation_level</span></code>&#x53C2;&#x6570;&#x8BBE;&#x7F6E;&#x7684;&#x3002;</span></p><p><span class="yiyi-st" id="yiyi-222">&#x4E8B;&#x52A1;&#x9694;&#x79BB;&#x652F;&#x6301;&#x76EE;&#x524D;&#x4EC5;&#x652F;&#x6301;Postgresql&#x548C;SQLite&#x540E;&#x7AEF;&#x3002;</span></p><p><span class="yiyi-st" id="yiyi-223"><a class="reference external" href="http://www.sqlalchemy.org/docs/07/core_connections.html#sqlalchemy.engine.base.Connection.execution_options"> execution_options() T0&gt;</a></span></p><p><span class="yiyi-st" id="yiyi-224"><a class="reference external" href="http://www.sqlalchemy.org/trac/ticket/2001">&#xFF03;2001  T0&gt;</a></span></p></div><div class="section" id="typedecorator-works-with-integer-primary-key-columns"><h3><span class="yiyi-st" id="yiyi-225"><code class="docutils literal"><span class="pre">TypeDecorator</span></code>&#x4F7F;&#x7528;&#x6574;&#x6570;&#x4E3B;&#x952E;&#x5217;<a class="headerlink" href="#typedecorator-works-with-integer-primary-key-columns" title="Permalink to this headline">&#xB6;</a></span></h3><p><span class="yiyi-st" id="yiyi-226">&#x6269;&#x5C55;<code class="docutils literal"><span class="pre">Integer</span></code>&#x884C;&#x4E3A;&#x7684;<code class="docutils literal"><span class="pre">TypeDecorator</span></code>&#x53EF;&#x4EE5;&#x4E0E;&#x4E3B;&#x952E;&#x5217;&#x4E00;&#x8D77;&#x4F7F;&#x7528;&#x3002;</span><span class="yiyi-st" id="yiyi-227"><code class="docutils literal"><span class="pre">Column</span></code>&#x7684;&#x201C;&#x81EA;&#x52A8;&#x589E;&#x91CF;&#x201D;&#x529F;&#x80FD;&#x73B0;&#x5728;&#x5C06;&#x8BA4;&#x8BC6;&#x5230;&#x5E95;&#x5C42;&#x6570;&#x636E;&#x5E93;&#x5217;&#x4ECD;&#x7136;&#x662F;&#x4E00;&#x4E2A;&#x6574;&#x6570;&#xFF0C;&#x4EE5;&#x4FBF;&#x62C9;&#x65AF;&#x7279;&#x74E6;&#x5C14;&#x5FB7;&#x673A;&#x5236;&#x7EE7;&#x7EED;&#x53D1;&#x6325;&#x4F5C;&#x7528;&#x3002;</span><span class="yiyi-st" id="yiyi-228"><code class="docutils literal"><span class="pre">TypeDecorator</span></code>&#x672C;&#x8EAB;&#x5C06;&#x5176;&#x7ED3;&#x679C;&#x503C;&#x5904;&#x7406;&#x5668;&#x5E94;&#x7528;&#x4E8E;&#x65B0;&#x751F;&#x6210;&#x7684;&#x4E3B;&#x952E;&#xFF0C;&#x5305;&#x62EC;&#x7531;DBAPI <code class="docutils literal"><span class="pre">cursor.lastrowid</span></code>&#x8BBF;&#x95EE;&#x5668;&#x63A5;&#x6536;&#x7684;&#x4E3B;&#x952E;&#x3002;</span></p><p><span class="yiyi-st" id="yiyi-229"><a class="reference external" href="http://www.sqlalchemy.org/trac/ticket/2005">&#xFF03;2005</a> <a class="reference external" href="http://www.sqlalchemy.org/trac/ticket/2006">&#xFF03;2006</a></span></p></div><div class="section" id="typedecorator-is-present-in-the-sqlalchemy-import-space"><h3><span class="yiyi-st" id="yiyi-230"><code class="docutils literal"><span class="pre">TypeDecorator</span></code>&#x5B58;&#x5728;&#x4E8E;&#x201C;sqlalchemy&#x201D;&#x5BFC;&#x5165;&#x7A7A;&#x95F4;&#x4E2D;<a class="headerlink" href="#typedecorator-is-present-in-the-sqlalchemy-import-space" title="Permalink to this headline">&#xB6;</a></span></h3><p><span class="yiyi-st" id="yiyi-231">&#x4E0D;&#x518D;&#x9700;&#x8981;&#x4ECE;<code class="docutils literal"><span class="pre">sqlalchemy.types</span></code>&#x4E2D;&#x5BFC;&#x5165;&#x5B83;&#xFF0C;&#x5B83;&#x73B0;&#x5728;&#x955C;&#x50CF;&#x5728;<code class="docutils literal"><span class="pre">sqlalchemy</span></code>&#x4E2D;&#x3002;</span></p></div><div class="section" id="new-dialects"><h3><span class="yiyi-st" id="yiyi-232">&#x65B0;&#x65B9;&#x8A00;<a class="headerlink" href="#new-dialects" title="Permalink to this headline">&#xB6;</a></span></h3><p><span class="yiyi-st" id="yiyi-233">&#x65B9;&#x8A00;&#x5DF2;&#x88AB;&#x6DFB;&#x52A0;&#xFF1A;</span></p><ul><li><p class="first"><span class="yiyi-st" id="yiyi-234">Drizzle&#x6570;&#x636E;&#x5E93;&#x7684;MySQLdb&#x9A71;&#x52A8;&#x7A0B;&#x5E8F;&#xFF1A;</span></p><p><span class="yiyi-st" id="yiyi-235"><a class="reference external" href="http://www.sqlalchemy.org/docs/07/dialects_drizzle.html">&#x7EC6;&#x96E8; T0&gt;</a></span></p></li><li><p class="first"><span class="yiyi-st" id="yiyi-236">&#x652F;&#x6301;pymysql DBAPI&#xFF1A;</span></p><p><span class="yiyi-st" id="yiyi-237"><a class="reference external" href="http://www.sqlalchemy.org/docs/07/dialects_mysql.html#module-sqlalchemy.dialects.mysql.pymysql">pymsql&#x6CE8;&#x91CA;</a></span></p></li><li><p class="first"><span class="yiyi-st" id="yiyi-238">psycopg2&#x73B0;&#x5728;&#x53EF;&#x4EE5;&#x4E0E;Python 3&#x4E00;&#x8D77;&#x4F7F;&#x7528;</span></p></li></ul></div></div><div class="section" id="behavioral-changes-backwards-compatible"><h2><span class="yiyi-st" id="yiyi-239">&#x884C;&#x4E3A;&#x6539;&#x53D8;&#xFF08;&#x5411;&#x540E;&#x517C;&#x5BB9;&#xFF09;<a class="headerlink" href="#behavioral-changes-backwards-compatible" title="Permalink to this headline">&#xB6;</a></span></h2><div class="section" id="c-extensions-build-by-default"><h3><span class="yiyi-st" id="yiyi-240">C&#x6269;&#x5C55;&#x9ED8;&#x8BA4;&#x751F;&#x6210;<a class="headerlink" href="#c-extensions-build-by-default" title="Permalink to this headline">&#xB6;</a></span></h3><p><span class="yiyi-st" id="yiyi-241">&#x8FD9;&#x662F;0.7b4&#x3002;</span><span class="yiyi-st" id="yiyi-242">&#x5982;&#x679C;&#x68C0;&#x6D4B;&#x5230;cPython 2.xx&#xFF0C;Exts&#x5C06;&#x751F;&#x6210;&#x3002;</span><span class="yiyi-st" id="yiyi-243">&#x5982;&#x679C;&#x6784;&#x5EFA;&#x5931;&#x8D25;&#xFF0C;&#x4F8B;&#x5982;&#x5728;Windows&#x5B89;&#x88C5;&#x4E2D;&#xFF0C;&#x5219;&#x6355;&#x83B7;&#x8BE5;&#x6761;&#x4EF6;&#x5E76;&#x7EE7;&#x7EED;&#x8FDB;&#x884C;&#x975E;C&#x5B89;&#x88C5;&#x3002;</span><span class="yiyi-st" id="yiyi-244">&#x5982;&#x679C;&#x4F7F;&#x7528;Python 3&#x6216;Pypy&#xFF0C;C exts&#x5C06;&#x4E0D;&#x4F1A;&#x751F;&#x6210;&#x3002;</span></p></div><div class="section" id="query-count-simplified-should-work-virtually-always"><h3><span class="yiyi-st" id="yiyi-245">Query.count()&#x7B80;&#x5316;&#x540E;&#xFF0C;&#x5E94;&#x8BE5;&#x59CB;&#x7EC8;&#x5DE5;&#x4F5C;<a class="headerlink" href="#query-count-simplified-should-work-virtually-always" title="Permalink to this headline">&#xB6;</a></span></h3><p><span class="yiyi-st" id="yiyi-246">&#x5728;<code class="docutils literal"><span class="pre">Query.count()</span></code>&#x4E2D;&#x53D1;&#x751F;&#x7684;&#x975E;&#x5E38;&#x53E4;&#x8001;&#x7684;&#x731C;&#x6D4B;&#x5DF2;&#x7ECF;&#x73B0;&#x4EE3;&#x5316;&#x4EE5;&#x4F7F;&#x7528;<code class="docutils literal"><span class="pre">.from_self()</span></code>&#x3002;</span><span class="yiyi-st" id="yiyi-247">That is, <code class="docutils literal"><span class="pre">query.count()</span></code> is now equivalent to:</span></p><div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">query</span><span class="o">.</span><span class="n">from_self</span><span class="p">(</span><span class="n">func</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="n">literal_column</span><span class="p">(</span><span class="s1">&apos;1&apos;</span><span class="p">)))</span><span class="o">.</span><span class="n">scalar</span><span class="p">()</span></pre></div></div><p><span class="yiyi-st" id="yiyi-248">&#x4EE5;&#x524D;&#xFF0C;&#x5185;&#x90E8;&#x903B;&#x8F91;&#x8BD5;&#x56FE;&#x91CD;&#x5199;&#x67E5;&#x8BE2;&#x672C;&#x8EAB;&#x7684;&#x5217;&#x5B50;&#x53E5;&#xFF0C;&#x5E76;&#x4E14;&#x5728;&#x68C0;&#x6D4B;&#x5230;&#x201C;&#x5B50;&#x67E5;&#x8BE2;&#x201D;&#x6761;&#x4EF6;&#xFF08;&#x4F8B;&#x5982;&#x53EF;&#x80FD;&#x5305;&#x542B;&#x805A;&#x5408;&#x7684;&#x5217;&#x67E5;&#x8BE2;&#x6216;&#x5177;&#x6709;DISTINCT&#x7684;&#x67E5;&#x8BE2;&#xFF09;&#x65F6;&#xFF0C;&#x4F1A;&#x7ECF;&#x5386;&#x590D;&#x6742;&#x91CD;&#x5199;&#x5217;&#x5B50;&#x53E5;&#x7684;&#x8FC7;&#x7A0B;&#x3002;</span><span class="yiyi-st" id="yiyi-249">&#x8FD9;&#x79CD;&#x903B;&#x8F91;&#x5728;&#x590D;&#x6742;&#x6761;&#x4EF6;&#x4E0B;&#x5931;&#x8D25;&#x4E86;&#xFF0C;&#x7279;&#x522B;&#x662F;&#x90A3;&#x4E9B;&#x6D89;&#x53CA;&#x5230;&#x8FDE;&#x63A5;&#x8868;&#x7EE7;&#x627F;&#x7684;&#x903B;&#x8F91;&#xFF0C;&#x5E76;&#x4E14;&#x7531;&#x4E8E;&#x66F4;&#x5168;&#x9762;&#x7684;<code class="docutils literal"><span class="pre">.from_self()</span></code>&#x8C03;&#x7528;&#x5DF2;&#x7ECF;&#x8FC7;&#x65F6;&#x4E86;&#x3002;</span></p><p><span class="yiyi-st" id="yiyi-250">&#x7531;<code class="docutils literal"><span class="pre">query.count()</span></code>&#x53D1;&#x51FA;&#x7684;SQL&#x73B0;&#x5728;&#x603B;&#x662F;&#x5982;&#x4E0B;&#x5F62;&#x5F0F;&#xFF1A;</span></p><div class="highlight-python"><div class="highlight"><pre><span></span>SELECT count(1) AS count_1 FROM (
    SELECT user.id AS user_id, user.name AS user_name from user
) AS anon_1</pre></div></div><p><span class="yiyi-st" id="yiyi-251">&#x4E5F;&#x5C31;&#x662F;&#x8BF4;&#xFF0C;&#x539F;&#x59CB;&#x67E5;&#x8BE2;&#x5B8C;&#x5168;&#x4FDD;&#x7559;&#x5728;&#x5B50;&#x67E5;&#x8BE2;&#x4E2D;&#xFF0C;&#x4E0D;&#x518D;&#x731C;&#x6D4B;&#x5E94;&#x8BE5;&#x5982;&#x4F55;&#x5E94;&#x7528;&#x8BA1;&#x6570;&#x3002;</span></p><p><span class="yiyi-st" id="yiyi-252"><a class="reference external" href="http://www.sqlalchemy.org/trac/ticket/2093">&#xFF03;2093  T0&gt;</a></span></p><div class="section" id="to-emit-a-non-subquery-form-of-count"><h4><span class="yiyi-st" id="yiyi-253">&#x53D1;&#x51FA;&#x4E00;&#x4E2A;&#x975E;&#x5B50;&#x67E5;&#x8BE2;&#x5F62;&#x5F0F;&#x7684;count()<a class="headerlink" href="#to-emit-a-non-subquery-form-of-count" title="Permalink to this headline">&#xB6;</a></span></h4><p><span class="yiyi-st" id="yiyi-254">MySQL&#x7528;&#x6237;&#x5DF2;&#x7ECF;&#x62A5;&#x9053;&#x8FC7;&#xFF0C;MyISAM&#x5F15;&#x64CE;&#x4E0D;&#x4F1A;&#x56E0;&#x4E3A;&#x8FD9;&#x4E2A;&#x7B80;&#x5355;&#x7684;&#x6539;&#x53D8;&#x800C;&#x5B8C;&#x5168;&#x843D;&#x7A7A;&#x3002;</span><span class="yiyi-st" id="yiyi-255">&#x8BF7;&#x6CE8;&#x610F;&#xFF0C;&#x5BF9;&#x4E8E;&#x9488;&#x5BF9;&#x65E0;&#x6CD5;&#x5904;&#x7406;&#x7B80;&#x5355;&#x5B50;&#x67E5;&#x8BE2;&#x7684;DB&#x8FDB;&#x884C;&#x4F18;&#x5316;&#x7684;&#x7B80;&#x5355;<code class="docutils literal"><span class="pre">count()</span></code>&#xFF0C;&#x5E94;&#x8BE5;&#x4F7F;&#x7528;<code class="docutils literal"><span class="pre">func.count()</span></code>&#xFF1A;</span></p><div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sqlalchemy</span> <span class="kn">import</span> <span class="n">func</span>
<span class="n">session</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">func</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="n">MyClass</span><span class="o">.</span><span class="n">id</span><span class="p">))</span><span class="o">.</span><span class="n">scalar</span><span class="p">()</span></pre></div></div><p><span class="yiyi-st" id="yiyi-256">&#x6216;&#x8005;&#x7528;&#x4E8E;<code class="docutils literal"><span class="pre">count(*)</span></code>&#xFF1A;</span></p><div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sqlalchemy</span> <span class="kn">import</span> <span class="n">func</span><span class="p">,</span> <span class="n">literal_column</span>
<span class="n">session</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">func</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="n">literal_column</span><span class="p">(</span><span class="s1">&apos;*&apos;</span><span class="p">)))</span><span class="o">.</span><span class="n">select_from</span><span class="p">(</span><span class="n">MyClass</span><span class="p">)</span><span class="o">.</span><span class="n">scalar</span><span class="p">()</span></pre></div></div></div></div><div class="section" id="limit-offset-clauses-now-use-bind-parameters"><h3><span class="yiyi-st" id="yiyi-257">LIMIT / OFFSET&#x5B50;&#x53E5;&#x73B0;&#x5728;&#x4F7F;&#x7528;&#x7ED1;&#x5B9A;&#x53C2;&#x6570;<a class="headerlink" href="#limit-offset-clauses-now-use-bind-parameters" title="Permalink to this headline">&#xB6;</a></span></h3><p><span class="yiyi-st" id="yiyi-258">LIMIT&#x548C;OFFSET&#x5B50;&#x53E5;&#x6216;&#x5176;&#x540E;&#x7AEF;&#x7B49;&#x4EF7;&#x7269;&#xFF08;&#x5373;TOP&#xFF0C;ROW NUMBER OVER&#x7B49;</span><span class="yiyi-st" id="yiyi-259">&#xFF09;&#xFF0C;&#x4E3A;&#x5B9E;&#x9645;&#x503C;&#x4F7F;&#x7528;&#x7ED1;&#x5B9A;&#x53C2;&#x6570;&#xFF0C;&#x652F;&#x6301;&#x5B83;&#x7684;&#x6240;&#x6709;&#x540E;&#x7AEF;&#xFF08;&#x9664;&#x4E86;Sybase&#x4EE5;&#x5916;&#xFF09;&#x3002;</span><span class="yiyi-st" id="yiyi-260">&#x8FD9;&#x5141;&#x8BB8;&#x66F4;&#x597D;&#x7684;&#x67E5;&#x8BE2;&#x4F18;&#x5316;&#x5668;&#x6027;&#x80FD;&#xFF0C;&#x56E0;&#x4E3A;&#x5177;&#x6709;&#x4E0D;&#x540C;LIMIT / OFFSET&#x7684;&#x591A;&#x4E2A;&#x8BED;&#x53E5;&#x7684;&#x6587;&#x672C;&#x5B57;&#x7B26;&#x4E32;&#x73B0;&#x5728;&#x662F;&#x76F8;&#x540C;&#x7684;&#x3002;</span></p><p><span class="yiyi-st" id="yiyi-261"><a class="reference external" href="http://www.sqlalchemy.org/trac/ticket/805">&#xFF03;805  T0&gt;</a></span></p></div><div class="section" id="logging-enhancements"><h3><span class="yiyi-st" id="yiyi-262">&#x65E5;&#x5FD7;&#x8BB0;&#x5F55;&#x589E;&#x5F3A;&#x529F;&#x80FD;<a class="headerlink" href="#logging-enhancements" title="Permalink to this headline">&#xB6;</a></span></h3><p><span class="yiyi-st" id="yiyi-263">Vinay Sajip&#x4E3A;&#x6211;&#x4EEC;&#x7684;&#x65E5;&#x5FD7;&#x8BB0;&#x5F55;&#x7CFB;&#x7EDF;&#x63D0;&#x4F9B;&#x4E86;&#x4E00;&#x4E2A;&#x8865;&#x4E01;&#xFF0C;&#x4F7F;&#x5F97;&#x4E0D;&#x518D;&#x9700;&#x8981;&#x5D4C;&#x5165;&#x5230;&#x5F15;&#x64CE;&#x548C;&#x6C60;&#x7684;&#x65E5;&#x5FD7;&#x8BED;&#x53E5;&#x4E2D;&#x7684;&#x201C;&#x5341;&#x516D;&#x8FDB;&#x5236;&#x5B57;&#x7B26;&#x4E32;&#x201D;&#x4EE5;&#x5141;&#x8BB8;<code class="docutils literal"><span class="pre">echo</span></code>&#x6807;&#x5FD7;&#x6B63;&#x5E38;&#x5DE5;&#x4F5C;&#x3002;</span><span class="yiyi-st" id="yiyi-264">&#x4E00;&#x4E2A;&#x4F7F;&#x7528;&#x8FC7;&#x6EE4;&#x8BB0;&#x5F55;&#x5BF9;&#x8C61;&#x7684;&#x65B0;&#x7CFB;&#x7EDF;&#x5141;&#x8BB8;&#x6211;&#x4EEC;&#x4FDD;&#x6301;&#x6211;&#x4EEC;&#x5F53;&#x524D;&#x7684;&#x884C;&#x4E3A;<code class="docutils literal"><span class="pre">echo</span></code>&#x5BF9;&#x4E8E;&#x5355;&#x4E2A;&#x5F15;&#x64CE;&#x662F;&#x672C;&#x5730;&#x7684;&#xFF0C;&#x800C;&#x4E0D;&#x9700;&#x8981;&#x5BF9;&#x8FD9;&#x4E9B;&#x5F15;&#x64CE;&#x5C40;&#x90E8;&#x7684;&#x9644;&#x52A0;&#x6807;&#x8BC6;&#x5B57;&#x7B26;&#x4E32;&#x3002;</span></p><p><span class="yiyi-st" id="yiyi-265"><a class="reference external" href="http://www.sqlalchemy.org/trac/ticket/1926">&#xFF03;1926  T0&gt;</a></span></p></div><div class="section" id="simplified-polymorphic-on-assignment"><h3><span class="yiyi-st" id="yiyi-266">&#x7B80;&#x5316;&#x7684;polymorphic_on&#x5206;&#x914D;<a class="headerlink" href="#simplified-polymorphic-on-assignment" title="Permalink to this headline">&#xB6;</a></span></h3><p><span class="yiyi-st" id="yiyi-267">&#x5F53;&#x5728;&#x7EE7;&#x627F;&#x573A;&#x666F;&#x4E2D;&#x4F7F;&#x7528;&#x65F6;&#xFF0C;<code class="docutils literal"><span class="pre">polymorphic_on</span></code>&#x5217;&#x6620;&#x5C04;&#x5C5E;&#x6027;&#x7684;&#x603B;&#x4F53;&#x73B0;&#x5728;&#x5728;&#x5BF9;&#x8C61;&#x6784;&#x9020;&#x65F6;&#x53D1;&#x751F;&#xFF0C;&#x5373;&#x4F7F;&#x7528;init&#x4E8B;&#x4EF6;&#x8C03;&#x7528;&#x5176;<code class="docutils literal"><span class="pre">__init__</span></code>&#x65B9;&#x6CD5;&#x3002;</span><span class="yiyi-st" id="yiyi-268">&#x8BE5;&#x5C5E;&#x6027;&#x7684;&#x884C;&#x4E3A;&#x4E0E;&#x4EFB;&#x4F55;&#x5176;&#x4ED6;&#x5217;&#x6620;&#x5C04;&#x5C5E;&#x6027;&#x76F8;&#x540C;&#x3002;</span><span class="yiyi-st" id="yiyi-269">&#x4EE5;&#x524D;&#xFF0C;&#x7279;&#x6B8A;&#x903B;&#x8F91;&#x4F1A;&#x5728;&#x5237;&#x65B0;&#x671F;&#x95F4;&#x89E6;&#x53D1;&#x4EE5;&#x586B;&#x5145;&#x6B64;&#x5217;&#xFF0C;&#x4ECE;&#x800C;&#x963B;&#x6B62;&#x4EFB;&#x4F55;&#x7528;&#x6237;&#x4EE3;&#x7801;&#x4FEE;&#x6539;&#x5176;&#x884C;&#x4E3A;&#x3002;</span><span class="yiyi-st" id="yiyi-270">&#x65B0;&#x65B9;&#x6CD5;&#x901A;&#x8FC7;&#x4E09;&#x79CD;&#x65B9;&#x5F0F;&#x6539;&#x8FDB;&#x4E86;&#x8FD9;&#x4E00;&#x70B9;&#xFF1A;1.&#x591A;&#x6001;&#x8EAB;&#x4EFD;&#x73B0;&#x5728;&#x5C31;&#x5728;&#x5176;&#x6784;&#x5EFA;&#x7684;&#x5BF9;&#x8C61;&#x4E0A;&#x51FA;&#x73B0;&#xFF1B; 2.&#x591A;&#x6001;&#x8EAB;&#x4EFD;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x7528;&#x6237;&#x4EE3;&#x7801;&#x8FDB;&#x884C;&#x66F4;&#x6539;&#xFF0C;&#x800C;&#x4E0D;&#x4F1A;&#x4E0E;&#x4EFB;&#x4F55;&#x5176;&#x4ED6;&#x5217;&#x6620;&#x5C04;&#x5C5E;&#x6027;&#x6709;&#x6240;&#x4E0D;&#x540C;&#xFF1B; 3.&#x5237;&#x65B0;&#x8FC7;&#x7A0B;&#x4E2D;&#x6620;&#x5C04;&#x5668;&#x7684;&#x5185;&#x90E8;&#x88AB;&#x7B80;&#x5316;&#xFF0C;&#x4E0D;&#x518D;&#x9700;&#x8981;&#x5BF9;&#x6B64;&#x5217;&#x8FDB;&#x884C;&#x7279;&#x6B8A;&#x68C0;&#x67E5;&#x3002;</span></p><p><span class="yiyi-st" id="yiyi-271"><a class="reference external" href="http://www.sqlalchemy.org/trac/ticket/1895">&#xFF03;1895  T0&gt;</a></span></p></div><div class="section" id="contains-eager-chains-across-multiple-paths-i-e-all"><h3><span class="yiyi-st" id="yiyi-272">contains_eager()&#x8FDE;&#x63A5;&#x591A;&#x4E2A;&#x8DEF;&#x5F84;&#xFF08;&#x5373;&#x201C;all()&#x201D;&#xFF09;<a class="headerlink" href="#contains-eager-chains-across-multiple-paths-i-e-all" title="Permalink to this headline">&#xB6;</a></span></h3><p><span class="yiyi-st" id="yiyi-273">&#x73B0;&#x5728;&#xFF0C;<code class="docutils literal"><span class="pre">`contains_eager()``</span></code>&#x4FEE;&#x9970;&#x7B26;&#x5C06;&#x81EA;&#x884C;&#x94FE;&#x63A5;&#x4E00;&#x6BB5;&#x66F4;&#x957F;&#x7684;&#x8DEF;&#x5F84;&#xFF0C;&#x800C;&#x4E0D;&#x9700;&#x8981;&#x53D1;&#x51FA;&#x5355;&#x72EC;&#x7684;<code class="docutils literal"><span class="pre">``contains_eager()`</span></code>&#x8C03;&#x7528;&#x3002;</span><span class="yiyi-st" id="yiyi-274">&#x4EE3;&#x66FF;&#xFF1A;</span></p><div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">session</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">A</span><span class="p">)</span><span class="o">.</span><span class="n">options</span><span class="p">(</span><span class="n">contains_eager</span><span class="p">(</span><span class="n">A</span><span class="o">.</span><span class="n">b</span><span class="p">),</span> <span class="n">contains_eager</span><span class="p">(</span><span class="n">A</span><span class="o">.</span><span class="n">b</span><span class="p">,</span> <span class="n">B</span><span class="o">.</span><span class="n">c</span><span class="p">))</span></pre></div></div><p><span class="yiyi-st" id="yiyi-275">&#x4F60;&#x53EF;&#x4EE5;&#x8BF4;&#xFF1A;</span></p><div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">session</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">A</span><span class="p">)</span><span class="o">.</span><span class="n">options</span><span class="p">(</span><span class="n">contains_eager</span><span class="p">(</span><span class="n">A</span><span class="o">.</span><span class="n">b</span><span class="p">,</span> <span class="n">B</span><span class="o">.</span><span class="n">c</span><span class="p">))</span></pre></div></div><p><span class="yiyi-st" id="yiyi-276"><a class="reference external" href="http://www.sqlalchemy.org/trac/ticket/2032">&#xFF03;2032  T0&gt;</a></span></p></div><div class="section" id="flushing-of-orphans-that-have-no-parent-is-allowed"><h3><span class="yiyi-st" id="yiyi-277">&#x7981;&#x6B62;&#x6CA1;&#x6709;&#x7236;&#x6BCD;&#x7684;&#x5B64;&#x513F;&#x88AB;&#x5141;&#x8BB8;<a class="headerlink" href="#flushing-of-orphans-that-have-no-parent-is-allowed" title="Permalink to this headline">&#xB6;</a></span></h3><p><span class="yiyi-st" id="yiyi-278">&#x6211;&#x4EEC;&#x6709;&#x4E00;&#x4E2A;&#x957F;&#x671F;&#x5B58;&#x5728;&#x7684;&#x884C;&#x4E3A;&#xFF0C;&#x5728;flush&#x671F;&#x95F4;&#x68C0;&#x67E5;&#x6240;&#x8C13;&#x7684;&#x201C;&#x5B64;&#x7ACB;&#x201D;&#xFF0C;&#x5373;&#x4E0E;<code class="docutils literal"><span class="pre">relationship()</span></code>&#x5173;&#x8054;&#x7684;&#x4E00;&#x4E2A;&#x5BF9;&#x8C61;&#xFF0C;&#x8BE5;&#x5BF9;&#x8C61;&#x6307;&#x5B9A;&#x4E86;&#x201C;delete-orphan&#x201D;&#x7EA7;&#x8054;&#xFF0C;&#x5DF2;&#x88AB;&#x65B0;&#x589E;&#x52A0;&#x5230;INSERT&#x7684;&#x4F1A;&#x8BDD;&#x4E2D;&#xFF0C;&#x5E76;&#x4E14;&#x6CA1;&#x6709;&#x5EFA;&#x7ACB;&#x7236;&#x6BCD;&#x5173;&#x7CFB;&#x3002;</span><span class="yiyi-st" id="yiyi-279">&#x8FD9;&#x9879;&#x68C0;&#x67E5;&#x662F;&#x5728;&#x51E0;&#x5E74;&#x524D;&#x6DFB;&#x52A0;&#x7684;&#xFF0C;&#x4EE5;&#x9002;&#x5E94;&#x6D4B;&#x8BD5;&#x5B64;&#x513F;&#x884C;&#x4E3A;&#x7684;&#x4E00;&#x81F4;&#x6027;&#x7684;&#x4E00;&#x4E9B;&#x6D4B;&#x8BD5;&#x6848;&#x4F8B;&#x3002;</span><span class="yiyi-st" id="yiyi-280">&#x5728;&#x73B0;&#x4EE3;SQLA&#x4E2D;&#xFF0C;&#x8FD9;&#x4E00;&#x68C0;&#x67E5;&#x5728;Python&#x65B9;&#x9762;&#x4E0D;&#x518D;&#x9700;&#x8981;&#x3002;</span><span class="yiyi-st" id="yiyi-281">&#x901A;&#x8FC7;&#x4F7F;&#x5BF9;&#x8C61;&#x7684;&#x7236;&#x884C;&#x7684;&#x5916;&#x952E;&#x5F15;&#x7528;NOT NULL&#x6765;&#x5B8C;&#x6210;&#x201C;&#x5B64;&#x7ACB;&#x68C0;&#x67E5;&#x201D;&#x7684;&#x7B49;&#x6548;&#x884C;&#x4E3A;&#xFF0C;&#x5176;&#x4E2D;&#x6570;&#x636E;&#x5E93;&#x4EE5;&#x4E0E;SQLA&#x5141;&#x8BB8;&#x5927;&#x591A;&#x6570;&#x5176;&#x4ED6;&#x64CD;&#x4F5C;&#x4E00;&#x6837;&#x7684;&#x65B9;&#x5F0F;&#x5EFA;&#x7ACB;&#x6570;&#x636E;&#x4E00;&#x81F4;&#x6027;&#x7684;&#x5DE5;&#x4F5C;&#x3002;</span><span class="yiyi-st" id="yiyi-282">&#x5982;&#x679C;&#x5BF9;&#x8C61;&#x7684;&#x7236;&#x5916;&#x952E;&#x53EF;&#x4E3A;&#x7A7A;&#xFF0C;&#x5219;&#x53EF;&#x4EE5;&#x63D2;&#x5165;&#x8BE5;&#x884C;&#x3002;</span><span class="yiyi-st" id="yiyi-283">&#x5F53;&#x5BF9;&#x8C61;&#x4E0E;&#x7279;&#x5B9A;&#x7684;&#x7236;&#x5BF9;&#x8C61;&#x6301;&#x4E45;&#x5316;&#x65F6;&#xFF0C;&#x5C06;&#x4F1A;&#x8FD0;&#x884C;&#x201C;&#x5B64;&#x513F;&#x201D;&#x884C;&#x4E3A;&#xFF0C;&#x7136;&#x540E;&#x4E0E;&#x8BE5;&#x7236;&#x5BF9;&#x8C61;&#x5173;&#x8054;&#xFF0C;&#x5BFC;&#x81F4;&#x4E3A;&#x5176;&#x53D1;&#x51FA;DELETE&#x8BED;&#x53E5;&#x3002;</span></p><p><span class="yiyi-st" id="yiyi-284"><a class="reference external" href="http://www.sqlalchemy.org/trac/ticket/1912">&#xFF03;1912  T0&gt;</a></span></p></div><div class="section" id="warnings-generated-when-collection-members-scalar-referents-not-part-of-the-flush"><h3><span class="yiyi-st" id="yiyi-285">&#x6536;&#x96C6;&#x6210;&#x5458;&#x65F6;&#x4EA7;&#x751F;&#x7684;&#x8B66;&#x544A;&#xFF0C;&#x6807;&#x91CF;&#x6307;&#x793A;&#x4E0D;&#x5C5E;&#x4E8E;flush <a class="headerlink" href="#warnings-generated-when-collection-members-scalar-referents-not-part-of-the-flush" title="Permalink to this headline">&#xB6;</a>&#x7684;&#x4E00;&#x90E8;&#x5206;</span></h3><p><span class="yiyi-st" id="yiyi-286">&#x5F53;&#x6807;&#x8BB0;&#x4E3A;&#x201C;&#x810F;&#x201D;&#x7684;&#x7236;&#x5BF9;&#x8C61;&#x4E0A;&#x901A;&#x8FC7;&#x52A0;&#x8F7D;&#x7684;<code class="docutils literal"><span class="pre">relationship()</span></code>&#x5F15;&#x7528;&#x7684;&#x76F8;&#x5173;&#x5BF9;&#x8C61;&#x5728;&#x5F53;&#x524D;<code class="docutils literal"><span class="pre">Session</span></code>&#x4E2D;&#x4E0D;&#x5B58;&#x5728;&#x65F6;&#xFF0C;&#x73B0;&#x5728;&#x4F1A;&#x53D1;&#x51FA;&#x8B66;&#x544A;&#x3002;</span></p><p><span class="yiyi-st" id="yiyi-287">&#x5F53;&#x5BF9;&#x8C61;&#x6DFB;&#x52A0;&#x5230;<code class="docutils literal"><span class="pre">Session</span></code>&#x65F6;&#xFF0C;&#x6216;&#x8005;&#x5F53;&#x5BF9;&#x8C61;&#x9996;&#x5148;&#x4E0E;&#x7236;&#x5BF9;&#x8C61;&#x5173;&#x8054;&#x65F6;&#xFF0C;<code class="docutils literal"><span class="pre">save-update</span></code>&#x7EA7;&#x8054;&#x4F1A;&#x751F;&#x6548;&#xFF0C;&#x56E0;&#x6B64;&#x901A;&#x5E38;&#x4E0E;&#x5BF9;&#x8C61;&#x76F8;&#x5173;&#x7684;&#x5BF9;&#x8C61;&#x5168;&#x90E8;&#x51FA;&#x73B0;&#x5728;&#x540C;&#x4E00;&#x4E2A;<code class="docutils literal"><span class="pre">Session</span></code>&#x4E2D;&#x3002;</span><span class="yiyi-st" id="yiyi-288">&#x4F46;&#x662F;&#xFF0C;&#x5982;&#x679C;&#x9488;&#x5BF9;&#x7279;&#x5B9A;<code class="docutils literal"><span class="pre">relationship()</span></code>&#x7981;&#x7528;<code class="docutils literal"><span class="pre">save-update</span></code>&#x7EA7;&#x8054;&#xFF0C;&#x5219;&#x4E0D;&#x4F1A;&#x53D1;&#x751F;&#x6B64;&#x884C;&#x4E3A;&#xFF0C;&#x800C;&#x5237;&#x65B0;&#x8FDB;&#x7A0B;&#x4E0D;&#x4F1A;&#x5C1D;&#x8BD5;&#x66F4;&#x6B63;&#x5B83;&#xFF0C;&#x800C;&#x662F;&#x4E0E;&#x914D;&#x7F6E;&#x7684;&#x7EA7;&#x8054;&#x884C;&#x4E3A;&#x4FDD;&#x6301;&#x4E00;&#x81F4;&#x3002;</span><span class="yiyi-st" id="yiyi-289">&#x4EE5;&#x524D;&#xFF0C;&#x5F53;&#x5728;&#x51B2;&#x6D17;&#x8FC7;&#x7A0B;&#x4E2D;&#x68C0;&#x6D4B;&#x5230;&#x8FD9;&#x4E9B;&#x7269;&#x4F53;&#x65F6;&#xFF0C;&#x5B83;&#x4EEC;&#x88AB;&#x65E0;&#x58F0;&#x5730;&#x8DF3;&#x8FC7;&#x3002;</span><span class="yiyi-st" id="yiyi-290">&#x65B0;&#x7684;&#x884C;&#x4E3A;&#x662F;&#x53D1;&#x51FA;&#x8B66;&#x544A;&#xFF0C;&#x76EE;&#x7684;&#x662F;&#x4E3A;&#x4E86;&#x63D0;&#x9192;&#x90A3;&#x4E9B;&#x7ECF;&#x5E38;&#x51FA;&#x73B0;&#x610F;&#x5916;&#x884C;&#x4E3A;&#x7684;&#x60C5;&#x51B5;&#x3002;</span></p><p><span class="yiyi-st" id="yiyi-291"><a class="reference external" href="http://www.sqlalchemy.org/trac/ticket/1973">&#xFF03;1973  T0&gt;</a></span></p></div><div class="section" id="setup-no-longer-installs-a-nose-plugin"><h3><span class="yiyi-st" id="yiyi-292">&#x5B89;&#x88C5;&#x7A0B;&#x5E8F;&#x4E0D;&#x518D;&#x5B89;&#x88C5;&#x9F3B;&#x63D2;&#x4EF6;<a class="headerlink" href="#setup-no-longer-installs-a-nose-plugin" title="Permalink to this headline">&#xB6;</a></span></h3><p><span class="yiyi-st" id="yiyi-293">&#x7531;&#x4E8E;&#x6211;&#x4EEC;&#x8F6C;&#x5411;&#x9F3B;&#x5B50;&#xFF0C;&#x6211;&#x4EEC;&#x4F7F;&#x7528;&#x4E86;&#x4E00;&#x4E2A;&#x901A;&#x8FC7;setuptools&#x5B89;&#x88C5;&#x7684;&#x63D2;&#x4EF6;&#xFF0C;&#x6240;&#x4EE5;<code class="docutils literal"><span class="pre">nosetests</span></code>&#x811A;&#x672C;&#x4F1A;&#x81EA;&#x52A8;&#x8FD0;&#x884C;SQLA&#x7684;&#x63D2;&#x4EF6;&#x4EE3;&#x7801;&#xFF0C;&#x8FD9;&#x662F;&#x6211;&#x4EEC;&#x6D4B;&#x8BD5;&#x62E5;&#x6709;&#x5B8C;&#x6574;&#x73AF;&#x5883;&#x6240;&#x5FC5;&#x9700;&#x7684;&#x3002;</span><span class="yiyi-st" id="yiyi-294">&#x5728;0.6&#x7684;&#x4E2D;&#x95F4;&#xFF0C;&#x6211;&#x4EEC;&#x610F;&#x8BC6;&#x5230;&#x8FD9;&#x91CC;&#x7684;&#x5BFC;&#x5165;&#x6A21;&#x5F0F;&#x610F;&#x5473;&#x7740;Nose&#x7684;&#x201C;coverage&#x201D;&#x63D2;&#x4EF6;&#x5C06;&#x4F1A;&#x4E2D;&#x65AD;&#xFF0C;&#x56E0;&#x4E3A;&#x201C;coverage&#x201D;&#x8981;&#x6C42;&#x5728;&#x5BFC;&#x5165;&#x4EFB;&#x4F55;&#x8986;&#x76D6;&#x6A21;&#x5757;&#x4E4B;&#x524D;&#x542F;&#x52A8;&#x8BE5;&#x63D2;&#x4EF6;&#x3002;&#x6240;&#x4EE5;&#x5728;0.6&#x7684;&#x4E2D;&#x95F4;&#xFF0C;&#x6211;&#x4EEC;&#x901A;&#x8FC7;&#x5728;&#x6784;&#x5EFA;&#x4E2D;&#x6DFB;&#x52A0;&#x4E00;&#x4E2A;&#x5355;&#x72EC;&#x7684;<code class="docutils literal"><span class="pre">sqlalchemy-nose</span></code>&#x5305;&#x6765;&#x89E3;&#x51B3;&#x8FD9;&#x4E2A;&#x95EE;&#x9898;&#xFF0C;&#x4ECE;&#x800C;&#x4F7F;&#x60C5;&#x51B5;&#x53D8;&#x5F97;&#x66F4;&#x7CDF;&#x3002;</span></p><p><span class="yiyi-st" id="yiyi-295">In 0.7 we&#x2019;ve done away with trying to get <code class="docutils literal"><span class="pre">nosetests</span></code> to work automatically, since the SQLAlchemy module would produce a large number of nose configuration options for all usages of <code class="docutils literal"><span class="pre">nosetests</span></code>, not just the SQLAlchemy unit tests themselves, and the additional <code class="docutils literal"><span class="pre">sqlalchemy-nose</span></code> install was an even worse idea, producing an extra package in Python environments. </span><span class="yiyi-st" id="yiyi-296">0.7&#x4E2D;&#x7684;<code class="docutils literal"><span class="pre">sqla_nose.py</span></code>&#x811A;&#x672C;&#x73B0;&#x5728;&#x662F;&#x7528;&#x9F3B;&#x5B50;&#x8FD0;&#x884C;&#x6D4B;&#x8BD5;&#x7684;&#x552F;&#x4E00;&#x65B9;&#x6CD5;&#x3002;</span></p><p><span class="yiyi-st" id="yiyi-297"><a class="reference external" href="http://www.sqlalchemy.org/trac/ticket/1949">&#xFF03;1949  T0&gt;</a></span></p></div><div class="section" id="non-table-derived-constructs-can-be-mapped"><h3><span class="yiyi-st" id="yiyi-298">&#x975E;<code class="docutils literal"><span class="pre">Table</span></code>&#x884D;&#x751F;&#x7684;&#x7ED3;&#x6784;&#x53EF;&#x4EE5;&#x6620;&#x5C04;<a class="headerlink" href="#non-table-derived-constructs-can-be-mapped" title="Permalink to this headline">&#xB6;</a></span></h3><p><span class="yiyi-st" id="yiyi-299">&#x5B8C;&#x5168;&#x4E0D;&#x53CD;&#x5BF9;&#x4EFB;&#x4F55;<code class="docutils literal"><span class="pre">Table</span></code>&#x7684;&#x6784;&#x9020;&#xFF0C;&#x5C31;&#x50CF;&#x4E00;&#x4E2A;&#x51FD;&#x6570;&#x4E00;&#x6837;&#xFF0C;&#x53EF;&#x4EE5;&#x88AB;&#x6620;&#x5C04;&#x3002;</span></p><div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sqlalchemy</span> <span class="kn">import</span> <span class="n">select</span><span class="p">,</span> <span class="n">func</span>
<span class="kn">from</span> <span class="nn">sqlalchemy.orm</span> <span class="kn">import</span> <span class="n">mapper</span>

<span class="k">class</span> <span class="nc">Subset</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="k">pass</span>
<span class="n">selectable</span> <span class="o">=</span> <span class="n">select</span><span class="p">([</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="s2">&quot;z&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">select_from</span><span class="p">(</span><span class="n">func</span><span class="o">.</span><span class="n">some_db_function</span><span class="p">())</span><span class="o">.</span><span class="n">alias</span><span class="p">()</span>
<span class="n">mapper</span><span class="p">(</span><span class="n">Subset</span><span class="p">,</span> <span class="n">selectable</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="p">[</span><span class="n">selectable</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">x</span><span class="p">])</span></pre></div></div><p><span class="yiyi-st" id="yiyi-300"><a class="reference external" href="http://www.sqlalchemy.org/trac/ticket/1876">&#xFF03;1876  T0&gt;</a></span></p></div><div class="section" id="aliased-accepts-fromclause-elements"><h3><span class="yiyi-st" id="yiyi-301">aliased()&#x63A5;&#x53D7;<code class="docutils literal"><span class="pre">FromClause</span></code>&#x5143;&#x7D20;<a class="headerlink" href="#aliased-accepts-fromclause-elements" title="Permalink to this headline">&#xB6;</a></span></h3><p><span class="yiyi-st" id="yiyi-302">This is a convenience helper such that in the case a plain <code class="docutils literal"><span class="pre">FromClause</span></code>, such as a <code class="docutils literal"><span class="pre">select</span></code>, <code class="docutils literal"><span class="pre">Table</span></code> or <code class="docutils literal"><span class="pre">join</span></code> is passed to the <code class="docutils literal"><span class="pre">orm.aliased()</span></code> construct, it passes through to the <code class="docutils literal"><span class="pre">.alias()</span></code> method of that from construct rather than constructing an ORM level <code class="docutils literal"><span class="pre">AliasedClass</span></code>.</span></p><p><span class="yiyi-st" id="yiyi-303"><a class="reference external" href="http://www.sqlalchemy.org/trac/ticket/2018">&#xFF03;2018  T0&gt;</a></span></p></div><div class="section" id="session-connection-session-execute-accept-bind"><h3><span class="yiyi-st" id="yiyi-304">Session.connection()&#xFF0C;Session.execute()&#x63A5;&#x53D7;&apos;bind&apos;<a class="headerlink" href="#session-connection-session-execute-accept-bind" title="Permalink to this headline">&#xB6;</a></span></h3><p><span class="yiyi-st" id="yiyi-305">&#x8FD9;&#x662F;&#x4E3A;&#x4E86;&#x5141;&#x8BB8;&#x6267;&#x884C;/&#x8FDE;&#x63A5;&#x64CD;&#x4F5C;&#x660E;&#x786E;&#x5730;&#x53C2;&#x4E0E;&#x5F15;&#x64CE;&#x7684;&#x516C;&#x5F00;&#x4E8B;&#x52A1;&#x3002;</span><span class="yiyi-st" id="yiyi-306">&#x5B83;&#x8FD8;&#x5141;&#x8BB8;<code class="docutils literal"><span class="pre">Session</span></code>&#x7684;&#x81EA;&#x5B9A;&#x4E49;&#x5B50;&#x7C7B;&#x5B9E;&#x73B0;&#x5B83;&#x4EEC;&#x81EA;&#x5DF1;&#x7684;<code class="docutils literal"><span class="pre">get_bind()</span></code>&#x65B9;&#x6CD5;&#x548C;&#x53C2;&#x6570;&#xFF0C;&#x4EE5;&#x5C06;&#x8FD9;&#x4E9B;&#x81EA;&#x5B9A;&#x4E49;&#x53C2;&#x6570;&#x4E0E;<code class="docutils literal"><span class="pre">execute()</span></code>&#x548C;<code class="docutils literal"><span class="pre">connection()</span></code>&#x65B9;&#x6CD5;&#x3002;</span></p><p><span class="yiyi-st" id="yiyi-307"><a class="reference external" href="http://www.sqlalchemy.org/docs/07/orm_session.html#sqlalchemy.orm.session.Session.connection">Session.connection</a> <a class="reference external" href="http://www.sqlalchemy.org/docs/07/orm_session.html#sqlalchemy.orm.session.Session.execute">Session.execute</a></span></p><p><span class="yiyi-st" id="yiyi-308"><a class="reference external" href="http://www.sqlalchemy.org/trac/ticket/1996">&#xFF03;1996  T0&gt;</a></span></p></div><div class="section" id="standalone-bind-parameters-in-columns-clause-auto-labeled"><h3><span class="yiyi-st" id="yiyi-309">&#x72EC;&#x7ACB;&#x5730;&#x7ED1;&#x5B9A;column&#x5B50;&#x53E5;&#x4E2D;&#x7684;&#x53C2;&#x6570;auto-labeled&#x3002;<a class="headerlink" href="#standalone-bind-parameters-in-columns-clause-auto-labeled" title="Permalink to this headline">&#xB6;</a></span></h3><p><span class="yiyi-st" id="yiyi-310">&#x73B0;&#x5728;&#x5728;&#x4E00;&#x4E2A;select&#x7684;&#x201C;columns&#x5B50;&#x53E5;&#x201D;&#x4E2D;&#x51FA;&#x73B0;&#x7684;&#x7ED1;&#x5B9A;&#x53C2;&#x6570;&#x73B0;&#x5728;&#x88AB;&#x81EA;&#x52A8;&#x6807;&#x8BB0;&#x4E3A;&#x50CF;&#x5176;&#x4ED6;&#x201C;&#x533F;&#x540D;&#x201D;&#x5B50;&#x53E5;&#x4E00;&#x6837;&#xFF0C;&#x9664;&#x4E86;&#x522B;&#x7684;&#x4EE5;&#x5916;&#xFF0C;&#x5728;&#x53D6;&#x51FA;&#x8BE5;&#x884C;&#x65F6;&#x5141;&#x8BB8;&#x5B83;&#x4EEC;&#x7684;&#x201C;&#x7C7B;&#x578B;&#x201D;&#x6709;&#x610F;&#x4E49;&#xFF0C;&#x5C31;&#x50CF;&#x5728;&#x7ED3;&#x679C;&#x884C;&#x5904;&#x7406;&#x5668;&#x4E2D;&#x4E00;&#x6837;&#x3002;</span></p></div><div class="section" id="sqlite-relative-file-paths-are-normalized-through-os-path-abspath"><h3><span class="yiyi-st" id="yiyi-311">SQLite - relative file paths are normalized through os.path.abspath()<a class="headerlink" href="#sqlite-relative-file-paths-are-normalized-through-os-path-abspath" title="Permalink to this headline">&#xB6;</a></span></h3><p><span class="yiyi-st" id="yiyi-312">&#x8FD9;&#x6837;&#xFF0C;&#x4E00;&#x4E2A;&#x6539;&#x53D8;&#x5F53;&#x524D;&#x76EE;&#x5F55;&#x7684;&#x811A;&#x672C;&#x5C06;&#x7EE7;&#x7EED;&#x5B9A;&#x4F4D;&#x5230;&#x76F8;&#x540C;&#x7684;&#x4F4D;&#x7F6E;&#xFF0C;&#x56E0;&#x4E3A;&#x540E;&#x7EED;&#x7684;SQLite&#x8FDE;&#x63A5;&#x5DF2;&#x7ECF;&#x5EFA;&#x7ACB;&#x3002;</span></p><p><span class="yiyi-st" id="yiyi-313"><a class="reference external" href="http://www.sqlalchemy.org/trac/ticket/2036">&#xFF03;2036  T0&gt;</a></span></p></div><div class="section" id="ms-sql-string-unicode-varchar-nvarchar-varbinary-emit-max-for-no-length"><h3><span class="yiyi-st" id="yiyi-314">MS-SQL  -  <code class="docutils literal"><span class="pre">String</span></code> / <code class="docutils literal"><span class="pre">Unicode</span></code> / <code class="docutils literal"><span class="pre">VARCHAR</span></code> / <code class="docutils literal"><span class="pre">NVARCHAR</span></code> / <code class="docutils literal"><span class="pre">VARBINARY</span></code>&#x6700;&#x5927;&#x201C;&#x4E3A;&#x6CA1;&#x6709;&#x957F;&#x5EA6;<a class="headerlink" href="#ms-sql-string-unicode-varchar-nvarchar-varbinary-emit-max-for-no-length" title="Permalink to this headline">&#xB6;</a></span></h3><p><span class="yiyi-st" id="yiyi-315">&#x5728;MS-SQL&#x540E;&#x7AEF;&#xFF0C;&#x5F53;&#x6CA1;&#x6709;&#x6307;&#x5B9A;&#x957F;&#x5EA6;&#x65F6;&#xFF0C;String / Unicode&#x7C7B;&#x578B;&#x53CA;&#x5176;&#x5BF9;&#x5E94;&#x7684;VARCHAR / NVARCHAR&#x4EE5;&#x53CA;VARBINARY&#xFF08;<a class="reference external" href="http://www.sqlalchemy.org/trac/ticket/1833">&#xFF03;1833</a>&#xFF09;&#x4F1A;&#x53D1;&#x51FA;&#x201C;max&#x201D;&#x4F5C;&#x4E3A;&#x957F;&#x5EA6;&#x3002;</span><span class="yiyi-st" id="yiyi-316">&#x8FD9;&#x4F7F;&#x5F97;&#x5B83;&#x4E0E;Postgresql&#x7684;VARCHAR&#x7C7B;&#x578B;&#x66F4;&#x517C;&#x5BB9;&#xFF0C;&#x5F53;&#x6CA1;&#x6709;&#x6307;&#x5B9A;&#x957F;&#x5EA6;&#x65F6;&#x5B83;&#x7C7B;&#x4F3C;&#x5730;&#x662F;&#x65E0;&#x754C;&#x7684;&#x3002;</span><span class="yiyi-st" id="yiyi-317">&#x5F53;&#x6CA1;&#x6709;&#x6307;&#x5B9A;&#x957F;&#x5EA6;&#x65F6;&#xFF0C;SQL Server&#x5C06;&#x8FD9;&#x4E9B;&#x7C7B;&#x578B;&#x7684;&#x957F;&#x5EA6;&#x9ED8;&#x8BA4;&#x4E3A;&apos;1&apos;&#x3002;</span></p></div></div><div class="section" id="behavioral-changes-backwards-incompatible"><h2><span class="yiyi-st" id="yiyi-318">&#x884C;&#x4E3A;&#x6539;&#x53D8;&#xFF08;&#x5411;&#x540E;&#x4E0D;&#x76F8;&#x5BB9;&#xFF09;<a class="headerlink" href="#behavioral-changes-backwards-incompatible" title="Permalink to this headline">&#xB6;</a></span></h2><p><span class="yiyi-st" id="yiyi-319">&#x518D;&#x6B21;&#x6CE8;&#x610F;&#xFF0C;&#x9664;&#x4E86;&#x9ED8;&#x8BA4;&#x7684;&#x53EF;&#x53D8;&#x6027;&#x66F4;&#x6539;&#x5916;&#xFF0C;&#x5927;&#x591A;&#x6570;&#x8FD9;&#x4E9B;&#x66F4;&#x6539;&#x90FD;&#x662F;*&#x975E;&#x5E38;&#x5C0F;&#x7684;&#xFF0C;&#x5E76;&#x4E14;&#x4E0D;&#x4F1A;&#x5F71;&#x54CD;&#x5927;&#x591A;&#x6570;&#x7528;&#x6237;&#x3002;</span></p><div class="section" id="pickletype-and-array-mutability-turned-off-by-default"><h3><span class="yiyi-st" id="yiyi-320"><code class="docutils literal"><span class="pre">PickleType</span></code>&#x548C;ARRAY&#x53EF;&#x53D8;&#x6027;&#x5173;&#x95ED;<a class="headerlink" href="#pickletype-and-array-mutability-turned-off-by-default" title="Permalink to this headline">&#xB6;</a></span></h3><p><span class="yiyi-st" id="yiyi-321">&#x5F53;&#x6620;&#x5C04;&#x5177;&#x6709;<code class="docutils literal"><span class="pre">PickleType</span></code>&#x6216;<code class="docutils literal"><span class="pre">postgresql.ARRAY</span></code>&#x6570;&#x636E;&#x7C7B;&#x578B;&#x7684;&#x5217;&#x65F6;&#xFF0C;&#x6B64;&#x66F4;&#x6539;&#x5F15;&#x7528;ORM&#x7684;&#x9ED8;&#x8BA4;&#x884C;&#x4E3A;&#x3002;</span><span class="yiyi-st" id="yiyi-322"><code class="docutils literal"><span class="pre">mutable</span></code>&#x6807;&#x5FD7;&#x73B0;&#x5728;&#x9ED8;&#x8BA4;&#x8BBE;&#x7F6E;&#x4E3A;<code class="docutils literal"><span class="pre">False</span></code>&#x3002;</span><span class="yiyi-st" id="yiyi-323">&#x5982;&#x679C;&#x73B0;&#x6709;&#x7684;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x4F7F;&#x7528;&#x8FD9;&#x4E9B;&#x7C7B;&#x578B;&#xFF0C;&#x5E76;&#x4E14;&#x4F9D;&#x8D56;&#x4E8E;&#x68C0;&#x6D4B;&#x5230;&#x5C31;&#x5730;&#x7A81;&#x53D8;&#xFF0C;&#x5219;&#x5FC5;&#x987B;&#x4F7F;&#x7528;<code class="docutils literal"><span class="pre">mutable=True</span></code>&#x6784;&#x9020;&#x7C7B;&#x578B;&#x5BF9;&#x8C61;&#x4EE5;&#x6062;&#x590D;0.6&#x884C;&#x4E3A;&#xFF1A;</span></p><div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">Table</span><span class="p">(</span><span class="s1">&apos;mytable&apos;</span><span class="p">,</span> <span class="n">metadata</span><span class="p">,</span>
    <span class="c1"># ....</span>

    <span class="n">Column</span><span class="p">(</span><span class="s1">&apos;pickled_data&apos;</span><span class="p">,</span> <span class="n">PickleType</span><span class="p">(</span><span class="n">mutable</span><span class="o">=</span><span class="bp">True</span><span class="p">))</span>
<span class="p">)</span></pre></div></div><p><span class="yiyi-st" id="yiyi-324"><code class="docutils literal"><span class="pre">mutable=True</span></code>&#x6807;&#x5FD7;&#x6B63;&#x5728;&#x9010;&#x6B65;&#x6DD8;&#x6C70;&#xFF0C;&#x4EE5;&#x652F;&#x6301;&#x65B0;&#x7684;<a class="reference external" href="http://www.sqlalchemy.org/docs/07/orm_extensions_mutable.html">&#x7A81;&#x53D8;&#x8DDF;&#x8E2A;</a>&#x6269;&#x5C55;&#x3002;</span><span class="yiyi-st" id="yiyi-325">&#x6B64;&#x6269;&#x5C55;&#x63D0;&#x4F9B;&#x4E86;&#x4E00;&#x79CD;&#x673A;&#x5236;&#xFF0C;&#x901A;&#x8FC7;&#x8BE5;&#x673A;&#x5236;&#xFF0C;&#x7528;&#x6237;&#x5B9A;&#x4E49;&#x7684;&#x6570;&#x636E;&#x7C7B;&#x578B;&#x53EF;&#x4EE5;&#x5C06;&#x66F4;&#x6539;&#x4E8B;&#x4EF6;&#x63D0;&#x4F9B;&#x7ED9;&#x62E5;&#x6709;&#x7684;&#x7236;&#x7EA7;&#x6216;&#x7236;&#x7EA7;&#x3002;</span></p><p><span class="yiyi-st" id="yiyi-326">&#x4EE5;&#x524D;&#x4F7F;&#x7528;<code class="docutils literal"><span class="pre">mutable=True</span></code>&#x7684;&#x65B9;&#x6CD5;&#x4E0D;&#x63D0;&#x4F9B;&#x66F4;&#x6539;&#x4E8B;&#x4EF6; - &#x76F8;&#x53CD;&#xFF0C;ORM&#x5FC5;&#x987B;&#x626B;&#x63CF;&#x4F1A;&#x8BDD;&#x4E2D;&#x5B58;&#x5728;&#x7684;&#x6240;&#x6709;&#x53EF;&#x53D8;&#x503C;&#xFF0C;&#x5E76;&#x5C06;&#x5B83;&#x4EEC;&#x4E0E;&#x539F;&#x59CB;&#x503C;&#x8FDB;&#x884C;&#x6BD4;&#x8F83;&#xFF0C;&#x4EE5;&#x4FBF;&#x6BCF;&#x6B21;<code class="docutils literal"><span class="pre">flush()</span></code>&#x88AB;&#x8C03;&#x7528;&#xFF0C;&#x8FD9;&#x662F;&#x4E00;&#x4E2A;&#x975E;&#x5E38;&#x8017;&#x65F6;&#x7684;&#x4E8B;&#x4EF6;&#x3002;</span><span class="yiyi-st" id="yiyi-327">&#x8FD9;&#x662F;&#x4ECE;SQLAlchemy&#x6700;&#x521D;&#x7684;&#x65F6;&#x5019;&#x5F00;&#x59CB;&#x7684;&#xFF0C;&#x5F53;<code class="docutils literal"><span class="pre">flush()</span></code>&#x4E0D;&#x662F;&#x81EA;&#x52A8;&#x7684;&#xFF0C;&#x5E76;&#x4E14;&#x5386;&#x53F2;&#x8DDF;&#x8E2A;&#x7CFB;&#x7EDF;&#x4E0D;&#x50CF;&#x73B0;&#x5728;&#x90A3;&#x6837;&#x590D;&#x6742;&#x65F6;&#x3002;</span></p><p><span class="yiyi-st" id="yiyi-328">Existing applications which use <code class="docutils literal"><span class="pre">PickleType</span></code>, <code class="docutils literal"><span class="pre">postgresql.ARRAY</span></code> or other <code class="docutils literal"><span class="pre">MutableType</span></code> subclasses, and require in-place mutation detection, should migrate to the new mutation tracking system, as <code class="docutils literal"><span class="pre">mutable=True</span></code> is likely to be deprecated in the future.</span></p><p><span class="yiyi-st" id="yiyi-329"><a class="reference external" href="http://www.sqlalchemy.org/trac/ticket/1980">&#xFF03;1980  T0&gt;</a></span></p></div><div class="section" id="mutability-detection-of-composite-requires-the-mutation-tracking-extension"><h3><span class="yiyi-st" id="yiyi-330"><code class="docutils literal"><span class="pre">composite()</span></code>&#x7684;&#x53EF;&#x53D8;&#x6027;&#x68C0;&#x6D4B;&#x9700;&#x8981;&#x7A81;&#x53D8;&#x8DDF;&#x8E2A;&#x6269;&#x5C55;<a class="headerlink" href="#mutability-detection-of-composite-requires-the-mutation-tracking-extension" title="Permalink to this headline">&#xB6;</a></span></h3><p><span class="yiyi-st" id="yiyi-331">&#x6240;&#x8C13;&#x7684;&#x201C;&#x590D;&#x5408;&#x201D;&#x6620;&#x5C04;&#x5C5E;&#x6027;&#xFF0C;&#x5373;&#x90A3;&#x4E9B;&#x4F7F;&#x7528;<a class="reference external" href="http://www.sqlalchemy.org/docs/07/orm_mapper_config.html#composite-column-types">&#x590D;&#x5408;&#x5217;&#x7C7B;&#x578B;</a>&#x4E2D;&#x63CF;&#x8FF0;&#x7684;&#x6280;&#x672F;&#x914D;&#x7F6E;&#x7684;&#x5C5E;&#x6027;&#xFF0C;&#x5DF2;&#x88AB;&#x91CD;&#x65B0;&#x5B9E;&#x73B0;&#xFF0C;&#x4F7F;&#x5F97;ORM&#x5185;&#x90E8;&#x4E0D;&#x518D;&#x610F;&#x8BC6;&#x5230;&#x5B83;&#x4EEC;&#xFF08;&#x5BFC;&#x81F4;&#x66F4;&#x77ED;&#xFF0C;&#x66F4;&#x9AD8;&#x6548;&#x5173;&#x952E;&#x90E8;&#x5206;&#x7684;&#x4EE3;&#x7801;&#x8DEF;&#x5F84;&#xFF09;&#x3002;</span><span class="yiyi-st" id="yiyi-332">&#x867D;&#x7136;&#x590D;&#x5408;&#x7C7B;&#x578B;&#x901A;&#x5E38;&#x88AB;&#x89C6;&#x4E3A;&#x4E0D;&#x53EF;&#x53D8;&#x7684;&#x503C;&#x5BF9;&#x8C61;&#xFF0C;&#x4F46;&#x4ECE;&#x672A;&#x5F3A;&#x5236;&#x6267;&#x884C;&#x3002;</span><span class="yiyi-st" id="yiyi-333">&#x5BF9;&#x4E8E;&#x4F7F;&#x7528;&#x5177;&#x6709;&#x53EF;&#x53D8;&#x6027;&#x7684;&#x7EC4;&#x5408;&#x7684;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#xFF0C;<a class="reference external" href="http://www.sqlalchemy.org/docs/07/orm_extensions_mutable.html">Mutation Tracking</a>&#x6269;&#x5C55;&#x63D0;&#x4F9B;&#x4E86;&#x4E00;&#x4E2A;&#x57FA;&#x7C7B;&#xFF0C;&#x5B83;&#x5EFA;&#x7ACB;&#x4E86;&#x7528;&#x6237;&#x5B9A;&#x4E49;&#x7684;&#x7EC4;&#x5408;&#x7C7B;&#x578B;&#x5C06;&#x66F4;&#x6539;&#x4E8B;&#x4EF6;&#x6D88;&#x606F;&#x53D1;&#x9001;&#x56DE;&#x6BCF;&#x4E2A;&#x5BF9;&#x8C61;&#x7684;&#x6240;&#x5C5E;&#x7236;&#x9879;&#x6216;&#x7236;&#x9879;&#x7684;&#x673A;&#x5236;&#x3002;</span></p><p><span class="yiyi-st" id="yiyi-334">&#x4F7F;&#x7528;&#x590D;&#x5408;&#x7C7B;&#x578B;&#x5E76;&#x4F9D;&#x8D56;&#x8FD9;&#x4E9B;&#x5BF9;&#x8C61;&#x7684;&#x539F;&#x4F4D;&#x53D8;&#x5F02;&#x68C0;&#x6D4B;&#x7684;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x5E94;&#x8BE5;&#x8FC1;&#x79FB;&#x5230;&#x201C;&#x7A81;&#x53D8;&#x8FFD;&#x8E2A;&#x201D;&#x6269;&#x5C55;&#xFF0C;&#x6216;&#x8005;&#x66F4;&#x6539;&#x590D;&#x5408;&#x7C7B;&#x578B;&#x7684;&#x7528;&#x6CD5;&#xFF0C;&#x4EE5;&#x514D;&#x4E0D;&#x518D;&#x9700;&#x8981;&#x5C31;&#x5730;&#x66F4;&#x6539;&#xFF08;&#x5373;&#x5BF9;&#x5F85;&#x5B83;&#x4EEC;&#x4F5C;&#x4E3A;&#x4E0D;&#x53EF;&#x53D8;&#x7684;&#x503C;&#x5BF9;&#x8C61;&#xFF09;&#x3002;</span></p></div><div class="section" id="sqlite-the-sqlite-dialect-now-uses-nullpool-for-file-based-databases"><h3><span class="yiyi-st" id="yiyi-335">SQLite  -  SQLite&#x65B9;&#x8A00;&#x73B0;&#x5728;&#x5BF9;&#x57FA;&#x4E8E;&#x6587;&#x4EF6;&#x7684;&#x6570;&#x636E;&#x5E93;&#x4F7F;&#x7528;<code class="docutils literal"><span class="pre">NullPool</span></code> <a class="headerlink" href="#sqlite-the-sqlite-dialect-now-uses-nullpool-for-file-based-databases" title="Permalink to this headline">&#xB6;</a></span></h3><p><span class="yiyi-st" id="yiyi-336">This change is <strong>99.999% backwards compatible</strong>, unless you are using temporary tables across connection pool connections.</span></p><p><span class="yiyi-st" id="yiyi-337">&#x57FA;&#x4E8E;&#x6587;&#x4EF6;&#x7684;SQLite&#x8FDE;&#x63A5;&#x901F;&#x5EA6;&#x975E;&#x5E38;&#x5FEB;&#xFF0C;&#x4F7F;&#x7528;<code class="docutils literal"><span class="pre">NullPool</span></code>&#x610F;&#x5473;&#x7740;&#x6BCF;&#x6B21;&#x8C03;&#x7528;<code class="docutils literal"><span class="pre">Engine.connect</span></code>&#x90FD;&#x4F1A;&#x521B;&#x5EFA;&#x4E00;&#x4E2A;&#x65B0;&#x7684;pysqlite&#x8FDE;&#x63A5;&#x3002;</span></p><p><span class="yiyi-st" id="yiyi-338">&#x4EE5;&#x524D;&#xFF0C;&#x4F7F;&#x7528;<code class="docutils literal"><span class="pre">SingletonThreadPool</span></code>&#xFF0C;&#x8FD9;&#x610F;&#x5473;&#x7740;&#x7EBF;&#x7A0B;&#x4E2D;&#x67D0;&#x4E2A;&#x5F15;&#x64CE;&#x7684;&#x6240;&#x6709;&#x8FDE;&#x63A5;&#x90FD;&#x662F;&#x76F8;&#x540C;&#x7684;&#x8FDE;&#x63A5;&#x3002;</span><span class="yiyi-st" id="yiyi-339">&#x8FD9;&#x610F;&#x5473;&#x7740;&#x65B0;&#x65B9;&#x6CD5;&#x66F4;&#x76F4;&#x89C2;&#xFF0C;&#x7279;&#x522B;&#x662F;&#x5728;&#x4F7F;&#x7528;&#x591A;&#x4E2A;&#x8FDE;&#x63A5;&#x65F6;&#x3002;</span></p><p><span class="yiyi-st" id="yiyi-340"><code class="docutils literal"><span class="pre">SingletonThreadPool</span></code> is still the default engine when a <code class="docutils literal"><span class="pre">:memory:</span></code> database is used.</span></p><p><span class="yiyi-st" id="yiyi-341">&#x8BF7;&#x6CE8;&#x610F;&#xFF0C;&#x7531;&#x4E8E;SQLite&#x5904;&#x7406;&#x4E34;&#x65F6;&#x8868;&#x7684;&#x65B9;&#x5F0F;&#xFF0C;&#x6B64;&#x66F4;&#x6539;<strong>&#x4F1A;&#x4E2D;&#x65AD;&#x8DE8;Session&#x63D0;&#x4EA4;&#x4F7F;&#x7528;&#x7684;&#x4E34;&#x65F6;&#x8868;</strong>&#x3002;</span><span class="yiyi-st" id="yiyi-342">&#x5982;&#x679C;&#x9700;&#x8981;&#x8D85;&#x51FA;&#x4E00;&#x4E2A;&#x6C60;&#x8FDE;&#x63A5;&#x8303;&#x56F4;&#x7684;&#x4E34;&#x65F6;&#x8868;&#xFF0C;&#x8BF7;&#x53C2;&#x89C1;<a class="reference external" href="http://www.sqlalchemy.org/docs/dialects_sqlite.html#using">http://www.sqlalchemy.org/docs/dialects_sqlite.html#using</a>  -  temporary-tables-with-sqlite&#x4E2D;&#x7684;&#x6CE8;&#x91CA;&#x3002;</span></p><p><span class="yiyi-st" id="yiyi-343"><a class="reference external" href="http://www.sqlalchemy.org/trac/ticket/1921">&#xFF03;1921  T0&gt;</a></span></p></div><div class="section" id="session-merge-checks-version-ids-for-versioned-mappers"><h3><span class="yiyi-st" id="yiyi-344"><code class="docutils literal"><span class="pre">Session.merge()</span></code>&#x68C0;&#x67E5;&#x7248;&#x672C;&#x6620;&#x5C04;&#x5668;&#x7684;&#x7248;&#x672C;id <a class="headerlink" href="#session-merge-checks-version-ids-for-versioned-mappers" title="Permalink to this headline">&#xB6;</a></span></h3><p><span class="yiyi-st" id="yiyi-345">Session.merge()&#x5C06;&#x68C0;&#x67E5;&#x4F20;&#x5165;&#x72B6;&#x6001;&#x7684;&#x7248;&#x672C;ID&#x4E0E;&#x6570;&#x636E;&#x5E93;&#x7684;&#x7248;&#x672C;ID&#xFF0C;&#x5047;&#x8BBE;&#x6620;&#x5C04;&#x4F7F;&#x7528;&#x7248;&#x672C;ID&#x5E76;&#x4E14;&#x4F20;&#x5165;&#x72B6;&#x6001;&#x5177;&#x6709;&#x5206;&#x914D;&#x7684;&#x7248;&#x672C;ID&#xFF0C;&#x5E76;&#x4E14;&#x5982;&#x679C;&#x5B83;&#x4EEC;&#x4E0D;&#x5339;&#x914D;&#x5219;&#x5F15;&#x53D1;StaleDataError&#x3002;</span><span class="yiyi-st" id="yiyi-346">&#x8FD9;&#x662F;&#x6B63;&#x786E;&#x7684;&#x884C;&#x4E3A;&#xFF0C;&#x56E0;&#x4E3A;&#x5982;&#x679C;&#x4F20;&#x5165;&#x72B6;&#x6001;&#x5305;&#x542B;&#x9648;&#x65E7;&#x7684;&#x7248;&#x672C;ID&#xFF0C;&#x5219;&#x5E94;&#x8BE5;&#x5047;&#x5B9A;&#x72B6;&#x6001;&#x4E3A;&#x9648;&#x65E7;&#x3002;</span></p><p><span class="yiyi-st" id="yiyi-347">&#x5982;&#x679C;&#x5C06;&#x6570;&#x636E;&#x5408;&#x5E76;&#x5230;&#x7248;&#x672C;&#x5316;&#x72B6;&#x6001;&#xFF0C;&#x5219;&#x7248;&#x672C;ID&#x5C5E;&#x6027;&#x53EF;&#x80FD;&#x672A;&#x5B9A;&#x4E49;&#xFF0C;&#x5E76;&#x4E14;&#x4E0D;&#x4F1A;&#x8FDB;&#x884C;&#x7248;&#x672C;&#x68C0;&#x67E5;&#x3002;</span></p><p><span class="yiyi-st" id="yiyi-348">&#x8FD9;&#x4E2A;&#x68C0;&#x67E5;&#x901A;&#x8FC7;&#x68C0;&#x67E5;Hibernate&#x662F;&#x505A;&#x4EC0;&#x4E48;&#x6765;&#x786E;&#x8BA4;&#x7684; -  <code class="docutils literal"><span class="pre">merge()</span></code>&#x548C;&#x7248;&#x672C;&#x63A7;&#x5236;&#x529F;&#x80FD;&#x6700;&#x521D;&#x90FD;&#x662F;&#x4ECE;Hibernate&#x8C03;&#x6574;&#x7684;&#x3002;</span></p><p><span class="yiyi-st" id="yiyi-349"><a class="reference external" href="http://www.sqlalchemy.org/trac/ticket/2027">&#xFF03;2027  T0&gt;</a></span></p></div><div class="section" id="tuple-label-names-in-query-improved"><h3><span class="yiyi-st" id="yiyi-350">&#x67E5;&#x8BE2;&#x6539;&#x8FDB;<a class="headerlink" href="#tuple-label-names-in-query-improved" title="Permalink to this headline">&#xB6;</a>&#x4E2D;&#x7684;&#x5143;&#x7EC4;&#x6807;&#x7B7E;&#x540D;&#x79F0;</span></h3><p><span class="yiyi-st" id="yiyi-351">&#x5BF9;&#x4E8E;&#x4F9D;&#x8D56;&#x65E7;&#x884C;&#x4E3A;&#x7684;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x6765;&#x8BF4;&#xFF0C;&#x8FD9;&#x79CD;&#x6539;&#x8FDB;&#x53EF;&#x80FD;&#x7565;&#x5FAE;&#x5411;&#x540E;&#x517C;&#x5BB9;&#x3002;</span></p><p><span class="yiyi-st" id="yiyi-352">&#x7ED9;&#x5B9A;&#x4E24;&#x4E2A;&#x6620;&#x5C04;&#x7C7B;<code class="docutils literal"><span class="pre">Foo</span></code>&#x548C;<code class="docutils literal"><span class="pre">Bar</span></code>&#xFF0C;&#x6BCF;&#x4E2A;&#x7C7B;&#x90FD;&#x6709;&#x4E00;&#x4E2A;&#x5217;<code class="docutils literal"><span class="pre">spam</span></code>&#xFF1A;</span></p><div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">qa</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">Foo</span><span class="o">.</span><span class="n">spam</span><span class="p">)</span>
<span class="n">qb</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">Bar</span><span class="o">.</span><span class="n">spam</span><span class="p">)</span>

<span class="n">qu</span> <span class="o">=</span> <span class="n">qa</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="n">qb</span><span class="p">)</span></pre></div></div><p><span class="yiyi-st" id="yiyi-353">&#x7531;<code class="docutils literal"><span class="pre">qu</span></code>&#x4EA7;&#x751F;&#x7684;&#x5355;&#x5217;&#x540D;&#x79F0;&#x5C06;&#x662F;<code class="docutils literal"><span class="pre">spam</span></code>&#x3002;</span><span class="yiyi-st" id="yiyi-354">&#x7531;&#x4E8E;<code class="docutils literal"><span class="pre">union</span></code>&#x4F1A;&#x7EC4;&#x5408;&#x4E8B;&#x7269;&#x7684;&#x65B9;&#x5F0F;&#xFF0C;&#x56E0;&#x6B64;&#x4E4B;&#x524D;&#x5B83;&#x4F1A;&#x50CF;<code class="docutils literal"><span class="pre">foo_spam</span></code>&#x7C7B;&#x4F3C;&#xFF0C;&#x8FD9;&#x4E0E;<code class="docutils literal"><span class="pre">spam</span></code>&#x540D;&#x79F0;&#x4E0D;&#x4E00;&#x81F4;&#x975E;&#x8054;&#x5408;&#x67E5;&#x8BE2;&#x3002;</span></p><p><span class="yiyi-st" id="yiyi-355"><a class="reference external" href="http://www.sqlalchemy.org/trac/ticket/1942">&#xFF03;1942  T0&gt;</a></span></p></div><div class="section" id="mapped-column-attributes-reference-the-most-specific-column-first"><h3><span class="yiyi-st" id="yiyi-356">&#x6620;&#x5C04;&#x5217;&#x5C5E;&#x6027;&#x9996;&#x5148;&#x5F15;&#x7528;&#x6700;&#x5177;&#x4F53;&#x7684;&#x5217;<a class="headerlink" href="#mapped-column-attributes-reference-the-most-specific-column-first" title="Permalink to this headline">&#xB6;</a></span></h3><p><span class="yiyi-st" id="yiyi-357">&#x8FD9;&#x662F;&#x5BF9;&#x6620;&#x5C04;&#x5217;&#x5C5E;&#x6027;&#x5F15;&#x7528;&#x591A;&#x4E2A;&#x5217;&#x65F6;&#x6D89;&#x53CA;&#x7684;&#x884C;&#x4E3A;&#x7684;&#x66F4;&#x6539;&#xFF0C;&#x7279;&#x522B;&#x662F;&#x5728;&#x5904;&#x7406;&#x4E0E;&#x8D85;&#x7C7B;&#x4E0A;&#x7684;&#x5C5E;&#x6027;&#x5177;&#x6709;&#x76F8;&#x540C;&#x540D;&#x79F0;&#x7684;&#x8FDE;&#x63A5;&#x8868;&#x5B50;&#x7C7B;&#x4E0A;&#x7684;&#x5C5E;&#x6027;&#x65F6;&#x3002;</span></p><p><span class="yiyi-st" id="yiyi-358">&#x4F7F;&#x7528;&#x58F0;&#x660E;&#x5F0F;&#xFF0C;&#x573A;&#x666F;&#x662F;&#x8FD9;&#x6837;&#x7684;&#xFF1A;</span></p><div class="highlight-python"><div class="highlight"><pre><span></span>class Parent(Base):
    __tablename__ = &apos;parent&apos;
    id = Column(Integer, primary_key=True)

class Child(Parent):
   __tablename__ = &apos;child&apos;
    id = Column(Integer, ForeignKey(&apos;parent.id&apos;), primary_key=True)</pre></div></div><p><span class="yiyi-st" id="yiyi-359">&#x4EE5;&#x4E0A;&#xFF0C;&#x5C5E;&#x6027;<code class="docutils literal"><span class="pre">Child.id</span></code>&#x6307;&#x5411;<code class="docutils literal"><span class="pre">child.id</span></code>&#x5217;&#x548C;<code class="docutils literal"><span class="pre">parent.id</span></code>  - &#x8FD9;&#x662F;&#x7531;&#x4E8E;&#x5C5E;&#x6027;&#x3002;</span><span class="yiyi-st" id="yiyi-360">&#x5982;&#x679C;&#x5B83;&#x5728;&#x7C7B;&#x4E0A;&#x547D;&#x540D;&#x4E0D;&#x540C;&#xFF0C;&#x5982;<code class="docutils literal"><span class="pre">Child.child_id</span></code>&#xFF0C;&#x5219;&#x5B83;&#x5C06;&#x660E;&#x786E;&#x5730;&#x6620;&#x5C04;&#x5230;<code class="docutils literal"><span class="pre">child.id</span></code>&#xFF0C;&#x5E76;&#x4E14;<code class="docutils literal"><span class="pre">Child.id</span></code>&#x4E3A;&#x4E0E;<code class="docutils literal"><span class="pre">Parent.id</span></code>&#x5177;&#x6709;&#x76F8;&#x540C;&#x7684;&#x5C5E;&#x6027;&#x3002;</span></p><p><span class="yiyi-st" id="yiyi-361">&#x5F53;<code class="docutils literal"><span class="pre">id</span></code>&#x5C5E;&#x6027;&#x7528;&#x4E8E;&#x5F15;&#x7528;<code class="docutils literal"><span class="pre">parent.id</span></code>&#x548C;<code class="docutils literal"><span class="pre">child.id</span></code>&#x65F6;&#xFF0C;&#x5B83;&#x5C06;&#x5B83;&#x4EEC;&#x5B58;&#x50A8;&#x5728;&#x6709;&#x5E8F;&#x5217;&#x8868;&#x4E2D;&#x3002;</span><span class="yiyi-st" id="yiyi-362">&#x50CF;<code class="docutils literal"><span class="pre">Child.id</span></code>&#x8FD9;&#x6837;&#x7684;&#x8868;&#x8FBE;&#x5F0F;&#x5728;&#x6E32;&#x67D3;&#x65F6;&#x4EC5;&#x5F15;&#x7528;&#x8FD9;&#x4E9B;&#x5217;&#x7684;<em>&#x4E00;&#x4E2A;</em>&#x3002;</span><span class="yiyi-st" id="yiyi-363">&#x76F4;&#x5230;0.6&#xFF0C;&#x8FD9;&#x4E2A;&#x5217;&#x5C06;&#x662F;<code class="docutils literal"><span class="pre">parent.id</span></code>&#x3002;</span><span class="yiyi-st" id="yiyi-364">In 0.7, it is the less surprising <code class="docutils literal"><span class="pre">child.id</span></code>.</span></p><p><span class="yiyi-st" id="yiyi-365">&#x8FD9;&#x79CD;&#x884C;&#x4E3A;&#x7684;&#x9057;&#x7559;&#x95EE;&#x9898;&#x6D89;&#x53CA;&#x5230;&#x4E0D;&#x518D;&#x9002;&#x7528;&#x7684;ORM&#x7684;&#x884C;&#x4E3A;&#x548C;&#x9650;&#x5236;&#xFF1B;&#x6240;&#x9700;&#x8981;&#x7684;&#x53EA;&#x662F;&#x626D;&#x8F6C;&#x79E9;&#x5E8F;&#x3002;</span></p><p><span class="yiyi-st" id="yiyi-366">&#x8FD9;&#x79CD;&#x65B9;&#x6CD5;&#x7684;&#x4E3B;&#x8981;&#x4F18;&#x70B9;&#x662F;&#xFF0C;&#x73B0;&#x5728;&#x53EF;&#x4EE5;&#x66F4;&#x8F7B;&#x677E;&#x5730;&#x6784;&#x5EFA;&#x5F15;&#x7528;&#x672C;&#x5730;&#x5217;&#x7684;<code class="docutils literal"><span class="pre">primaryjoin</span></code>&#x8868;&#x8FBE;&#x5F0F;&#xFF1A;</span></p><div class="highlight-python"><div class="highlight"><pre><span></span>class Child(Parent):
   __tablename__ = &apos;child&apos;
    id = Column(Integer, ForeignKey(&apos;parent.id&apos;), primary_key=True)
    some_related = relationship(&quot;SomeRelated&quot;,
                    primaryjoin=&quot;Child.id==SomeRelated.child_id&quot;)

class SomeRelated(Base):
   __tablename__ = &apos;some_related&apos;
    id = Column(Integer, primary_key=True)
    child_id = Column(Integer, ForeignKey(&apos;child.id&apos;))</pre></div></div><p><span class="yiyi-st" id="yiyi-367">&#x5728;0.7&#x4E4B;&#x524D;&#xFF0C;<code class="docutils literal"><span class="pre">Child.id</span></code>&#x8868;&#x8FBE;&#x5F0F;&#x5C06;&#x5F15;&#x7528;<code class="docutils literal"><span class="pre">Parent.id</span></code>&#xFF0C;&#x5E76;&#x4E14;&#x6709;&#x5FC5;&#x8981;&#x5C06;<code class="docutils literal"><span class="pre">child.id</span></code>&#x6620;&#x5C04;&#x5230;&#x4E0D;&#x540C;&#x7684;&#x5C5E;&#x6027;&#x3002;</span></p><p><span class="yiyi-st" id="yiyi-368">&#x8FD9;&#x4E5F;&#x610F;&#x5473;&#x7740;&#x50CF;&#x8FD9;&#x6837;&#x7684;&#x67E5;&#x8BE2;&#x4F1A;&#x6539;&#x53D8;&#x5B83;&#x7684;&#x884C;&#x4E3A;&#xFF1A;</span></p><div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">session</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">Parent</span><span class="p">)</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">Child</span><span class="o">.</span><span class="n">id</span> <span class="o">&gt;</span> <span class="mi">7</span><span class="p">)</span></pre></div></div><p><span class="yiyi-st" id="yiyi-369">&#x5728;0.6&#x4E2D;&#xFF0C;&#x8FD9;&#x4F1A;&#x4F7F;&#x5F97;&#xFF1A;</span></p><div class="highlight-python"><div class="highlight"><pre><span></span>SELECT parent.id AS parent_id
FROM parent
WHERE parent.id &gt; :id_1</pre></div></div><p><span class="yiyi-st" id="yiyi-370">&#x5728;0.7&#x4E2D;&#xFF0C;&#x4F60;&#x4F1A;&#x5F97;&#x5230;&#xFF1A;</span></p><div class="highlight-python"><div class="highlight"><pre><span></span>SELECT parent.id AS parent_id
FROM parent, child
WHERE child.id &gt; :id_1</pre></div></div><p><span class="yiyi-st" id="yiyi-371">&#x4F60;&#x4F1A;&#x6CE8;&#x610F;&#x5230;&#x5B83;&#x662F;&#x4E00;&#x4E2A;&#x7B1B;&#x5361;&#x5C14;&#x79EF; - &#x8FD9;&#x4E2A;&#x884C;&#x4E3A;&#x73B0;&#x5728;&#x7B49;&#x540C;&#x4E8E;<code class="docutils literal"><span class="pre">Child</span></code>&#x672C;&#x5730;&#x7684;&#x4EFB;&#x4F55;&#x5176;&#x4ED6;&#x5C5E;&#x6027;&#x7684;&#x884C;&#x4E3A;&#x3002;</span><span class="yiyi-st" id="yiyi-372">&#x4F7F;&#x7528;<code class="docutils literal"><span class="pre">with_polymorphic()</span></code>&#x65B9;&#x6CD5;&#x6216;&#x663E;&#x5F0F;&#x8FDE;&#x63A5;&#x5E95;&#x5C42;<code class="docutils literal"><span class="pre">Table</span></code>&#x5BF9;&#x8C61;&#x7684;&#x7C7B;&#x4F3C;&#x7B56;&#x7565;&#x6765;&#x9488;&#x5BF9;&#x6240;&#x6709;<code class="docutils literal"><span class="pre">Parent</span></code>&#x5BF9;&#x8C61;&#x5448;&#x73B0;&#x67E5;&#x8BE2;&#x6309;&#x7167;&#x4E0E;0.5&#x548C;0.6&#x76F8;&#x540C;&#x7684;&#x65B9;&#x5F0F;&#x5BF9;<code class="docutils literal"><span class="pre">Child</span></code>&#x8FDB;&#x884C;&#x6807;&#x51C6;&#x5316;&#xFF1A;</span></p><div class="highlight-python"><div class="highlight"><pre><span></span><span class="k">print</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">Parent</span><span class="p">)</span><span class="o">.</span><span class="n">with_polymorphic</span><span class="p">([</span><span class="n">Child</span><span class="p">])</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">Child</span><span class="o">.</span><span class="n">id</span> <span class="o">&gt;</span> <span class="mi">7</span><span class="p">))</span></pre></div></div><p><span class="yiyi-st" id="yiyi-373">0.6&#x548C;0.7&#x4E2D;&#x7684;&#x54EA;&#x4E00;&#x4E2A;&#x5448;&#x73B0;&#xFF1A;</span></p><div class="highlight-python"><div class="highlight"><pre><span></span>SELECT parent.id AS parent_id, child.id AS child_id
FROM parent LEFT OUTER JOIN child ON parent.id = child.id
WHERE child.id &gt; :id_1</pre></div></div><p><span class="yiyi-st" id="yiyi-374">&#x6B64;&#x66F4;&#x6539;&#x7684;&#x53E6;&#x4E00;&#x4E2A;&#x5F71;&#x54CD;&#x662F;&#x8DE8;&#x4E24;&#x4E2A;&#x8868;&#x7684;&#x8FDE;&#x63A5;&#x7EE7;&#x627F;&#x8D1F;&#x8F7D;&#x5C06;&#x4ECE;&#x5B50;&#x8868;&#x7684;&#x503C;&#x4E2D;&#x586B;&#x5145;&#xFF0C;&#x800C;&#x4E0D;&#x662F;&#x7236;&#x8868;&#x7684;&#x503C;&#x3002;</span><span class="yiyi-st" id="yiyi-375">&#x4E00;&#x4E2A;&#x4E0D;&#x5E38;&#x89C1;&#x7684;&#x60C5;&#x51B5;&#x662F;&#xFF0C;&#x4F7F;&#x7528;<code class="docutils literal"><span class="pre">with_polymorphic=&quot;*&quot;</span></code>&#x9488;&#x5BF9;&#x201C;&#x7236;&#x201D;&#x8FDB;&#x884C;&#x7684;&#x67E5;&#x8BE2;&#x9488;&#x5BF9;&#x201C;&#x7236;&#x201D;&#x53D1;&#x51FA;&#x67E5;&#x8BE2;&#xFF0C;&#x5E76;&#x5C06;LEFT OUTER JOIN&#x6539;&#x4E3A;&#x201C;child&#x201D;&#x3002;</span><span class="yiyi-st" id="yiyi-376">&#x8BE5;&#x884C;&#x4F4D;&#x4E8E;&#x201C;Parent&#x201D;&#x4E2D;&#xFF0C;&#x770B;&#x5230;&#x591A;&#x6001;&#x8EAB;&#x4EFD;&#x5BF9;&#x5E94;&#x4E8E;&#x201C;Child&#x201D;&#xFF0C;&#x4F46;&#x5047;&#x8BBE;&#x201C;child&#x201D;&#x4E2D;&#x7684;&#x5B9E;&#x9645;&#x884C;&#x5DF2;&#x88AB;<em>&#x5220;&#x9664;</em>&#x3002;</span><span class="yiyi-st" id="yiyi-377">&#x7531;&#x4E8E;&#x8FD9;&#x79CD;&#x635F;&#x574F;&#xFF0C;&#x8BE5;&#x884C;&#x51FA;&#x73B0;&#x4E0E;&#x201C;child&#x201D;&#x8BBE;&#x7F6E;&#x4E3A;NULL&#x7684;&#x6240;&#x6709;&#x5217; - &#x8FD9;&#x662F;&#x73B0;&#x5728;&#x586B;&#x5145;&#x7684;&#x503C;&#xFF0C;&#x800C;&#x4E0D;&#x662F;&#x7236;&#x8868;&#x4E2D;&#x7684;&#x503C;&#x3002;</span></p><p><span class="yiyi-st" id="yiyi-378"><a class="reference external" href="http://www.sqlalchemy.org/trac/ticket/1892">&#xFF03;1892  T0&gt;</a></span></p></div><div class="section" id="mapping-to-joins-with-two-or-more-same-named-columns-requires-explicit-declaration"><h3><span class="yiyi-st" id="yiyi-379">&#x6620;&#x5C04;&#x5230;&#x4E24;&#x4E2A;&#x6216;&#x591A;&#x4E2A;&#x540C;&#x540D;&#x5217;&#x7684;&#x8FDE;&#x63A5;&#x9700;&#x8981;&#x663E;&#x5F0F;&#x58F0;&#x660E;<a class="headerlink" href="#mapping-to-joins-with-two-or-more-same-named-columns-requires-explicit-declaration" title="Permalink to this headline">&#xB6;</a></span></h3><p><span class="yiyi-st" id="yiyi-380">&#x8FD9;&#x4E0E;<a class="reference external" href="http://www.sqlalchemy.org/trac/ticket/1892">&#xFF03;1892</a>&#x4E2D;&#x7684;&#x524D;&#x4E00;&#x4E2A;&#x66F4;&#x6539;&#x6709;&#x4E9B;&#x76F8;&#x5173;&#x3002;</span><span class="yiyi-st" id="yiyi-381">&#x5728;&#x6620;&#x5C04;&#x5230;&#x8FDE;&#x63A5;&#x65F6;&#xFF0C;&#x540C;&#x540D;&#x5217;&#x5FC5;&#x987B;&#x663E;&#x5F0F;&#x94FE;&#x63A5;&#x5230;&#x6620;&#x5C04;&#x5C5E;&#x6027;&#xFF0C;&#x5373;&#x5982;<a class="reference external" href="http://www.sqlalchemy.org/docs/07/orm_mapper_config.html#mapping-a-class-against-multiple-tables">&#x6839;&#x636E;&#x591A;&#x4E2A;&#x8868;&#x6620;&#x5C04;&#x7C7B;</a>&#x4E2D;&#x6240;&#x8FF0;&#x3002;</span></p><p><span class="yiyi-st" id="yiyi-382">&#x7ED9;&#x5B9A;&#x4E24;&#x4E2A;&#x8868;<code class="docutils literal"><span class="pre">foo</span></code>&#x548C;<code class="docutils literal"><span class="pre">bar</span></code>&#xFF0C;&#x6BCF;&#x4E2A;&#x8868;&#x5177;&#x6709;&#x4E3B;&#x952E;&#x5217;<code class="docutils literal"><span class="pre">id</span></code>&#xFF0C;&#x73B0;&#x5728;&#x4F1A;&#x4EA7;&#x751F;&#x4E00;&#x4E2A;&#x9519;&#x8BEF;&#xFF1A;</span></p><div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">foobar</span> <span class="o">=</span> <span class="n">foo</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">bar</span><span class="p">,</span> <span class="n">foo</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">id</span><span class="o">==</span><span class="n">bar</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">foo_id</span><span class="p">)</span>
<span class="n">mapper</span><span class="p">(</span><span class="n">FooBar</span><span class="p">,</span> <span class="n">foobar</span><span class="p">)</span></pre></div></div><p><span class="yiyi-st" id="yiyi-383">This because the <code class="docutils literal"><span class="pre">mapper()</span></code> refuses to guess what column is the primary representation of <code class="docutils literal"><span class="pre">FooBar.id</span></code> - is it <code class="docutils literal"><span class="pre">foo.c.id</span></code> or is it <code class="docutils literal"><span class="pre">bar.c.id</span></code> ? </span><span class="yiyi-st" id="yiyi-384">&#x8BE5;&#x5C5E;&#x6027;&#x5FC5;&#x987B;&#x662F;&#x660E;&#x786E;&#x7684;&#xFF1A;</span></p><div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">foobar</span> <span class="o">=</span> <span class="n">foo</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">bar</span><span class="p">,</span> <span class="n">foo</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">id</span><span class="o">==</span><span class="n">bar</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">foo_id</span><span class="p">)</span>
<span class="n">mapper</span><span class="p">(</span><span class="n">FooBar</span><span class="p">,</span> <span class="n">foobar</span><span class="p">,</span> <span class="n">properties</span><span class="o">=</span><span class="p">{</span>
    <span class="s1">&apos;id&apos;</span><span class="p">:[</span><span class="n">foo</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">bar</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">id</span><span class="p">]</span>
<span class="p">})</span></pre></div></div><p><span class="yiyi-st" id="yiyi-385"><a class="reference external" href="http://www.sqlalchemy.org/trac/ticket/1896">&#xFF03;1896  T0&gt;</a></span></p></div><div class="section" id="mapper-requires-that-polymorphic-on-column-be-present-in-the-mapped-selectable"><h3><span class="yiyi-st" id="yiyi-386">Mapper&#x8981;&#x6C42;polymorphic_on&#x5217;&#x5B58;&#x5728;&#x4E8E;&#x6620;&#x5C04;&#x7684;&#x53EF;&#x9009;<a class="headerlink" href="#mapper-requires-that-polymorphic-on-column-be-present-in-the-mapped-selectable" title="Permalink to this headline">&#xB6;</a>&#x4E2D;</span></h3><p><span class="yiyi-st" id="yiyi-387">&#x8FD9;&#x662F;0.6&#x7684;&#x8B66;&#x544A;&#xFF0C;&#x73B0;&#x5728;0.7&#x7684;&#x9519;&#x8BEF;&#x3002;</span><span class="yiyi-st" id="yiyi-388">&#x4E3A;<code class="docutils literal"><span class="pre">polymorphic_on</span></code>&#x63D0;&#x4F9B;&#x7684;&#x5217;&#x5FC5;&#x987B;&#x4F4D;&#x4E8E;&#x6620;&#x5C04;&#x53EF;&#x9009;&#x9879;&#x4E2D;&#x3002;</span><span class="yiyi-st" id="yiyi-389">&#x8FD9;&#x53EF;&#x4EE5;&#x9632;&#x6B62;&#x4E00;&#x4E9B;&#x5076;&#x7136;&#x7684;&#x7528;&#x6237;&#x9519;&#x8BEF;&#xFF0C;&#x4F8B;&#x5982;&#xFF1A;</span></p><div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">mapper</span><span class="p">(</span><span class="n">SomeClass</span><span class="p">,</span> <span class="n">sometable</span><span class="p">,</span> <span class="n">polymorphic_on</span><span class="o">=</span><span class="n">some_lookup_table</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">id</span><span class="p">)</span></pre></div></div><p><span class="yiyi-st" id="yiyi-390">&#x5176;&#x4E2D;polymorphic_on&#x5FC5;&#x987B;&#x4F4D;&#x4E8E;<code class="docutils literal"><span class="pre">sometable</span></code>&#x5217;&#x4E0A;&#xFF0C;&#x5728;&#x8FD9;&#x79CD;&#x60C5;&#x51B5;&#x4E0B;&#x53EF;&#x80FD;&#x662F;<code class="docutils literal"><span class="pre">sometable.c.some_lookup_id</span></code>&#x3002;</span><span class="yiyi-st" id="yiyi-391">&#x8FD8;&#x6709;&#x4E00;&#x4E9B;&#x201C;&#x591A;&#x6001;&#x8054;&#x5408;&#x201D;&#x60C5;&#x666F;&#xFF0C;&#x5176;&#x4E2D;&#x6709;&#x65F6;&#x4F1A;&#x51FA;&#x73B0;&#x7C7B;&#x4F3C;&#x7684;&#x9519;&#x8BEF;&#x3002;</span></p><p><span class="yiyi-st" id="yiyi-392">&#x8FD9;&#x6837;&#x7684;&#x914D;&#x7F6E;&#x9519;&#x8BEF;&#x4E00;&#x76F4;&#x662F;&#x201C;&#x9519;&#x8BEF;&#x7684;&#x201D;&#xFF0C;&#x5E76;&#x4E14;&#x4E0A;&#x9762;&#x7684;&#x6620;&#x5C04;&#x4E0D;&#x80FD;&#x50CF;&#x6307;&#x5B9A;&#x7684;&#x90A3;&#x6837;&#x5DE5;&#x4F5C; - &#x8BE5;&#x5217;&#x5C06;&#x88AB;&#x5FFD;&#x7565;&#x3002;</span><span class="yiyi-st" id="yiyi-393">&#x7136;&#x800C;&#xFF0C;&#x5728;&#x7F55;&#x89C1;&#x7684;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x5728;&#x4E0D;&#x77E5;&#x4E0D;&#x89C9;&#x4E2D;&#x4F9D;&#x8D56;&#x4E8E;&#x8FD9;&#x79CD;&#x884C;&#x4E3A;&#xFF0C;&#x5B83;&#x53EF;&#x80FD;&#x4F1A;&#x5411;&#x540E;&#x517C;&#x5BB9;&#x3002;</span></p><p><span class="yiyi-st" id="yiyi-394"><a class="reference external" href="http://www.sqlalchemy.org/trac/ticket/1875">&#xFF03;1875  T0&gt;</a></span></p></div><div class="section" id="ddl-constructs-now-escape-percent-signs"><h3><span class="yiyi-st" id="yiyi-395"><code class="docutils literal"><span class="pre">DDL()</span></code>&#x6784;&#x9020;&#x73B0;&#x5728;&#x8F6C;&#x4E49;&#x767E;&#x5206;&#x53F7;<a class="headerlink" href="#ddl-constructs-now-escape-percent-signs" title="Permalink to this headline">&#xB6;</a></span></h3><p><span class="yiyi-st" id="yiyi-396">&#x4EE5;&#x524D;&#xFF0C;&#x5BF9;&#x4E8E;&#x90A3;&#x4E9B;&#x63A5;&#x53D7;<code class="docutils literal"><span class="pre">pyformat</span></code>&#x7684;DBAPI&#xFF0C;&#x6839;&#x636E;DBAPI&#xFF0C;<code class="docutils literal"><span class="pre">DDL()</span></code>&#x5B57;&#x7B26;&#x4E32;&#x4E2D;&#x7684;&#x767E;&#x5206;&#x53F7;&#x5FC5;&#x987B;&#x8F6C;&#x4E49;&#xFF0C;&#x5373;<code class="docutils literal"><span class="pre">%%</span></code>&#x6216;<code class="docutils literal"><span class="pre">format</span></code>&#x7ED1;&#x5B9A;&#xFF08;&#x5373;psycopg2&#xFF0C;mysql-python&#xFF09;&#xFF0C;&#x8FD9;&#x4E0E;<code class="docutils literal"><span class="pre">text()</span></code>&#x6784;&#x9020;&#x4E0D;&#x4E00;&#x81F4;&#x3002;</span><span class="yiyi-st" id="yiyi-397">&#x5BF9;&#x4E8E;<code class="docutils literal"><span class="pre">text()</span></code>&#xFF0C;&#x73B0;&#x5728;&#x5BF9;<code class="docutils literal"><span class="pre">DDL()</span></code>&#x53D1;&#x751F;&#x540C;&#x6837;&#x7684;&#x8F6C;&#x4E49;&#x3002;</span></p><p><span class="yiyi-st" id="yiyi-398"><a class="reference external" href="http://www.sqlalchemy.org/trac/ticket/1897">&#xFF03;1897  T0&gt;</a></span></p></div><div class="section" id="table-c-metadata-tables-refined-a-bit-don-t-allow-direct-mutation"><h3><span class="yiyi-st" id="yiyi-399"><code class="docutils literal"><span class="pre">Table.c</span></code> / <code class="docutils literal"><span class="pre">MetaData.tables</span></code>&#x7EC6;&#x5316;&#x4E86;&#x4E00;&#x4E0B;&#xFF0C;&#x4E0D;&#x5141;&#x8BB8;&#x76F4;&#x63A5;&#x53D8;&#x5F02;<a class="headerlink" href="#table-c-metadata-tables-refined-a-bit-don-t-allow-direct-mutation" title="Permalink to this headline">&#xB6;</a></span></h3><p><span class="yiyi-st" id="yiyi-400">Another area where some users were tinkering around in such a way that doesn&#x2019;t actually work as expected, but still left an exceedingly small chance that some application was relying upon this behavior, the construct returned by the <code class="docutils literal"><span class="pre">.c</span></code> attribute on <code class="docutils literal"><span class="pre">Table</span></code> and the <code class="docutils literal"><span class="pre">.tables</span></code> attribute on <code class="docutils literal"><span class="pre">MetaData</span></code> is explicitly non-mutable. </span><span class="yiyi-st" id="yiyi-401">&#x8BE5;&#x6784;&#x9020;&#x7684;&#x201C;&#x53EF;&#x53D8;&#x201D;&#x7248;&#x672C;&#x73B0;&#x5728;&#x662F;&#x79C1;&#x4EBA;&#x7684;&#x3002;</span><span class="yiyi-st" id="yiyi-402">Adding columns to <code class="docutils literal"><span class="pre">.c</span></code> involves using the <code class="docutils literal"><span class="pre">append_column()</span></code> method of <code class="docutils literal"><span class="pre">Table</span></code>, which ensures things are associated with the parent <code class="docutils literal"><span class="pre">Table</span></code> in the appropriate way; similarly, <code class="docutils literal"><span class="pre">MetaData.tables</span></code> has a contract with the <code class="docutils literal"><span class="pre">Table</span></code> objects stored in this dictionary, as well as a little bit of new bookkeeping in that a <code class="docutils literal"><span class="pre">set()</span></code> of all schema names is tracked, which is satisfied only by using the public <code class="docutils literal"><span class="pre">Table</span></code> constructor as well as <code class="docutils literal"><span class="pre">Table.tometadata()</span></code>.</span></p><p><span class="yiyi-st" id="yiyi-403">&#x5F53;&#x7136;&#x6709;&#x53EF;&#x80FD;&#x8FD9;&#x4E9B;&#x5C5E;&#x6027;&#x6240;&#x54A8;&#x8BE2;&#x7684;<code class="docutils literal"><span class="pre">ColumnCollection</span></code>&#x548C;<code class="docutils literal"><span class="pre">dict</span></code>&#x96C6;&#x5408;&#x6709;&#x4E00;&#x5929;&#x4F1A;&#x5728;&#x5176;&#x6240;&#x6709;&#x7684;&#x7A81;&#x53D8;&#x65B9;&#x6CD5;&#x4E0A;&#x5B9E;&#x73B0;&#x4E8B;&#x4EF6;&#xFF0C;&#x8FD9;&#x6837;&#x6070;&#x5F53;&#x7684;&#x7C3F;&#x8BB0;&#x5C31;&#x53D1;&#x751F;&#x5728;&#x4F46;&#x662F;&#x76F4;&#x5230;&#x6709;&#x4EBA;&#x6709;&#x52A8;&#x673A;&#x53BB;&#x5B9E;&#x73B0;&#x6240;&#x6709;&#x8FD9;&#x4E9B;&#x4EE5;&#x53CA;&#x51E0;&#x5341;&#x4E2A;&#x65B0;&#x7684;&#x5355;&#x5143;&#x6D4B;&#x8BD5;&#xFF0C;&#x7F29;&#x5C0F;&#x8FD9;&#x4E9B;&#x96C6;&#x5408;&#x7684;&#x53D8;&#x5F02;&#x8DEF;&#x5F84;&#x5C06;&#x786E;&#x4FDD;&#x6CA1;&#x6709;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x8BD5;&#x56FE;&#x4F9D;&#x8D56;&#x76EE;&#x524D;&#x4E0D;&#x88AB;&#x652F;&#x6301;&#x7684;&#x7528;&#x6CD5;&#x3002;</span></p><p><span class="yiyi-st" id="yiyi-404"><a class="reference external" href="http://www.sqlalchemy.org/trac/ticket/1893">&#xFF03;1893</a> <a class="reference external" href="http://www.sqlalchemy.org/trac/ticket/1917">&#xFF03;1917</a></span></p></div><div class="section" id="server-default-consistently-returns-none-for-all-inserted-primary-key-values"><h3><span class="yiyi-st" id="yiyi-405">&#x5BF9;&#x4E8E;&#x6240;&#x6709;inserted_primary_key&#x503C;&#xFF0C;server_default&#x59CB;&#x7EC8;&#x8FD4;&#x56DE;None <a class="headerlink" href="#server-default-consistently-returns-none-for-all-inserted-primary-key-values" title="Permalink to this headline">&#xB6;</a></span></h3><p><span class="yiyi-st" id="yiyi-406">&#x5728;Integer PK&#x5217;&#x4E0A;&#x5B58;&#x5728;server_default&#x65F6;&#x5EFA;&#x7ACB;&#x4E00;&#x81F4;&#x6027;&#x3002;</span><span class="yiyi-st" id="yiyi-407">SQLA&#x4E0D;&#x4F1A;&#x9884;&#x53D6;&#x8FD9;&#x4E9B;&#xFF0C;&#x4E5F;&#x4E0D;&#x4F1A;&#x8FD4;&#x56DE;&#x5230;cursor.lastrowid&#xFF08;DBAPI&#xFF09;&#x4E2D;&#x3002;</span><span class="yiyi-st" id="yiyi-408">&#x786E;&#x4FDD;&#x6240;&#x6709;&#x540E;&#x7AEF;&#x59CB;&#x7EC8;&#x5728;result.inserted_primary_key&#x4E2D;&#x8FD4;&#x56DE;None&#xFF0C;&#x8FD9;&#x4E9B;&#x540E;&#x7AEF;&#x53EF;&#x80FD;&#x5148;&#x524D;&#x5DF2;&#x8FD4;&#x56DE;&#x4E00;&#x4E2A;&#x503C;&#x3002;</span><span class="yiyi-st" id="yiyi-409">&#x5728;&#x4E3B;&#x952E;&#x5217;&#x4E0A;&#x4F7F;&#x7528;server_default&#x662F;&#x975E;&#x5E38;&#x4E0D;&#x5BFB;&#x5E38;&#x7684;&#x3002;</span><span class="yiyi-st" id="yiyi-410">&#x5982;&#x679C;&#x4F7F;&#x7528;&#x7279;&#x6B8A;&#x51FD;&#x6570;&#x6216;SQL&#x8868;&#x8FBE;&#x5F0F;&#x6765;&#x751F;&#x6210;&#x4E3B;&#x952E;&#x9ED8;&#x8BA4;&#x503C;&#xFF0C;&#x5219;&#x5E94;&#x8BE5;&#x5C06;&#x5176;&#x8BBE;&#x7F6E;&#x4E3A;Python&#x7AEF;&#x201C;default&#x201D;&#x800C;&#x4E0D;&#x662F;server_default&#x3002;</span></p><p><span class="yiyi-st" id="yiyi-411">&#x5173;&#x4E8E;&#x8FD9;&#x79CD;&#x60C5;&#x51B5;&#x7684;&#x53CD;&#x601D;&#xFF0C;&#x9664;&#x4E86;&#x5728;&#x6211;&#x4EEC;&#x68C0;&#x6D4B;&#x5230;&#x5E8F;&#x5217;&#x9ED8;&#x8BA4;&#x503C;&#x7684;PG SERIAL col&#x7684;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;&#x5BF9;server_default&#x7684;int PK col&#x7684;&#x53CD;&#x6620;&#x5C06;&#x201C;autoincrement&#x201D;&#x6807;&#x5FD7;&#x8BBE;&#x7F6E;&#x4E3A;False&#x3002;</span></p><p><span class="yiyi-st" id="yiyi-412"><a class="reference external" href="http://www.sqlalchemy.org/trac/ticket/2020">#2020</a> <a class="reference external" href="http://www.sqlalchemy.org/trac/ticket/2021">#2021</a></span></p></div><div class="section" id="the-sqlalchemy-exceptions-alias-in-sys-modules-is-removed"><h3><span class="yiyi-st" id="yiyi-413">sys.modules&#x4E2D;&#x7684;<code class="docutils literal"><span class="pre">sqlalchemy.exceptions</span></code>&#x522B;&#x540D;&#x5DF2;&#x88AB;&#x79FB;&#x9664;<a class="headerlink" href="#the-sqlalchemy-exceptions-alias-in-sys-modules-is-removed" title="Permalink to this headline">&#xB6;</a></span></h3><p><span class="yiyi-st" id="yiyi-414">For a few years we&#x2019;ve added the string <code class="docutils literal"><span class="pre">sqlalchemy.exceptions</span></code> to <code class="docutils literal"><span class="pre">sys.modules</span></code>, so that a statement like &#x201C;<code class="docutils literal"><span class="pre">import</span> <span class="pre">sqlalchemy.exceptions</span></code>&#x201D; would work. </span><span class="yiyi-st" id="yiyi-415">&#x5F88;&#x4E45;&#x4EE5;&#x6765;&#xFF0C;&#x6838;&#x5FC3;&#x4F8B;&#x5916;&#x6A21;&#x5757;&#x7684;&#x540D;&#x79F0;&#x4E00;&#x76F4;&#x662F;<code class="docutils literal"><span class="pre">exc</span></code>&#xFF0C;&#x56E0;&#x6B64;&#x5EFA;&#x8BAE;&#x4E3A;&#x6B64;&#x6A21;&#x5757;&#x5BFC;&#x5165;&#xFF1A;</span></p><div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sqlalchemy</span> <span class="kn">import</span> <span class="n">exc</span></pre></div></div><p><span class="yiyi-st" id="yiyi-416">The <code class="docutils literal"><span class="pre">exceptions</span></code> name is still present in &#x201C;<code class="docutils literal"><span class="pre">sqlalchemy</span></code>&#x201D; for applications which might have said <code class="docutils literal"><span class="pre">from</span> <span class="pre">sqlalchemy</span> <span class="pre">import</span> <span class="pre">exceptions</span></code>, but they should also start using the <code class="docutils literal"><span class="pre">exc</span></code> name.</span></p></div><div class="section" id="query-timing-recipe-changes"><h3><span class="yiyi-st" id="yiyi-417">&#x67E5;&#x8BE2;&#x8BA1;&#x65F6;&#x914D;&#x65B9;&#x66F4;&#x6539;<a class="headerlink" href="#query-timing-recipe-changes" title="Permalink to this headline">&#xB6;</a></span></h3><p><span class="yiyi-st" id="yiyi-418">&#x867D;&#x7136;&#x4E0D;&#x662F;SQLAlchemy&#x672C;&#x8EAB;&#x7684;&#x4E00;&#x90E8;&#x5206;&#xFF0C;&#x4F46;&#x503C;&#x5F97;&#x4E00;&#x63D0;&#x7684;&#x662F;&#xFF0C;&#x5C06;<code class="docutils literal"><span class="pre">ConnectionProxy</span></code>&#x91CD;&#x65B0;&#x52A0;&#x5165;&#x5230;&#x65B0;&#x4E8B;&#x4EF6;&#x7CFB;&#x7EDF;&#x4E2D;&#x610F;&#x5473;&#x7740;&#x5B83;&#x4E0D;&#x518D;&#x9002;&#x5408;&#x201C;Timing all Queries&#x201D;&#x914D;&#x65B9;&#x3002;</span><span class="yiyi-st" id="yiyi-419">&#x8BF7;&#x8C03;&#x6574;&#x67E5;&#x8BE2;&#x8BA1;&#x65F6;&#x5668;&#x4EE5;&#x4F7F;&#x7528;<code class="docutils literal"><span class="pre">before_cursor_execute()</span></code>&#x548C;<code class="docutils literal"><span class="pre">after_cursor_execute()</span></code>&#x4E8B;&#x4EF6;&#xFF0C;&#x5E76;&#x5728;&#x66F4;&#x65B0;&#x914D;&#x65B9;UsageRecipes / Profiling&#x4E2D;&#x8FDB;&#x884C;&#x6F14;&#x793A;&#x3002;</span></p></div></div><div class="section" id="deprecated-api"><h2><span class="yiyi-st" id="yiyi-420">&#x5F03;&#x7528;&#x7684;API <a class="headerlink" href="#deprecated-api" title="Permalink to this headline">&#xB6;</a></span></h2><div class="section" id="default-constructor-on-types-will-not-accept-arguments"><h3><span class="yiyi-st" id="yiyi-421">&#x7C7B;&#x578B;&#x4E0A;&#x7684;&#x9ED8;&#x8BA4;&#x6784;&#x9020;&#x51FD;&#x6570;&#x4E0D;&#x4F1A;&#x63A5;&#x53D7;&#x53C2;&#x6570;<a class="headerlink" href="#default-constructor-on-types-will-not-accept-arguments" title="Permalink to this headline">&#xB6;</a></span></h3><p><span class="yiyi-st" id="yiyi-422">&#x7B80;&#x5355;&#x7C7B;&#x578B;&#xFF0C;&#x5982;<code class="docutils literal"><span class="pre">Integer</span></code>&#xFF0C;<code class="docutils literal"><span class="pre">Date</span></code>&#x7B49;</span><span class="yiyi-st" id="yiyi-423">&#x5728;&#x6838;&#x5FC3;&#x7C7B;&#x578B;&#x6A21;&#x5757;&#x4E2D;&#x4E0D;&#x63A5;&#x53D7;&#x53C2;&#x6570;&#x3002;</span><span class="yiyi-st" id="yiyi-424">The default constructor that accepts/ignores a catchall <code class="docutils literal"><span class="pre">\*args,</span> <span class="pre">\**kwargs</span></code> is restored as of 0.7b4/0.7.0, but emits a deprecation warning.</span></p><p><span class="yiyi-st" id="yiyi-425">&#x5982;&#x679C;&#x53C2;&#x6570;&#x4E0E;&#x6838;&#x5FC3;&#x7C7B;&#x578B;&#xFF08;&#x5982;<code class="docutils literal"><span class="pre">Integer</span></code>&#xFF09;&#x4E00;&#x8D77;&#x4F7F;&#x7528;&#xFF0C;&#x53EF;&#x80FD;&#x662F;&#x56E0;&#x4E3A;&#x60A8;&#x6253;&#x7B97;&#x4F7F;&#x7528;&#x7279;&#x5B9A;&#x4E8E;&#x65B9;&#x8A00;&#x7684;&#x7C7B;&#x578B;&#xFF0C;&#x5982;<code class="docutils literal"><span class="pre">sqlalchemy.dialects.mysql.INTEGER</span></code>&#x4F8B;&#x5982;&#x63A5;&#x53D7;&#x4E00;&#x4E2A;&#x201C;display_width&#x201D;&#x53C2;&#x6570;&#x3002;</span></p></div><div class="section" id="compile-mappers-renamed-configure-mappers-simplified-configuration-internals"><h3><span class="yiyi-st" id="yiyi-426">compile_mappers()&#x91CD;&#x547D;&#x540D;&#x4E3A;configure_mappers()&#xFF0C;&#x7B80;&#x5316;&#x4E86;&#x914D;&#x7F6E;&#x5185;&#x90E8;&#x7ED3;&#x6784;<a class="headerlink" href="#compile-mappers-renamed-configure-mappers-simplified-configuration-internals" title="Permalink to this headline">&#xB6;</a></span></h3><p><span class="yiyi-st" id="yiyi-427">&#x8FD9;&#x4E2A;&#x7CFB;&#x7EDF;&#x6162;&#x6162;&#x5730;&#x4ECE;&#x5C0F;&#x7684;&#x4E1C;&#x897F;&#x53D8;&#x6210;&#x4E86;&#x4E1C;&#x897F;&#xFF0C;&#x4ECE;&#x672C;&#x5730;&#x5B9E;&#x73B0;&#x5230;&#x4E86;&#x5355;&#x4E2A;&#x7684;&#x6620;&#x5C04;&#x5668;&#xFF0C;&#x5E76;&#x4E14;&#x5F88;&#x5C11;&#x88AB;&#x547D;&#x540D;&#x4E3A;&#x66F4;&#x5177;&#x5168;&#x5C40;&#x6027;&#x7684;&#x201C;&#x6CE8;&#x518C;&#x8868;&#x201D;&#x7EA7;&#x529F;&#x80FD;&#xFF0C;&#x800C;&#x4E14;&#x547D;&#x540D;&#x5F97;&#x4E0D;&#x597D;&#xFF0C;&#x6240;&#x4EE5;&#x6211;&#x4EEC;&#x901A;&#x8FC7;&#x5C06;&#x5B9E;&#x73B0;&#x79FB;&#x51FA;<code class="docutils literal"><span class="pre">Mapper</span></code>&#x5E76;&#x5C06;&#x5176;&#x91CD;&#x547D;&#x540D;&#x4E3A;<code class="docutils literal"><span class="pre">configure_mappers()</span></code>&#x3002;</span><span class="yiyi-st" id="yiyi-428">&#x5F53;&#x4E00;&#x4E2A;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x901A;&#x8FC7;&#x5C5E;&#x6027;&#x6216;&#x67E5;&#x8BE2;&#x8BBF;&#x95EE;&#x9700;&#x8981;&#x6620;&#x5C04;&#x65F6;&#xFF0C;&#x901A;&#x5E38;&#x4E0D;&#x9700;&#x8981;&#x8C03;&#x7528;<code class="docutils literal"><span class="pre">configure_mappers()</span></code>&#xFF0C;&#x56E0;&#x4E3A;&#x6B64;&#x8FC7;&#x7A0B;&#x662F;&#x6309;&#x7167;&#x9700;&#x8981;&#x53D1;&#x751F;&#x7684;&#x3002;</span></p><p><span class="yiyi-st" id="yiyi-429"><a class="reference external" href="http://www.sqlalchemy.org/trac/ticket/1966">&#xFF03;1966  T0&gt;</a></span></p></div><div class="section" id="core-listener-proxy-superseded-by-event-listeners"><h3><span class="yiyi-st" id="yiyi-430">&#x6838;&#x5FC3;&#x4FA6;&#x542C;&#x5668;/&#x4EE3;&#x7406;&#x88AB;&#x4E8B;&#x4EF6;&#x4FA6;&#x542C;&#x5668;&#x53D6;&#x4EE3;<a class="headerlink" href="#core-listener-proxy-superseded-by-event-listeners" title="Permalink to this headline">&#xB6;</a></span></h3><p><span class="yiyi-st" id="yiyi-431"><code class="docutils literal"><span class="pre">PoolListener</span></code>, <code class="docutils literal"><span class="pre">ConnectionProxy</span></code>, <code class="docutils literal"><span class="pre">DDLElement.execute_at</span></code> are superseded by <code class="docutils literal"><span class="pre">event.listen()</span></code>, using the <code class="docutils literal"><span class="pre">PoolEvents</span></code>, <code class="docutils literal"><span class="pre">EngineEvents</span></code>, <code class="docutils literal"><span class="pre">DDLEvents</span></code> dispatch targets, respectively.</span></p></div><div class="section" id="orm-extensions-superseded-by-event-listeners"><h3><span class="yiyi-st" id="yiyi-432">ORM&#x6269;&#x5C55;&#x53D6;&#x4EE3;&#x4E86;&#x4E8B;&#x4EF6;&#x76D1;&#x542C;&#x5668;<a class="headerlink" href="#orm-extensions-superseded-by-event-listeners" title="Permalink to this headline">&#xB6;</a></span></h3><p><span class="yiyi-st" id="yiyi-433"><code class="docutils literal"><span class="pre">MapperExtension</span></code>, <code class="docutils literal"><span class="pre">AttributeExtension</span></code>, <code class="docutils literal"><span class="pre">SessionExtension</span></code> are superseded by <code class="docutils literal"><span class="pre">event.listen()</span></code>, using the <code class="docutils literal"><span class="pre">MapperEvents</span></code>/<code class="docutils literal"><span class="pre">InstanceEvents</span></code>, <code class="docutils literal"><span class="pre">AttributeEvents</span></code>, <code class="docutils literal"><span class="pre">SessionEvents</span></code>, dispatch targets, respectively.</span></p></div><div class="section" id="sending-a-string-to-distinct-in-select-for-mysql-should-be-done-via-prefixes"><h3><span class="yiyi-st" id="yiyi-434">&#x5728;select()&#x4E2D;&#x4E3A;MySQL&#x53D1;&#x9001;&#x5B57;&#x7B26;&#x4E32;&apos;distinct&apos;&#x5E94;&#x8BE5;&#x901A;&#x8FC7;&#x524D;&#x7F00;&#x6765;&#x5B8C;&#x6210;<a class="headerlink" href="#sending-a-string-to-distinct-in-select-for-mysql-should-be-done-via-prefixes" title="Permalink to this headline">&#xB6;</a></span></h3><p><span class="yiyi-st" id="yiyi-435">&#x8FD9;&#x4E2A;&#x6A21;&#x7CCA;&#x7684;&#x7279;&#x6027;&#x5141;&#x8BB8;&#x8FD9;&#x79CD;&#x6A21;&#x5F0F;&#x4E0E;MySQL&#x540E;&#x7AEF;&#xFF1A;</span></p><div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">select</span><span class="p">([</span><span class="n">mytable</span><span class="p">],</span> <span class="n">distinct</span><span class="o">=</span><span class="s1">&apos;ALL&apos;</span><span class="p">,</span> <span class="n">prefixes</span><span class="o">=</span><span class="p">[</span><span class="s1">&apos;HIGH_PRIORITY&apos;</span><span class="p">])</span></pre></div></div><p><span class="yiyi-st" id="yiyi-436"><code class="docutils literal"><span class="pre">prefixes</span></code>&#x5173;&#x952E;&#x5B57;&#x6216;<code class="docutils literal"><span class="pre">prefix_with()</span></code>&#x65B9;&#x6CD5;&#x5E94;&#x8BE5;&#x7528;&#x4E8E;&#x975E;&#x6807;&#x51C6;&#x6216;&#x4E0D;&#x5E38;&#x7528;&#x7684;&#x524D;&#x7F00;&#xFF1A;</span></p><div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">select</span><span class="p">([</span><span class="n">mytable</span><span class="p">])</span><span class="o">.</span><span class="n">prefix_with</span><span class="p">(</span><span class="s1">&apos;HIGH_PRIORITY&apos;</span><span class="p">,</span> <span class="s1">&apos;ALL&apos;</span><span class="p">)</span></pre></div></div></div><div class="section" id="useexisting-superseded-by-extend-existing-and-keep-existing"><h3><span class="yiyi-st" id="yiyi-437"><code class="docutils literal"><span class="pre">useexisting</span></code>&#x53D6;&#x4EE3;<code class="docutils literal"><span class="pre">extend_existing</span></code>&#x548C;<code class="docutils literal"><span class="pre">keep_existing</span></code> <a class="headerlink" href="#useexisting-superseded-by-extend-existing-and-keep-existing" title="Permalink to this headline">&#xB6;</a></span></h3><p><span class="yiyi-st" id="yiyi-438">&#x8868;&#x4E2D;&#x7684;<code class="docutils literal"><span class="pre">useexisting</span></code>&#x6807;&#x5FD7;&#x5DF2;&#x88AB;&#x4E00;&#x5BF9;&#x65B0;&#x7684;&#x6807;&#x5FD7;<code class="docutils literal"><span class="pre">keep_existing</span></code>&#x548C;<code class="docutils literal"><span class="pre">extend_existing</span></code>&#x6240;&#x53D6;&#x4EE3;&#x3002;</span><span class="yiyi-st" id="yiyi-439"><code class="docutils literal"><span class="pre">extend_existing</span></code>&#x76F8;&#x5F53;&#x4E8E;<code class="docutils literal"><span class="pre">useexisting</span></code>  - &#x8FD4;&#x56DE;&#x73B0;&#x6709;&#x7684;&#x8868;&#xFF0C;&#x5E76;&#x6DFB;&#x52A0;&#x5176;&#x4ED6;&#x6784;&#x9020;&#x51FD;&#x6570;&#x5143;&#x7D20;&#x3002;</span><span class="yiyi-st" id="yiyi-440">&#x4F7F;&#x7528;<code class="docutils literal"><span class="pre">keep_existing</span></code>&#xFF0C;&#x5C06;&#x8FD4;&#x56DE;&#x73B0;&#x6709;&#x8868;&#x683C;&#xFF0C;&#x4F46;&#x4E0D;&#x4F1A;&#x6DFB;&#x52A0;&#x5176;&#x4ED6;&#x6784;&#x9020;&#x51FD;&#x6570;&#x5143;&#x7D20; - &#x4EC5;&#x5728;&#x65B0;&#x521B;&#x5EFA;&#x8868;&#x683C;&#x65F6;&#x5E94;&#x7528;&#x8FD9;&#x4E9B;&#x5143;&#x7D20;&#x3002;</span></p></div></div><div class="section" id="backwards-incompatible-api-changes"><h2><span class="yiyi-st" id="yiyi-441">&#x5411;&#x540E;&#x4E0D;&#x517C;&#x5BB9;&#x7684;API&#x66F4;&#x6539;<a class="headerlink" href="#backwards-incompatible-api-changes" title="Permalink to this headline">&#xB6;</a></span></h2><div class="section" id="callables-passed-to-bindparam-don-t-get-evaluated-affects-the-beaker-example"><h3><span class="yiyi-st" id="yiyi-442">&#x4F20;&#x9012;&#x7ED9;<code class="docutils literal"><span class="pre">bindparam()</span></code>&#x7684;&#x53EF;&#x52A0;&#x5BC6;&#x6807;&#x7B7E;&#x4E0D;&#x4F1A;&#x88AB;&#x8BC4;&#x4F30; - &#x5F71;&#x54CD;Beaker&#x793A;&#x4F8B;<a class="headerlink" href="#callables-passed-to-bindparam-don-t-get-evaluated-affects-the-beaker-example" title="Permalink to this headline">&#xB6;</a></span></h3><p><span class="yiyi-st" id="yiyi-443"><a class="reference external" href="http://www.sqlalchemy.org/trac/ticket/1950">&#xFF03;1950  T0&gt;</a></span></p><p><span class="yiyi-st" id="yiyi-444">&#x8BF7;&#x6CE8;&#x610F;&#xFF0C;&#x8FD9;&#x4F1A;&#x5F71;&#x54CD;Beaker&#x7F13;&#x5B58;&#x793A;&#x4F8B;&#xFF0C;&#x5176;&#x4E2D;<code class="docutils literal"><span class="pre">_params_from_query()</span></code>&#x51FD;&#x6570;&#x7684;&#x5DE5;&#x4F5C;&#x9700;&#x8981;&#x7A0D;&#x4F5C;&#x8C03;&#x6574;&#x3002;</span><span class="yiyi-st" id="yiyi-445">&#x5982;&#x679C;&#x60A8;&#x4F7F;&#x7528;Beaker&#x793A;&#x4F8B;&#x4E2D;&#x7684;&#x4EE3;&#x7801;&#xFF0C;&#x5219;&#x5E94;&#x8BE5;&#x5E94;&#x7528;&#x6B64;&#x66F4;&#x6539;&#x3002;</span></p></div><div class="section" id="types-type-map-is-now-private-types-type-map"><h3><span class="yiyi-st" id="yiyi-446">types.type_map&#x73B0;&#x5728;&#x662F;private&#xFF0C;types._type_map <a class="headerlink" href="#types-type-map-is-now-private-types-type-map" title="Permalink to this headline">&#xB6;</a></span></h3><p><span class="yiyi-st" id="yiyi-447">&#x6211;&#x4EEC;&#x6CE8;&#x610F;&#x5230;&#x4E00;&#x4E9B;&#x7528;&#x6237;&#x4F7F;&#x7528;<code class="docutils literal"><span class="pre">sqlalchemy.types</span></code>&#x4E2D;&#x7684;&#x8FD9;&#x4E2A;&#x5B57;&#x5178;&#x4F5C;&#x4E3A;&#x5C06;Python&#x7C7B;&#x578B;&#x4E0E;SQL&#x7C7B;&#x578B;&#x5173;&#x8054;&#x7684;&#x5FEB;&#x6377;&#x65B9;&#x5F0F;&#x3002;</span><span class="yiyi-st" id="yiyi-448">&#x6211;&#x4EEC;&#x65E0;&#x6CD5;&#x4FDD;&#x8BC1;&#x6B64;&#x5B57;&#x5178;&#x7684;&#x5185;&#x5BB9;&#x6216;&#x683C;&#x5F0F;&#xFF0C;&#x53E6;&#x5916;&#xFF0C;&#x4EE5;&#x4E00;&#x5BF9;&#x4E00;&#x7684;&#x65B9;&#x5F0F;&#x5173;&#x8054;Python&#x7C7B;&#x578B;&#x7684;&#x4E1A;&#x52A1;&#x6709;&#x4E00;&#x4E9B;&#x7070;&#x8272;&#x533A;&#x57DF;&#xFF0C;&#x5E94;&#x7531;&#x5404;&#x4E2A;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x6700;&#x597D;&#x51B3;&#x5B9A;&#xFF0C;&#x56E0;&#x6B64;&#x6211;&#x4EEC;&#x5F3A;&#x8C03;&#x4E86;&#x6B64;&#x5C5E;&#x6027;&#x3002;</span></p><p><span class="yiyi-st" id="yiyi-449"><a class="reference external" href="http://www.sqlalchemy.org/trac/ticket/1870">&#xFF03;1870  T0&gt;</a></span></p></div><div class="section" id="renamed-the-alias-keyword-arg-of-standalone-alias-function-to-name"><h3><span class="yiyi-st" id="yiyi-450">&#x5C06;&#x72EC;&#x7ACB;<code class="docutils literal"><span class="pre">alias()</span></code>&#x51FD;&#x6570;&#x7684;<code class="docutils literal"><span class="pre">alias</span></code>&#x5173;&#x952E;&#x5B57;arg&#x91CD;&#x547D;&#x540D;&#x4E3A;<code class="docutils literal"><span class="pre">name</span></code> <a class="headerlink" href="#renamed-the-alias-keyword-arg-of-standalone-alias-function-to-name" title="Permalink to this headline">&#xB6;</a></span></h3><p><span class="yiyi-st" id="yiyi-451">This so that the keyword argument <code class="docutils literal"><span class="pre">name</span></code> matches that of the <code class="docutils literal"><span class="pre">alias()</span></code> methods on all <code class="docutils literal"><span class="pre">FromClause</span></code> objects as well as the <code class="docutils literal"><span class="pre">name</span></code> argument on <code class="docutils literal"><span class="pre">Query.subquery()</span></code>.</span></p><p><span class="yiyi-st" id="yiyi-452">&#x53EA;&#x6709;&#x4F7F;&#x7528;&#x72EC;&#x7ACB;<code class="docutils literal"><span class="pre">alias()</span></code>&#x51FD;&#x6570;&#x800C;&#x4E0D;&#x662F;&#x65B9;&#x6CD5;&#x7ED1;&#x5B9A;&#x51FD;&#x6570;&#x5E76;&#x4F7F;&#x7528;&#x663E;&#x5F0F;&#x5173;&#x952E;&#x5B57;&#x540D;&#x79F0;<code class="docutils literal"><span class="pre">alias</span></code>&#x4F20;&#x9012;&#x522B;&#x540D;&#x7684;&#x4EE3;&#x7801;&#x624D;&#x4F1A;&#x9700;&#x8981;&#x8FD9;&#x91CC;&#x4FEE;&#x6539;&#x3002;</span></p></div><div class="section" id="non-public-pool-methods-underscored"><h3><span class="yiyi-st" id="yiyi-453">&#x975E;&#x516C;&#x5F00;&#x7684;<code class="docutils literal"><span class="pre">Pool</span></code>&#x65B9;&#x6CD5;&#x5F3A;&#x8C03;<a class="headerlink" href="#non-public-pool-methods-underscored" title="Permalink to this headline">&#xB6;</a></span></h3><p><span class="yiyi-st" id="yiyi-454">&#x6240;&#x6709;&#x4E0D;&#x9002;&#x5408;&#x516C;&#x5F00;&#x4F7F;&#x7528;&#x7684;<code class="docutils literal"><span class="pre">Pool</span></code>&#x548C;&#x5B50;&#x7C7B;&#x7684;&#x65B9;&#x6CD5;&#x90FD;&#x5DF2;&#x7528;&#x4E0B;&#x5212;&#x7EBF;&#x91CD;&#x65B0;&#x547D;&#x540D;&#x3002;</span><span class="yiyi-st" id="yiyi-455">&#x4ED6;&#x4EEC;&#x4EE5;&#x524D;&#x6CA1;&#x6709;&#x8FD9;&#x6837;&#x547D;&#x540D;&#x662F;&#x4E00;&#x4E2A;&#x9519;&#x8BEF;&#x3002;</span></p><p><span class="yiyi-st" id="yiyi-456">&#x73B0;&#x5728;&#x5F3A;&#x8C03;&#x6216;&#x5220;&#x9664;&#x4E86;&#x5408;&#x5E76;&#x65B9;&#x6CD5;&#xFF1A;</span></p><p><span class="yiyi-st" id="yiyi-457"><code class="docutils literal"><span class="pre">Pool.create_connection()</span></code>  - &gt; <code class="docutils literal"><span class="pre">Pool._create_connection()</span></code></span></p><p><span class="yiyi-st" id="yiyi-458"><code class="docutils literal"><span class="pre">Pool.do_get()</span></code>  - &gt; <code class="docutils literal"><span class="pre">Pool._do_get()</span></code></span></p><p><span class="yiyi-st" id="yiyi-459"><code class="docutils literal"><span class="pre">Pool.do_return_conn()</span></code>  - &gt; <code class="docutils literal"><span class="pre">Pool._do_return_conn()</span></code></span></p><p><span class="yiyi-st" id="yiyi-460"><code class="docutils literal"><span class="pre">Pool.do_return_invalid()</span></code>  - &gt;&#x5DF2;&#x5220;&#x9664;&#xFF0C;&#x672A;&#x4F7F;&#x7528;</span></p><p><span class="yiyi-st" id="yiyi-461"><code class="docutils literal"><span class="pre">Pool.return_conn()</span></code>  - &gt; <code class="docutils literal"><span class="pre">Pool._return_conn()</span></code></span></p><p><span class="yiyi-st" id="yiyi-462"><code class="docutils literal"><span class="pre">Pool.get()</span></code>  - &gt; <code class="docutils literal"><span class="pre">Pool._get()</span></code>&#xFF0C;&#x516C;&#x5171;API&#x4E3A;<code class="docutils literal"><span class="pre">Pool.connect()</span></code></span></p><p><span class="yiyi-st" id="yiyi-463"><code class="docutils literal"><span class="pre">SingletonThreadPool.cleanup()</span></code>  - &gt; <code class="docutils literal"><span class="pre">_cleanup()</span></code></span></p><p><span class="yiyi-st" id="yiyi-464"><code class="docutils literal"><span class="pre">SingletonThreadPool.dispose_local()</span></code>  - &gt;&#x5DF2;&#x79FB;&#x9664;&#xFF0C;&#x8BF7;&#x4F7F;&#x7528;<code class="docutils literal"><span class="pre">conn.invalidate()</span></code></span></p><p><span class="yiyi-st" id="yiyi-465"><a class="reference external" href="http://www.sqlalchemy.org/trac/ticket/1982">&#xFF03;1982  T0&gt;</a></span></p></div></div><div class="section" id="previously-deprecated-now-removed"><h2><span class="yiyi-st" id="yiyi-466">&#x5148;&#x524D;&#x5DF2;&#x5F03;&#x7528;&#xFF0C;&#x73B0;&#x5DF2;&#x5220;&#x9664;<a class="headerlink" href="#previously-deprecated-now-removed" title="Permalink to this headline">&#xB6;</a></span></h2><div class="section" id="query-join-query-outerjoin-eagerload-eagerload-all-others-no-longer-allow-lists-of-attributes-as-arguments"><h3><span class="yiyi-st" id="yiyi-467">Query.join()&#xFF0C;Query.outerjoin()&#xFF0C;eagerload()&#xFF0C;eagerload_all()&#x7B49;&#x4E0D;&#x518D;&#x5141;&#x8BB8;&#x5C5E;&#x6027;&#x5217;&#x8868;&#x4F5C;&#x4E3A;&#x53C2;&#x6570;<a class="headerlink" href="#query-join-query-outerjoin-eagerload-eagerload-all-others-no-longer-allow-lists-of-attributes-as-arguments" title="Permalink to this headline">&#xB6;</a></span></h3><p><span class="yiyi-st" id="yiyi-468">&#x5C06;&#x5C5E;&#x6027;&#x6216;&#x5C5E;&#x6027;&#x540D;&#x79F0;&#x7684;&#x5217;&#x8868;&#x4F20;&#x9012;&#x7ED9;<code class="docutils literal"><span class="pre">Query.join</span></code>&#xFF0C;<code class="docutils literal"><span class="pre">eagerload()</span></code></span></p><div class="highlight-python"><div class="highlight"><pre><span></span><span class="c1"># old way, deprecated since 0.5</span>
<span class="n">session</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">Houses</span><span class="p">)</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">Houses</span><span class="o">.</span><span class="n">rooms</span><span class="p">,</span> <span class="n">Room</span><span class="o">.</span><span class="n">closets</span><span class="p">])</span>
<span class="n">session</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">Houses</span><span class="p">)</span><span class="o">.</span><span class="n">options</span><span class="p">(</span><span class="n">eagerload_all</span><span class="p">([</span><span class="n">Houses</span><span class="o">.</span><span class="n">rooms</span><span class="p">,</span> <span class="n">Room</span><span class="o">.</span><span class="n">closets</span><span class="p">]))</span></pre></div></div><p><span class="yiyi-st" id="yiyi-469">&#x8FD9;&#x4E9B;&#x65B9;&#x6CD5;&#x90FD;&#x53EF;&#x4EE5;&#x63A5;&#x53D7;0.5&#x7CFB;&#x5217;&#x7684;*&#x53C2;&#x6570;&#xFF1A;</span></p><div class="highlight-python"><div class="highlight"><pre><span></span><span class="c1"># current way, in place since 0.5</span>
<span class="n">session</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">Houses</span><span class="p">)</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">Houses</span><span class="o">.</span><span class="n">rooms</span><span class="p">,</span> <span class="n">Room</span><span class="o">.</span><span class="n">closets</span><span class="p">)</span>
<span class="n">session</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">Houses</span><span class="p">)</span><span class="o">.</span><span class="n">options</span><span class="p">(</span><span class="n">eagerload_all</span><span class="p">(</span><span class="n">Houses</span><span class="o">.</span><span class="n">rooms</span><span class="p">,</span> <span class="n">Room</span><span class="o">.</span><span class="n">closets</span><span class="p">))</span></pre></div></div></div><div class="section" id="scopedsession-mapper-is-removed"><h3><span class="yiyi-st" id="yiyi-470"><code class="docutils literal"><span class="pre">ScopedSession.mapper</span></code>&#x88AB;&#x5220;&#x9664;<a class="headerlink" href="#scopedsession-mapper-is-removed" title="Permalink to this headline">&#xB6;</a></span></h3><p><span class="yiyi-st" id="yiyi-471">&#x6B64;&#x529F;&#x80FD;&#x63D0;&#x4F9B;&#x4E86;&#x4E00;&#x4E2A;&#x6620;&#x5C04;&#x5668;&#x6269;&#x5C55;&#xFF0C;&#x5B83;&#x5C06;&#x57FA;&#x4E8E;&#x7C7B;&#x7684;&#x529F;&#x80FD;&#x4E0E;&#x7279;&#x5B9A;&#x7684;<code class="docutils literal"><span class="pre">ScopedSession</span></code>&#x76F8;&#x94FE;&#x63A5;&#xFF0C;&#x7279;&#x522B;&#x662F;&#x63D0;&#x4F9B;&#x4E86;&#x65B0;&#x5BF9;&#x8C61;&#x5B9E;&#x4F8B;&#x5C06;&#x81EA;&#x52A8;&#x4E0E;&#x8BE5;&#x4F1A;&#x8BDD;&#x5173;&#x8054;&#x7684;&#x884C;&#x4E3A;&#x3002;</span><span class="yiyi-st" id="yiyi-472">&#x8BE5;&#x529F;&#x80FD;&#x88AB;&#x6559;&#x7A0B;&#x548C;&#x6846;&#x67B6;&#x8FC7;&#x5EA6;&#x4F7F;&#x7528;&#xFF0C;&#x7531;&#x4E8E;&#x5176;&#x9690;&#x542B;&#x7684;&#x884C;&#x4E3A;&#x5BFC;&#x81F4;&#x7528;&#x6237;&#x5F88;&#x5927;&#x7684;&#x56F0;&#x60D1;&#xFF0C;&#x5E76;&#x5728;0.5.5&#x4E2D;&#x88AB;&#x5F03;&#x7528;&#x3002;</span><span class="yiyi-st" id="yiyi-473">&#x590D;&#x5236;&#x5176;&#x529F;&#x80FD;&#x7684;&#x6280;&#x672F;&#x5728;[wiki&#xFF1A;UsageRecipes / SessionAwareMapper]</span></p></div></div>