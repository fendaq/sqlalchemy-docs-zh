<h1><span class="yiyi-st" id="yiyi-54">&#x6536;&#x96C6;&#x914D;&#x7F6E;&#x548C;&#x6280;&#x672F;<a class="headerlink" href="#collection-configuration-and-techniques" title="Permalink to this headline">&#xB6;</a></span></h1><p><span class="yiyi-st" id="yiyi-55"><a class="reference internal" href="relationship_api.html#sqlalchemy.orm.relationship" title="sqlalchemy.orm.relationship"><code class="xref py py-func docutils literal"><span class="pre">relationship()</span></code></a>&#x51FD;&#x6570;&#x5B9A;&#x4E49;&#x4E24;&#x4E2A;&#x7C7B;&#x4E4B;&#x95F4;&#x7684;&#x94FE;&#x63A5;&#x3002;</span><span class="yiyi-st" id="yiyi-56">&#x5F53;&#x94FE;&#x63A5;&#x5B9A;&#x4E49;&#x4E86;&#x4E00;&#x5BF9;&#x591A;&#x6216;&#x591A;&#x5BF9;&#x591A;&#x7684;&#x5173;&#x7CFB;&#x65F6;&#xFF0C;&#x5F53;&#x5BF9;&#x8C61;&#x88AB;&#x52A0;&#x8F7D;&#x548C;&#x64CD;&#x4F5C;&#x65F6;&#xFF0C;&#x5B83;&#x88AB;&#x8868;&#x793A;&#x4E3A;&#x4E00;&#x4E2A;Python&#x96C6;&#x5408;&#x3002;</span><span class="yiyi-st" id="yiyi-57">&#x672C;&#x8282;&#x4ECB;&#x7ECD;&#x6709;&#x5173;&#x6536;&#x96C6;&#x914D;&#x7F6E;&#x548C;&#x6280;&#x672F;&#x7684;&#x5176;&#x4ED6;&#x4FE1;&#x606F;&#x3002;</span></p><div class="section" id="working-with-large-collections"><h2><span class="yiyi-st" id="yiyi-58">&#x4F7F;&#x7528;&#x5927;&#x96C6;&#x5408;<a class="headerlink" href="#working-with-large-collections" title="Permalink to this headline">&#xB6;</a></span></h2><p><span class="yiyi-st" id="yiyi-59">&#x6839;&#x636E;&#x5173;&#x7CFB;&#x7684;&#x52A0;&#x8F7D;&#x7B56;&#x7565;&#xFF0C;<a class="reference internal" href="relationship_api.html#sqlalchemy.orm.relationship" title="sqlalchemy.orm.relationship"><code class="xref py py-func docutils literal"><span class="pre">relationship()</span></code></a>&#x7684;&#x9ED8;&#x8BA4;&#x884C;&#x4E3A;&#x662F;&#x5B8C;&#x5168;&#x52A0;&#x8F7D;&#x9879;&#x76EE;&#x96C6;&#x5408;&#x3002;</span><span class="yiyi-st" id="yiyi-60">&#x53E6;&#x5916;&#xFF0C;&#x9ED8;&#x8BA4;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;<a class="reference internal" href="session_api.html#sqlalchemy.orm.session.Session" title="sqlalchemy.orm.session.Session"><code class="xref py py-class docutils literal"><span class="pre">Session</span></code></a>&#x53EA;&#x77E5;&#x9053;&#x5982;&#x4F55;&#x5220;&#x9664;&#x4F1A;&#x8BDD;&#x4E2D;&#x5B9E;&#x9645;&#x5B58;&#x5728;&#x7684;&#x5BF9;&#x8C61;&#x3002;</span><span class="yiyi-st" id="yiyi-61">&#x5F53;&#x4E00;&#x4E2A;&#x7236;&#x5B9E;&#x4F8B;&#x88AB;&#x6807;&#x8BB0;&#x4E3A;&#x5220;&#x9664;&#x548C;&#x5237;&#x65B0;&#x65F6;&#xFF0C;<a class="reference internal" href="session_api.html#sqlalchemy.orm.session.Session" title="sqlalchemy.orm.session.Session"><code class="xref py py-class docutils literal"><span class="pre">Session</span></code></a>&#x52A0;&#x8F7D;&#x5176;&#x5B50;&#x9879;&#x7684;&#x5B8C;&#x6574;&#x5217;&#x8868;&#xFF0C;&#x4EE5;&#x4FBF;&#x5B83;&#x4EEC;&#x53EF;&#x4EE5;&#x88AB;&#x5220;&#x9664;&#xFF0C;&#x6216;&#x8005;&#x5C06;&#x5176;&#x5916;&#x952E;&#x503C;&#x8BBE;&#x7F6E;&#x4E3A;&#x7A7A;&#xFF1B;&#x8FD9;&#x662F;&#x4E3A;&#x4E86;&#x907F;&#x514D;&#x8FDD;&#x53CD;&#x7EA6;&#x675F;&#x3002;</span><span class="yiyi-st" id="yiyi-62">&#x5BF9;&#x4E8E;&#x5927;&#x91CF;&#x5B50;&#x9879;&#x76EE;&#xFF0C;&#x6709;&#x51E0;&#x79CD;&#x7B56;&#x7565;&#x53EF;&#x4EE5;&#x5728;&#x52A0;&#x8F7D;&#x65F6;&#x95F4;&#x548C;&#x5220;&#x9664;&#x65F6;&#x95F4;&#x5185;&#x7ED5;&#x8FC7;&#x5B50;&#x9879;&#x76EE;&#x7684;&#x5168;&#x90E8;&#x52A0;&#x8F7D;&#x3002;</span></p><div class="section" id="dynamic-relationship-loaders"><h3><span class="yiyi-st" id="yiyi-63">&#x52A8;&#x6001;&#x5173;&#x7CFB;&#x52A0;&#x8F7D;&#x5668;<a class="headerlink" href="#dynamic-relationship-loaders" title="Permalink to this headline">&#xB6;</a></span></h3><p><span class="yiyi-st" id="yiyi-64">&#x5B9E;&#x73B0;&#x5927;&#x578B;&#x96C6;&#x5408;&#x7BA1;&#x7406;&#x7684;&#x5173;&#x952E;&#x7279;&#x5F81;&#x662F;&#x6240;&#x8C13;&#x7684;&#x201C;&#x52A8;&#x6001;&#x201D;&#x5173;&#x7CFB;&#x3002;</span><span class="yiyi-st" id="yiyi-65">&#x8FD9;&#x662F;<a class="reference internal" href="relationship_api.html#sqlalchemy.orm.relationship" title="sqlalchemy.orm.relationship"><code class="xref py py-func docutils literal"><span class="pre">relationship()</span></code></a>&#x7684;&#x4E00;&#x79CD;&#x53EF;&#x9009;&#x5F62;&#x5F0F;&#xFF0C;&#x5B83;&#x5728;&#x8BBF;&#x95EE;&#x65F6;&#x8FD4;&#x56DE;&#x4E00;&#x4E2A;<a class="reference internal" href="query.html#sqlalchemy.orm.query.Query" title="sqlalchemy.orm.query.Query"><code class="xref py py-class docutils literal"><span class="pre">Query</span></code></a>&#x5BF9;&#x8C61;&#x6765;&#x4EE3;&#x66FF;&#x96C6;&#x5408;&#x3002;</span><span class="yiyi-st" id="yiyi-66"><a class="reference internal" href="query.html#sqlalchemy.orm.query.Query.filter" title="sqlalchemy.orm.query.Query.filter"><code class="xref py py-func docutils literal"><span class="pre">filter()</span></code></a> criterion may be applied as well as limits and offsets, either explicitly or via array slices:</span></p><div class="highlight-python"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">User</span><span class="p">(</span><span class="n">Base</span><span class="p">):</span>
    <span class="n">__tablename__</span> <span class="o">=</span> <span class="s1">&apos;user&apos;</span>

    <span class="n">posts</span> <span class="o">=</span> <span class="n">relationship</span><span class="p">(</span><span class="n">Post</span><span class="p">,</span> <span class="n">lazy</span><span class="o">=</span><span class="s2">&quot;dynamic&quot;</span><span class="p">)</span>

<span class="n">jack</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">User</span><span class="p">)</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="nb">id</span><span class="p">)</span>

<span class="c1"># filter Jack&apos;s blog posts</span>
<span class="n">posts</span> <span class="o">=</span> <span class="n">jack</span><span class="o">.</span><span class="n">posts</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">Post</span><span class="o">.</span><span class="n">headline</span><span class="o">==</span><span class="s1">&apos;this is a post&apos;</span><span class="p">)</span>

<span class="c1"># apply array slices</span>
<span class="n">posts</span> <span class="o">=</span> <span class="n">jack</span><span class="o">.</span><span class="n">posts</span><span class="p">[</span><span class="mi">5</span><span class="p">:</span><span class="mi">20</span><span class="p">]</span></pre></div></div><p><span class="yiyi-st" id="yiyi-67">&#x52A8;&#x6001;&#x5173;&#x7CFB;&#x901A;&#x8FC7;<code class="docutils literal"><span class="pre">append()</span></code>&#x548C;<code class="docutils literal"><span class="pre">remove()</span></code>&#x65B9;&#x6CD5;&#x652F;&#x6301;&#x6709;&#x9650;&#x7684;&#x5199;&#x5165;&#x64CD;&#x4F5C;&#xFF1A;</span></p><div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">oldpost</span> <span class="o">=</span> <span class="n">jack</span><span class="o">.</span><span class="n">posts</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">Post</span><span class="o">.</span><span class="n">headline</span><span class="o">==</span><span class="s1">&apos;old post&apos;</span><span class="p">)</span><span class="o">.</span><span class="n">one</span><span class="p">()</span>
<span class="n">jack</span><span class="o">.</span><span class="n">posts</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">oldpost</span><span class="p">)</span>

<span class="n">jack</span><span class="o">.</span><span class="n">posts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Post</span><span class="p">(</span><span class="s1">&apos;new post&apos;</span><span class="p">))</span></pre></div></div><p><span class="yiyi-st" id="yiyi-68">&#x7531;&#x4E8E;&#x52A8;&#x6001;&#x5173;&#x7CFB;&#x7684;&#x8BFB;&#x53D6;&#x7AEF;&#x603B;&#x662F;&#x67E5;&#x8BE2;&#x6570;&#x636E;&#x5E93;&#xFF0C;&#x56E0;&#x6B64;&#x5728;&#x5BF9;&#x6570;&#x636E;&#x8FDB;&#x884C;&#x5237;&#x65B0;&#x4E4B;&#x524D;&#xFF0C;&#x5BF9;&#x57FA;&#x7840;&#x96C6;&#x5408;&#x7684;&#x66F4;&#x6539;&#x5C06;&#x4E0D;&#x53EF;&#x89C1;&#x3002;</span><span class="yiyi-st" id="yiyi-69">&#x4F46;&#x662F;&#xFF0C;&#x53EA;&#x8981;&#x5728;&#x4F7F;&#x7528;&#x4E2D;&#x7684;<a class="reference internal" href="session_api.html#sqlalchemy.orm.session.Session" title="sqlalchemy.orm.session.Session"><code class="xref py py-class docutils literal"><span class="pre">Session</span></code></a>&#x4E0A;&#x542F;&#x7528;&#x4E86;&#x201C;autoflush&#x201D;&#xFF0C;&#x6BCF;&#x6B21;&#x96C6;&#x5408;&#x5373;&#x5C06;&#x53D1;&#x51FA;&#x67E5;&#x8BE2;&#x65F6;&#x90FD;&#x4F1A;&#x81EA;&#x52A8;&#x53D1;&#x751F;&#x3002;</span></p><p><span class="yiyi-st" id="yiyi-70">&#x8981;&#x5728;&#x540E;&#x7AEF;&#x53C2;&#x8003;&#x4E0A;&#x653E;&#x7F6E;&#x4E00;&#x4E2A;&#x52A8;&#x6001;&#x5173;&#x7CFB;&#xFF0C;&#x8BF7;&#x5C06;<a class="reference internal" href="relationship_api.html#sqlalchemy.orm.backref" title="sqlalchemy.orm.backref"><code class="xref py py-func docutils literal"><span class="pre">backref()</span></code></a>&#x51FD;&#x6570;&#x4E0E;<code class="docutils literal"><span class="pre">lazy=&apos;dynamic&apos;</span></code>&#x7ED3;&#x5408;&#x4F7F;&#x7528;&#xFF1A;</span></p><div class="highlight-python"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">Post</span><span class="p">(</span><span class="n">Base</span><span class="p">):</span>
    <span class="n">__table__</span> <span class="o">=</span> <span class="n">posts_table</span>

    <span class="n">user</span> <span class="o">=</span> <span class="n">relationship</span><span class="p">(</span><span class="n">User</span><span class="p">,</span>
                <span class="n">backref</span><span class="o">=</span><span class="n">backref</span><span class="p">(</span><span class="s1">&apos;posts&apos;</span><span class="p">,</span> <span class="n">lazy</span><span class="o">=</span><span class="s1">&apos;dynamic&apos;</span><span class="p">)</span>
            <span class="p">)</span></pre></div></div><p><span class="yiyi-st" id="yiyi-71">&#x8BF7;&#x6CE8;&#x610F;&#xFF0C;&#x6B64;&#x65F6;&#xFF0C;&#x65E0;&#x6CD5;&#x5C06;&#x52A8;&#x6001;/&#x5EF6;&#x8FDF;&#x52A0;&#x8F7D;&#x9009;&#x9879;&#x4E0E;&#x52A8;&#x6001;&#x5173;&#x7CFB;&#x7ED3;&#x5408;&#x4F7F;&#x7528;&#x3002;</span></p><div class="admonition note"><p class="first admonition-title"><span class="yiyi-st" id="yiyi-72">&#x6CE8;&#x610F;</span></p><p class="last"><span class="yiyi-st" id="yiyi-73"><a class="reference internal" href="relationship_api.html#sqlalchemy.orm.dynamic_loader" title="sqlalchemy.orm.dynamic_loader"><code class="xref py py-func docutils literal"><span class="pre">dynamic_loader()</span></code></a>&#x51FD;&#x6570;&#x4E0E;&#x6307;&#x5B9A;<code class="docutils literal"><span class="pre">lazy=&apos;dynamic&apos;</span></code>&#x53C2;&#x6570;&#x65F6;&#x7684;<a class="reference internal" href="relationship_api.html#sqlalchemy.orm.relationship" title="sqlalchemy.orm.relationship"><code class="xref py py-func docutils literal"><span class="pre">relationship()</span></code></a>&#x57FA;&#x672C;&#x76F8;&#x540C;&#x3002;</span></p></div><div class="admonition warning"><p class="first admonition-title"><span class="yiyi-st" id="yiyi-74">&#x8B66;&#x544A;</span></p><p class="last"><span class="yiyi-st" id="yiyi-75">&#x201C;&#x52A8;&#x6001;&#x201D;&#x52A0;&#x8F7D;&#x5668;&#x4EC5;&#x9002;&#x7528;&#x4E8E;<strong>&#x96C6;&#x5408;</strong>&#x3002;</span><span class="yiyi-st" id="yiyi-76">&#x4F7F;&#x7528;&#x5177;&#x6709;&#x591A;&#x5BF9;&#x4E00;&#xFF0C;&#x4E00;&#x5BF9;&#x4E00;&#x6216;uselist = False&#x5173;&#x7CFB;&#x7684;&#x201C;&#x52A8;&#x6001;&#x201D;&#x52A0;&#x8F7D;&#x5668;&#x662F;&#x65E0;&#x6548;&#x7684;&#x3002;</span><span class="yiyi-st" id="yiyi-77">&#x5728;&#x8FD9;&#x4E9B;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;&#x8F83;&#x65B0;&#x7248;&#x672C;&#x7684;SQLAlchemy&#x4F1A;&#x53D1;&#x51FA;&#x8B66;&#x544A;&#x6216;&#x5F02;&#x5E38;&#x3002;</span></p></div></div><div class="section" id="setting-noload-raiseload"><h3><span class="yiyi-st" id="yiyi-78">&#x8BBE;&#x7F6E;Noload&#xFF0C;RaiseLoad <a class="headerlink" href="#setting-noload-raiseload" title="Permalink to this headline">&#xB6;</a></span></h3><p><span class="yiyi-st" id="yiyi-79">&#x5373;&#x4F7F;&#x8BBF;&#x95EE;&#xFF0C;&#x201C;noload&#x201D;&#x5173;&#x7CFB;&#x4E5F;&#x4E0D;&#x4F1A;&#x4ECE;&#x6570;&#x636E;&#x5E93;&#x52A0;&#x8F7D;&#x3002;</span><span class="yiyi-st" id="yiyi-80">&#x5B83;&#x4F7F;&#x7528;<code class="docutils literal"><span class="pre">lazy=&apos;noload&apos;</span></code>&#x914D;&#x7F6E;&#xFF1A;</span></p><div class="highlight-python"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">MyClass</span><span class="p">(</span><span class="n">Base</span><span class="p">):</span>
    <span class="n">__tablename__</span> <span class="o">=</span> <span class="s1">&apos;some_table&apos;</span>

    <span class="n">children</span> <span class="o">=</span> <span class="n">relationship</span><span class="p">(</span><span class="n">MyOtherClass</span><span class="p">,</span> <span class="n">lazy</span><span class="o">=</span><span class="s1">&apos;noload&apos;</span><span class="p">)</span></pre></div></div><p><span class="yiyi-st" id="yiyi-81">&#x5728;&#x4E0A;&#x9762;&#xFF0C;<code class="docutils literal"><span class="pre">children</span></code>&#x96C6;&#x5408;&#x662F;&#x5B8C;&#x5168;&#x53EF;&#x5199;&#x7684;&#xFF0C;&#x5E76;&#x4E14;&#x5BF9;&#x5B83;&#x7684;&#x66F4;&#x6539;&#x5C06;&#x88AB;&#x6301;&#x4E45;&#x4FDD;&#x5B58;&#x5230;&#x6570;&#x636E;&#x5E93;&#x4EE5;&#x53CA;&#x672C;&#x5730;&#x53EF;&#x7528;&#x4E8E;&#x5728;&#x6DFB;&#x52A0;&#x65F6;&#x8BFB;&#x53D6;&#x3002;</span><span class="yiyi-st" id="yiyi-82">&#x4F46;&#x662F;&#xFF0C;&#x5F53;<code class="docutils literal"><span class="pre">MyClass</span></code>&#x5B9E;&#x4F8B;&#x521A;&#x4ECE;&#x6570;&#x636E;&#x5E93;&#x52A0;&#x8F7D;&#x65F6;&#xFF0C;<code class="docutils literal"><span class="pre">children</span></code>&#x96C6;&#x5408;&#x4FDD;&#x6301;&#x4E3A;&#x7A7A;&#x3002;</span><span class="yiyi-st" id="yiyi-83">noload&#x7B56;&#x7565;&#x4E5F;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;<a class="reference internal" href="loading_relationships.html#sqlalchemy.orm.noload" title="sqlalchemy.orm.noload"><code class="xref py py-func docutils literal"><span class="pre">orm.noload()</span></code></a>&#x52A0;&#x8F7D;&#x7A0B;&#x5E8F;&#x9009;&#x9879;&#x4EE5;&#x67E5;&#x8BE2;&#x9009;&#x9879;&#x4E3A;&#x57FA;&#x7840;&#x3002;</span></p><p><span class="yiyi-st" id="yiyi-84">&#x6216;&#x8005;&#xFF0C;&#x201C;&#x52A0;&#x8F7D;&#x201D;&#x52A0;&#x8F7D;&#x5173;&#x7CFB;&#x4F1A;&#x5F15;&#x53D1;&#x4E00;&#x4E2A;<a class="reference internal" href="core_exceptions.html#sqlalchemy.exc.InvalidRequestError" title="sqlalchemy.exc.InvalidRequestError"><code class="xref py py-exc docutils literal"><span class="pre">InvalidRequestError</span></code></a>&#xFF0C;&#x5176;&#x4E2D;&#x5C5E;&#x6027;&#x901A;&#x5E38;&#x4F1A;&#x53D1;&#x51FA;&#x5EF6;&#x8FDF;&#x52A0;&#x8F7D;&#xFF1A;</span></p><div class="highlight-python"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">MyClass</span><span class="p">(</span><span class="n">Base</span><span class="p">):</span>
    <span class="n">__tablename__</span> <span class="o">=</span> <span class="s1">&apos;some_table&apos;</span>

    <span class="n">children</span> <span class="o">=</span> <span class="n">relationship</span><span class="p">(</span><span class="n">MyOtherClass</span><span class="p">,</span> <span class="n">lazy</span><span class="o">=</span><span class="s1">&apos;raise&apos;</span><span class="p">)</span></pre></div></div><p><span class="yiyi-st" id="yiyi-85">&#x4EE5;&#x4E0A;&#xFF0C;<code class="docutils literal"><span class="pre">children</span></code>&#x96C6;&#x5408;&#x4E0A;&#x7684;&#x5C5E;&#x6027;&#x8BBF;&#x95EE;&#x5C06;&#x4F1A;&#x5F15;&#x53D1;&#x5F02;&#x5E38;&#xFF0C;&#x5982;&#x679C;&#x5B83;&#x4EE5;&#x524D;&#x6CA1;&#x6709;&#x88AB;&#x9884;&#x5148;&#x52A0;&#x8F7D;&#x3002;</span><span class="yiyi-st" id="yiyi-86">&#x8FD9;&#x5305;&#x62EC;&#x8BFB;&#x53D6;&#x6743;&#x9650;&#xFF0C;&#x4F46;&#x5BF9;&#x4E8E;&#x96C6;&#x5408;&#x4E5F;&#x4F1A;&#x5F71;&#x54CD;&#x5199;&#x5165;&#x6743;&#x9650;&#xFF0C;&#x56E0;&#x4E3A;&#x96C6;&#x5408;&#x4E0D;&#x80FD;&#x5728;&#x6CA1;&#x6709;&#x5148;&#x52A0;&#x8F7D;&#x7684;&#x60C5;&#x51B5;&#x4E0B;&#x8FDB;&#x884C;&#x7A81;&#x53D8;&#x3002;</span><span class="yiyi-st" id="yiyi-87">&#x5176;&#x57FA;&#x672C;&#x539F;&#x7406;&#x662F;&#x786E;&#x4FDD;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x5728;&#x7279;&#x5B9A;&#x4E0A;&#x4E0B;&#x6587;&#x4E2D;&#x4E0D;&#x53D1;&#x51FA;&#x4EFB;&#x4F55;&#x610F;&#x5916;&#x7684;&#x5EF6;&#x8FDF;&#x52A0;&#x8F7D;&#x3002;</span><span class="yiyi-st" id="yiyi-88">&#x4E0E;&#x5176;&#x4E0D;&#x5FC5;&#x901A;&#x8FC7;SQL&#x65E5;&#x5FD7;&#x6765;&#x786E;&#x5B9A;&#x6240;&#x6709;&#x5FC5;&#x8981;&#x7684;&#x5C5E;&#x6027;&#x5DF2;&#x88AB;&#x52A0;&#x8F7D;&#xFF0C;&#x201C;&#x63D0;&#x5347;&#x201D;&#x7B56;&#x7565;&#x5C06;&#x5BFC;&#x81F4;&#x5378;&#x8F7D;&#x7684;&#x5C5E;&#x6027;&#x5728;&#x88AB;&#x8BBF;&#x95EE;&#x65F6;&#x7ACB;&#x5373;&#x5F15;&#x53D1;&#x3002;</span><span class="yiyi-st" id="yiyi-89">&#x901A;&#x8FC7;&#x4F7F;&#x7528;<a class="reference internal" href="loading_relationships.html#sqlalchemy.orm.raiseload" title="sqlalchemy.orm.raiseload"><code class="xref py py-func docutils literal"><span class="pre">orm.raiseload()</span></code></a>&#x52A0;&#x8F7D;&#x5668;&#x9009;&#x9879;&#xFF0C;&#x67E5;&#x8BE2;&#x9009;&#x9879;&#x4E5F;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;&#x63D0;&#x5347;&#x7B56;&#x7565;&#x3002;</span></p><div class="versionadded"><p><span class="yiyi-st" id="yiyi-90"><span class="versionmodified">&#x7248;&#x672C;1.1&#x4E2D;&#x7684;&#x65B0;&#x589E;&#x529F;&#x80FD;&#xFF1A;</span>&#x6DFB;&#x52A0;&#x4E86;&#x201C;&#x5F15;&#x5BFC;&#x201D;&#x52A0;&#x8F7D;&#x5668;&#x7B56;&#x7565;&#x3002;</span></p></div></div><div class="section" id="using-passive-deletes"><h3><span class="yiyi-st" id="yiyi-91">&#x4F7F;&#x7528;&#x88AB;&#x52A8;&#x5220;&#x9664;<a class="headerlink" href="#using-passive-deletes" title="Permalink to this headline">&#xB6;</a></span></h3><p><span class="yiyi-st" id="yiyi-92">&#x4F7F;&#x7528;<a class="reference internal" href="relationship_api.html#sqlalchemy.orm.relationship.params.passive_deletes" title="sqlalchemy.orm.relationship"><code class="xref py py-paramref docutils literal"><span class="pre">passive_deletes</span></code></a>&#x7981;&#x7528;DELETE&#x64CD;&#x4F5C;&#x4E0A;&#x7684;&#x5B50;&#x5BF9;&#x8C61;&#x52A0;&#x8F7D;&#xFF0C;&#x5E76;&#x7ED3;&#x5408;&#x6570;&#x636E;&#x5E93;&#x4E0A;&#x7684;&#x201C;ON DELETE&#xFF08;CASCADE | SET NULL&#xFF09;&#x201D;&#x6765;&#x81EA;&#x52A8;&#x7EA7;&#x8054;&#x5220;&#x9664;&#x5B50;&#x5BF9;&#x8C61;&#xFF1A;</span></p><div class="highlight-python"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">MyClass</span><span class="p">(</span><span class="n">Base</span><span class="p">):</span>
    <span class="n">__tablename__</span> <span class="o">=</span> <span class="s1">&apos;mytable&apos;</span>
    <span class="nb">id</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">Integer</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    <span class="n">children</span> <span class="o">=</span> <span class="n">relationship</span><span class="p">(</span><span class="s2">&quot;MyOtherClass&quot;</span><span class="p">,</span>
                    <span class="n">cascade</span><span class="o">=</span><span class="s2">&quot;all, delete-orphan&quot;</span><span class="p">,</span>
                    <span class="n">passive_deletes</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

<span class="k">class</span> <span class="nc">MyOtherClass</span><span class="p">(</span><span class="n">Base</span><span class="p">):</span>
    <span class="n">__tablename__</span> <span class="o">=</span> <span class="s1">&apos;myothertable&apos;</span>
    <span class="nb">id</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">Integer</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    <span class="n">parent_id</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">Integer</span><span class="p">,</span>
                <span class="n">ForeignKey</span><span class="p">(</span><span class="s1">&apos;mytable.id&apos;</span><span class="p">,</span> <span class="n">ondelete</span><span class="o">=</span><span class="s1">&apos;CASCADE&apos;</span><span class="p">)</span>
                    <span class="p">)</span></pre></div></div><div class="admonition note"><p class="first admonition-title"><span class="yiyi-st" id="yiyi-93">&#x6CE8;&#x610F;</span></p><p><span class="yiyi-st" id="yiyi-94">&#x8981;&#x4F7F;&#x7528;&#x201C;ON DELETE CASCADE&#x201D;&#xFF0C;&#x5E95;&#x5C42;&#x6570;&#x636E;&#x5E93;&#x5F15;&#x64CE;&#x5FC5;&#x987B;&#x652F;&#x6301;&#x5916;&#x952E;&#x3002;</span></p><ul class="last simple"><li><span class="yiyi-st" id="yiyi-95">&#x4F7F;&#x7528;MySQL&#x65F6;&#xFF0C;&#x5FC5;&#x987B;&#x9009;&#x62E9;&#x9002;&#x5F53;&#x7684;&#x5B58;&#x50A8;&#x5F15;&#x64CE;&#x3002;</span><span class="yiyi-st" id="yiyi-96">&#x6709;&#x5173;&#x8BE6;&#x7EC6;&#x4FE1;&#x606F;&#xFF0C;&#x8BF7;&#x53C2;&#x9605;<a class="reference internal" href="dialects_mysql.html#mysql-storage-engines"><span>CREATE TABLE arguments including Storage Engines</span></a>&#x3002;</span></li><li><span class="yiyi-st" id="yiyi-97">&#x5728;&#x4F7F;&#x7528;SQLite&#x65F6;&#xFF0C;&#x5FC5;&#x987B;&#x660E;&#x786E;&#x542F;&#x7528;&#x5916;&#x952E;&#x652F;&#x6301;&#x3002;</span><span class="yiyi-st" id="yiyi-98">&#x6709;&#x5173;&#x8BE6;&#x7EC6;&#x4FE1;&#x606F;&#xFF0C;&#x8BF7;&#x53C2;&#x89C1;<a class="reference internal" href="dialects_sqlite.html#sqlite-foreign-keys"><span>Foreign Key Support</span></a>&#x3002;</span></li></ul></div><p><span class="yiyi-st" id="yiyi-99">&#x5F53;&#x5E94;&#x7528;<a class="reference internal" href="relationship_api.html#sqlalchemy.orm.relationship.params.passive_deletes" title="sqlalchemy.orm.relationship"><code class="xref py py-paramref docutils literal"><span class="pre">passive_deletes</span></code></a>&#x65F6;&#xFF0C;&#x5F53;<code class="docutils literal"><span class="pre">MyClass</span></code>&#x7684;&#x5B9E;&#x4F8B;&#x6807;&#x8BB0;&#x4E3A;&#x5220;&#x9664;&#x65F6;&#xFF0C;<code class="docutils literal"><span class="pre">children</span></code>&#x5173;&#x7CFB;&#x4E0D;&#x4F1A;&#x88AB;&#x52A0;&#x8F7D;&#x5230;&#x5185;&#x5B58;&#x4E2D;&#x3002;</span><span class="yiyi-st" id="yiyi-100">The <code class="docutils literal"><span class="pre">cascade=&quot;all,</span> <span class="pre">delete-orphan&quot;</span></code> <em>will</em> take effect for instances of <code class="docutils literal"><span class="pre">MyOtherClass</span></code> which are currently present in the session; however for instances of <code class="docutils literal"><span class="pre">MyOtherClass</span></code> which are not loaded, SQLAlchemy assumes that &#x201C;ON DELETE CASCADE&#x201D; rules will ensure that those rows are deleted by the database.</span></p><div class="admonition seealso"><p class="first admonition-title"><span class="yiyi-st" id="yiyi-101">&#x4E5F;&#x53EF;&#x4EE5;&#x770B;&#x770B;</span></p><p class="last"><span class="yiyi-st" id="yiyi-102"><a class="reference internal" href="mapping_api.html#sqlalchemy.orm.mapper.params.passive_deletes" title="sqlalchemy.orm.mapper"><code class="xref py py-paramref docutils literal"><span class="pre">orm.mapper.passive_deletes</span></code></a>  -  <a class="reference internal" href="mapping_api.html#sqlalchemy.orm.mapper" title="sqlalchemy.orm.mapper"><code class="xref py py-func docutils literal"><span class="pre">mapper()</span></code></a>&#x4E0A;&#x7684;&#x7C7B;&#x4F3C;&#x529F;&#x80FD;</span></p></div></div></div><div class="section" id="customizing-collection-access"><h2><span class="yiyi-st" id="yiyi-103">&#x81EA;&#x5B9A;&#x4E49;&#x96C6;&#x5408;&#x8BBF;&#x95EE;<a class="headerlink" href="#customizing-collection-access" title="Permalink to this headline">&#xB6;</a></span></h2><p><span class="yiyi-st" id="yiyi-104">&#x6620;&#x5C04;&#x4E00;&#x5BF9;&#x591A;&#x6216;&#x591A;&#x5BF9;&#x591A;&#x5173;&#x7CFB;&#x4F1A;&#x5BFC;&#x81F4;&#x901A;&#x8FC7;&#x7236;&#x5B9E;&#x4F8B;&#x4E0A;&#x7684;&#x5C5E;&#x6027;&#x8BBF;&#x95EE;&#x503C;&#x7684;&#x96C6;&#x5408;&#x3002;</span><span class="yiyi-st" id="yiyi-105">&#x9ED8;&#x8BA4;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;&#x8FD9;&#x4E2A;&#x96C6;&#x5408;&#x662F;&#x4E00;&#x4E2A;<code class="docutils literal"><span class="pre">list</span></code>&#xFF1A;</span></p><div class="highlight-python"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">Parent</span><span class="p">(</span><span class="n">Base</span><span class="p">):</span>
    <span class="n">__tablename__</span> <span class="o">=</span> <span class="s1">&apos;parent&apos;</span>
    <span class="n">parent_id</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">Integer</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

    <span class="n">children</span> <span class="o">=</span> <span class="n">relationship</span><span class="p">(</span><span class="n">Child</span><span class="p">)</span>

<span class="n">parent</span> <span class="o">=</span> <span class="n">Parent</span><span class="p">()</span>
<span class="n">parent</span><span class="o">.</span><span class="n">children</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Child</span><span class="p">())</span>
<span class="k">print</span><span class="p">(</span><span class="n">parent</span><span class="o">.</span><span class="n">children</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span></pre></div></div><p><span class="yiyi-st" id="yiyi-106">&#x96C6;&#x5408;&#x4E0D;&#x9650;&#x4E8E;&#x5217;&#x8868;&#x3002;</span><span class="yiyi-st" id="yiyi-107">&#x901A;&#x8FC7;&#x5728;<a class="reference internal" href="relationship_api.html#sqlalchemy.orm.relationship" title="sqlalchemy.orm.relationship"><code class="xref py py-func docutils literal"><span class="pre">relationship()</span></code></a>&#x4E2D;&#x6307;&#x5B9A;<a class="reference internal" href="relationship_api.html#sqlalchemy.orm.relationship.params.collection_class" title="sqlalchemy.orm.relationship"><code class="xref py py-paramref docutils literal"><span class="pre">collection_class</span></code></a>&#x9009;&#x9879;&#xFF0C;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;&#x96C6;&#x5408;&#xFF0C;&#x53EF;&#x53D8;&#x5E8F;&#x5217;&#x548C;&#x51E0;&#x4E4E;&#x4EFB;&#x4F55;&#x5176;&#x4ED6;&#x53EF;&#x5145;&#x5F53;&#x5BB9;&#x5668;&#x7684;Python&#x5BF9;&#x8C61;&#x6765;&#x4EE3;&#x66FF;&#x9ED8;&#x8BA4;&#x5217;&#x8868;&#xFF1A;</span></p><div class="highlight-python"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">Parent</span><span class="p">(</span><span class="n">Base</span><span class="p">):</span>
    <span class="n">__tablename__</span> <span class="o">=</span> <span class="s1">&apos;parent&apos;</span>
    <span class="n">parent_id</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">Integer</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

    <span class="c1"># use a set</span>
    <span class="n">children</span> <span class="o">=</span> <span class="n">relationship</span><span class="p">(</span><span class="n">Child</span><span class="p">,</span> <span class="n">collection_class</span><span class="o">=</span><span class="nb">set</span><span class="p">)</span>

<span class="n">parent</span> <span class="o">=</span> <span class="n">Parent</span><span class="p">()</span>
<span class="n">child</span> <span class="o">=</span> <span class="n">Child</span><span class="p">()</span>
<span class="n">parent</span><span class="o">.</span><span class="n">children</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">child</span><span class="p">)</span>
<span class="k">assert</span> <span class="n">child</span> <span class="ow">in</span> <span class="n">parent</span><span class="o">.</span><span class="n">children</span></pre></div></div><div class="section" id="dictionary-collections"><h3><span class="yiyi-st" id="yiyi-108">&#x8BCD;&#x5178;&#x96C6;&#x5408;<a class="headerlink" href="#dictionary-collections" title="Permalink to this headline">&#xB6;</a></span></h3><p><span class="yiyi-st" id="yiyi-109">&#x5C06;&#x5B57;&#x5178;&#x7528;&#x4F5C;&#x96C6;&#x5408;&#x65F6;&#x9700;&#x8981;&#x4E00;&#x4E9B;&#x989D;&#x5916;&#x7684;&#x7EC6;&#x8282;&#x3002;</span><span class="yiyi-st" id="yiyi-110">&#x8FD9;&#x662F;&#x56E0;&#x4E3A;&#x5BF9;&#x8C61;&#x603B;&#x662F;&#x4F5C;&#x4E3A;&#x5217;&#x8868;&#x4ECE;&#x6570;&#x636E;&#x5E93;&#x52A0;&#x8F7D;&#xFF0C;&#x5E76;&#x4E14;&#x5FC5;&#x987B;&#x63D0;&#x4F9B;&#x5BC6;&#x94A5;&#x751F;&#x6210;&#x7B56;&#x7565;&#x624D;&#x80FD;&#x6B63;&#x786E;&#x586B;&#x5145;&#x5B57;&#x5178;&#x3002;</span><span class="yiyi-st" id="yiyi-111"><a class="reference internal" href="#sqlalchemy.orm.collections.attribute_mapped_collection" title="sqlalchemy.orm.collections.attribute_mapped_collection"><code class="xref py py-func docutils literal"><span class="pre">attribute_mapped_collection()</span></code></a>&#x51FD;&#x6570;&#x662F;&#x5B9E;&#x73B0;&#x7B80;&#x5355;&#x5B57;&#x5178;&#x96C6;&#x5408;&#x7684;&#x6700;&#x5E38;&#x89C1;&#x65B9;&#x6CD5;&#x3002;</span><span class="yiyi-st" id="yiyi-112">&#x5B83;&#x751F;&#x6210;&#x4E00;&#x4E2A;&#x5B57;&#x5178;&#x7C7B;&#xFF0C;&#x5B83;&#x5C06;&#x6620;&#x5C04;&#x7C7B;&#x7684;&#x7279;&#x5B9A;&#x5C5E;&#x6027;&#x4F5C;&#x4E3A;&#x5173;&#x952E;&#x5B57;&#x3002;</span><span class="yiyi-st" id="yiyi-113">Below we map an <code class="docutils literal"><span class="pre">Item</span></code> class containing a dictionary of <code class="docutils literal"><span class="pre">Note</span></code> items keyed to the <code class="docutils literal"><span class="pre">Note.keyword</span></code> attribute:</span></p><div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sqlalchemy</span> <span class="kn">import</span> <span class="n">Column</span><span class="p">,</span> <span class="n">Integer</span><span class="p">,</span> <span class="n">String</span><span class="p">,</span> <span class="n">ForeignKey</span>
<span class="kn">from</span> <span class="nn">sqlalchemy.orm</span> <span class="kn">import</span> <span class="n">relationship</span>
<span class="kn">from</span> <span class="nn">sqlalchemy.orm.collections</span> <span class="kn">import</span> <span class="n">attribute_mapped_collection</span>
<span class="kn">from</span> <span class="nn">sqlalchemy.ext.declarative</span> <span class="kn">import</span> <span class="n">declarative_base</span>

<span class="n">Base</span> <span class="o">=</span> <span class="n">declarative_base</span><span class="p">()</span>

<span class="k">class</span> <span class="nc">Item</span><span class="p">(</span><span class="n">Base</span><span class="p">):</span>
    <span class="n">__tablename__</span> <span class="o">=</span> <span class="s1">&apos;item&apos;</span>
    <span class="nb">id</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">Integer</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    <span class="n">notes</span> <span class="o">=</span> <span class="n">relationship</span><span class="p">(</span><span class="s2">&quot;Note&quot;</span><span class="p">,</span>
                <span class="n">collection_class</span><span class="o">=</span><span class="n">attribute_mapped_collection</span><span class="p">(</span><span class="s1">&apos;keyword&apos;</span><span class="p">),</span>
                <span class="n">cascade</span><span class="o">=</span><span class="s2">&quot;all, delete-orphan&quot;</span><span class="p">)</span>

<span class="k">class</span> <span class="nc">Note</span><span class="p">(</span><span class="n">Base</span><span class="p">):</span>
    <span class="n">__tablename__</span> <span class="o">=</span> <span class="s1">&apos;note&apos;</span>
    <span class="nb">id</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">Integer</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    <span class="n">item_id</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">Integer</span><span class="p">,</span> <span class="n">ForeignKey</span><span class="p">(</span><span class="s1">&apos;item.id&apos;</span><span class="p">),</span> <span class="n">nullable</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
    <span class="n">keyword</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">String</span><span class="p">)</span>
    <span class="n">text</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">String</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">keyword</span><span class="p">,</span> <span class="n">text</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">keyword</span> <span class="o">=</span> <span class="n">keyword</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="n">text</span></pre></div></div><p><span class="yiyi-st" id="yiyi-114"><code class="docutils literal"><span class="pre">Item.notes</span></code> is then a dictionary:</span></p><div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">item</span> <span class="o">=</span> <span class="n">Item</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">item</span><span class="o">.</span><span class="n">notes</span><span class="p">[</span><span class="s1">&apos;a&apos;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Note</span><span class="p">(</span><span class="s1">&apos;a&apos;</span><span class="p">,</span> <span class="s1">&apos;atext&apos;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">item</span><span class="o">.</span><span class="n">notes</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
<span class="go">{&apos;a&apos;: &lt;__main__.Note object at 0x2eaaf0&gt;}</span></pre></div></div><p><span class="yiyi-st" id="yiyi-115"><a class="reference internal" href="#sqlalchemy.orm.collections.attribute_mapped_collection" title="sqlalchemy.orm.collections.attribute_mapped_collection"><code class="xref py py-func docutils literal"><span class="pre">attribute_mapped_collection()</span></code></a>&#x5C06;&#x786E;&#x4FDD;&#x6BCF;&#x4E2A;<code class="docutils literal"><span class="pre">Note</span></code>&#x7684;<code class="docutils literal"><span class="pre">.keyword</span></code>&#x5C5E;&#x6027;&#x7B26;&#x5408;&#x5B57;&#x5178;&#x4E2D;&#x7684;&#x952E;&#x3002;</span><span class="yiyi-st" id="yiyi-116">&#x4F8B;&#x5982;&#xFF0C;&#x5F53;&#x5206;&#x914D;&#x7ED9;<code class="docutils literal"><span class="pre">Item.notes</span></code>&#x65F6;&#xFF0C;&#x6211;&#x4EEC;&#x63D0;&#x4F9B;&#x7684;&#x5B57;&#x5178;&#x952E;&#x5FC5;&#x987B;&#x4E0E;&#x5B9E;&#x9645;&#x7684;<code class="docutils literal"><span class="pre">Note</span></code>&#x5BF9;&#x8C61;&#x5339;&#x914D;&#xFF1A;</span></p><div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">item</span> <span class="o">=</span> <span class="n">Item</span><span class="p">()</span>
<span class="n">item</span><span class="o">.</span><span class="n">notes</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&apos;a&apos;</span><span class="p">:</span> <span class="n">Note</span><span class="p">(</span><span class="s1">&apos;a&apos;</span><span class="p">,</span> <span class="s1">&apos;atext&apos;</span><span class="p">),</span>
            <span class="s1">&apos;b&apos;</span><span class="p">:</span> <span class="n">Note</span><span class="p">(</span><span class="s1">&apos;b&apos;</span><span class="p">,</span> <span class="s1">&apos;btext&apos;</span><span class="p">)</span>
        <span class="p">}</span></pre></div></div><p><span class="yiyi-st" id="yiyi-117"><a class="reference internal" href="#sqlalchemy.orm.collections.attribute_mapped_collection" title="sqlalchemy.orm.collections.attribute_mapped_collection"><code class="xref py py-func docutils literal"><span class="pre">attribute_mapped_collection()</span></code></a>&#x7528;&#x4F5C;&#x952E;&#x7684;&#x5C5E;&#x6027;&#x6839;&#x672C;&#x4E0D;&#x9700;&#x8981;&#x6620;&#x5C04;&#xFF01;</span><span class="yiyi-st" id="yiyi-118">Using a regular Python <code class="docutils literal"><span class="pre">@property</span></code> allows virtually any detail or combination of details about the object to be used as the key, as below when we establish it as a tuple of <code class="docutils literal"><span class="pre">Note.keyword</span></code> and the first ten letters of the <code class="docutils literal"><span class="pre">Note.text</span></code> field:</span></p><div class="highlight-python"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">Item</span><span class="p">(</span><span class="n">Base</span><span class="p">):</span>
    <span class="n">__tablename__</span> <span class="o">=</span> <span class="s1">&apos;item&apos;</span>
    <span class="nb">id</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">Integer</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    <span class="n">notes</span> <span class="o">=</span> <span class="n">relationship</span><span class="p">(</span><span class="s2">&quot;Note&quot;</span><span class="p">,</span>
                <span class="n">collection_class</span><span class="o">=</span><span class="n">attribute_mapped_collection</span><span class="p">(</span><span class="s1">&apos;note_key&apos;</span><span class="p">),</span>
                <span class="n">backref</span><span class="o">=</span><span class="s2">&quot;item&quot;</span><span class="p">,</span>
                <span class="n">cascade</span><span class="o">=</span><span class="s2">&quot;all, delete-orphan&quot;</span><span class="p">)</span>

<span class="k">class</span> <span class="nc">Note</span><span class="p">(</span><span class="n">Base</span><span class="p">):</span>
    <span class="n">__tablename__</span> <span class="o">=</span> <span class="s1">&apos;note&apos;</span>
    <span class="nb">id</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">Integer</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    <span class="n">item_id</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">Integer</span><span class="p">,</span> <span class="n">ForeignKey</span><span class="p">(</span><span class="s1">&apos;item.id&apos;</span><span class="p">),</span> <span class="n">nullable</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
    <span class="n">keyword</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">String</span><span class="p">)</span>
    <span class="n">text</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">String</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">note_key</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">keyword</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">text</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">10</span><span class="p">])</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">keyword</span><span class="p">,</span> <span class="n">text</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">keyword</span> <span class="o">=</span> <span class="n">keyword</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="n">text</span></pre></div></div><p><span class="yiyi-st" id="yiyi-119">&#x4E0A;&#x9762;&#x6211;&#x4EEC;&#x6DFB;&#x52A0;&#x4E86;&#x4E00;&#x4E2A;<code class="docutils literal"><span class="pre">Note.item</span></code> backref&#x3002;</span><span class="yiyi-st" id="yiyi-120">&#x6307;&#x5B9A;&#x8FD9;&#x79CD;&#x53CD;&#x5411;&#x5173;&#x7CFB;&#x65F6;&#xFF0C;<code class="docutils literal"><span class="pre">Note</span></code>&#x88AB;&#x6DFB;&#x52A0;&#x5230;<code class="docutils literal"><span class="pre">Item.notes</span></code>&#x5B57;&#x5178;&#x4E2D;&#xFF0C;&#x5E76;&#x4E14;&#x4F1A;&#x81EA;&#x52A8;&#x4E3A;&#x6211;&#x4EEC;&#x751F;&#x6210;&#x5BC6;&#x94A5;&#xFF1A;</span></p><div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">item</span> <span class="o">=</span> <span class="n">Item</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">n1</span> <span class="o">=</span> <span class="n">Note</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;atext&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">n1</span><span class="o">.</span><span class="n">item</span> <span class="o">=</span> <span class="n">item</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">item</span><span class="o">.</span><span class="n">notes</span>
<span class="go">{(&apos;a&apos;, &apos;atext&apos;): &lt;__main__.Note object at 0x2eaaf0&gt;}</span></pre></div></div><p><span class="yiyi-st" id="yiyi-121">&#x5176;&#x4ED6;&#x5185;&#x7F6E;&#x7684;&#x5B57;&#x5178;&#x7C7B;&#x578B;&#x5305;&#x62EC;<a class="reference internal" href="#sqlalchemy.orm.collections.column_mapped_collection" title="sqlalchemy.orm.collections.column_mapped_collection"><code class="xref py py-func docutils literal"><span class="pre">column_mapped_collection()</span></code></a>&#xFF0C;&#x5B83;&#x51E0;&#x4E4E;&#x50CF;<a class="reference internal" href="#sqlalchemy.orm.collections.attribute_mapped_collection" title="sqlalchemy.orm.collections.attribute_mapped_collection"><code class="xref py py-func docutils literal"><span class="pre">attribute_mapped_collection()</span></code></a>&#xFF0C;&#x76F4;&#x63A5;&#x7ED9;&#x5B9A;<a class="reference internal" href="core_metadata.html#sqlalchemy.schema.Column" title="sqlalchemy.schema.Column"><code class="xref py py-class docutils literal"><span class="pre">Column</span></code></a></span></p><div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sqlalchemy.orm.collections</span> <span class="kn">import</span> <span class="n">column_mapped_collection</span>

<span class="k">class</span> <span class="nc">Item</span><span class="p">(</span><span class="n">Base</span><span class="p">):</span>
    <span class="n">__tablename__</span> <span class="o">=</span> <span class="s1">&apos;item&apos;</span>
    <span class="nb">id</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">Integer</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    <span class="n">notes</span> <span class="o">=</span> <span class="n">relationship</span><span class="p">(</span><span class="s2">&quot;Note&quot;</span><span class="p">,</span>
                <span class="n">collection_class</span><span class="o">=</span><span class="n">column_mapped_collection</span><span class="p">(</span><span class="n">Note</span><span class="o">.</span><span class="n">__table__</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">keyword</span><span class="p">),</span>
                <span class="n">cascade</span><span class="o">=</span><span class="s2">&quot;all, delete-orphan&quot;</span><span class="p">)</span></pre></div></div><p><span class="yiyi-st" id="yiyi-122">&#x4EE5;&#x53CA;&#x4F20;&#x9012;&#x4EFB;&#x4F55;&#x53EF;&#x8C03;&#x7528;&#x51FD;&#x6570;&#x7684;<a class="reference internal" href="#sqlalchemy.orm.collections.mapped_collection" title="sqlalchemy.orm.collections.mapped_collection"><code class="xref py py-func docutils literal"><span class="pre">mapped_collection()</span></code></a>&#x3002;</span><span class="yiyi-st" id="yiyi-123">&#x8BF7;&#x6CE8;&#x610F;&#xFF0C;&#x5982;&#x524D;&#x6240;&#x8FF0;&#xFF0C;&#x4F7F;&#x7528;<a class="reference internal" href="#sqlalchemy.orm.collections.attribute_mapped_collection" title="sqlalchemy.orm.collections.attribute_mapped_collection"><code class="xref py py-func docutils literal"><span class="pre">attribute_mapped_collection()</span></code></a>&#x4EE5;&#x53CA;<code class="docutils literal"><span class="pre">@property</span></code>&#x901A;&#x5E38;&#x66F4;&#x5BB9;&#x6613;&#xFF1A;</span></p><div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sqlalchemy.orm.collections</span> <span class="kn">import</span> <span class="n">mapped_collection</span>

<span class="k">class</span> <span class="nc">Item</span><span class="p">(</span><span class="n">Base</span><span class="p">):</span>
    <span class="n">__tablename__</span> <span class="o">=</span> <span class="s1">&apos;item&apos;</span>
    <span class="nb">id</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">Integer</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    <span class="n">notes</span> <span class="o">=</span> <span class="n">relationship</span><span class="p">(</span><span class="s2">&quot;Note&quot;</span><span class="p">,</span>
                <span class="n">collection_class</span><span class="o">=</span><span class="n">mapped_collection</span><span class="p">(</span><span class="k">lambda</span> <span class="n">note</span><span class="p">:</span> <span class="n">note</span><span class="o">.</span><span class="n">text</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">10</span><span class="p">]),</span>
                <span class="n">cascade</span><span class="o">=</span><span class="s2">&quot;all, delete-orphan&quot;</span><span class="p">)</span></pre></div></div><p><span class="yiyi-st" id="yiyi-124">&#x5B57;&#x5178;&#x6620;&#x5C04;&#x901A;&#x5E38;&#x4E0E;&#x201C;&#x5173;&#x8054;&#x4EE3;&#x7406;&#x201D;&#x6269;&#x5C55;&#x7ED3;&#x5408;&#x4F7F;&#x7528;&#xFF0C;&#x4EE5;&#x4EA7;&#x751F;&#x6D41;&#x7EBF;&#x5316;&#x7684;&#x5B57;&#x5178;&#x89C6;&#x56FE;&#x3002;</span><span class="yiyi-st" id="yiyi-125">&#x6709;&#x5173;&#x793A;&#x4F8B;&#xFF0C;&#x8BF7;&#x53C2;&#x89C1;<a class="reference internal" href="extensions_associationproxy.html#proxying-dictionaries"><span>Proxying to Dictionary Based Collections</span></a>&#x548C;<a class="reference internal" href="extensions_associationproxy.html#composite-association-proxy"><span>Composite Association Proxies</span></a>&#x3002;</span></p><dl class="function"><dt id="sqlalchemy.orm.collections.attribute_mapped_collection"><span class="yiyi-st" id="yiyi-126"><code class="descclassname"> sqlalchemy.orm.collections&#x3002; T0&gt; <code class="descname"> attribute_mapped_collection  T1&gt; <span class="sig-paren">&#xFF08; T2&gt; <em> attr_name  T3&gt; <span class="sig-paren">&#xFF09; T4&gt; <a class="headerlink" href="#sqlalchemy.orm.collections.attribute_mapped_collection" title="Permalink to this definition">&#xB6;&lt; / T5&gt;</a></span></em></span></code></code></span></dt><dd><p><span class="yiyi-st" id="yiyi-127">&#x57FA;&#x4E8E;&#x5C5E;&#x6027;&#x7684;&#x952E;&#x63A7;&#x7684;&#x57FA;&#x4E8E;&#x5B57;&#x5178;&#x7684;&#x96C6;&#x5408;&#x7C7B;&#x578B;&#x3002;</span></p><p><span class="yiyi-st" id="yiyi-128">&#x4F7F;&#x7528;&#x57FA;&#x4E8E;&#x96C6;&#x5408;&#x4E2D;&#x5B9E;&#x4F53;&#x7684;&apos;attr_name&apos;&#x5C5E;&#x6027;&#x7684;&#x952E;&#x503C;&#x8FD4;&#x56DE;<a class="reference internal" href="#sqlalchemy.orm.collections.MappedCollection" title="sqlalchemy.orm.collections.MappedCollection"><code class="xref py py-class docutils literal"><span class="pre">MappedCollection</span></code></a>&#x5DE5;&#x5382;&#xFF0C;&#x5176;&#x4E2D;<code class="docutils literal"><span class="pre">attr_name</span></code>&#x662F;&#x5C5E;&#x6027;&#x7684;&#x5B57;&#x7B26;&#x4E32;&#x540D;&#x79F0;&#x3002;</span></p><p><span class="yiyi-st" id="yiyi-129">&#x5173;&#x952E;&#x503C;&#x5728;&#x5BF9;&#x8C61;&#x7684;&#x751F;&#x547D;&#x5468;&#x671F;&#x4E2D;&#x5FC5;&#x987B;&#x662F;&#x4E0D;&#x53EF;&#x53D8;&#x7684;&#x3002;</span><span class="yiyi-st" id="yiyi-130">&#x4F8B;&#x5982;&#xFF0C;&#x5982;&#x679C;&#x8FD9;&#x4E9B;&#x952E;&#x503C;&#x5728;&#x4F1A;&#x8BDD;&#x671F;&#x95F4;&#x53D1;&#x751F;&#x66F4;&#x6539;&#xFF08;&#x4F8B;&#x5982;&#xFF0C;&#x4F1A;&#x8BDD;&#x5237;&#x65B0;&#x540E;&#x4ECE;&#x65E0;&#x5230;&#x6570;&#x636E;&#x5E93;&#x5206;&#x914D;&#x7684;&#x6574;&#x6570;&#xFF09;&#xFF0C;&#x5219;&#x65E0;&#x6CD5;&#x6620;&#x5C04;&#x5916;&#x952E;&#x503C;&#x3002;</span></p></dd></dl><dl class="function"><dt id="sqlalchemy.orm.collections.column_mapped_collection"><span class="yiyi-st" id="yiyi-131"><code class="descclassname"> sqlalchemy.orm.collections&#x3002; T0&gt; <code class="descname"> column_mapped_collection  T1&gt; <span class="sig-paren">&#xFF08; T2&gt; <em> mapping_spec  T3&gt; <span class="sig-paren">&#xFF09; T4&gt; <a class="headerlink" href="#sqlalchemy.orm.collections.column_mapped_collection" title="Permalink to this definition">&#xB6;&lt; / T5&gt;</a></span></em></span></code></code></span></dt><dd><p><span class="yiyi-st" id="yiyi-132">&#x57FA;&#x4E8E;&#x5217;&#x7684;&#x952E;&#x63A7;&#x7684;&#x57FA;&#x4E8E;&#x5B57;&#x5178;&#x7684;&#x96C6;&#x5408;&#x7C7B;&#x578B;&#x3002;</span></p><p><span class="yiyi-st" id="yiyi-133">&#x4F7F;&#x7528;&#x4ECE;mapping_spec&#x751F;&#x6210;&#x7684;&#x952E;&#x63A7;&#x51FD;&#x6570;&#x8FD4;&#x56DE;&#x4E00;&#x4E2A;<a class="reference internal" href="#sqlalchemy.orm.collections.MappedCollection" title="sqlalchemy.orm.collections.MappedCollection"><code class="xref py py-class docutils literal"><span class="pre">MappedCollection</span></code></a>&#x5DE5;&#x5382;&#xFF0C;&#x8BE5;&#x5DE5;&#x5177;&#x53EF;&#x80FD;&#x662F;&#x4E00;&#x5217;&#x6216;&#x4E00;&#x5217;&#x5217;&#x3002;</span></p><p><span class="yiyi-st" id="yiyi-134">&#x5173;&#x952E;&#x503C;&#x5728;&#x5BF9;&#x8C61;&#x7684;&#x751F;&#x547D;&#x5468;&#x671F;&#x4E2D;&#x5FC5;&#x987B;&#x662F;&#x4E0D;&#x53EF;&#x53D8;&#x7684;&#x3002;</span><span class="yiyi-st" id="yiyi-135">&#x4F8B;&#x5982;&#xFF0C;&#x5982;&#x679C;&#x8FD9;&#x4E9B;&#x952E;&#x503C;&#x5728;&#x4F1A;&#x8BDD;&#x671F;&#x95F4;&#x53D1;&#x751F;&#x66F4;&#x6539;&#xFF08;&#x4F8B;&#x5982;&#xFF0C;&#x4F1A;&#x8BDD;&#x5237;&#x65B0;&#x540E;&#x4ECE;&#x65E0;&#x5230;&#x6570;&#x636E;&#x5E93;&#x5206;&#x914D;&#x7684;&#x6574;&#x6570;&#xFF09;&#xFF0C;&#x5219;&#x65E0;&#x6CD5;&#x6620;&#x5C04;&#x5916;&#x952E;&#x503C;&#x3002;</span></p></dd></dl><dl class="function"><dt id="sqlalchemy.orm.collections.mapped_collection"><span class="yiyi-st" id="yiyi-136"><code class="descclassname"> sqlalchemy.orm.collections&#x3002; T0&gt; <code class="descname"> mapped_collection  T1&gt; <span class="sig-paren">&#xFF08; T2&gt; <em> keyfunc  T3&gt; <span class="sig-paren">&#xFF09; T4&gt; <a class="headerlink" href="#sqlalchemy.orm.collections.mapped_collection" title="Permalink to this definition">&#xB6;&lt; / T5&gt;</a></span></em></span></code></code></span></dt><dd><p><span class="yiyi-st" id="yiyi-137">&#x57FA;&#x4E8E;&#x5B57;&#x5178;&#x7684;&#x5177;&#x6709;&#x4EFB;&#x610F;&#x952E;&#x63A7;&#x7684;&#x96C6;&#x5408;&#x7C7B;&#x578B;&#x3002;</span></p><p><span class="yiyi-st" id="yiyi-138">&#x8FD4;&#x56DE;&#x5E26;&#x6709;&#x4ECE;keyfunc&#x751F;&#x6210;&#x7684;&#x952E;&#x63A7;&#x51FD;&#x6570;&#x7684;<a class="reference internal" href="#sqlalchemy.orm.collections.MappedCollection" title="sqlalchemy.orm.collections.MappedCollection"><code class="xref py py-class docutils literal"><span class="pre">MappedCollection</span></code></a>&#x5DE5;&#x5382;&#xFF0C;&#x8FD9;&#x662F;&#x4E00;&#x4E2A;&#x53EF;&#x8C03;&#x7528;&#x7684;&#x5B9E;&#x4F53;&#xFF0C;&#x5B83;&#x8FD4;&#x56DE;&#x4E00;&#x4E2A;&#x5B9E;&#x4F53;&#x5E76;&#x8FD4;&#x56DE;&#x4E00;&#x4E2A;&#x952E;&#x503C;&#x3002;</span></p><p><span class="yiyi-st" id="yiyi-139">&#x5173;&#x952E;&#x503C;&#x5728;&#x5BF9;&#x8C61;&#x7684;&#x751F;&#x547D;&#x5468;&#x671F;&#x4E2D;&#x5FC5;&#x987B;&#x662F;&#x4E0D;&#x53EF;&#x53D8;&#x7684;&#x3002;</span><span class="yiyi-st" id="yiyi-140">&#x4F8B;&#x5982;&#xFF0C;&#x5982;&#x679C;&#x8FD9;&#x4E9B;&#x952E;&#x503C;&#x5728;&#x4F1A;&#x8BDD;&#x671F;&#x95F4;&#x53D1;&#x751F;&#x66F4;&#x6539;&#xFF08;&#x4F8B;&#x5982;&#xFF0C;&#x4F1A;&#x8BDD;&#x5237;&#x65B0;&#x540E;&#x4ECE;&#x65E0;&#x5230;&#x6570;&#x636E;&#x5E93;&#x5206;&#x914D;&#x7684;&#x6574;&#x6570;&#xFF09;&#xFF0C;&#x5219;&#x65E0;&#x6CD5;&#x6620;&#x5C04;&#x5916;&#x952E;&#x503C;&#x3002;</span></p></dd></dl></div></div><div class="section" id="custom-collection-implementations"><h2><span class="yiyi-st" id="yiyi-141">&#x81EA;&#x5B9A;&#x4E49;&#x96C6;&#x5408;&#x5B9E;&#x73B0;<a class="headerlink" href="#custom-collection-implementations" title="Permalink to this headline">&#xB6;</a></span></h2><p><span class="yiyi-st" id="yiyi-142">&#x60A8;&#x4E5F;&#x53EF;&#x4EE5;&#x5C06;&#x81EA;&#x5DF1;&#x7684;&#x7C7B;&#x578B;&#x7528;&#x4E8E;&#x6536;&#x85CF;&#x3002;</span><span class="yiyi-st" id="yiyi-143">&#x5728;&#x7B80;&#x5355;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;&#x4ECE;<code class="docutils literal"><span class="pre">list</span></code>&#x6216;<code class="docutils literal"><span class="pre">set</span></code>&#x8FDB;&#x884C;&#x63D2;&#x5165;&#xFF0C;&#x6DFB;&#x52A0;&#x81EA;&#x5B9A;&#x4E49;&#x884C;&#x4E3A;&#x662F;&#x6240;&#x6709;&#x5FC5;&#x9700;&#x7684;&#x3002;</span><span class="yiyi-st" id="yiyi-144">&#x5728;&#x5176;&#x4ED6;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;&#x9700;&#x8981;&#x7279;&#x6B8A;&#x7684;&#x88C5;&#x9970;&#x5668;&#x6765;&#x544A;&#x8BC9;SQLAlchemy&#x6709;&#x5173;&#x96C6;&#x5408;&#x5982;&#x4F55;&#x64CD;&#x4F5C;&#x7684;&#x66F4;&#x591A;&#x7EC6;&#x8282;&#x3002;</span></p><div class="topic"><p class="topic-title first"><span class="yiyi-st" id="yiyi-145">&#x6211;&#x9700;&#x8981;&#x4E00;&#x4E2A;&#x81EA;&#x5B9A;&#x4E49;&#x96C6;&#x5408;&#x5B9E;&#x73B0;&#x5417;&#xFF1F;</span></p><p><span class="yiyi-st" id="yiyi-146">&#x5728;&#x5927;&#x591A;&#x6570;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;&#x6839;&#x672C;&#x4E0D;&#x662F;&#xFF01;</span><span class="yiyi-st" id="yiyi-147">&#x201C;&#x81EA;&#x5B9A;&#x4E49;&#x201D;&#x96C6;&#x5408;&#x7684;&#x6700;&#x5E38;&#x89C1;&#x7528;&#x4F8B;&#x662F;&#x5C06;&#x4F20;&#x5165;&#x503C;&#x9A8C;&#x8BC1;&#x6216;&#x7F16;&#x7EC4;&#x4E3A;&#x65B0;&#x7684;&#x8868;&#x5355;&#xFF0C;&#x4F8B;&#x5982;&#x6210;&#x4E3A;&#x7C7B;&#x5B9E;&#x4F8B;&#x7684;&#x5B57;&#x7B26;&#x4E32;&#xFF0C;&#x6216;&#x8005;&#x4EE5;&#x67D0;&#x79CD;&#x65B9;&#x5F0F;&#x5728;&#x5185;&#x90E8;&#x4EE3;&#x8868;&#x6570;&#x636E;&#x7684;&#x5B57;&#x7B26;&#x4E32;&#xFF0C;&#x5728;&#x4E0D;&#x540C;&#x5F62;&#x5F0F;&#x7684;&#x5916;&#x90E8;&#x5448;&#x73B0;&#x8BE5;&#x6570;&#x636E;&#x7684;&#x201C;&#x89C6;&#x56FE;&#x201D;&#x3002;</span></p><p><span class="yiyi-st" id="yiyi-148">&#x5BF9;&#x4E8E;&#x7B2C;&#x4E00;&#x4E2A;&#x7528;&#x4F8B;&#xFF0C;<a class="reference internal" href="mapped_attributes.html#sqlalchemy.orm.validates" title="sqlalchemy.orm.validates"><code class="xref py py-func docutils literal"><span class="pre">orm.validates()</span></code></a>&#x88C5;&#x9970;&#x5668;&#x662F;&#x8FC4;&#x4ECA;&#x4E3A;&#x6B62;&#x5728;&#x6240;&#x6709;&#x60C5;&#x51B5;&#x4E0B;&#x4E3A;&#x9A8C;&#x8BC1;&#x548C;&#x7B80;&#x5355;&#x7F16;&#x7EC4;&#x800C;&#x622A;&#x53D6;&#x4F20;&#x5165;&#x503C;&#x7684;&#x6700;&#x7B80;&#x5355;&#x65B9;&#x6CD5;&#x3002;</span><span class="yiyi-st" id="yiyi-149">&#x6709;&#x5173;&#x6B64;&#x793A;&#x4F8B;&#xFF0C;&#x8BF7;&#x53C2;&#x9605;<a class="reference internal" href="mapped_attributes.html#simple-validators"><span>Simple Validators</span></a>&#x3002;</span></p><p><span class="yiyi-st" id="yiyi-150">For the second use case, the <a class="reference internal" href="extensions_associationproxy.html"><span>Association Proxy</span></a> extension is a well-tested, widely used system that provides a read/write &#x201C;view&#x201D; of a collection in terms of some attribute present on the target object. </span><span class="yiyi-st" id="yiyi-151">&#x7531;&#x4E8E;&#x76EE;&#x6807;&#x5C5E;&#x6027;&#x53EF;&#x4EE5;&#x662F;&#x8FD4;&#x56DE;&#x51E0;&#x4E4E;&#x4EFB;&#x4F55;&#x4E1C;&#x897F;&#x7684;<code class="docutils literal"><span class="pre">@property</span></code>&#xFF0C;&#x56E0;&#x6B64;&#x53EA;&#x9700;&#x51E0;&#x4E2A;&#x51FD;&#x6570;&#x5C31;&#x53EF;&#x4EE5;&#x6784;&#x5EFA;&#x4E00;&#x4E2A;&#x96C6;&#x5408;&#x7684;&#x4E00;&#x7CFB;&#x5217;&#x201C;&#x66FF;&#x4EE3;&#x201D;&#x89C6;&#x56FE;&#x3002;</span><span class="yiyi-st" id="yiyi-152">&#x8FD9;&#x79CD;&#x65B9;&#x6CD5;&#x4F7F;&#x5E95;&#x5C42;&#x6620;&#x5C04;&#x96C6;&#x5408;&#x4E0D;&#x53D7;&#x5F71;&#x54CD;&#xFF0C;&#x5E76;&#x4E14;&#x907F;&#x514D;&#x4E86;&#x5728;&#x9010;&#x4E2A;&#x65B9;&#x6CD5;&#x7684;&#x57FA;&#x7840;&#x4E0A;&#x4ED4;&#x7EC6;&#x8C03;&#x6574;&#x96C6;&#x5408;&#x884C;&#x4E3A;&#x7684;&#x9700;&#x8981;&#x3002;</span></p><p><span class="yiyi-st" id="yiyi-153">&#x5F53;&#x96C6;&#x5408;&#x9700;&#x8981;&#x5728;&#x8BBF;&#x95EE;&#x6216;&#x53D8;&#x5F02;&#x64CD;&#x4F5C;&#x65F6;&#x5177;&#x6709;&#x7279;&#x6B8A;&#x884C;&#x4E3A;&#x65F6;&#xFF0C;&#x81EA;&#x5B9A;&#x4E49;&#x96C6;&#x5408;&#x975E;&#x5E38;&#x6709;&#x7528;&#xFF0C;&#x5426;&#x5219;&#x8FD9;&#x4E9B;&#x64CD;&#x4F5C;&#x65E0;&#x6CD5;&#x5728;&#x96C6;&#x5408;&#x7684;&#x5916;&#x90E8;&#x8FDB;&#x884C;&#x5EFA;&#x6A21;&#x3002;</span><span class="yiyi-st" id="yiyi-154">&#x4ED6;&#x4EEC;&#x5F53;&#x7136;&#x53EF;&#x4EE5;&#x7ED3;&#x5408;&#x4E0A;&#x8FF0;&#x4E24;&#x79CD;&#x65B9;&#x6CD5;&#x3002;</span></p></div><p><span class="yiyi-st" id="yiyi-155">SQLAlchemy&#x4E2D;&#x7684;&#x96C6;&#x5408;&#x662F;&#x900F;&#x660E;&#x7684;<em>&#x68C0;&#x6D4B;</em>&#x3002;</span><span class="yiyi-st" id="yiyi-156">&#x4EEA;&#x8868;&#x610F;&#x5473;&#x7740;&#x5BF9;&#x96C6;&#x5408;&#x4E0A;&#x7684;&#x6B63;&#x5E38;&#x64CD;&#x4F5C;&#x8FDB;&#x884C;&#x8DDF;&#x8E2A;&#xFF0C;&#x5E76;&#x5BFC;&#x81F4;&#x5728;&#x5237;&#x65B0;&#x65F6;&#x523B;&#x5C06;&#x66F4;&#x6539;&#x5199;&#x5165;&#x6570;&#x636E;&#x5E93;&#x3002;</span><span class="yiyi-st" id="yiyi-157">&#x6B64;&#x5916;&#xFF0C;&#x6536;&#x96C6;&#x64CD;&#x4F5C;&#x53EF;&#x4EE5;&#x89E6;&#x53D1;<em>&#x4E8B;&#x4EF6;</em>&#xFF0C;&#x8FD9;&#x8868;&#x660E;&#x5FC5;&#x987B;&#x8FDB;&#x884C;&#x4E00;&#x4E9B;&#x8F85;&#x52A9;&#x64CD;&#x4F5C;&#x3002;</span><span class="yiyi-st" id="yiyi-158">&#x8F85;&#x52A9;&#x64CD;&#x4F5C;&#x7684;&#x4F8B;&#x5B50;&#x5305;&#x62EC;&#x5C06;&#x5B50;&#x9879;&#x4FDD;&#x5B58;&#x5728;&#x7236;&#x8282;&#x70B9;&#x7684;<a class="reference internal" href="session_api.html#sqlalchemy.orm.session.Session" title="sqlalchemy.orm.session.Session"><code class="xref py py-class docutils literal"><span class="pre">Session</span></code></a>&#x4E2D;&#xFF08;&#x5373;<code class="docutils literal"><span class="pre">save-update</span></code>&#x7EA7;&#x8054;&#xFF09;&#xFF0C;&#x4EE5;&#x53CA;&#x540C;&#x6B65;&#x53CC;&#x5411;&#x5173;&#x7CFB;&#x7684;&#x72B6;&#x6001;&#xFF08;&#x5373;<a class="reference internal" href="relationship_api.html#sqlalchemy.orm.backref" title="sqlalchemy.orm.backref"><code class="xref py py-func docutils literal"><span class="pre">backref()</span></code></a>&#xFF09;&#x3002;</span></p><p><span class="yiyi-st" id="yiyi-159">&#x96C6;&#x5408;&#x5305;&#x7406;&#x89E3;&#x5217;&#x8868;&#xFF0C;&#x96C6;&#x5408;&#x548C;&#x5B57;&#x5178;&#x7684;&#x57FA;&#x672C;&#x63A5;&#x53E3;&#xFF0C;&#x5E76;&#x5C06;&#x81EA;&#x52A8;&#x5C06;&#x68C0;&#x6D4B;&#x5E94;&#x7528;&#x4E8E;&#x8FD9;&#x4E9B;&#x5185;&#x7F6E;&#x7C7B;&#x578B;&#x53CA;&#x5176;&#x5B50;&#x7C7B;&#x3002;</span><span class="yiyi-st" id="yiyi-160">&#x5B9E;&#x73B0;&#x57FA;&#x672C;&#x96C6;&#x5408;&#x63A5;&#x53E3;&#x7684;&#x5BF9;&#x8C61;&#x6D3E;&#x751F;&#x7C7B;&#x578B;&#x901A;&#x8FC7;&#x9E2D;&#x5F0F;&#x8F93;&#x5165;&#x8FDB;&#x884C;&#x68C0;&#x6D4B;&#x548C;&#x68C0;&#x6D4B;&#xFF1A;</span></p><div class="highlight-python+sql"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">ListLike</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">def</span> <span class="nf">append</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">remove</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">extend</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">items</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">items</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">iter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">foo</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&apos;foo&apos;</span></pre></div></div><p><span class="yiyi-st" id="yiyi-161"><code class="docutils literal"><span class="pre">append</span></code>&#xFF0C;<code class="docutils literal"><span class="pre">remove</span></code>&#x548C;<code class="docutils literal"><span class="pre">extend</span></code>&#x662F;&#x5DF2;&#x77E5;&#x7684;&#x7C7B;&#x5217;&#x8868;&#x65B9;&#x6CD5;&#xFF0C;&#x5E76;&#x5C06;&#x81EA;&#x52A8;&#x8FDB;&#x884C;&#x68C0;&#x6D4B;&#x3002;</span><span class="yiyi-st" id="yiyi-162"><code class="docutils literal"><span class="pre">__iter__</span></code>&#x4E0D;&#x662F;&#x4E00;&#x4E2A;&#x589E;&#x53D8;&#x5668;&#x65B9;&#x6CD5;&#xFF0C;&#x4E0D;&#x4F1A;&#x88AB;&#x68C0;&#x6D4B;&#xFF0C;&#x800C;&#x4E14;<code class="docutils literal"><span class="pre">foo</span></code>&#x4E5F;&#x4E0D;&#x4F1A;&#x3002;</span></p><p><span class="yiyi-st" id="yiyi-163">&#x5F53;&#x7136;&#xFF0C;&#x9E2D;&#x5B50;&#x8F93;&#x5165;&#xFF08;&#x5373;&#x731C;&#x6D4B;&#xFF09;&#x5E76;&#x4E0D;&#x7A33;&#x5B9A;&#xFF0C;&#x6240;&#x4EE5;&#x4F60;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x63D0;&#x4F9B;&#x4E00;&#x4E2A;<code class="docutils literal"><span class="pre">__emulates__</span></code> class&#x5C5E;&#x6027;&#x6765;&#x660E;&#x786E;&#x4F60;&#x6B63;&#x5728;&#x5B9E;&#x73B0;&#x7684;&#x63A5;&#x53E3;&#xFF1A;</span></p><div class="highlight-python"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">SetLike</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="n">__emulates__</span> <span class="o">=</span> <span class="nb">set</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">append</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">remove</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">iter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">)</span></pre></div></div><p><span class="yiyi-st" id="yiyi-164">&#x7531;&#x4E8E;<code class="docutils literal"><span class="pre">append</span></code>&#xFF0C;&#x8FD9;&#x4E2A;&#x7C7B;&#x770B;&#x8D77;&#x6765;&#x50CF;&#x5217;&#x8868;&#x4E00;&#x6837;&#xFF0C;&#x4F46;&#x662F;<code class="docutils literal"><span class="pre">__emulates__</span></code>&#x5F3A;&#x5236;&#x5B83;&#x8BBE;&#x7F6E;&#x4E3A;&#x7C7B;&#x4F3C;&#x7684;&#x3002;</span><span class="yiyi-st" id="yiyi-165"><code class="docutils literal"><span class="pre">remove</span></code>&#x5DF2;&#x77E5;&#x662F;&#x8BBE;&#x7F6E;&#x754C;&#x9762;&#x7684;&#x4E00;&#x90E8;&#x5206;&#xFF0C;&#x5E76;&#x5C06;&#x8FDB;&#x884C;&#x68C0;&#x6D4B;&#x3002;</span></p><p><span class="yiyi-st" id="yiyi-166">&#x4F46;&#x662F;&#x8FD9;&#x4E2A;&#x7C7B;&#x8FD8;&#x4E0D;&#x884C;&#xFF1A;&#x9700;&#x8981;&#x4E00;&#x70B9;&#x70B9;&#x7C98;&#x5408;&#x5242;&#x624D;&#x80FD;&#x9002;&#x5E94;SQLAlchemy&#x7684;&#x4F7F;&#x7528;&#x3002;</span><span class="yiyi-st" id="yiyi-167">ORM&#x9700;&#x8981;&#x77E5;&#x9053;&#x4F7F;&#x7528;&#x54EA;&#x4E9B;&#x65B9;&#x6CD5;&#x6765;&#x8FFD;&#x52A0;&#xFF0C;&#x5220;&#x9664;&#x548C;&#x8FED;&#x4EE3;&#x96C6;&#x5408;&#x7684;&#x6210;&#x5458;&#x3002;</span><span class="yiyi-st" id="yiyi-168">&#x5F53;&#x4F7F;&#x7528;&#x50CF;<code class="docutils literal"><span class="pre">list</span></code>&#x6216;<code class="docutils literal"><span class="pre">set</span></code>&#x8FD9;&#x6837;&#x7684;&#x7C7B;&#x578B;&#x65F6;&#xFF0C;&#x9002;&#x5F53;&#x7684;&#x65B9;&#x6CD5;&#x662F;&#x4F17;&#x6240;&#x5468;&#x77E5;&#x7684;&#xFF0C;&#x5E76;&#x5728;&#x51FA;&#x73B0;&#x65F6;&#x81EA;&#x52A8;&#x4F7F;&#x7528;&#x3002;</span><span class="yiyi-st" id="yiyi-169">&#x8FD9;&#x4E2A;&#x96C6;&#x5408;&#x7C7B;&#x6CA1;&#x6709;&#x63D0;&#x4F9B;&#x9884;&#x671F;&#x7684;<code class="docutils literal"><span class="pre">add</span></code>&#x65B9;&#x6CD5;&#xFF0C;&#x56E0;&#x6B64;&#x6211;&#x4EEC;&#x5FC5;&#x987B;&#x901A;&#x8FC7;&#x88C5;&#x9970;&#x5668;&#x4E3A;ORM&#x63D0;&#x4F9B;&#x663E;&#x5F0F;&#x6620;&#x5C04;&#x3002;</span></p><div class="section" id="annotating-custom-collections-via-decorators"><h3><span class="yiyi-st" id="yiyi-170">&#x901A;&#x8FC7;&#x88C5;&#x9970;&#x5668;&#x6CE8;&#x91CA;&#x81EA;&#x5B9A;&#x4E49;&#x96C6;&#x5408;<a class="headerlink" href="#annotating-custom-collections-via-decorators" title="Permalink to this headline">&#xB6;</a></span></h3><p><span class="yiyi-st" id="yiyi-171">&#x88C5;&#x9970;&#x5668;&#x53EF;&#x7528;&#x4E8E;&#x6807;&#x8BB0;ORM&#x7BA1;&#x7406;&#x96C6;&#x5408;&#x6240;&#x9700;&#x7684;&#x5404;&#x79CD;&#x65B9;&#x6CD5;&#x3002;</span><span class="yiyi-st" id="yiyi-172">&#x5F53;&#x4F60;&#x7684;&#x8BFE;&#x5802;&#x5E76;&#x4E0D;&#x5B8C;&#x5168;&#x6EE1;&#x8DB3;&#x5176;&#x5BB9;&#x5668;&#x7C7B;&#x578B;&#x7684;&#x5E38;&#x89C4;&#x754C;&#x9762;&#xFF0C;&#x6216;&#x8005;&#x4F60;&#x60F3;&#x7528;&#x53E6;&#x4E00;&#x79CD;&#x65B9;&#x6CD5;&#x5B8C;&#x6210;&#x5DE5;&#x4F5C;&#x65F6;&#x4F7F;&#x7528;&#x5B83;&#x4EEC;&#x3002;</span></p><div class="highlight-python+sql"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sqlalchemy.orm.collections</span> <span class="kn">import</span> <span class="n">collection</span>

<span class="k">class</span> <span class="nc">SetLike</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="n">__emulates__</span> <span class="o">=</span> <span class="nb">set</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>

    <span class="nd">@collection.appender</span>
    <span class="k">def</span> <span class="nf">append</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">remove</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">iter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">)</span></pre></div></div><p><span class="yiyi-st" id="yiyi-173">&#x8FD9;&#x5C31;&#x662F;&#x5B8C;&#x6210;&#x8FD9;&#x4E2A;&#x4F8B;&#x5B50;&#x6240;&#x9700;&#x8981;&#x7684;&#x4E00;&#x5207;&#x3002;</span><span class="yiyi-st" id="yiyi-174">SQLAlchemy&#x5C06;&#x901A;&#x8FC7;<code class="docutils literal"><span class="pre">append</span></code>&#x65B9;&#x6CD5;&#x6DFB;&#x52A0;&#x5B9E;&#x4F8B;&#x3002;</span><span class="yiyi-st" id="yiyi-175"><code class="docutils literal"><span class="pre">remove</span></code>&#x548C;<code class="docutils literal"><span class="pre">__iter__</span></code>&#x662F;&#x96C6;&#x5408;&#x7684;&#x9ED8;&#x8BA4;&#x65B9;&#x6CD5;&#xFF0C;&#x5C06;&#x7528;&#x4E8E;&#x5220;&#x9664;&#x548C;&#x8FED;&#x4EE3;&#x3002;</span><span class="yiyi-st" id="yiyi-176">&#x7F3A;&#x7701;&#x65B9;&#x6CD5;&#x4E5F;&#x53EF;&#x4EE5;&#x66F4;&#x6539;&#xFF1A;</span></p><div class="highlight-python+sql"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sqlalchemy.orm.collections</span> <span class="kn">import</span> <span class="n">collection</span>

<span class="k">class</span> <span class="nc">MyList</span><span class="p">(</span><span class="nb">list</span><span class="p">):</span>
    <span class="nd">@collection.remover</span>
    <span class="k">def</span> <span class="nf">zark</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">):</span>
        <span class="c1"># do something special...</span>

    <span class="nd">@collection.iterator</span>
    <span class="k">def</span> <span class="nf">hey_use_this_instead_for_iteration</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># ...</span></pre></div></div><p><span class="yiyi-st" id="yiyi-177">&#x6CA1;&#x6709;&#x8981;&#x6C42;&#x6210;&#x4E3A;&#x540D;&#x5355;&#xFF0C;&#x6216;&#x8005;&#x6839;&#x672C;&#x4E0D;&#x9700;&#x8981;&#x8BBE;&#x7F6E;&#x3002;</span><span class="yiyi-st" id="yiyi-178">&#x96C6;&#x5408;&#x7C7B;&#x53EF;&#x4EE5;&#x662F;&#x4EFB;&#x4F55;&#x5F62;&#x72B6;&#xFF0C;&#x53EA;&#x8981;&#x5B83;&#x4EEC;&#x5177;&#x6709;&#x6807;&#x8BB0;&#x4E3A;SQLAlchemy&#x4F7F;&#x7528;&#x7684;append&#xFF0C;remove&#x548C;iterate&#x63A5;&#x53E3;&#x5373;&#x53EF;&#x3002;</span><span class="yiyi-st" id="yiyi-179">&#x5C06;&#x4F7F;&#x7528;&#x6620;&#x5C04;&#x5B9E;&#x4F53;&#x4F5C;&#x4E3A;&#x5355;&#x4E2A;&#x53C2;&#x6570;&#x8C03;&#x7528;Append&#x548C;Remove&#x65B9;&#x6CD5;&#xFF0C;&#x5E76;&#x4E14;&#x4E0D;&#x5E26;&#x4EFB;&#x4F55;&#x53C2;&#x6570;&#x8C03;&#x7528;&#x8FED;&#x4EE3;&#x5668;&#x65B9;&#x6CD5;&#xFF0C;&#x5E76;&#x4E14;&#x5FC5;&#x987B;&#x8FD4;&#x56DE;&#x4E00;&#x4E2A;&#x8FED;&#x4EE3;&#x5668;&#x3002;</span></p><dl class="class"><dt id="sqlalchemy.orm.collections.collection"><span class="yiyi-st" id="yiyi-180"><em class="property">class</em> <code class="descclassname">sqlalchemy.orm.collections&#x3002;</code> <code class="descname">&#x96C6;&#x5408;</code> <a class="headerlink" href="#sqlalchemy.orm.collections.collection" title="Permalink to this definition">&#xB6;</a></span></dt><dd><p><span class="yiyi-st" id="yiyi-181">&#x5B9E;&#x4F53;&#x96C6;&#x5408;&#x7C7B;&#x7684;&#x88C5;&#x9970;&#x5668;&#x3002;</span></p><p><span class="yiyi-st" id="yiyi-182">&#x88C5;&#x9970;&#x8005;&#x5206;&#x4E3A;&#x4E24;&#x7EC4;&#xFF1A;&#x6CE8;&#x91CA;&#x548C;&#x622A;&#x53D6;&#x98DF;&#x8C31;&#x3002;</span></p><p><span class="yiyi-st" id="yiyi-183">&#x6CE8;&#x91CA;&#x88C5;&#x9970;&#x5668;&#xFF08;appender&#xFF0C;remover&#xFF0C;iterator&#xFF0C;linker&#xFF0C;converter&#xFF0C;inward_instrumented&#xFF09;&#x8868;&#x793A;&#x65B9;&#x6CD5;&#x7684;&#x7528;&#x9014;&#x5E76;&#x4E14;&#x4E0D;&#x5E26;&#x4EFB;&#x4F55;&#x53C2;&#x6570;&#x3002;</span><span class="yiyi-st" id="yiyi-184">&#x4ED6;&#x4EEC;&#x4E0D;&#x662F;&#x4E0E;parens&#x5199;&#x7684;&#xFF1A;</span></p><div class="highlight-python"><div class="highlight"><pre><span></span><span class="nd">@collection.appender</span>
<span class="k">def</span> <span class="nf">append</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">append</span><span class="p">):</span> <span class="o">...</span></pre></div></div><p><span class="yiyi-st" id="yiyi-185">&#x914D;&#x65B9;&#x88C5;&#x9970;&#x5668;&#x90FD;&#x9700;&#x8981;parens&#xFF0C;&#x5373;&#x4F7F;&#x90A3;&#x4E9B;&#x6CA1;&#x6709;&#x53C2;&#x6570;&#x7684;&#x914D;&#x7F6E;&#xFF1A;</span></p><div class="highlight-python"><div class="highlight"><pre><span></span><span class="nd">@collection.adds</span><span class="p">(</span><span class="s1">&apos;entity&apos;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">insert</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">position</span><span class="p">,</span> <span class="n">entity</span><span class="p">):</span> <span class="o">...</span>

<span class="nd">@collection.removes_return</span><span class="p">()</span>
<span class="k">def</span> <span class="nf">popitem</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="o">...</span></pre></div></div><dl class="staticmethod"><dt id="sqlalchemy.orm.collections.collection.adds"><span class="yiyi-st" id="yiyi-186"><em class="property">&#x9759;&#x6001; tt&gt; <code class="descname">&#x589E;&#x52A0;</code> <span class="sig-paren">&#xFF08;</span> <em>arg</em> <span class="sig-paren">&#xFF09;</span> <a class="headerlink" href="#sqlalchemy.orm.collections.collection.adds" title="Permalink to this definition"></a></em></span></dt><dd><p><span class="yiyi-st" id="yiyi-187">&#x5C06;&#x8BE5;&#x65B9;&#x6CD5;&#x6807;&#x8BB0;&#x4E3A;&#x5C06;&#x5B9E;&#x4F53;&#x6DFB;&#x52A0;&#x5230;&#x96C6;&#x5408;&#x4E2D;&#x3002;</span></p><p><span class="yiyi-st" id="yiyi-188">&#x5411;&#x8BE5;&#x65B9;&#x6CD5;&#x6DFB;&#x52A0;&#x201C;&#x6DFB;&#x52A0;&#x5230;&#x96C6;&#x5408;&#x201D;&#x5904;&#x7406;&#x3002;</span><span class="yiyi-st" id="yiyi-189">decorator&#x53C2;&#x6570;&#x6307;&#x793A;&#x54EA;&#x4E2A;&#x65B9;&#x6CD5;&#x53C2;&#x6570;&#x4FDD;&#x5B58;&#x4E0E;SQLAlchemy&#x76F8;&#x5173;&#x7684;&#x503C;&#x3002;</span><span class="yiyi-st" id="yiyi-190">&#x53C2;&#x6570;&#x53EF;&#x4EE5;&#x5728;&#x4F4D;&#x7F6E;&#x4E0A;&#x6307;&#x5B9A;&#xFF08;&#x5373;&#x6574;&#x6570;&#xFF09;&#x6216;&#x6309;&#x540D;&#x79F0;&#x6307;&#x5B9A;&#xFF1A;</span></p><div class="highlight-python"><div class="highlight"><pre><span></span><span class="nd">@collection.adds</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">push</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">):</span> <span class="o">...</span>

<span class="nd">@collection.adds</span><span class="p">(</span><span class="s1">&apos;entity&apos;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">do_stuff</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">thing</span><span class="p">,</span> <span class="n">entity</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span> <span class="o">...</span></pre></div></div></dd></dl><dl class="staticmethod"><dt id="sqlalchemy.orm.collections.collection.appender"><span class="yiyi-st" id="yiyi-191"><em class="property">&#x9759;&#x6001; tt&gt; <code class="descname">appender</code> <span class="sig-paren">&#xFF08;</span> <em>fn</em> <span class="sig-paren">&#xFF09;</span> <a class="headerlink" href="#sqlalchemy.orm.collections.collection.appender" title="Permalink to this definition"></a></em></span></dt><dd><p><span class="yiyi-st" id="yiyi-192">&#x5C06;&#x8BE5;&#x65B9;&#x6CD5;&#x6807;&#x8BB0;&#x4E3A;&#x6536;&#x96C6;appender&#x3002;</span></p><p><span class="yiyi-st" id="yiyi-193">&#x4F7F;&#x7528;&#x4E00;&#x4E2A;&#x4F4D;&#x7F6E;&#x53C2;&#x6570;&#x8C03;&#x7528;appender&#x65B9;&#x6CD5;&#xFF1A;&#x8981;&#x9644;&#x52A0;&#x7684;&#x503C;&#x3002;</span><span class="yiyi-st" id="yiyi-194">&#x5982;&#x679C;&#x5C1A;&#x672A;&#x88C5;&#x9970;&#xFF0C;&#x8BE5;&#x65B9;&#x6CD5;&#x5C06;&#x81EA;&#x52A8;&#x7528;&apos;adds&#xFF08;1&#xFF09;&apos;&#x88C5;&#x9970;&#xFF1A;</span></p><div class="highlight-python"><div class="highlight"><pre><span></span><span class="nd">@collection.appender</span>
<span class="k">def</span> <span class="nf">add</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">append</span><span class="p">):</span> <span class="o">...</span>

<span class="c1"># or, equivalently</span>
<span class="nd">@collection.appender</span>
<span class="nd">@collection.adds</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">add</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">append</span><span class="p">):</span> <span class="o">...</span>

<span class="c1"># for mapping type, an &apos;append&apos; may kick out a previous value</span>
<span class="c1"># that occupies that slot.  consider d[&apos;a&apos;] = &apos;foo&apos;- any previous</span>
<span class="c1"># value in d[&apos;a&apos;] is discarded.</span>
<span class="nd">@collection.appender</span>
<span class="nd">@collection.replaces</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">add</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">entity</span><span class="p">):</span>
    <span class="n">key</span> <span class="o">=</span> <span class="n">some_key_func</span><span class="p">(</span><span class="n">entity</span><span class="p">)</span>
    <span class="n">previous</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
        <span class="n">previous</span> <span class="o">=</span> <span class="bp">self</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
    <span class="bp">self</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">entity</span>
    <span class="k">return</span> <span class="n">previous</span></pre></div></div><p><span class="yiyi-st" id="yiyi-195">&#x5982;&#x679C;&#x96C6;&#x5408;&#x4E2D;&#x4E0D;&#x5141;&#x8BB8;&#x9644;&#x52A0;&#x503C;&#xFF0C;&#x5219;&#x53EF;&#x80FD;&#x5F15;&#x53D1;&#x5F02;&#x5E38;&#x3002;</span><span class="yiyi-st" id="yiyi-196">&#x9700;&#x8981;&#x8BB0;&#x4F4F;&#x7684;&#x662F;appender&#x5C06;&#x88AB;&#x6570;&#x636E;&#x5E93;&#x67E5;&#x8BE2;&#x6620;&#x5C04;&#x7684;&#x6BCF;&#x4E2A;&#x5BF9;&#x8C61;&#x8C03;&#x7528;&#x3002;</span><span class="yiyi-st" id="yiyi-197">&#x5982;&#x679C;&#x6570;&#x636E;&#x5E93;&#x5305;&#x542B;&#x8FDD;&#x53CD;&#x96C6;&#x5408;&#x8BED;&#x4E49;&#x7684;&#x884C;&#xFF0C;&#x5219;&#x9700;&#x8981;&#x6709;&#x521B;&#x610F;&#x624D;&#x80FD;&#x89E3;&#x51B3;&#x8BE5;&#x95EE;&#x9898;&#xFF0C;&#x56E0;&#x4E3A;&#x901A;&#x8FC7;&#x96C6;&#x5408;&#x8FDB;&#x884C;&#x8BBF;&#x95EE;&#x5C06;&#x4E0D;&#x8D77;&#x4F5C;&#x7528;&#x3002;</span></p><p><span class="yiyi-st" id="yiyi-198">&#x5982;&#x679C;appender&#x65B9;&#x6CD5;&#x5728;&#x5185;&#x90E8;&#x8FDB;&#x884C;&#x68C0;&#x6D4B;&#xFF0C;&#x5219;&#x8FD8;&#x5FC5;&#x987B;&#x63A5;&#x6536;&#x5173;&#x952E;&#x5B57;&#x53C2;&#x6570;&apos;_sa_initiator&apos;&#x5E76;&#x786E;&#x4FDD;&#x5C06;&#x5176;&#x9881;&#x53D1;&#x7ED9;&#x6536;&#x96C6;&#x4E8B;&#x4EF6;&#x3002;</span></p></dd></dl><dl class="staticmethod"><dt id="sqlalchemy.orm.collections.collection.converter"><span class="yiyi-st" id="yiyi-199"> <em class="property">static </em><code class="descname">converter</code><span class="sig-paren">(</span><em>fn</em><span class="sig-paren">)</span><a class="headerlink" href="#sqlalchemy.orm.collections.collection.converter" title="Permalink to this definition">&#xB6;</a></span></dt><dd><p><span class="yiyi-st" id="yiyi-200">&#x5C06;&#x65B9;&#x6CD5;&#x6807;&#x8BB0;&#x4E3A;&#x6536;&#x96C6;&#x8F6C;&#x6362;&#x5668;&#x3002;</span></p><p><span class="yiyi-st" id="yiyi-201">&#x5F53;&#x4E00;&#x4E2A;&#x96C6;&#x5408;&#x88AB;&#x5B8C;&#x5168;&#x66FF;&#x6362;&#x65F6;&#xFF0C;&#x8FD9;&#x4E2A;&#x53EF;&#x9009;&#x65B9;&#x6CD5;&#x5C06;&#x88AB;&#x8C03;&#x7528;&#xFF0C;&#x5982;&#x4E0B;&#x6240;&#x793A;&#xFF1A;</span></p><div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">myobj</span><span class="o">.</span><span class="n">acollection</span> <span class="o">=</span> <span class="p">[</span><span class="n">newvalue1</span><span class="p">,</span> <span class="n">newvalue2</span><span class="p">]</span></pre></div></div><p><span class="yiyi-st" id="yiyi-202">&#x8F6C;&#x6362;&#x5668;&#x65B9;&#x6CD5;&#x5C06;&#x63A5;&#x6536;&#x6B63;&#x5728;&#x5206;&#x914D;&#x7684;&#x5BF9;&#x8C61;&#xFF0C;&#x5E76;&#x4E14;&#x5E94;&#x8BE5;&#x8FD4;&#x56DE;&#x4E00;&#x4E2A;&#x9002;&#x7528;&#x4E8E;<code class="docutils literal"><span class="pre">appender</span></code>&#x65B9;&#x6CD5;&#x7684;&#x53EF;&#x8FED;&#x4EE3;&#x503C;&#x3002;</span><span class="yiyi-st" id="yiyi-203">&#x8F6C;&#x6362;&#x5668;&#x4E0D;&#x5F97;&#x5206;&#x914D;&#x503C;&#x6216;&#x6539;&#x53D8;&#x96C6;&#x5408;&#xFF0C;&#x5B83;&#x552F;&#x4E00;&#x7684;&#x5DE5;&#x4F5C;&#x5C31;&#x662F;&#x5C06;&#x7528;&#x6237;&#x63D0;&#x4F9B;&#x7684;&#x503C;&#x8C03;&#x6574;&#x4E3A;ORM&#x4F7F;&#x7528;&#x7684;&#x53EF;&#x8FED;&#x4EE3;&#x503C;&#x3002;</span></p><p><span class="yiyi-st" id="yiyi-204">&#x9ED8;&#x8BA4;&#x7684;&#x8F6C;&#x6362;&#x5668;&#x5B9E;&#x73B0;&#x5C06;&#x4F7F;&#x7528;&#x9E2D;&#x5B50;&#x952E;&#x5165;&#x8FDB;&#x884C;&#x8F6C;&#x6362;&#x3002;</span><span class="yiyi-st" id="yiyi-205">&#x7C7B;&#x4F3C;dict&#x7684;&#x96C6;&#x5408;&#x5C06;&#x88AB;&#x8F6C;&#x6362;&#x4E3A;&#x5B57;&#x5178;&#x503C;&#x7684;&#x8FED;&#x4EE3;&#xFF0C;&#x800C;&#x5176;&#x4ED6;&#x7C7B;&#x578B;&#x5C06;&#x88AB;&#x7B80;&#x5355;&#x5730;&#x8FED;&#x4EE3;&#xFF1A;</span></p><div class="highlight-python"><div class="highlight"><pre><span></span><span class="nd">@collection.converter</span>
<span class="k">def</span> <span class="nf">convert</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span> <span class="o">...</span></pre></div></div><p><span class="yiyi-st" id="yiyi-206">&#x5982;&#x679C;&#x5BF9;&#x8C61;&#x7684;&#x9E2D;&#x5F0F;&#x952E;&#x5165;&#x4E0E;&#x6B64;&#x96C6;&#x5408;&#x7684;&#x7C7B;&#x578B;&#x4E0D;&#x5339;&#x914D;&#xFF0C;&#x5219;&#x4F1A;&#x5F15;&#x53D1;TypeError&#x3002;</span></p><p><span class="yiyi-st" id="yiyi-207">&#x5982;&#x679C;&#x8981;&#x6269;&#x5C55;&#x53EF;&#x4EE5;&#x6279;&#x91CF;&#x5206;&#x914D;&#x7684;&#x53EF;&#x80FD;&#x7C7B;&#x578B;&#x7684;&#x8303;&#x56F4;&#x6216;&#x5BF9;&#x8981;&#x5206;&#x914D;&#x7684;&#x503C;&#x6267;&#x884C;&#x9A8C;&#x8BC1;&#xFF0C;&#x8BF7;&#x63D0;&#x4F9B;&#x6B64;&#x65B9;&#x6CD5;&#x7684;&#x5B9E;&#x73B0;&#x3002;</span></p></dd></dl><dl class="staticmethod"><dt id="sqlalchemy.orm.collections.collection.internally_instrumented"><span class="yiyi-st" id="yiyi-208"><em class="property">static</em> <code class="descname">within_instrumented</code> <span class="sig-paren">&#xFF08;</span> <em>fn</em> <span class="sig-paren">&#xFF09;</span> <a class="headerlink" href="#sqlalchemy.orm.collections.collection.internally_instrumented" title="Permalink to this definition"></a></span></dt><dd><p><span class="yiyi-st" id="yiyi-209">&#x6309;&#x7167;&#x4EEA;&#x5668;&#x6807;&#x8BB0;&#x65B9;&#x6CD5;&#x3002;</span></p><p><span class="yiyi-st" id="yiyi-210">&#x8FD9;&#x4E2A;&#x6807;&#x7B7E;&#x5C06;&#x9632;&#x6B62;&#x4EFB;&#x4F55;&#x88C5;&#x9970;&#x88AB;&#x5E94;&#x7528;&#x4E8E;&#x8BE5;&#x65B9;&#x6CD5;&#x3002;</span><span class="yiyi-st" id="yiyi-211">&#x5982;&#x679C;&#x60A8;&#x6B63;&#x5728;&#x4F7F;&#x7528;&#x57FA;&#x672C;&#x7684;SQLAlchemy&#x63A5;&#x53E3;&#x65B9;&#x6CD5;&#x4E4B;&#x4E00;&#x7F16;&#x6392;&#x60A8;&#x81EA;&#x5DF1;&#x5BF9;<code class="xref py py-func docutils literal"><span class="pre">collection_adapter()</span></code>&#x7684;&#x8C03;&#x7528;&#xFF0C;&#x6216;&#x8005;&#x963B;&#x6B62;&#x81EA;&#x52A8;&#x7684;ABC&#x65B9;&#x6CD5;&#x4FEE;&#x9970;&#x5C01;&#x88C5;&#x60A8;&#x7684;&#x5B9E;&#x73B0;&#xFF0C;&#x8BF7;&#x4F7F;&#x7528;&#x6B64;&#x65B9;&#x6CD5;&#xFF1A;</span></p><div class="highlight-python"><div class="highlight"><pre><span></span><span class="c1"># normally an &apos;extend&apos; method on a list-like class would be</span>
<span class="c1"># automatically intercepted and re-implemented in terms of</span>
<span class="c1"># SQLAlchemy events and append().  your implementation will</span>
<span class="c1"># never be called, unless:</span>
<span class="nd">@collection.internally_instrumented</span>
<span class="k">def</span> <span class="nf">extend</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">items</span><span class="p">):</span> <span class="o">...</span></pre></div></div></dd></dl><dl class="staticmethod"><dt id="sqlalchemy.orm.collections.collection.iterator"><span class="yiyi-st" id="yiyi-212"><em class="property">&#x9759;&#x6001; tt&gt; <code class="descname">&#x8FED;&#x4EE3;&#x5668;</code> <span class="sig-paren">&#xFF08;</span> <em>fn</em> <span class="sig-paren">&#xFF09;</span> <a class="headerlink" href="#sqlalchemy.orm.collections.collection.iterator" title="Permalink to this definition">&#xB6;</a></em></span></dt><dd><p><span class="yiyi-st" id="yiyi-213">&#x5C06;&#x65B9;&#x6CD5;&#x6807;&#x8BB0;&#x4E3A;&#x6536;&#x96C6;&#x5378;&#x5986;&#x3002;</span></p><p><span class="yiyi-st" id="yiyi-214">&#x8FED;&#x4EE3;&#x5668;&#x65B9;&#x6CD5;&#x88AB;&#x8C03;&#x7528;&#x65F6;&#x6CA1;&#x6709;&#x53C2;&#x6570;&#x3002;</span><span class="yiyi-st" id="yiyi-215">&#x9884;&#x8BA1;&#x4F1A;&#x8FD4;&#x56DE;&#x6240;&#x6709;&#x96C6;&#x5408;&#x6210;&#x5458;&#x7684;&#x8FED;&#x4EE3;&#x5668;&#xFF1A;</span></p><div class="highlight-python"><div class="highlight"><pre><span></span><span class="nd">@collection.iterator</span>
<span class="k">def</span> <span class="nf">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="o">...</span></pre></div></div></dd></dl><dl class="staticmethod"><dt id="sqlalchemy.orm.collections.collection.link"><span class="yiyi-st" id="yiyi-216"><em class="property">&#x9759;&#x6001; tt&gt; <code class="descname">&#x94FE;&#x63A5;</code> <span class="sig-paren">&#xFF08;</span> <em>fn</em> <span class="sig-paren">&#xFF09;</span> <a class="headerlink" href="#sqlalchemy.orm.collections.collection.link" title="Permalink to this definition">&#xB6;</a></em></span></dt><dd><p><span class="yiyi-st" id="yiyi-217">&#x5F03;&#x7528;&#xFF1B; <a class="reference internal" href="#sqlalchemy.orm.collections.collection.linker" title="sqlalchemy.orm.collections.collection.linker"><code class="xref py py-meth docutils literal"><span class="pre">collection.linker()</span></code></a>&#x7684;&#x540C;&#x4E49;&#x8BCD;&#x3002;</span></p></dd></dl><dl class="staticmethod"><dt id="sqlalchemy.orm.collections.collection.linker"><span class="yiyi-st" id="yiyi-218"><em class="property">&#x9759;&#x6001; tt&gt; <code class="descname">&#x94FE;&#x63A5;&#x5668;</code> <span class="sig-paren">&#xFF08;</span> <em>fn</em> <span class="sig-paren">&#xFF09;</span> <a class="headerlink" href="#sqlalchemy.orm.collections.collection.linker" title="Permalink to this definition"></a></em></span></dt><dd><p><span class="yiyi-st" id="yiyi-219">&#x5C06;&#x8BE5;&#x65B9;&#x6CD5;&#x6807;&#x8BB0;&#x4E3A;&#x201C;&#x94FE;&#x63A5;&#x5230;&#x5C5E;&#x6027;&#x201D;&#x4E8B;&#x4EF6;&#x5904;&#x7406;&#x7A0B;&#x5E8F;&#x3002;</span></p><p><span class="yiyi-st" id="yiyi-220">&#x5F53;&#x96C6;&#x5408;&#x7C7B;&#x4E0E;InstrumentedAttribute&#x94FE;&#x63A5;&#x6216;&#x65AD;&#x5F00;&#x94FE;&#x63A5;&#x65F6;&#xFF0C;&#x5C06;&#x8C03;&#x7528;&#x6B64;&#x53EF;&#x9009;&#x4E8B;&#x4EF6;&#x5904;&#x7406;&#x7A0B;&#x5E8F;&#x3002;</span><span class="yiyi-st" id="yiyi-221">&#x5B83;&#x5728;&#x5B9E;&#x4F8B;&#x4E0A;&#x8BBE;&#x7F6E;&apos;_sa_adapter&apos;&#x5C5E;&#x6027;&#x540E;&#x7ACB;&#x5373;&#x8C03;&#x7528;&#x3002;</span><span class="yiyi-st" id="yiyi-222">&#x4F20;&#x9012;&#x4E00;&#x4E2A;&#x53C2;&#x6570;&#xFF1A;&#x94FE;&#x63A5;&#x7684;&#x96C6;&#x5408;&#x9002;&#x914D;&#x5668;&#xFF1B;&#x5982;&#x679C;&#x89E3;&#x9664;&#x94FE;&#x63A5;&#xFF0C;&#x5219;&#x8FD4;&#x56DE;None&#x3002;</span></p><div class="deprecated"><p><span class="yiyi-st" id="yiyi-223"><span class="versionmodified">&#x4ECE;&#x7248;&#x672C;1.0.0&#x5F00;&#x59CB;&#x5F03;&#x7528;&#xFF1A;</span>  -  <a class="reference internal" href="#sqlalchemy.orm.collections.collection.linker" title="sqlalchemy.orm.collections.collection.linker"><code class="xref py py-meth docutils literal"><span class="pre">collection.linker()</span></code></a>&#x5904;&#x7406;&#x7A0B;&#x5E8F;&#x88AB;<a class="reference internal" href="events.html#sqlalchemy.orm.events.AttributeEvents.init_collection" title="sqlalchemy.orm.events.AttributeEvents.init_collection"><code class="xref py py-meth docutils literal"><span class="pre">AttributeEvents.init_collection()</span></code></a>&#x548C;<a class="reference internal" href="events.html#sqlalchemy.orm.events.AttributeEvents.dispose_collection" title="sqlalchemy.orm.events.AttributeEvents.dispose_collection"><code class="xref py py-meth docutils literal"><span class="pre">AttributeEvents.dispose_collection()</span></code></a>&#x5904;&#x7406;&#x7A0B;&#x5E8F;&#x3002;</span></p></div></dd></dl><dl class="staticmethod"><dt id="sqlalchemy.orm.collections.collection.remover"><span class="yiyi-st" id="yiyi-224"><em class="property">&#x9759;&#x6001; T0&gt; <code class="descname">&#x5378;&#x5986; T1&gt; <span class="sig-paren">&#xFF08; T2&gt; <em> FN  T3&gt; <span class="sig-paren">&#xFF09; T4&gt; <a class="headerlink" href="#sqlalchemy.orm.collections.collection.remover" title="Permalink to this definition">&#xB6; T5&gt;</a></span></em></span></code></em></span></dt><dd><p><span class="yiyi-st" id="yiyi-225">&#x5C06;&#x65B9;&#x6CD5;&#x6807;&#x8BB0;&#x4E3A;&#x6536;&#x96C6;&#x5378;&#x5986;&#x3002;</span></p><p><span class="yiyi-st" id="yiyi-226">&#x4F7F;&#x7528;&#x4E00;&#x4E2A;&#x4F4D;&#x7F6E;&#x53C2;&#x6570;&#x8C03;&#x7528;&#x79FB;&#x9664;&#x65B9;&#x6CD5;&#xFF1A;&#x8981;&#x79FB;&#x9664;&#x7684;&#x503C;&#x3002;</span><span class="yiyi-st" id="yiyi-227">&#x5982;&#x679C;&#x5C1A;&#x672A;&#x88C5;&#x9970;&#xFF0C;&#x8BE5;&#x65B9;&#x6CD5;&#x5C06;&#x81EA;&#x52A8;&#x7528;<a class="reference internal" href="#sqlalchemy.orm.collections.collection.removes_return" title="sqlalchemy.orm.collections.collection.removes_return"><code class="xref py py-meth docutils literal"><span class="pre">removes_return()</span></code></a>&#x8FDB;&#x884C;&#x4FEE;&#x9970;&#xFF1A;</span></p><div class="highlight-python"><div class="highlight"><pre><span></span><span class="nd">@collection.remover</span>
<span class="k">def</span> <span class="nf">zap</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">entity</span><span class="p">):</span> <span class="o">...</span>

<span class="c1"># or, equivalently</span>
<span class="nd">@collection.remover</span>
<span class="nd">@collection.removes_return</span><span class="p">()</span>
<span class="k">def</span> <span class="nf">zap</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="p">):</span> <span class="o">...</span></pre></div></div><p><span class="yiyi-st" id="yiyi-228">&#x5982;&#x679C;&#x8981;&#x5220;&#x9664;&#x7684;&#x503C;&#x5728;&#x96C6;&#x5408;&#x4E2D;&#x4E0D;&#x5B58;&#x5728;&#xFF0C;&#x5219;&#x53EF;&#x4EE5;&#x5F15;&#x53D1;&#x5F02;&#x5E38;&#x6216;&#x8FD4;&#x56DE;&#x65E0;&#x4EE5;&#x5FFD;&#x7565;&#x8BE5;&#x9519;&#x8BEF;&#x3002;</span></p><p><span class="yiyi-st" id="yiyi-229">&#x5982;&#x679C;remove&#x65B9;&#x6CD5;&#x5728;&#x5185;&#x90E8;&#x8FDB;&#x884C;&#x68C0;&#x6D4B;&#xFF0C;&#x5219;&#x8FD8;&#x5FC5;&#x987B;&#x63A5;&#x6536;&#x5173;&#x952E;&#x5B57;&#x53C2;&#x6570;&apos;_sa_initiator&apos;&#x5E76;&#x786E;&#x4FDD;&#x5C06;&#x5176;&#x9881;&#x53D1;&#x7ED9;&#x6536;&#x96C6;&#x4E8B;&#x4EF6;&#x3002;</span></p></dd></dl><dl class="staticmethod"><dt id="sqlalchemy.orm.collections.collection.removes"><span class="yiyi-st" id="yiyi-230"><em class="property">static</em> <code class="descname">&#x79FB;&#x9664;</code> <span class="sig-paren">&#xFF08;</span> <em>arg</em> <span class="sig-paren">&#xFF09;</span> <a class="headerlink" href="#sqlalchemy.orm.collections.collection.removes" title="Permalink to this definition">&#xB6;</a></span></dt><dd><p><span class="yiyi-st" id="yiyi-231">&#x5C06;&#x8BE5;&#x65B9;&#x6CD5;&#x6807;&#x8BB0;&#x4E3A;&#x5220;&#x9664;&#x96C6;&#x5408;&#x4E2D;&#x7684;&#x5B9E;&#x4F53;&#x3002;</span></p><p><span class="yiyi-st" id="yiyi-232">&#x5411;&#x65B9;&#x6CD5;&#x6DFB;&#x52A0;&#x201C;&#x4ECE;&#x96C6;&#x5408;&#x4E2D;&#x5220;&#x9664;&#x201D;&#x5904;&#x7406;&#x3002;</span><span class="yiyi-st" id="yiyi-233">decorator&#x53C2;&#x6570;&#x6307;&#x793A;&#x54EA;&#x4E2A;&#x65B9;&#x6CD5;&#x53C2;&#x6570;&#x4FDD;&#x5B58;&#x8981;&#x5220;&#x9664;&#x7684;&#x4E0E;SQLAlchemy&#x76F8;&#x5173;&#x7684;&#x503C;&#x3002;</span><span class="yiyi-st" id="yiyi-234">&#x53C2;&#x6570;&#x53EF;&#x4EE5;&#x5728;&#x4F4D;&#x7F6E;&#x4E0A;&#x6307;&#x5B9A;&#xFF08;&#x5373;&#x6574;&#x6570;&#xFF09;&#x6216;&#x6309;&#x540D;&#x79F0;&#x6307;&#x5B9A;&#xFF1A;</span></p><div class="highlight-python"><div class="highlight"><pre><span></span><span class="nd">@collection.removes</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">zap</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">):</span> <span class="o">...</span></pre></div></div><p><span class="yiyi-st" id="yiyi-235">&#x5BF9;&#x4E8E;&#x5728;&#x8C03;&#x7528;&#x65F6;&#x672A;&#x77E5;&#x79FB;&#x9664;&#x503C;&#x7684;&#x65B9;&#x6CD5;&#xFF0C;&#x8BF7;&#x4F7F;&#x7528;collection.removes_return&#x3002;</span></p></dd></dl><dl class="staticmethod"><dt id="sqlalchemy.orm.collections.collection.removes_return"><span class="yiyi-st" id="yiyi-236"><em class="property">static</em> <code class="descname">removed_return</code> <span class="sig-paren">&#xFF08;</span> <span class="sig-paren">&#xFF09;</span> <a class="headerlink" href="#sqlalchemy.orm.collections.collection.removes_return" title="Permalink to this definition">&#xB6;</a></span></dt><dd><p><span class="yiyi-st" id="yiyi-237">&#x5C06;&#x8BE5;&#x65B9;&#x6CD5;&#x6807;&#x8BB0;&#x4E3A;&#x5220;&#x9664;&#x96C6;&#x5408;&#x4E2D;&#x7684;&#x5B9E;&#x4F53;&#x3002;</span></p><p><span class="yiyi-st" id="yiyi-238">&#x5411;&#x65B9;&#x6CD5;&#x6DFB;&#x52A0;&#x201C;&#x4ECE;&#x96C6;&#x5408;&#x4E2D;&#x5220;&#x9664;&#x201D;&#x5904;&#x7406;&#x3002;</span><span class="yiyi-st" id="yiyi-239">&#x8BE5;&#x65B9;&#x6CD5;&#x7684;&#x8FD4;&#x56DE;&#x503C;&#xFF08;&#x5982;&#x679C;&#x6709;&#x7684;&#x8BDD;&#xFF09;&#x88AB;&#x89C6;&#x4E3A;&#x8981;&#x5220;&#x9664;&#x7684;&#x503C;&#x3002;</span><span class="yiyi-st" id="yiyi-240">&#x65B9;&#x6CD5;&#x53C2;&#x6570;&#x672A;&#x88AB;&#x68C0;&#x67E5;&#xFF1A;</span></p><div class="highlight-python"><div class="highlight"><pre><span></span><span class="nd">@collection.removes_return</span><span class="p">()</span>
<span class="k">def</span> <span class="nf">pop</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="o">...</span></pre></div></div><p><span class="yiyi-st" id="yiyi-241">&#x5BF9;&#x4E8E;&#x5728;&#x8C03;&#x7528;&#x65F6;&#x5DF2;&#x77E5;&#x79FB;&#x9664;&#x503C;&#x7684;&#x65B9;&#x6CD5;&#xFF0C;&#x8BF7;&#x4F7F;&#x7528;collection.remove&#x3002;</span></p></dd></dl><dl class="staticmethod"><dt id="sqlalchemy.orm.collections.collection.replaces"><span class="yiyi-st" id="yiyi-242"><em class="property">&#x9759;&#x6001; tt&gt; <code class="descname">&#x66FF;&#x6362; tt&gt; <span class="sig-paren">&#xFF08;</span> <em>arg</em> <span class="sig-paren">&#xFF09;</span> <a class="headerlink" href="#sqlalchemy.orm.collections.collection.replaces" title="Permalink to this definition"></a></code></em></span></dt><dd><p><span class="yiyi-st" id="yiyi-243">&#x5C06;&#x65B9;&#x6CD5;&#x6807;&#x8BB0;&#x4E3A;&#x66FF;&#x6362;&#x96C6;&#x5408;&#x4E2D;&#x7684;&#x5B9E;&#x4F53;&#x3002;</span></p><p><span class="yiyi-st" id="yiyi-244">&#x5411;&#x8BE5;&#x65B9;&#x6CD5;&#x6DFB;&#x52A0;&#x201C;&#x6DFB;&#x52A0;&#x5230;&#x96C6;&#x5408;&#x201D;&#x548C;&#x201C;&#x4ECE;&#x96C6;&#x5408;&#x4E2D;&#x5220;&#x9664;&#x201D;&#x5904;&#x7406;&#x3002;</span><span class="yiyi-st" id="yiyi-245">decorator&#x53C2;&#x6570;&#x6307;&#x793A;&#x54EA;&#x4E2A;&#x65B9;&#x6CD5;&#x53C2;&#x6570;&#x4FDD;&#x5B58;&#x8981;&#x6DFB;&#x52A0;&#x7684;SQLAlchemy&#x76F8;&#x5173;&#x503C;&#xFF0C;&#x4EE5;&#x53CA;&#x8FD4;&#x56DE;&#x503C;&#xFF08;&#x5982;&#x679C;&#x6709;&#x7684;&#x8BDD;&#x5C06;&#x88AB;&#x89C6;&#x4E3A;&#x8981;&#x5220;&#x9664;&#x7684;&#x503C;&#xFF09;&#x3002;</span></p><p><span class="yiyi-st" id="yiyi-246">&#x53C2;&#x6570;&#x53EF;&#x4EE5;&#x5728;&#x4F4D;&#x7F6E;&#x4E0A;&#x6307;&#x5B9A;&#xFF08;&#x5373;&#x6574;&#x6570;&#xFF09;&#x6216;&#x6309;&#x540D;&#x79F0;&#x6307;&#x5B9A;&#xFF1A;</span></p><div class="highlight-python"><div class="highlight"><pre><span></span><span class="nd">@collection.replaces</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">__setitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">,</span> <span class="n">item</span><span class="p">):</span> <span class="o">...</span></pre></div></div></dd></dl></dd></dl></div><div class="section" id="custom-dictionary-based-collections"><h3><span class="yiyi-st" id="yiyi-247">&#x81EA;&#x5B9A;&#x4E49;&#x57FA;&#x4E8E;&#x5B57;&#x5178;&#x7684;&#x96C6;&#x5408;<a class="headerlink" href="#custom-dictionary-based-collections" title="Permalink to this headline">&#xB6;</a></span></h3><p><span class="yiyi-st" id="yiyi-248"><a class="reference internal" href="#sqlalchemy.orm.collections.MappedCollection" title="sqlalchemy.orm.collections.MappedCollection"><code class="xref py py-class docutils literal"><span class="pre">MappedCollection</span></code></a>&#x7C7B;&#x53EF;&#x4EE5;&#x7528;&#x4F5C;&#x81EA;&#x5B9A;&#x4E49;&#x7C7B;&#x578B;&#x7684;&#x57FA;&#x7C7B;&#xFF0C;&#x4E5F;&#x53EF;&#x4EE5;&#x4F5C;&#x4E3A;&#x6DF7;&#x5408;&#x6765;&#x5FEB;&#x901F;&#x5C06;<code class="docutils literal"><span class="pre">dict</span></code>&#x96C6;&#x5408;&#x652F;&#x6301;&#x6DFB;&#x52A0;&#x5230;&#x5176;&#x4ED6;&#x7C7B;&#x4E2D;&#x3002;</span><span class="yiyi-st" id="yiyi-249">&#x5B83;&#x4F7F;&#x7528;&#x952E;&#x63A7;&#x529F;&#x80FD;&#x59D4;&#x6258;&#x7ED9;<code class="docutils literal"><span class="pre">__setitem__</span></code>&#x548C;<code class="docutils literal"><span class="pre">__delitem__</span></code>&#xFF1A;</span></p><div class="highlight-python+sql"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sqlalchemy.util</span> <span class="kn">import</span> <span class="n">OrderedDict</span>
<span class="kn">from</span> <span class="nn">sqlalchemy.orm.collections</span> <span class="kn">import</span> <span class="n">MappedCollection</span>

<span class="k">class</span> <span class="nc">NodeMap</span><span class="p">(</span><span class="n">OrderedDict</span><span class="p">,</span> <span class="n">MappedCollection</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Holds &apos;Node&apos; objects, keyed by the &apos;name&apos; attribute with insert order maintained.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">):</span>
        <span class="n">MappedCollection</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">keyfunc</span><span class="o">=</span><span class="k">lambda</span> <span class="n">node</span><span class="p">:</span> <span class="n">node</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
        <span class="n">OrderedDict</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">)</span></pre></div></div><p><span class="yiyi-st" id="yiyi-250">When subclassing <a class="reference internal" href="#sqlalchemy.orm.collections.MappedCollection" title="sqlalchemy.orm.collections.MappedCollection"><code class="xref py py-class docutils literal"><span class="pre">MappedCollection</span></code></a>, user-defined versions of <code class="docutils literal"><span class="pre">__setitem__()</span></code> or <code class="docutils literal"><span class="pre">__delitem__()</span></code> should be decorated with <a class="reference internal" href="#sqlalchemy.orm.collections.collection.internally_instrumented" title="sqlalchemy.orm.collections.collection.internally_instrumented"><code class="xref py py-meth docutils literal"><span class="pre">collection.internally_instrumented()</span></code></a>, <strong>if</strong> they call down to those same methods on <a class="reference internal" href="#sqlalchemy.orm.collections.MappedCollection" title="sqlalchemy.orm.collections.MappedCollection"><code class="xref py py-class docutils literal"><span class="pre">MappedCollection</span></code></a>. </span><span class="yiyi-st" id="yiyi-251">&#x8FD9;&#x662F;&#x56E0;&#x4E3A;<a class="reference internal" href="#sqlalchemy.orm.collections.MappedCollection" title="sqlalchemy.orm.collections.MappedCollection"><code class="xref py py-class docutils literal"><span class="pre">MappedCollection</span></code></a>&#x4E0A;&#x7684;&#x65B9;&#x6CD5;&#x5DF2;&#x7ECF;&#x88AB;&#x68C0;&#x6D4B;&#x5230; - &#x5728;&#x4E00;&#x4E2A;&#x5DF2;&#x7ECF;&#x68C0;&#x6D4B;&#x5230;&#x7684;&#x8C03;&#x7528;&#x4E2D;&#x8C03;&#x7528;&#x5B83;&#x4EEC;&#x53EF;&#x80FD;&#x4F1A;&#x5BFC;&#x81F4;&#x91CD;&#x590D;&#x89E6;&#x53D1;&#x4E8B;&#x4EF6;&#x6216;&#x4E0D;&#x6070;&#x5F53;&#x5730;&#x89E6;&#x53D1;&#x4E8B;&#x4EF6;&#xFF0C;&#x4ECE;&#x800C;&#x5728;&#x6781;&#x5C11;&#x6570;&#x60C5;&#x51B5;&#x4E0B;&#x5BFC;&#x81F4;&#x5185;&#x90E8;&#x72B6;&#x6001;&#x635F;&#x574F;&#xFF1A;</span></p><div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sqlalchemy.orm.collections</span> <span class="kn">import</span> <span class="n">MappedCollection</span><span class="p">,</span>\
                                    <span class="n">collection</span>

<span class="k">class</span> <span class="nc">MyMappedCollection</span><span class="p">(</span><span class="n">MappedCollection</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Use @internally_instrumented when your methods</span>
<span class="sd">    call down to already-instrumented methods.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="nd">@collection.internally_instrumented</span>
    <span class="k">def</span> <span class="nf">__setitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">_sa_initiator</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="c1"># do something with key, value</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">MyMappedCollection</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__setitem__</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">_sa_initiator</span><span class="p">)</span>

    <span class="nd">@collection.internally_instrumented</span>
    <span class="k">def</span> <span class="nf">__delitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">_sa_initiator</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="c1"># do something with key</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">MyMappedCollection</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__delitem__</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">_sa_initiator</span><span class="p">)</span></pre></div></div><p><span class="yiyi-st" id="yiyi-252">ORM&#x7406;&#x89E3;<code class="docutils literal"><span class="pre">dict</span></code>&#x63A5;&#x53E3;&#x5C31;&#x50CF;&#x5217;&#x8868;&#x548C;&#x96C6;&#x5408;&#x4E00;&#x6837;&#xFF0C;&#x5982;&#x679C;&#x60A8;&#x9009;&#x62E9;&#x7EE7;&#x627F;<code class="docutils literal"><span class="pre">dict</span></code>&#x6216;&#x5728;&#x7C7B;&#x4E2D;&#x63D0;&#x4F9B;&#x5B57;&#x5178;&#x96C6;&#x5408;&#x884C;&#x4E3A;&#xFF0C;&#x5B83;&#x5C06;&#x81EA;&#x52A8;&#x5904;&#x7406;&#x6240;&#x6709;&#x7C7B;&#x5B57;&#x5178;&#x65B9;&#x6CD5;&#x9E2D;&#x5B50;&#x7C7B;&#x3002;</span><span class="yiyi-st" id="yiyi-253">&#x4F46;&#x662F;&#xFF0C;&#x5FC5;&#x987B;&#x4FEE;&#x9970;appender&#x548C;remover&#x65B9;&#x6CD5; - &#x9ED8;&#x8BA4;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;SQLAlchemy&#x57FA;&#x672C;&#x5B57;&#x5178;&#x63A5;&#x53E3;&#x4E2D;&#x6CA1;&#x6709;&#x517C;&#x5BB9;&#x65B9;&#x6CD5;&#x3002;</span><span class="yiyi-st" id="yiyi-254">&#x8FED;&#x4EE3;&#x5C06;&#x7ECF;&#x8FC7;<code class="docutils literal"><span class="pre">itervalues()</span></code>&#xFF0C;&#x9664;&#x975E;&#x53E6;&#x6709;&#x4FEE;&#x9970;&#x3002;</span></p><div class="admonition note"><p class="first admonition-title"><span class="yiyi-st" id="yiyi-255">&#x6CE8;&#x610F;</span></p><p><span class="yiyi-st" id="yiyi-256">&#x7531;&#x4E8E;&#x7248;&#x672C;0.7.6&#x4E4B;&#x524D;&#x7684;MappedCollection&#x4E2D;&#x5B58;&#x5728;&#x4E00;&#x4E2A;&#x9519;&#x8BEF;&#xFF0C;&#x901A;&#x5E38;&#x9700;&#x8981;&#x5728;&#x4F7F;&#x7528;<a class="reference internal" href="#sqlalchemy.orm.collections.collection.internally_instrumented" title="sqlalchemy.orm.collections.collection.internally_instrumented"><code class="xref py py-meth docutils literal"><span class="pre">collection.internally_instrumented()</span></code></a>&#x7684;&#x81EA;&#x5B9A;&#x4E49;<a class="reference internal" href="#sqlalchemy.orm.collections.MappedCollection" title="sqlalchemy.orm.collections.MappedCollection"><code class="xref py py-class docutils literal"><span class="pre">MappedCollection</span></code></a>&#x5B50;&#x7C7B;&#x4E4B;&#x524D;&#x8C03;&#x7528;&#x200B;&#x200B;&#x6B64;&#x89E3;&#x51B3;&#x65B9;&#x6CD5;&#xFF1A;</span></p><div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sqlalchemy.orm.collections</span> <span class="kn">import</span> <span class="n">_instrument_class</span><span class="p">,</span> <span class="n">MappedCollection</span>
<span class="n">_instrument_class</span><span class="p">(</span><span class="n">MappedCollection</span><span class="p">)</span></pre></div></div><p class="last"><span class="yiyi-st" id="yiyi-257">&#x8FD9;&#x5C06;&#x786E;&#x4FDD;<a class="reference internal" href="#sqlalchemy.orm.collections.MappedCollection" title="sqlalchemy.orm.collections.MappedCollection"><code class="xref py py-class docutils literal"><span class="pre">MappedCollection</span></code></a>&#x5728;&#x81EA;&#x5B9A;&#x4E49;&#x5B50;&#x7C7B;&#x4E2D;&#x4F7F;&#x7528;&#x4E4B;&#x524D;&#xFF0C;&#x5DF2;&#x4F7F;&#x7528;&#x81EA;&#x5B9A;&#x4E49;<code class="docutils literal"><span class="pre">__setitem__()</span></code>&#x548C;<code class="docutils literal"><span class="pre">__delitem__()</span></code>&#x65B9;&#x6CD5;&#x6B63;&#x786E;&#x521D;&#x59CB;&#x5316;&#x3002;</span></p></div><dl class="class"><dt id="sqlalchemy.orm.collections.MappedCollection"><span class="yiyi-st" id="yiyi-258"><em class="property">class</em> <code class="descclassname">sqlalchemy.orm.collections&#x3002;</code> <code class="descname">MappedCollection</code> <span class="sig-paren">&#xFF08;</span> <em>keyfunc</em> <span class="sig-paren">&#xFF09;&lt; / T5&gt; <a class="headerlink" href="#sqlalchemy.orm.collections.MappedCollection" title="Permalink to this definition">&#xB6; T6&gt;</a></span></span></dt><dd><p><span class="yiyi-st" id="yiyi-259">&#x57FA;&#x7840;&#xFF1A;<code class="xref py py-class docutils literal"><span class="pre">__builtin__.dict</span></code></span></p><p><span class="yiyi-st" id="yiyi-260">&#x57FA;&#x672C;&#x7684;&#x57FA;&#x4E8E;&#x5B57;&#x5178;&#x7684;&#x96C6;&#x5408;&#x7C7B;&#x3002;</span></p><p><span class="yiyi-st" id="yiyi-261">&#x4F7F;&#x7528;&#x96C6;&#x5408;&#x7C7B;&#x9700;&#x8981;&#x7684;&#x6700;&#x5C0F;&#x5305;&#x8BED;&#x4E49;&#x6269;&#x5C55;&#x5B57;&#x5178;&#x3002;</span><span class="yiyi-st" id="yiyi-262"><code class="docutils literal"><span class="pre">set</span></code>&#x548C;<code class="docutils literal"><span class="pre">remove</span></code>&#x662F;&#x901A;&#x8FC7;&#x952E;&#x63A7;&#x51FD;&#x6570;&#x5B9E;&#x73B0;&#x7684;&#xFF1A;&#x4EFB;&#x4F55;&#x53EF;&#x8C03;&#x7528;&#x7684;&#x65B9;&#x6CD5;&#x90FD;&#x9700;&#x8981;&#x4E00;&#x4E2A;&#x5BF9;&#x8C61;&#x5E76;&#x8FD4;&#x56DE;&#x4E00;&#x4E2A;&#x7528;&#x4F5C;&#x5B57;&#x5178;&#x952E;&#x7684;&#x5BF9;&#x8C61;&#x3002;</span></p><dl class="method"><dt id="sqlalchemy.orm.collections.MappedCollection.__init__"><span class="yiyi-st" id="yiyi-263"><code class="descname"> __&#x521D;&#x59CB;&#x5316;__  T0&gt; <span class="sig-paren">&#xFF08; T1&gt; <em> keyfunc  T2&gt; <span class="sig-paren">&#xFF09; T3&gt; <a class="headerlink" href="#sqlalchemy.orm.collections.MappedCollection.__init__" title="Permalink to this definition">&#xB6; T4&gt;</a></span></em></span></code></span></dt><dd><p><span class="yiyi-st" id="yiyi-264">&#x7528;keyfunc&#x63D0;&#x4F9B;&#x7684;&#x952E;&#x63A7;&#x521B;&#x5EFA;&#x4E00;&#x4E2A;&#x65B0;&#x7684;&#x96C6;&#x5408;&#x3002;</span></p><p><span class="yiyi-st" id="yiyi-265">keyfunc&#x53EF;&#x4EE5;&#x662F;&#x63A5;&#x53D7;&#x5BF9;&#x8C61;&#x5E76;&#x8FD4;&#x56DE;&#x4E00;&#x4E2A;&#x5BF9;&#x8C61;&#x7528;&#x4F5C;&#x5B57;&#x5178;&#x952E;&#x7684;&#x4EFB;&#x4F55;&#x53EF;&#x8C03;&#x7528;&#x5BF9;&#x8C61;&#x3002;</span></p><p><span class="yiyi-st" id="yiyi-266">&#x6BCF;&#x6B21;ORM&#x9700;&#x8981;&#x6309;&#x503C;&#x6DFB;&#x52A0;&#x6210;&#x5458;&#xFF08;&#x4F8B;&#x5982;&#x4ECE;&#x6570;&#x636E;&#x5E93;&#x52A0;&#x8F7D;&#x5B9E;&#x4F8B;&#x65F6;&#xFF09;&#x6216;&#x5220;&#x9664;&#x6210;&#x5458;&#x65F6;&#xFF0C;&#x90FD;&#x4F1A;&#x8C03;&#x7528;keyfunc&#x3002;</span><span class="yiyi-st" id="yiyi-267">&#x5173;&#x4E8E;&#x5B57;&#x5178;&#x952E;&#x63A7;&#x5E94;&#x7528;&#x7684;&#x901A;&#x5E38;&#x8B66;&#x544A; -  <code class="docutils literal"><span class="pre">keyfunc(object)</span></code>&#x5728;&#x96C6;&#x5408;&#x7684;&#x751F;&#x547D;&#x5468;&#x671F;&#x4E2D;&#x5E94;&#x8BE5;&#x8FD4;&#x56DE;&#x76F8;&#x540C;&#x7684;&#x8F93;&#x51FA;&#x3002;</span><span class="yiyi-st" id="yiyi-268">&#x57FA;&#x4E8E;&#x53EF;&#x53D8;&#x5C5E;&#x6027;&#x7684;&#x952E;&#x63A7;&#x4F1A;&#x5BFC;&#x81F4;&#x96C6;&#x5408;&#x4E2D;&#x7684;&#x201C;&#x65E0;&#x6CD5;&#x8BBF;&#x95EE;&#x201D;&#x5B9E;&#x4F8B;&#x201C;&#x4E22;&#x5931;&#x201D;&#x3002;</span></p></dd></dl><dl class="method"><dt id="sqlalchemy.orm.collections.MappedCollection.clear"><span class="yiyi-st" id="yiyi-269"><code class="descname">&#x6E05;&#x9664;</code> <span class="sig-paren">&#xFF08;</span> <span class="sig-paren">&#xFF09;</span>&#x2192;&#x65E0;&#x3002;</span><span class="yiyi-st" id="yiyi-270">&#x5220;&#x9664;D. <a class="headerlink" href="#sqlalchemy.orm.collections.MappedCollection.clear" title="Permalink to this definition">&#xB6;</a>&#x4E2D;&#x7684;&#x6240;&#x6709;&#x9879;&#x76EE;</span></dt><dd></dd></dl><dl class="method"><dt id="sqlalchemy.orm.collections.MappedCollection.pop"><span class="yiyi-st" id="yiyi-271"> <code class="descname">pop</code><span class="sig-paren">(</span><em>k</em><span class="optional">[</span>, <em>d</em><span class="optional">]</span><span class="sig-paren">)</span> &#x2192; v, remove specified key and return the corresponding value.<a class="headerlink" href="#sqlalchemy.orm.collections.MappedCollection.pop" title="Permalink to this definition">&#xB6;</a></span></dt><dd><p><span class="yiyi-st" id="yiyi-272">&#x5982;&#x679C;&#x672A;&#x627E;&#x5230;&#x5BC6;&#x94A5;&#xFF0C;&#x5219;&#x5728;&#x8FD4;&#x56DE;&#x65F6;&#x8FD4;&#x56DE;d&#xFF0C;&#x5426;&#x5219;&#x5F15;&#x53D1;KeyError</span></p></dd></dl><dl class="method"><dt id="sqlalchemy.orm.collections.MappedCollection.popitem"><span class="yiyi-st" id="yiyi-273"><code class="descname">popitem</code> <span class="sig-paren">&#xFF08;</span> <span class="sig-paren">&#xFF09;</span>&#x2192;&#xFF08;k&#xFF0C;v&#xFF09;&#xFF0C;&#x79FB;&#x9664;&#x5E76;&#x8FD4;&#x56DE;&#x4E00;&#x4E9B;&#xFF08;key&#xFF0C;value&#xFF09;&#x5BF9;&#x4F5C;&#x4E3A;<a class="headerlink" href="#sqlalchemy.orm.collections.MappedCollection.popitem" title="Permalink to this definition">&#xB6; t3 &gt;</a></span></dt><dd><p><span class="yiyi-st" id="yiyi-274">2&#x5143;&#x7EC4;&#xFF1B;&#x4F46;&#x5982;&#x679C;D&#x4E3A;&#x7A7A;&#x5219;&#x5F15;&#x53D1;KeyError&#x3002;</span></p></dd></dl><dl class="method"><dt id="sqlalchemy.orm.collections.MappedCollection.remove"><span class="yiyi-st" id="yiyi-275"><code class="descname">&#x9664;&#x53BB; T0&gt; <span class="sig-paren">&#xFF08; T1&gt; <em>&#x503C; T2&gt;&#xFF0C;<em> _sa_initiator =&#x65E0; T3&gt; <span class="sig-paren">&#xFF09; T4&gt; <a class="headerlink" href="#sqlalchemy.orm.collections.MappedCollection.remove" title="Permalink to this definition">&#xB6; T5 &gt;</a></span></em></em></span></code></span></dt><dd><p><span class="yiyi-st" id="yiyi-276">&#x6309;&#x503C;&#x5220;&#x9664;&#x4E00;&#x4E2A;&#x9879;&#x76EE;&#xFF0C;&#x67E5;&#x8BE2;&#x8BE5;&#x9879;&#x7684;keyfunc&#x3002;</span></p></dd></dl><dl class="method"><dt id="sqlalchemy.orm.collections.MappedCollection.set"><span class="yiyi-st" id="yiyi-277"><code class="descname">set</code> <span class="sig-paren">&#xFF08;</span> <em>value</em>&#xFF0C;<em>_sa_initiator = None</em> <span class="sig-paren">&#xFF09;</span> <a class="headerlink" href="#sqlalchemy.orm.collections.MappedCollection.set" title="Permalink to this definition"> t5 &gt;</a></span></dt><dd><p><span class="yiyi-st" id="yiyi-278">&#x6309;&#x503C;&#x6DFB;&#x52A0;&#x9879;&#x76EE;&#xFF0C;&#x67E5;&#x8BE2;&#x5BC6;&#x94A5;&#x7684;keyfunc&#x3002;</span></p></dd></dl><dl class="method"><dt id="sqlalchemy.orm.collections.MappedCollection.setdefault"><span class="yiyi-st" id="yiyi-279"> <code class="descname">setdefault</code><span class="sig-paren">(</span><em>k</em><span class="optional">[</span>, <em>d</em><span class="optional">]</span><span class="sig-paren">)</span> &#x2192; D.get(k,d), also set D[k]=d if k not in D<a class="headerlink" href="#sqlalchemy.orm.collections.MappedCollection.setdefault" title="Permalink to this definition">&#xB6;</a></span></dt><dd></dd></dl><dl class="method"><dt id="sqlalchemy.orm.collections.MappedCollection.update"><span class="yiyi-st" id="yiyi-280"> <code class="descname">update</code><span class="sig-paren">(</span><span class="optional">[</span><em>E</em>, <span class="optional">]</span><em>**F</em><span class="sig-paren">)</span> &#x2192; None. </span><span class="yiyi-st" id="yiyi-281">&#x4ECE;dict / iterable E&#x548C;F&#x66F4;&#x65B0;D&#x3002;<a class="headerlink" href="#sqlalchemy.orm.collections.MappedCollection.update" title="Permalink to this definition">&#xB6;</a></span></dt><dd><p><span class="yiyi-st" id="yiyi-282">&#x5982;&#x679C;E&#x5B58;&#x5728;&#x4E14;&#x5177;&#x6709;.keys()&#x65B9;&#x6CD5;&#xFF0C;&#x5219;&#xFF1A;&#x5BF9;&#x4E8E;E&#x4E2D;&#x7684;k&#xFF1A;D [k] = E [k]&#x5982;&#x679C;E&#x5B58;&#x5728;&#x5E76;&#x4E14;&#x7F3A;&#x5C11;.keys()&#x65B9;&#x6CD5;&#xFF0C;&#x5219;&#xFF1A;for&#xFF08;k&#xFF0C;v&#xFF09;in E&#xFF1A; D [k] = v&#x5728;&#x4EFB;&#x4E00;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;&#x8FD9;&#x540E;&#x9762;&#x662F;&#xFF1A;&#x5BF9;&#x4E8E;F&#x4E2D;&#x7684;k&#xFF1A;D [k] = F [k]</span></p></dd></dl></dd></dl></div><div class="section" id="instrumentation-and-custom-types"><h3><span class="yiyi-st" id="yiyi-283">&#x4EEA;&#x8868;&#x548C;&#x81EA;&#x5B9A;&#x4E49;&#x7C7B;&#x578B;<a class="headerlink" href="#instrumentation-and-custom-types" title="Permalink to this headline">&#xB6;</a></span></h3><p><span class="yiyi-st" id="yiyi-284">&#x8BB8;&#x591A;&#x81EA;&#x5B9A;&#x4E49;&#x7C7B;&#x578B;&#x548C;&#x73B0;&#x6709;&#x5E93;&#x7C7B;&#x53EF;&#x4EE5;&#x4F5C;&#x4E3A;&#x5B9E;&#x4F53;&#x96C6;&#x5408;&#x7C7B;&#x578B;&#x4F7F;&#x7528;&#x3002;</span><span class="yiyi-st" id="yiyi-285">&#x4F46;&#x662F;&#xFF0C;&#x9700;&#x8981;&#x6CE8;&#x610F;&#x7684;&#x662F;&#xFF0C;&#x68C0;&#x6D4B;&#x8FC7;&#x7A0B;&#x4F1A;&#x4FEE;&#x6539;&#x7C7B;&#x578B;&#xFF0C;&#x5E76;&#x81EA;&#x52A8;&#x5728;&#x65B9;&#x6CD5;&#x4E2D;&#x6DFB;&#x52A0;&#x88C5;&#x9970;&#x5668;&#x3002;</span></p><p><span class="yiyi-st" id="yiyi-286">&#x8FD9;&#x4E9B;&#x88C5;&#x9970;&#x5728;&#x5173;&#x7CFB;&#x4E4B;&#x5916;&#x662F;&#x8F7B;&#x91CF;&#x7EA7;&#x4E14;&#x65E0;&#x64CD;&#x4F5C;&#x7684;&#xFF0C;&#x4F46;&#x662F;&#x5728;&#x5176;&#x4ED6;&#x5730;&#x65B9;&#x89E6;&#x53D1;&#x65F6;&#x5B83;&#x4EEC;&#x786E;&#x5B9E;&#x589E;&#x52A0;&#x4E86;&#x4E0D;&#x5FC5;&#x8981;&#x7684;&#x5F00;&#x9500;&#x3002;</span><span class="yiyi-st" id="yiyi-287">&#x5F53;&#x4F7F;&#x7528;&#x5E93;&#x7C7B;&#x4F5C;&#x4E3A;&#x96C6;&#x5408;&#x65F6;&#xFF0C;&#x6700;&#x597D;&#x4F7F;&#x7528;&#x201C;&#x5E73;&#x51E1;&#x7684;&#x5B50;&#x7C7B;&#x201D;&#x6280;&#x5DE7;&#x6765;&#x9650;&#x5236;&#x88C5;&#x9970;&#xFF0C;&#x4F7F;&#x5176;&#x4EC5;&#x7528;&#x4E8E;&#x5173;&#x7CFB;&#x4E2D;&#x7684;&#x4F7F;&#x7528;&#x3002;</span><span class="yiyi-st" id="yiyi-288">&#x4F8B;&#x5982;&#xFF1A;</span></p><div class="highlight-python+sql"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">MyAwesomeList</span><span class="p">(</span><span class="n">some</span><span class="o">.</span><span class="n">great</span><span class="o">.</span><span class="n">library</span><span class="o">.</span><span class="n">AwesomeList</span><span class="p">):</span>
    <span class="k">pass</span>

<span class="c1"># ... relationship(..., collection_class=MyAwesomeList)</span></pre></div></div><p><span class="yiyi-st" id="yiyi-289">ORM&#x5C06;&#x8FD9;&#x79CD;&#x65B9;&#x6CD5;&#x7528;&#x4E8E;&#x5185;&#x7F6E;&#x63D2;&#x4EF6;&#xFF0C;&#x5F53;<code class="docutils literal"><span class="pre">list</span></code>&#xFF0C;<code class="docutils literal"><span class="pre">set</span></code>&#x6216;<code class="docutils literal"><span class="pre">dict</span></code>&#x88AB;&#x76F4;&#x63A5;&#x4F7F;&#x7528;&#x65F6;&#xFF0C;&#x9759;&#x9759;&#x5730;&#x66FF;&#x6362;&#x4E00;&#x4E2A;&#x666E;&#x901A;&#x7684;&#x5B50;&#x7C7B;&#x3002;</span></p></div></div><div class="section" id="collection-internals"><h2><span class="yiyi-st" id="yiyi-290">&#x96C6;&#x5408;&#x5185;&#x90E8;<a class="headerlink" href="#collection-internals" title="Permalink to this headline">&#xB6;</a></span></h2><p><span class="yiyi-st" id="yiyi-291">&#x5404;&#x79CD;&#x5185;&#x90E8;&#x65B9;&#x6CD5;&#x3002;</span></p><dl class="function"><dt id="sqlalchemy.orm.collections.bulk_replace"><span class="yiyi-st" id="yiyi-292"> <code class="descclassname">sqlalchemy.orm.collections.</code><code class="descname">bulk_replace</code><span class="sig-paren">(</span><em>values</em>, <em>existing_adapter</em>, <em>new_adapter</em><span class="sig-paren">)</span><a class="headerlink" href="#sqlalchemy.orm.collections.bulk_replace" title="Permalink to this definition">&#xB6;</a></span></dt><dd><p><span class="yiyi-st" id="yiyi-293">&#x52A0;&#x8F7D;&#x4E00;&#x4E2A;&#x65B0;&#x7684;&#x96C6;&#x5408;&#xFF0C;&#x6839;&#x636E;&#x4E4B;&#x524D;&#x7684;&#x7C7B;&#x4F3C;&#x6210;&#x5458;&#x8D44;&#x683C;&#x89E6;&#x53D1;&#x4E8B;&#x4EF6;&#x3002;</span></p><p><span class="yiyi-st" id="yiyi-294">&#x5C06;<code class="docutils literal"><span class="pre">values</span></code>&#x4E2D;&#x7684;&#x5B9E;&#x4F8B;&#x9644;&#x52A0;&#x5230;<code class="docutils literal"><span class="pre">new_adapter</span></code>&#x4E0A;&#x3002;</span><span class="yiyi-st" id="yiyi-295">&#x5BF9;&#x4E8E;<code class="docutils literal"><span class="pre">existing_adapter</span></code>&#x4E2D;&#x4E0D;&#x5B58;&#x5728;&#x7684;&#x4EFB;&#x4F55;&#x5B9E;&#x4F8B;&#xFF0C;&#x90FD;&#x4F1A;&#x89E6;&#x53D1;&#x4E8B;&#x4EF6;&#x3002;</span><span class="yiyi-st" id="yiyi-296"><code class="docutils literal"><span class="pre">values</span></code>&#x4E2D;&#x4E0D;&#x5B58;&#x5728;&#x7684;<code class="docutils literal"><span class="pre">existing_adapter</span></code>&#x4E2D;&#x7684;&#x4EFB;&#x4F55;&#x5B9E;&#x4F8B;&#x90FD;&#x5C06;&#x79FB;&#x9664;&#x5728;&#x5B83;&#x4EEC;&#x4E0A;&#x9762;&#x89E6;&#x53D1;&#x7684;&#x4E8B;&#x4EF6;&#x3002;</span></p><table class="docutils field-list" frame="void" rules="none"><tbody valign="top"><tr class="field-odd field"><th class="field-name"><span class="yiyi-st" id="yiyi-297">&#x53C2;&#x6570;&#xFF1A;</span></th><td class="field-body"><ul class="first last simple"><li><span class="yiyi-st" id="yiyi-298"><span class="target" id="sqlalchemy.orm.collections.bulk_replace.params.values"></span><strong>values</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.orm.collections.bulk_replace.params.values">&#xB6;</a> &#x2013; An iterable of collection member instances</span></li><li><span class="yiyi-st" id="yiyi-299"><span class="target" id="sqlalchemy.orm.collections.bulk_replace.params.existing_adapter"></span><strong>existing_adapter</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.orm.collections.bulk_replace.params.existing_adapter">&#xB6;</a> &#x2013; A <a class="reference internal" href="#sqlalchemy.orm.collections.CollectionAdapter" title="sqlalchemy.orm.collections.CollectionAdapter"><code class="xref py py-class docutils literal"><span class="pre">CollectionAdapter</span></code></a> of instances to be replaced</span></li><li><span class="yiyi-st" id="yiyi-300"><span class="target" id="sqlalchemy.orm.collections.bulk_replace.params.new_adapter"></span><strong>new_adapter</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.orm.collections.bulk_replace.params.new_adapter">&#xB6;</a> &#x2013; An empty <a class="reference internal" href="#sqlalchemy.orm.collections.CollectionAdapter" title="sqlalchemy.orm.collections.CollectionAdapter"><code class="xref py py-class docutils literal"><span class="pre">CollectionAdapter</span></code></a> to load with <code class="docutils literal"><span class="pre">values</span></code></span></li></ul></td></tr></tbody></table></dd></dl><dl class="class"><dt><span class="yiyi-st" id="yiyi-301"><em class="property">class</em> <code class="descclassname">sqlalchemy.orm.collections&#x3002;</code> <code class="descname">&#x96C6;&#x5408;</code></span></dt><dd><p><span class="yiyi-st" id="yiyi-302">&#x5B9E;&#x4F53;&#x96C6;&#x5408;&#x7C7B;&#x7684;&#x88C5;&#x9970;&#x5668;&#x3002;</span></p><p><span class="yiyi-st" id="yiyi-303">&#x88C5;&#x9970;&#x8005;&#x5206;&#x4E3A;&#x4E24;&#x7EC4;&#xFF1A;&#x6CE8;&#x91CA;&#x548C;&#x622A;&#x53D6;&#x98DF;&#x8C31;&#x3002;</span></p><p><span class="yiyi-st" id="yiyi-304">&#x6CE8;&#x91CA;&#x88C5;&#x9970;&#x5668;&#xFF08;appender&#xFF0C;remover&#xFF0C;iterator&#xFF0C;linker&#xFF0C;converter&#xFF0C;inward_instrumented&#xFF09;&#x8868;&#x793A;&#x65B9;&#x6CD5;&#x7684;&#x7528;&#x9014;&#x5E76;&#x4E14;&#x4E0D;&#x5E26;&#x4EFB;&#x4F55;&#x53C2;&#x6570;&#x3002;</span><span class="yiyi-st" id="yiyi-305">&#x4ED6;&#x4EEC;&#x4E0D;&#x662F;&#x4E0E;parens&#x5199;&#x7684;&#xFF1A;</span></p><div class="highlight-python"><div class="highlight"><pre><span></span><span class="nd">@collection.appender</span>
<span class="k">def</span> <span class="nf">append</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">append</span><span class="p">):</span> <span class="o">...</span></pre></div></div><p><span class="yiyi-st" id="yiyi-306">&#x914D;&#x65B9;&#x88C5;&#x9970;&#x5668;&#x90FD;&#x9700;&#x8981;parens&#xFF0C;&#x5373;&#x4F7F;&#x90A3;&#x4E9B;&#x6CA1;&#x6709;&#x53C2;&#x6570;&#x7684;&#x914D;&#x7F6E;&#xFF1A;</span></p><div class="highlight-python"><div class="highlight"><pre><span></span><span class="nd">@collection.adds</span><span class="p">(</span><span class="s1">&apos;entity&apos;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">insert</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">position</span><span class="p">,</span> <span class="n">entity</span><span class="p">):</span> <span class="o">...</span>

<span class="nd">@collection.removes_return</span><span class="p">()</span>
<span class="k">def</span> <span class="nf">popitem</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="o">...</span></pre></div></div></dd></dl><dl class="data"><dt id="sqlalchemy.orm.collections.collection_adapter"><span class="yiyi-st" id="yiyi-307"><code class="descclassname">sqlalchemy.orm.collections&#x3002;</code> <code class="descname">collection_adapter</code> <em class="property">=&#xFF06;lt&#xFF1B; operator.attrgetter object&#xFF06;gt&#xFF1B;</em> <a class="headerlink" href="#sqlalchemy.orm.collections.collection_adapter" title="Permalink to this definition">&#xB6;</a></span></dt><dd><p><span class="yiyi-st" id="yiyi-308">&#x83B7;&#x53D6;&#x96C6;&#x5408;&#x7684;<a class="reference internal" href="#sqlalchemy.orm.collections.CollectionAdapter" title="sqlalchemy.orm.collections.CollectionAdapter"><code class="xref py py-class docutils literal"><span class="pre">CollectionAdapter</span></code></a>&#x3002;</span></p></dd></dl><dl class="class"><dt id="sqlalchemy.orm.collections.CollectionAdapter"><span class="yiyi-st" id="yiyi-309"> <em class="property">class </em><code class="descclassname">sqlalchemy.orm.collections.</code><code class="descname">CollectionAdapter</code><span class="sig-paren">(</span><em>attr</em>, <em>owner_state</em>, <em>data</em><span class="sig-paren">)</span><a class="headerlink" href="#sqlalchemy.orm.collections.CollectionAdapter" title="Permalink to this definition">&#xB6;</a></span></dt><dd><p><span class="yiyi-st" id="yiyi-310">ORM&#x548C;&#x4EFB;&#x610F;Python&#x96C6;&#x5408;&#x4E4B;&#x95F4;&#x7684;&#x6865;&#x6881;&#x3002;</span></p><p><span class="yiyi-st" id="yiyi-311">&#x4EE3;&#x7406;&#x57FA;&#x672C;&#x7EA7;&#x96C6;&#x5408;&#x64CD;&#x4F5C;&#xFF08;&#x200B;&#x200B;&#x8FFD;&#x52A0;&#xFF0C;&#x5220;&#x9664;&#xFF0C;&#x8FED;&#x4EE3;&#xFF09;&#x5230;&#x57FA;&#x7840;Python&#x96C6;&#x5408;&#xFF0C;&#x5E76;&#x4E3A;&#x8FDB;&#x5165;&#x6216;&#x79BB;&#x5F00;&#x96C6;&#x5408;&#x7684;&#x5B9E;&#x4F53;&#x53D1;&#x51FA;&#x6DFB;&#x52A0;/&#x5220;&#x9664;&#x4E8B;&#x4EF6;&#x3002;</span></p><p><span class="yiyi-st" id="yiyi-312">ORM&#x4EC5;&#x4F7F;&#x7528;<a class="reference internal" href="#sqlalchemy.orm.collections.CollectionAdapter" title="sqlalchemy.orm.collections.CollectionAdapter"><code class="xref py py-class docutils literal"><span class="pre">CollectionAdapter</span></code></a>&#x6765;&#x4E0E;&#x5B9E;&#x4F53;&#x96C6;&#x5408;&#x8FDB;&#x884C;&#x4EA4;&#x4E92;&#x3002;</span></p></dd></dl><dl class="class"><dt id="sqlalchemy.orm.collections.InstrumentedDict"><span class="yiyi-st" id="yiyi-313"><em class="property">class</em> <code class="descclassname">sqlalchemy.orm.collections&#x3002;</code> <code class="descname">InstrumentedDict</code> <a class="headerlink" href="#sqlalchemy.orm.collections.InstrumentedDict" title="Permalink to this definition">&#xB6;</a></span></dt><dd><p><span class="yiyi-st" id="yiyi-314">&#x57FA;&#x7840;&#xFF1A;<code class="xref py py-class docutils literal"><span class="pre">__builtin__.dict</span></code></span></p><p><span class="yiyi-st" id="yiyi-315">&#x5185;&#x7F6E;&#x5B57;&#x5178;&#x7684;&#x5DE5;&#x5177;&#x7248;&#x672C;&#x3002;</span></p></dd></dl><dl class="class"><dt id="sqlalchemy.orm.collections.InstrumentedList"><span class="yiyi-st" id="yiyi-316"><em class="property">class</em> <code class="descclassname">sqlalchemy.orm.collections&#x3002;</code> <code class="descname">InstrumentedList</code> <a class="headerlink" href="#sqlalchemy.orm.collections.InstrumentedList" title="Permalink to this definition">&#xB6;</a></span></dt><dd><p><span class="yiyi-st" id="yiyi-317">&#x57FA;&#x7840;&#xFF1A;<code class="xref py py-class docutils literal"><span class="pre">__builtin__.list</span></code></span></p><p><span class="yiyi-st" id="yiyi-318">&#x5185;&#x7F6E;&#x5217;&#x8868;&#x7684;&#x68C0;&#x6D4B;&#x7248;&#x672C;&#x3002;</span></p></dd></dl><dl class="class"><dt id="sqlalchemy.orm.collections.InstrumentedSet"><span class="yiyi-st" id="yiyi-319"><em class="property">class</em> <code class="descclassname">sqlalchemy.orm.collections&#x3002;</code> <code class="descname">InstrumentedSet</code> <a class="headerlink" href="#sqlalchemy.orm.collections.InstrumentedSet" title="Permalink to this definition">&#xB6;</a></span></dt><dd><p><span class="yiyi-st" id="yiyi-320">&#x57FA;&#x7840;&#xFF1A;<code class="xref py py-class docutils literal"><span class="pre">__builtin__.set</span></code></span></p><p><span class="yiyi-st" id="yiyi-321">&#x5185;&#x7F6E;&#x96C6;&#x5408;&#x7684;&#x63D2;&#x88C5;&#x7248;&#x672C;&#x3002;</span></p></dd></dl><dl class="function"><dt id="sqlalchemy.orm.collections.prepare_instrumentation"><span class="yiyi-st" id="yiyi-322"><code class="descclassname"> sqlalchemy.orm.collections&#x3002; T0&gt; <code class="descname"> prepare_instrumentation  T1&gt; <span class="sig-paren">&#xFF08; T2&gt; <em>&#x5DE5;&#x5382; T3&gt; <span class="sig-paren">&#xFF09; T4&gt; <a class="headerlink" href="#sqlalchemy.orm.collections.prepare_instrumentation" title="Permalink to this definition">&#xB6;&lt; / T5&gt;</a></span></em></span></code></code></span></dt><dd><p><span class="yiyi-st" id="yiyi-323">&#x4E3A;&#x5C06;&#x6765;&#x4F7F;&#x7528;&#x4F5C;&#x4E3A;&#x96C6;&#x5408;&#x7C7B;&#x5DE5;&#x5382;&#x51C6;&#x5907;&#x4E00;&#x4E2A;&#x53EF;&#x8C03;&#x7528;&#x7684;&#x51FD;&#x6570;&#x3002;</span></p><p><span class="yiyi-st" id="yiyi-324">&#x7ED9;&#x5B9A;&#x4E00;&#x4E2A;&#x96C6;&#x5408;&#x7C7B;&#x5DE5;&#x5382;&#xFF08;&#x65E0;&#x8BBA;&#x7C7B;&#x578B;&#x8FD8;&#x662F;&#x65E0;&#x53C2;&#x6570;&#xFF09;&#xFF0C;&#x8FD4;&#x56DE;&#x53E6;&#x4E00;&#x4E2A;&#x5DE5;&#x5382;&#xFF0C;&#x5728;&#x8C03;&#x7528;&#x65F6;&#x5C06;&#x751F;&#x6210;&#x517C;&#x5BB9;&#x7684;&#x5B9E;&#x4F8B;&#x3002;</span></p><p><span class="yiyi-st" id="yiyi-325">&#x8BE5;&#x51FD;&#x6570;&#x8D1F;&#x8D23;&#x5C06;collection_class = list&#x8F6C;&#x6362;&#x4E3A;collection_class = InstrumentedList&#x7684;&#x8FD0;&#x884C;&#x65F6;&#x884C;&#x4E3A;&#x3002;</span></p></dd></dl></div>