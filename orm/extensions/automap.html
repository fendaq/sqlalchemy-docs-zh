<h1><span class="yiyi-st" id="yiyi-57">&#x81EA;&#x52A8;&#x5730;&#x56FE;<a class="headerlink" href="#module-sqlalchemy.ext.automap" title="Permalink to this headline">&#xB6; T0&gt;</a></span></h1><p><span class="yiyi-st" id="yiyi-58">&#x5B9A;&#x4E49;&#x5BF9;<a class="reference internal" href="declarative_api.html#module-sqlalchemy.ext.declarative" title="sqlalchemy.ext.declarative"><code class="xref py py-mod docutils literal"><span class="pre">sqlalchemy.ext.declarative</span></code></a>&#x7CFB;&#x7EDF;&#x7684;&#x6269;&#x5C55;&#xFF0C;&#x8BE5;&#x7CFB;&#x7EDF;&#x81EA;&#x52A8;&#x4ECE;&#x6570;&#x636E;&#x5E93;&#x6A21;&#x5F0F;&#x751F;&#x6210;&#x6620;&#x5C04;&#x7C7B;&#x548C;&#x5173;&#x7CFB;&#xFF0C;&#x4F46;&#x901A;&#x5E38;&#x4E0D;&#x4E00;&#x5B9A;&#x53CD;&#x6620;&#x51FA;&#x6765;&#x3002;</span></p><div class="versionadded"><p><span class="yiyi-st" id="yiyi-59"><span class="versionmodified">&#x7248;&#x672C;0.9.1&#x65B0;&#x589E;&#xFF1A;</span>&#x6DFB;&#x52A0;&#x4E86;<a class="reference internal" href="#module-sqlalchemy.ext.automap" title="sqlalchemy.ext.automap"><code class="xref py py-mod docutils literal"><span class="pre">sqlalchemy.ext.automap</span></code></a>&#x3002;</span></p></div><p><span class="yiyi-st" id="yiyi-60">It is hoped that the <a class="reference internal" href="#sqlalchemy.ext.automap.AutomapBase" title="sqlalchemy.ext.automap.AutomapBase"><code class="xref py py-class docutils literal"><span class="pre">AutomapBase</span></code></a> system provides a quick and modernized solution to the problem that the very famous <a class="reference external" href="https://sqlsoup.readthedocs.io/en/latest/">SQLSoup</a> also tries to solve, that of generating a quick and rudimentary object model from an existing database on the fly. </span><span class="yiyi-st" id="yiyi-61">By addressing the issue strictly at the mapper configuration level, and integrating fully with existing Declarative class techniques, <a class="reference internal" href="#sqlalchemy.ext.automap.AutomapBase" title="sqlalchemy.ext.automap.AutomapBase"><code class="xref py py-class docutils literal"><span class="pre">AutomapBase</span></code></a> seeks to provide a well-integrated approach to the issue of expediently auto-generating ad-hoc mappings.</span></p><div class="section" id="basic-use"><h2><span class="yiyi-st" id="yiyi-62">&#x57FA;&#x672C;&#x4F7F;&#x7528;<a class="headerlink" href="#basic-use" title="Permalink to this headline">&#xB6;</a></span></h2><p><span class="yiyi-st" id="yiyi-63">&#x6700;&#x7B80;&#x5355;&#x7684;&#x7528;&#x6CD5;&#x662F;&#x5C06;&#x73B0;&#x6709;&#x6570;&#x636E;&#x5E93;&#x53CD;&#x6620;&#x5230;&#x65B0;&#x6A21;&#x578B;&#x4E2D;&#x3002;</span><span class="yiyi-st" id="yiyi-64">&#x6211;&#x4EEC;&#x4F7F;&#x7528;<a class="reference internal" href="#sqlalchemy.ext.automap.automap_base" title="sqlalchemy.ext.automap.automap_base"><code class="xref py py-func docutils literal"><span class="pre">automap_base()</span></code></a>&#x521B;&#x5EFA;&#x4E00;&#x4E2A;&#x65B0;&#x7684;<a class="reference internal" href="#sqlalchemy.ext.automap.AutomapBase" title="sqlalchemy.ext.automap.AutomapBase"><code class="xref py py-class docutils literal"><span class="pre">AutomapBase</span></code></a>&#x7C7B;&#xFF0C;&#x7C7B;&#x4F3C;&#x4E8E;&#x6211;&#x4EEC;&#x5982;&#x4F55;&#x521B;&#x5EFA;&#x58F0;&#x660E;&#x6027;&#x57FA;&#x7C7B;&#x3002;</span><span class="yiyi-st" id="yiyi-65">&#x7136;&#x540E;&#xFF0C;&#x6211;&#x4EEC;&#x5728;&#x751F;&#x6210;&#x7684;&#x57FA;&#x7C7B;&#x4E0A;&#x8C03;&#x7528;<a class="reference internal" href="#sqlalchemy.ext.automap.AutomapBase.prepare" title="sqlalchemy.ext.automap.AutomapBase.prepare"><code class="xref py py-meth docutils literal"><span class="pre">AutomapBase.prepare()</span></code></a>&#xFF0C;&#x8981;&#x6C42;&#x5B83;&#x53CD;&#x6620;&#x6A21;&#x5F0F;&#x5E76;&#x751F;&#x6210;&#x6620;&#x5C04;&#xFF1A;</span></p><div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sqlalchemy.ext.automap</span> <span class="kn">import</span> <span class="n">automap_base</span>
<span class="kn">from</span> <span class="nn">sqlalchemy.orm</span> <span class="kn">import</span> <span class="n">Session</span>
<span class="kn">from</span> <span class="nn">sqlalchemy</span> <span class="kn">import</span> <span class="n">create_engine</span>

<span class="n">Base</span> <span class="o">=</span> <span class="n">automap_base</span><span class="p">()</span>

<span class="c1"># engine, suppose it has two tables &apos;user&apos; and &apos;address&apos; set up</span>
<span class="n">engine</span> <span class="o">=</span> <span class="n">create_engine</span><span class="p">(</span><span class="s2">&quot;sqlite:///mydatabase.db&quot;</span><span class="p">)</span>

<span class="c1"># reflect the tables</span>
<span class="n">Base</span><span class="o">.</span><span class="n">prepare</span><span class="p">(</span><span class="n">engine</span><span class="p">,</span> <span class="n">reflect</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

<span class="c1"># mapped classes are now created with names by default</span>
<span class="c1"># matching that of the table name.</span>
<span class="n">User</span> <span class="o">=</span> <span class="n">Base</span><span class="o">.</span><span class="n">classes</span><span class="o">.</span><span class="n">user</span>
<span class="n">Address</span> <span class="o">=</span> <span class="n">Base</span><span class="o">.</span><span class="n">classes</span><span class="o">.</span><span class="n">address</span>

<span class="n">session</span> <span class="o">=</span> <span class="n">Session</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span>

<span class="c1"># rudimentary relationships are produced</span>
<span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Address</span><span class="p">(</span><span class="n">email_address</span><span class="o">=</span><span class="s2">&quot;foo@bar.com&quot;</span><span class="p">,</span> <span class="n">user</span><span class="o">=</span><span class="n">User</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;foo&quot;</span><span class="p">)))</span>
<span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>

<span class="c1"># collection-based relationships are by default named</span>
<span class="c1"># &quot;&lt;classname&gt;_collection&quot;</span>
<span class="k">print</span> <span class="p">(</span><span class="n">u1</span><span class="o">.</span><span class="n">address_collection</span><span class="p">)</span></pre></div></div><p><span class="yiyi-st" id="yiyi-66">Above, calling <a class="reference internal" href="#sqlalchemy.ext.automap.AutomapBase.prepare" title="sqlalchemy.ext.automap.AutomapBase.prepare"><code class="xref py py-meth docutils literal"><span class="pre">AutomapBase.prepare()</span></code></a> while passing along the <a class="reference internal" href="#sqlalchemy.ext.automap.AutomapBase.prepare.params.reflect" title="sqlalchemy.ext.automap.AutomapBase.prepare"><code class="xref py py-paramref docutils literal"><span class="pre">AutomapBase.prepare.reflect</span></code></a> parameter indicates that the <a class="reference internal" href="core_metadata.html#sqlalchemy.schema.MetaData.reflect" title="sqlalchemy.schema.MetaData.reflect"><code class="xref py py-meth docutils literal"><span class="pre">MetaData.reflect()</span></code></a> method will be called on this declarative base classes&#x2019; <a class="reference internal" href="core_metadata.html#sqlalchemy.schema.MetaData" title="sqlalchemy.schema.MetaData"><code class="xref py py-class docutils literal"><span class="pre">MetaData</span></code></a> collection; then, each <strong>viable</strong> <a class="reference internal" href="core_metadata.html#sqlalchemy.schema.Table" title="sqlalchemy.schema.Table"><code class="xref py py-class docutils literal"><span class="pre">Table</span></code></a> within the <a class="reference internal" href="core_metadata.html#sqlalchemy.schema.MetaData" title="sqlalchemy.schema.MetaData"><code class="xref py py-class docutils literal"><span class="pre">MetaData</span></code></a> will get a new mapped class generated automatically. </span><span class="yiyi-st" id="yiyi-67">&#x5C06;&#x5404;&#x79CD;&#x8868;&#x94FE;&#x63A5;&#x5728;&#x4E00;&#x8D77;&#x7684;<a class="reference internal" href="core_constraints.html#sqlalchemy.schema.ForeignKeyConstraint" title="sqlalchemy.schema.ForeignKeyConstraint"><code class="xref py py-class docutils literal"><span class="pre">ForeignKeyConstraint</span></code></a>&#x5BF9;&#x8C61;&#x5C06;&#x7528;&#x4E8E;&#x5728;&#x7C7B;&#x4E4B;&#x95F4;&#x751F;&#x6210;&#x65B0;&#x7684;&#xFF0C;&#x53CC;&#x5411;&#x7684;<a class="reference internal" href="relationship_api.html#sqlalchemy.orm.relationship" title="sqlalchemy.orm.relationship"><code class="xref py py-func docutils literal"><span class="pre">relationship()</span></code></a>&#x5BF9;&#x8C61;&#x3002;</span><span class="yiyi-st" id="yiyi-68">&#x7C7B;&#x548C;&#x5173;&#x7CFB;&#x6CBF;&#x7740;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x5B9A;&#x5236;&#x7684;&#x9ED8;&#x8BA4;&#x547D;&#x540D;&#x65B9;&#x6848;&#x8FDB;&#x884C;&#x3002;</span><span class="yiyi-st" id="yiyi-69">&#x6B64;&#x65F6;&#xFF0C;&#x7531;&#x76F8;&#x5173;&#x7684;<code class="docutils literal"><span class="pre">User</span></code>&#x548C;<code class="docutils literal"><span class="pre">Address</span></code>&#x7C7B;&#x7EC4;&#x6210;&#x7684;&#x57FA;&#x672C;&#x6620;&#x5C04;&#x5DF2;&#x51C6;&#x5907;&#x597D;&#x4EE5;&#x4F20;&#x7EDF;&#x65B9;&#x5F0F;&#x4F7F;&#x7528;&#x3002;</span></p><div class="admonition note"><p class="first admonition-title"><span class="yiyi-st" id="yiyi-70">&#x6CE8;&#x610F;</span></p><p class="last"><span class="yiyi-st" id="yiyi-71">&#x901A;&#x8FC7;<strong>&#x53EF;&#x884C;</strong>&#xFF0C;&#x6211;&#x4EEC;&#x7684;&#x610F;&#x601D;&#x662F;&#xFF0C;&#x5BF9;&#x4E8E;&#x8981;&#x6620;&#x5C04;&#x7684;&#x8868;&#xFF0C;&#x5B83;&#x5FC5;&#x987B;&#x6307;&#x5B9A;&#x4E00;&#x4E2A;&#x4E3B;&#x952E;&#x3002;</span><span class="yiyi-st" id="yiyi-72">&#x6B64;&#x5916;&#xFF0C;&#x5982;&#x679C;&#x8BE5;&#x8868;&#x88AB;&#x68C0;&#x6D4B;&#x4E3A;&#x4E24;&#x4E2A;&#x5176;&#x4ED6;&#x8868;&#x4E4B;&#x95F4;&#x7684;&#x7EAF;&#x5173;&#x8054;&#x8868;&#xFF0C;&#x5219;&#x8BE5;&#x8868;&#x4E0D;&#x4F1A;&#x88AB;&#x76F4;&#x63A5;&#x6620;&#x5C04;&#xFF0C;&#x800C;&#x662F;&#x4F1A;&#x88AB;&#x914D;&#x7F6E;&#x4E3A;&#x4E24;&#x4E2A;&#x5F15;&#x7528;&#x8868;&#x7684;&#x6620;&#x5C04;&#x4E4B;&#x95F4;&#x7684;&#x591A;&#x5BF9;&#x591A;&#x8868;&#x3002;</span></p></div></div><div class="section" id="generating-mappings-from-an-existing-metadata"><h2><span class="yiyi-st" id="yiyi-73">&#x4ECE;&#x73B0;&#x6709;&#x5143;&#x6570;&#x636E;&#x751F;&#x6210;&#x6620;&#x5C04;<a class="headerlink" href="#generating-mappings-from-an-existing-metadata" title="Permalink to this headline">&#xB6;</a></span></h2><p><span class="yiyi-st" id="yiyi-74">&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x5C06;&#x9884;&#x5148;&#x58F0;&#x660E;&#x7684;<a class="reference internal" href="core_metadata.html#sqlalchemy.schema.MetaData" title="sqlalchemy.schema.MetaData"><code class="xref py py-class docutils literal"><span class="pre">MetaData</span></code></a>&#x5BF9;&#x8C61;&#x4F20;&#x9012;&#x7ED9;<a class="reference internal" href="#sqlalchemy.ext.automap.automap_base" title="sqlalchemy.ext.automap.automap_base"><code class="xref py py-func docutils literal"><span class="pre">automap_base()</span></code></a>&#x3002;</span><span class="yiyi-st" id="yiyi-75">&#x8FD9;&#x4E2A;&#x5BF9;&#x8C61;&#x53EF;&#x4EE5;&#x4EE5;&#x4EFB;&#x4F55;&#x65B9;&#x5F0F;&#x6784;&#x9020;&#xFF0C;&#x5305;&#x62EC;&#x4EE5;&#x7F16;&#x7A0B;&#x65B9;&#x5F0F;&#xFF0C;&#x4ECE;&#x5E8F;&#x5217;&#x5316;&#x7684;&#x6587;&#x4EF6;&#x4E2D;&#xFF0C;&#x6216;&#x4ECE;&#x4F7F;&#x7528;<a class="reference internal" href="core_metadata.html#sqlalchemy.schema.MetaData.reflect" title="sqlalchemy.schema.MetaData.reflect"><code class="xref py py-meth docutils literal"><span class="pre">MetaData.reflect()</span></code></a>&#x53CD;&#x6620;&#x7684;&#x672C;&#x8EAB;&#x3002;</span><span class="yiyi-st" id="yiyi-76">&#x4E0B;&#x9762;&#x6211;&#x4EEC;&#x4E3E;&#x4F8B;&#x8BF4;&#x660E;&#x53CD;&#x5C04;&#x548C;&#x663E;&#x5F0F;&#x8868;&#x58F0;&#x660E;&#x7684;&#x7EC4;&#x5408;&#xFF1A;</span></p><div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sqlalchemy</span> <span class="kn">import</span> <span class="n">create_engine</span><span class="p">,</span> <span class="n">MetaData</span><span class="p">,</span> <span class="n">Table</span><span class="p">,</span> <span class="n">Column</span><span class="p">,</span> <span class="n">ForeignKey</span>
<span class="n">engine</span> <span class="o">=</span> <span class="n">create_engine</span><span class="p">(</span><span class="s2">&quot;sqlite:///mydatabase.db&quot;</span><span class="p">)</span>

<span class="c1"># produce our own MetaData object</span>
<span class="n">metadata</span> <span class="o">=</span> <span class="n">MetaData</span><span class="p">()</span>

<span class="c1"># we can reflect it ourselves from a database, using options</span>
<span class="c1"># such as &apos;only&apos; to limit what tables we look at...</span>
<span class="n">metadata</span><span class="o">.</span><span class="n">reflect</span><span class="p">(</span><span class="n">engine</span><span class="p">,</span> <span class="n">only</span><span class="o">=</span><span class="p">[</span><span class="s1">&apos;user&apos;</span><span class="p">,</span> <span class="s1">&apos;address&apos;</span><span class="p">])</span>

<span class="c1"># ... or just define our own Table objects with it (or combine both)</span>
<span class="n">Table</span><span class="p">(</span><span class="s1">&apos;user_order&apos;</span><span class="p">,</span> <span class="n">metadata</span><span class="p">,</span>
                <span class="n">Column</span><span class="p">(</span><span class="s1">&apos;id&apos;</span><span class="p">,</span> <span class="n">Integer</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="bp">True</span><span class="p">),</span>
                <span class="n">Column</span><span class="p">(</span><span class="s1">&apos;user_id&apos;</span><span class="p">,</span> <span class="n">ForeignKey</span><span class="p">(</span><span class="s1">&apos;user.id&apos;</span><span class="p">))</span>
            <span class="p">)</span>

<span class="c1"># we can then produce a set of mappings from this MetaData.</span>
<span class="n">Base</span> <span class="o">=</span> <span class="n">automap_base</span><span class="p">(</span><span class="n">metadata</span><span class="o">=</span><span class="n">metadata</span><span class="p">)</span>

<span class="c1"># calling prepare() just sets up mapped classes and relationships.</span>
<span class="n">Base</span><span class="o">.</span><span class="n">prepare</span><span class="p">()</span>

<span class="c1"># mapped classes are ready</span>
<span class="n">User</span><span class="p">,</span> <span class="n">Address</span><span class="p">,</span> <span class="n">Order</span> <span class="o">=</span> <span class="n">Base</span><span class="o">.</span><span class="n">classes</span><span class="o">.</span><span class="n">user</span><span class="p">,</span> <span class="n">Base</span><span class="o">.</span><span class="n">classes</span><span class="o">.</span><span class="n">address</span><span class="p">,</span>        <span class="n">Base</span><span class="o">.</span><span class="n">classes</span><span class="o">.</span><span class="n">user_order</span></pre></div></div></div><div class="section" id="specifying-classes-explicitly"><h2><span class="yiyi-st" id="yiyi-77">&#x660E;&#x786E;&#x6307;&#x5B9A;&#x7C7B;<a class="headerlink" href="#specifying-classes-explicitly" title="Permalink to this headline">&#xB6;</a></span></h2><p><span class="yiyi-st" id="yiyi-78"><a class="reference internal" href="#module-sqlalchemy.ext.automap" title="sqlalchemy.ext.automap"><code class="xref py py-mod docutils literal"><span class="pre">sqlalchemy.ext.automap</span></code></a>&#x6269;&#x5C55;&#x5141;&#x8BB8;&#x7C7B;&#x4EE5;&#x7C7B;&#x4F3C;&#x4E8E;<a class="reference internal" href="declarative_api.html#sqlalchemy.ext.declarative.DeferredReflection" title="sqlalchemy.ext.declarative.DeferredReflection"><code class="xref py py-class docutils literal"><span class="pre">DeferredReflection</span></code></a>&#x7C7B;&#x7684;&#x65B9;&#x5F0F;&#x663E;&#x5F0F;&#x5B9A;&#x4E49;&#x3002;</span><span class="yiyi-st" id="yiyi-79">&#x4ECE;<a class="reference internal" href="#sqlalchemy.ext.automap.AutomapBase" title="sqlalchemy.ext.automap.AutomapBase"><code class="xref py py-class docutils literal"><span class="pre">AutomapBase</span></code></a>&#x6269;&#x5C55;&#x7684;&#x7C7B;&#x4E0E;&#x5E38;&#x89C4;&#x58F0;&#x660E;&#x7C7B;&#x76F8;&#x4F3C;&#xFF0C;&#x4F46;&#x5728;&#x6784;&#x5EFA;&#x4E4B;&#x540E;&#x4E0D;&#x4F1A;&#x7ACB;&#x5373;&#x6620;&#x5C04;&#xFF0C;&#x800C;&#x662F;&#x5728;&#x8C03;&#x7528;<a class="reference internal" href="#sqlalchemy.ext.automap.AutomapBase.prepare" title="sqlalchemy.ext.automap.AutomapBase.prepare"><code class="xref py py-meth docutils literal"><span class="pre">AutomapBase.prepare()</span></code></a>&#x65F6;&#x6620;&#x5C04;&#x3002;</span><span class="yiyi-st" id="yiyi-80">The <a class="reference internal" href="#sqlalchemy.ext.automap.AutomapBase.prepare" title="sqlalchemy.ext.automap.AutomapBase.prepare"><code class="xref py py-meth docutils literal"><span class="pre">AutomapBase.prepare()</span></code></a> method will make use of the classes we&#x2019;ve established based on the table name we use. </span><span class="yiyi-st" id="yiyi-81">&#x5982;&#x679C;&#x6211;&#x4EEC;&#x7684;&#x6A21;&#x5F0F;&#x5305;&#x542B;&#x8868;<code class="docutils literal"><span class="pre">user</span></code>&#x548C;<code class="docutils literal"><span class="pre">address</span></code>&#xFF0C;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x5B9A;&#x4E49;&#x4E00;&#x4E2A;&#x6216;&#x4E24;&#x4E2A;&#x8981;&#x4F7F;&#x7528;&#x7684;&#x7C7B;&#xFF1A;</span></p><div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sqlalchemy.ext.automap</span> <span class="kn">import</span> <span class="n">automap_base</span>
<span class="kn">from</span> <span class="nn">sqlalchemy</span> <span class="kn">import</span> <span class="n">create_engine</span>

<span class="c1"># automap base</span>
<span class="n">Base</span> <span class="o">=</span> <span class="n">automap_base</span><span class="p">()</span>

<span class="c1"># pre-declare User for the &apos;user&apos; table</span>
<span class="k">class</span> <span class="nc">User</span><span class="p">(</span><span class="n">Base</span><span class="p">):</span>
    <span class="n">__tablename__</span> <span class="o">=</span> <span class="s1">&apos;user&apos;</span>

    <span class="c1"># override schema elements like Columns</span>
    <span class="n">user_name</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="s1">&apos;name&apos;</span><span class="p">,</span> <span class="n">String</span><span class="p">)</span>

    <span class="c1"># override relationships too, if desired.</span>
    <span class="c1"># we must use the same name that automap would use for the</span>
    <span class="c1"># relationship, and also must refer to the class name that automap will</span>
    <span class="c1"># generate for &quot;address&quot;</span>
    <span class="n">address_collection</span> <span class="o">=</span> <span class="n">relationship</span><span class="p">(</span><span class="s2">&quot;address&quot;</span><span class="p">,</span> <span class="n">collection_class</span><span class="o">=</span><span class="nb">set</span><span class="p">)</span>

<span class="c1"># reflect</span>
<span class="n">engine</span> <span class="o">=</span> <span class="n">create_engine</span><span class="p">(</span><span class="s2">&quot;sqlite:///mydatabase.db&quot;</span><span class="p">)</span>
<span class="n">Base</span><span class="o">.</span><span class="n">prepare</span><span class="p">(</span><span class="n">engine</span><span class="p">,</span> <span class="n">reflect</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

<span class="c1"># we still have Address generated from the tablename &quot;address&quot;,</span>
<span class="c1"># but User is the same as Base.classes.User now</span>

<span class="n">Address</span> <span class="o">=</span> <span class="n">Base</span><span class="o">.</span><span class="n">classes</span><span class="o">.</span><span class="n">address</span>

<span class="n">u1</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">User</span><span class="p">)</span><span class="o">.</span><span class="n">first</span><span class="p">()</span>
<span class="k">print</span> <span class="p">(</span><span class="n">u1</span><span class="o">.</span><span class="n">address_collection</span><span class="p">)</span>

<span class="c1"># the backref is still there:</span>
<span class="n">a1</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">Address</span><span class="p">)</span><span class="o">.</span><span class="n">first</span><span class="p">()</span>
<span class="k">print</span> <span class="p">(</span><span class="n">a1</span><span class="o">.</span><span class="n">user</span><span class="p">)</span></pre></div></div><p><span class="yiyi-st" id="yiyi-82">&#x4EE5;&#x4E0A;&#xFF0C;&#x5176;&#x4E2D;&#x4E00;&#x4E2A;&#x66F4;&#x590D;&#x6742;&#x7684;&#x7EC6;&#x8282;&#x662F;&#xFF0C;&#x6211;&#x4EEC;&#x8BF4;&#x660E;&#x4E86;&#x8986;&#x76D6;automap&#x5C06;&#x521B;&#x5EFA;&#x7684;<a class="reference internal" href="relationship_api.html#sqlalchemy.orm.relationship" title="sqlalchemy.orm.relationship"><code class="xref py py-func docutils literal"><span class="pre">relationship()</span></code></a>&#x5BF9;&#x8C61;&#x4E4B;&#x4E00;&#x3002;</span><span class="yiyi-st" id="yiyi-83">&#x4E3A;&#x6B64;&#xFF0C;&#x6211;&#x4EEC;&#x9700;&#x8981;&#x786E;&#x4FDD;&#x540D;&#x79F0;&#x4E0E;automap&#x901A;&#x5E38;&#x4F1A;&#x751F;&#x6210;&#x7684;&#x540D;&#x79F0;&#x76F8;&#x5339;&#x914D;&#xFF0C;&#x56E0;&#x4E3A;&#x4ECE;automap&#x7684;&#x89D2;&#x5EA6;&#x6765;&#x770B;&#xFF0C;&#x5173;&#x7CFB;&#x540D;&#x79F0;&#x5C06;&#x662F;<code class="docutils literal"><span class="pre">User.address_collection</span></code>&#x548C;&#x5F15;&#x7528;&#x7684;&#x7C7B;&#x540D;&#x79F0;&#xFF0C;&#x88AB;&#x79F0;&#x4E3A;<code class="docutils literal"><span class="pre">address</span></code>&#xFF0C;&#x5373;&#x4F7F;&#x6211;&#x4EEC;&#x5728;&#x6211;&#x4EEC;&#x4F7F;&#x7528;&#x8FD9;&#x4E2A;&#x7C7B;&#x65F6;&#x5C06;&#x5B83;&#x79F0;&#x4E3A;<code class="docutils literal"><span class="pre">Address</span></code>&#x3002;</span></p></div><div class="section" id="overriding-naming-schemes"><h2><span class="yiyi-st" id="yiyi-84">&#x91CD;&#x5199;&#x547D;&#x540D;&#x65B9;&#x6848;<a class="headerlink" href="#overriding-naming-schemes" title="Permalink to this headline">&#xB6;</a></span></h2><p><span class="yiyi-st" id="yiyi-85"><a class="reference internal" href="#module-sqlalchemy.ext.automap" title="sqlalchemy.ext.automap"><code class="xref py py-mod docutils literal"><span class="pre">sqlalchemy.ext.automap</span></code></a> is tasked with producing mapped classes and relationship names based on a schema, which means it has decision points in how these names are determined. </span><span class="yiyi-st" id="yiyi-86">These three decision points are provided using functions which can be passed to the <a class="reference internal" href="#sqlalchemy.ext.automap.AutomapBase.prepare" title="sqlalchemy.ext.automap.AutomapBase.prepare"><code class="xref py py-meth docutils literal"><span class="pre">AutomapBase.prepare()</span></code></a> method, and are known as <a class="reference internal" href="#sqlalchemy.ext.automap.classname_for_table" title="sqlalchemy.ext.automap.classname_for_table"><code class="xref py py-func docutils literal"><span class="pre">classname_for_table()</span></code></a>, <a class="reference internal" href="#sqlalchemy.ext.automap.name_for_scalar_relationship" title="sqlalchemy.ext.automap.name_for_scalar_relationship"><code class="xref py py-func docutils literal"><span class="pre">name_for_scalar_relationship()</span></code></a>, and <a class="reference internal" href="#sqlalchemy.ext.automap.name_for_collection_relationship" title="sqlalchemy.ext.automap.name_for_collection_relationship"><code class="xref py py-func docutils literal"><span class="pre">name_for_collection_relationship()</span></code></a>. </span><span class="yiyi-st" id="yiyi-87">&#x8FD9;&#x4E9B;&#x51FD;&#x6570;&#x4E2D;&#x7684;&#x4EFB;&#x4F55;&#x4E00;&#x4E2A;&#x6216;&#x6240;&#x6709;&#x51FD;&#x6570;&#x90FD;&#x662F;&#x5728;&#x4E0B;&#x9762;&#x7684;&#x4F8B;&#x5B50;&#x4E2D;&#x63D0;&#x4F9B;&#x7684;&#xFF0C;&#x6211;&#x4EEC;&#x4F7F;&#x7528;<a class="reference external" href="https://pypi.python.org/pypi/inflect">Inflect</a>&#x5305;&#x4F7F;&#x7528;&#x7C7B;&#x540D;&#x7684;&#x201C;camel case&#x201D;&#x65B9;&#x6848;&#x548C;&#x96C6;&#x5408;&#x540D;&#x79F0;&#x7684;&#x201C;pluralizer&#x201D;&#xFF1A;</span></p><div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">re</span>
<span class="kn">import</span> <span class="nn">inflect</span>

<span class="k">def</span> <span class="nf">camelize_classname</span><span class="p">(</span><span class="n">base</span><span class="p">,</span> <span class="n">tablename</span><span class="p">,</span> <span class="n">table</span><span class="p">):</span>
    <span class="s2">&quot;Produce a &apos;camelized&apos; class name, e.g. &quot;</span>
    <span class="s2">&quot;&apos;words_and_underscores&apos; -&gt; &apos;WordsAndUnderscores&apos;&quot;</span>

    <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="n">tablename</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="o">+</span> \
            <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s1">r&apos;_([a-z])&apos;</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">m</span><span class="p">:</span> <span class="n">m</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">upper</span><span class="p">(),</span> <span class="n">tablename</span><span class="p">[</span><span class="mi">1</span><span class="p">:]))</span>

<span class="n">_pluralizer</span> <span class="o">=</span> <span class="n">inflect</span><span class="o">.</span><span class="n">engine</span><span class="p">()</span>
<span class="k">def</span> <span class="nf">pluralize_collection</span><span class="p">(</span><span class="n">base</span><span class="p">,</span> <span class="n">local_cls</span><span class="p">,</span> <span class="n">referred_cls</span><span class="p">,</span> <span class="n">constraint</span><span class="p">):</span>
    <span class="s2">&quot;Produce an &apos;uncamelized&apos;, &apos;pluralized&apos; class name, e.g. &quot;</span>
    <span class="s2">&quot;&apos;SomeTerm&apos; -&gt; &apos;some_terms&apos;&quot;</span>

    <span class="n">referred_name</span> <span class="o">=</span> <span class="n">referred_cls</span><span class="o">.</span><span class="n">__name__</span>
    <span class="n">uncamelized</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s1">r&apos;[A-Z]&apos;</span><span class="p">,</span>
                         <span class="k">lambda</span> <span class="n">m</span><span class="p">:</span> <span class="s2">&quot;_</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">m</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">lower</span><span class="p">(),</span>
                         <span class="n">referred_name</span><span class="p">)[</span><span class="mi">1</span><span class="p">:]</span>
    <span class="n">pluralized</span> <span class="o">=</span> <span class="n">_pluralizer</span><span class="o">.</span><span class="n">plural</span><span class="p">(</span><span class="n">uncamelized</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">pluralized</span>

<span class="kn">from</span> <span class="nn">sqlalchemy.ext.automap</span> <span class="kn">import</span> <span class="n">automap_base</span>

<span class="n">Base</span> <span class="o">=</span> <span class="n">automap_base</span><span class="p">()</span>

<span class="n">engine</span> <span class="o">=</span> <span class="n">create_engine</span><span class="p">(</span><span class="s2">&quot;sqlite:///mydatabase.db&quot;</span><span class="p">)</span>

<span class="n">Base</span><span class="o">.</span><span class="n">prepare</span><span class="p">(</span><span class="n">engine</span><span class="p">,</span> <span class="n">reflect</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
            <span class="n">classname_for_table</span><span class="o">=</span><span class="n">camelize_classname</span><span class="p">,</span>
            <span class="n">name_for_collection_relationship</span><span class="o">=</span><span class="n">pluralize_collection</span>
    <span class="p">)</span></pre></div></div><p><span class="yiyi-st" id="yiyi-88">&#x4ECE;&#x4E0A;&#x9762;&#x7684;&#x6620;&#x5C04;&#x4E2D;&#xFF0C;&#x6211;&#x4EEC;&#x73B0;&#x5728;&#x5C06;&#x6709;<code class="docutils literal"><span class="pre">User</span></code>&#x548C;<code class="docutils literal"><span class="pre">Address</span></code>&#x7684;&#x7C7B;&#xFF0C;&#x5176;&#x4E2D;<code class="docutils literal"><span class="pre">User</span></code>&#x5230;<code class="docutils literal"><span class="pre">Address</span></code>&#x7684;&#x96C6;&#x5408;&#x662F;&#x79F0;&#x4E3A;<code class="docutils literal"><span class="pre">User.addresses</span></code>&#xFF1A;</span></p><div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">User</span><span class="p">,</span> <span class="n">Address</span> <span class="o">=</span> <span class="n">Base</span><span class="o">.</span><span class="n">classes</span><span class="o">.</span><span class="n">User</span><span class="p">,</span> <span class="n">Base</span><span class="o">.</span><span class="n">classes</span><span class="o">.</span><span class="n">Address</span>

<span class="n">u1</span> <span class="o">=</span> <span class="n">User</span><span class="p">(</span><span class="n">addresses</span><span class="o">=</span><span class="p">[</span><span class="n">Address</span><span class="p">(</span><span class="n">email</span><span class="o">=</span><span class="s2">&quot;foo@bar.com&quot;</span><span class="p">)])</span></pre></div></div></div><div class="section" id="relationship-detection"><h2><span class="yiyi-st" id="yiyi-89">&#x5173;&#x7CFB;&#x68C0;&#x6D4B;<a class="headerlink" href="#relationship-detection" title="Permalink to this headline">&#xB6;</a></span></h2><p><span class="yiyi-st" id="yiyi-90">&#x7EDD;&#x5927;&#x591A;&#x6570;automap&#x5B8C;&#x6210;&#x7684;&#x662F;&#x57FA;&#x4E8E;&#x5916;&#x952E;&#x7684;<a class="reference internal" href="relationship_api.html#sqlalchemy.orm.relationship" title="sqlalchemy.orm.relationship"><code class="xref py py-func docutils literal"><span class="pre">relationship()</span></code></a>&#x7ED3;&#x6784;&#x7684;&#x751F;&#x6210;&#x3002;</span><span class="yiyi-st" id="yiyi-91">&#x8FD9;&#x5BF9;&#x4E8E;&#x591A;&#x5BF9;&#x4E00;&#x548C;&#x4E00;&#x5BF9;&#x591A;&#x5173;&#x7CFB;&#x6709;&#x6548;&#x7684;&#x673A;&#x5236;&#x5982;&#x4E0B;&#xFF1A;</span></p><ol class="arabic"><li><p class="first"><span class="yiyi-st" id="yiyi-92">&#x5DF2;&#x77E5;&#x6620;&#x5C04;&#x5230;&#x7279;&#x5B9A;&#x7C7B;&#x7684;&#x7ED9;&#x5B9A;<a class="reference internal" href="core_metadata.html#sqlalchemy.schema.Table" title="sqlalchemy.schema.Table"><code class="xref py py-class docutils literal"><span class="pre">Table</span></code></a>&#x4F1A;&#x9488;&#x5BF9;<a class="reference internal" href="core_constraints.html#sqlalchemy.schema.ForeignKeyConstraint" title="sqlalchemy.schema.ForeignKeyConstraint"><code class="xref py py-class docutils literal"><span class="pre">ForeignKeyConstraint</span></code></a>&#x5BF9;&#x8C61;&#x8FDB;&#x884C;&#x68C0;&#x67E5;&#x3002;</span></p></li><li><p class="first"><span class="yiyi-st" id="yiyi-93">&#x4ECE;&#x6BCF;&#x4E2A;<a class="reference internal" href="core_constraints.html#sqlalchemy.schema.ForeignKeyConstraint" title="sqlalchemy.schema.ForeignKeyConstraint"><code class="xref py py-class docutils literal"><span class="pre">ForeignKeyConstraint</span></code></a>&#xFF0C;&#x5B58;&#x5728;&#x7684;&#x8FDC;&#x7A0B;<a class="reference internal" href="core_metadata.html#sqlalchemy.schema.Table" title="sqlalchemy.schema.Table"><code class="xref py py-class docutils literal"><span class="pre">Table</span></code></a>&#x5BF9;&#x8C61;&#x4E0E;&#x5176;&#x6620;&#x5C04;&#x5230;&#x7684;&#x7C7B;&#x5339;&#x914D;&#xFF08;&#x5982;&#x679C;&#x6709;&#x7684;&#x8BDD;&#xFF09;&#xFF0C;&#x5426;&#x5219;&#x5B83;&#x5C06;&#x88AB;&#x8DF3;&#x8FC7;&#x3002;</span></p></li><li><p class="first"><span class="yiyi-st" id="yiyi-94">&#x6B63;&#x5982;&#x6211;&#x4EEC;&#x6B63;&#x5728;&#x68C0;&#x67E5;&#x7684;<a class="reference internal" href="core_constraints.html#sqlalchemy.schema.ForeignKeyConstraint" title="sqlalchemy.schema.ForeignKeyConstraint"><code class="xref py py-class docutils literal"><span class="pre">ForeignKeyConstraint</span></code></a>&#x5BF9;&#x5E94;&#x4E8E;&#x6765;&#x81EA;&#x76F4;&#x63A5;&#x6620;&#x5C04;&#x7C7B;&#x7684;&#x5F15;&#x7528;&#xFF0C;&#x8BE5;&#x5173;&#x7CFB;&#x5C06;&#x88AB;&#x8BBE;&#x7F6E;&#x4E3A;&#x6307;&#x5411;&#x6240;&#x5F15;&#x7528;&#x7684;&#x7C7B;&#x7684;&#x591A;&#x5BF9;&#x4E00;&#xFF1B;&#x5C06;&#x5728;&#x6D89;&#x53CA;&#x8FD9;&#x4E2A;&#x7C7B;&#x7684;&#x5F15;&#x7528;&#x7C7B;&#x4E0A;&#x521B;&#x5EFA;&#x76F8;&#x5E94;&#x7684;&#x4E00;&#x5BF9;&#x591A;&#x540E;&#x5411;&#x53C2;&#x8003;&#x3002;</span></p></li><li><p class="first"><span class="yiyi-st" id="yiyi-95">If any of the columns that are part of the <a class="reference internal" href="core_constraints.html#sqlalchemy.schema.ForeignKeyConstraint" title="sqlalchemy.schema.ForeignKeyConstraint"><code class="xref py py-class docutils literal"><span class="pre">ForeignKeyConstraint</span></code></a> are not nullable (e.g. <code class="docutils literal"><span class="pre">nullable=False</span></code>), a <a class="reference internal" href="relationship_api.html#sqlalchemy.orm.relationship.params.cascade" title="sqlalchemy.orm.relationship"><code class="xref py py-paramref docutils literal"><span class="pre">cascade</span></code></a> keyword argument of <code class="docutils literal"><span class="pre">all,</span> <span class="pre">delete-orphan</span></code> will be added to the keyword arguments to be passed to the relationship or backref. </span><span class="yiyi-st" id="yiyi-96">If the <a class="reference internal" href="core_constraints.html#sqlalchemy.schema.ForeignKeyConstraint" title="sqlalchemy.schema.ForeignKeyConstraint"><code class="xref py py-class docutils literal"><span class="pre">ForeignKeyConstraint</span></code></a> reports that <a class="reference internal" href="core_constraints.html#sqlalchemy.schema.ForeignKeyConstraint.params.ondelete" title="sqlalchemy.schema.ForeignKeyConstraint"><code class="xref py py-paramref docutils literal"><span class="pre">ForeignKeyConstraint.ondelete</span></code></a> is set to <code class="docutils literal"><span class="pre">CASCADE</span></code> for a not null or <code class="docutils literal"><span class="pre">SET</span> <span class="pre">NULL</span></code> for a nullable set of columns, the option <a class="reference internal" href="relationship_api.html#sqlalchemy.orm.relationship.params.passive_deletes" title="sqlalchemy.orm.relationship"><code class="xref py py-paramref docutils literal"><span class="pre">passive_deletes</span></code></a> flag is set to <code class="docutils literal"><span class="pre">True</span></code> in the set of relationship keyword arguments. </span><span class="yiyi-st" id="yiyi-97">&#x8BF7;&#x6CE8;&#x610F;&#xFF0C;&#x5E76;&#x975E;&#x6240;&#x6709;&#x540E;&#x7AEF;&#x90FD;&#x652F;&#x6301;ON DELETE&#x7684;&#x53CD;&#x5C04;&#x3002;</span></p><div class="versionadded"><p><span class="yiyi-st" id="yiyi-98"><span class="versionmodified">&#x7248;&#x672C;1.0.0&#x4E2D;&#x7684;&#x65B0;&#x529F;&#x80FD;&#xFF1A;</span>  - &#x5F53;&#x751F;&#x6210;&#x4E00;&#x5BF9;&#x591A;&#x5173;&#x7CFB;&#x5E76;&#x5EFA;&#x7ACB;&#x9ED8;&#x8BA4;&#x7EA7;&#x8054;<code class="docutils literal"><span class="pre">all&#x65F6;&#xFF0C;automap&#x5C06;&#x68C0;&#x6D4B;&#x4E0D;&#x53EF;&#x4E3A;&#x7A7A;&#x7684;&#x5916;&#x952E;&#x7EA6;&#x675F;&#xFF0C; t2 &gt; <span class="pre">delete-orphan</span></span></code>&#x5982;&#x679C;&#x662F;&#x7684;&#x8BDD;&#xFF1B;&#x6B64;&#x5916;&#xFF0C;&#x5982;&#x679C;&#x7EA6;&#x675F;&#x6307;&#x5B9A;<code class="docutils literal"><span class="pre">CASCADE</span></code>&#x7684;<a class="reference internal" href="core_constraints.html#sqlalchemy.schema.ForeignKeyConstraint.params.ondelete" title="sqlalchemy.schema.ForeignKeyConstraint"><code class="xref py py-paramref docutils literal"><span class="pre">ForeignKeyConstraint.ondelete</span></code></a>&#x4E3A;&#x975E;&#x7A7A;&#x6216;<code class="docutils literal"><span class="pre">SET  tt&gt; <span class="pre">NULL</span> / t9&gt;&#x8868;&#x793A;&#x53EF;&#x7A7A;&#x5217;&#xFF0C;&#x8FD8;&#x6DFB;&#x52A0;<code class="docutils literal"><span class="pre">passive_deletes=True</span></code>&#x9009;&#x9879;&#x3002;</span></code></span></p></div></li><li><p class="first"><span class="yiyi-st" id="yiyi-99">&#x5173;&#x7CFB;&#x7684;&#x540D;&#x79F0;&#x662F;&#x4F7F;&#x7528;<a class="reference internal" href="#sqlalchemy.ext.automap.AutomapBase.prepare.params.name_for_scalar_relationship" title="sqlalchemy.ext.automap.AutomapBase.prepare"><code class="xref py py-paramref docutils literal"><span class="pre">AutomapBase.prepare.name_for_scalar_relationship</span></code></a>&#x548C;<a class="reference internal" href="#sqlalchemy.ext.automap.AutomapBase.prepare.params.name_for_collection_relationship" title="sqlalchemy.ext.automap.AutomapBase.prepare"><code class="xref py py-paramref docutils literal"><span class="pre">AutomapBase.prepare.name_for_collection_relationship</span></code></a>&#x53EF;&#x8C03;&#x7528;&#x51FD;&#x6570;&#x786E;&#x5B9A;&#x7684;&#x3002;</span><span class="yiyi-st" id="yiyi-100">&#x9700;&#x8981;&#x6CE8;&#x610F;&#x7684;&#x662F;&#xFF0C;&#x9ED8;&#x8BA4;&#x5173;&#x7CFB;&#x547D;&#x540D;&#x4ECE;<strong>&#x5B9E;&#x9645;&#x7C7B;&#x540D;&#x79F0;</strong>&#x6D3E;&#x751F;&#x540D;&#x79F0;&#x3002;</span><span class="yiyi-st" id="yiyi-101">&#x5982;&#x679C;&#x60A8;&#x901A;&#x8FC7;&#x58F0;&#x660E;&#x67D0;&#x4E2A;&#x7279;&#x5B9A;&#x7C7B;&#x7684;&#x660E;&#x786E;&#x540D;&#x79F0;&#xFF0C;&#x6216;&#x8005;&#x6307;&#x5B9A;&#x4E86;&#x4E00;&#x4E2A;&#x5907;&#x7528;&#x7C7B;&#x547D;&#x540D;&#x65B9;&#x6848;&#xFF0C;&#x90A3;&#x4E48;&#x8FD9;&#x5C31;&#x662F;&#x4ECE;&#x4E2D;&#x6D3E;&#x751F;&#x5173;&#x7CFB;&#x540D;&#x79F0;&#x7684;&#x540D;&#x79F0;&#x3002;</span></p></li><li><p class="first"><span class="yiyi-st" id="yiyi-102">&#x68C0;&#x67E5;&#x8FD9;&#x4E9B;&#x7C7B;&#x662F;&#x5426;&#x5B58;&#x5728;&#x4E0E;&#x8FD9;&#x4E9B;&#x540D;&#x79F0;&#x5339;&#x914D;&#x7684;&#x73B0;&#x6709;&#x6620;&#x5C04;&#x5C5E;&#x6027;&#x3002;</span><span class="yiyi-st" id="yiyi-103">If one is detected on one side, but none on the other side, <a class="reference internal" href="#sqlalchemy.ext.automap.AutomapBase" title="sqlalchemy.ext.automap.AutomapBase"><code class="xref py py-class docutils literal"><span class="pre">AutomapBase</span></code></a> attempts to create a relationship on the missing side, then uses the <a class="reference internal" href="relationship_api.html#sqlalchemy.orm.relationship.params.back_populates" title="sqlalchemy.orm.relationship"><code class="xref py py-paramref docutils literal"><span class="pre">relationship.back_populates</span></code></a> parameter in order to point the new relationship to the other side.</span></p></li><li><p class="first"><span class="yiyi-st" id="yiyi-104">In the usual case where no relationship is on either side, <a class="reference internal" href="#sqlalchemy.ext.automap.AutomapBase.prepare" title="sqlalchemy.ext.automap.AutomapBase.prepare"><code class="xref py py-meth docutils literal"><span class="pre">AutomapBase.prepare()</span></code></a> produces a <a class="reference internal" href="relationship_api.html#sqlalchemy.orm.relationship" title="sqlalchemy.orm.relationship"><code class="xref py py-func docutils literal"><span class="pre">relationship()</span></code></a> on the &#x201C;many-to-one&#x201D; side and matches it to the other using the <a class="reference internal" href="relationship_api.html#sqlalchemy.orm.relationship.params.backref" title="sqlalchemy.orm.relationship"><code class="xref py py-paramref docutils literal"><span class="pre">relationship.backref</span></code></a> parameter.</span></p></li><li><p class="first"><span class="yiyi-st" id="yiyi-105">Production of the <a class="reference internal" href="relationship_api.html#sqlalchemy.orm.relationship" title="sqlalchemy.orm.relationship"><code class="xref py py-func docutils literal"><span class="pre">relationship()</span></code></a> and optionally the <a class="reference internal" href="relationship_api.html#sqlalchemy.orm.backref" title="sqlalchemy.orm.backref"><code class="xref py py-func docutils literal"><span class="pre">backref()</span></code></a> is handed off to the <a class="reference internal" href="#sqlalchemy.ext.automap.AutomapBase.prepare.params.generate_relationship" title="sqlalchemy.ext.automap.AutomapBase.prepare"><code class="xref py py-paramref docutils literal"><span class="pre">AutomapBase.prepare.generate_relationship</span></code></a> function, which can be supplied by the end-user in order to augment the arguments passed to <a class="reference internal" href="relationship_api.html#sqlalchemy.orm.relationship" title="sqlalchemy.orm.relationship"><code class="xref py py-func docutils literal"><span class="pre">relationship()</span></code></a> or <a class="reference internal" href="relationship_api.html#sqlalchemy.orm.backref" title="sqlalchemy.orm.backref"><code class="xref py py-func docutils literal"><span class="pre">backref()</span></code></a> or to make use of custom implementations of these functions.</span></p></li></ol><div class="section" id="custom-relationship-arguments"><h3><span class="yiyi-st" id="yiyi-106">&#x81EA;&#x5B9A;&#x4E49;&#x5173;&#x7CFB;&#x53C2;&#x6570;<a class="headerlink" href="#custom-relationship-arguments" title="Permalink to this headline">&#xB6;</a></span></h3><p><span class="yiyi-st" id="yiyi-107"><a class="reference internal" href="#sqlalchemy.ext.automap.AutomapBase.prepare.params.generate_relationship" title="sqlalchemy.ext.automap.AutomapBase.prepare"><code class="xref py py-paramref docutils literal"><span class="pre">AutomapBase.prepare.generate_relationship</span></code></a>&#x6302;&#x94A9;&#x53EF;&#x7528;&#x4E8E;&#x5411;&#x5173;&#x7CFB;&#x6DFB;&#x52A0;&#x53C2;&#x6570;&#x3002;</span><span class="yiyi-st" id="yiyi-108">&#x5728;&#x5927;&#x591A;&#x6570;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;&#x73B0;&#x6709;&#x7684;<a class="reference internal" href="#sqlalchemy.ext.automap.generate_relationship" title="sqlalchemy.ext.automap.generate_relationship"><code class="xref py py-func docutils literal"><span class="pre">automap.generate_relationship()</span></code></a>&#x51FD;&#x6570;&#x5728;&#x7528;&#x7ED9;&#x5B9A;&#x7684;&#x5173;&#x952E;&#x5B57;&#x5B57;&#x5178;&#x589E;&#x52A0;&#x81EA;&#x5DF1;&#x7684;&#x53C2;&#x6570;&#x540E;&#x8FD4;&#x56DE;&#x5BF9;&#x8C61;&#x3002;</span></p><p><span class="yiyi-st" id="yiyi-109">&#x4E0B;&#x9762;&#x662F;&#x5982;&#x4F55;&#x5C06;<a class="reference internal" href="relationship_api.html#sqlalchemy.orm.relationship.params.cascade" title="sqlalchemy.orm.relationship"><code class="xref py py-paramref docutils literal"><span class="pre">relationship.cascade</span></code></a>&#x548C;<a class="reference internal" href="relationship_api.html#sqlalchemy.orm.relationship.params.passive_deletes" title="sqlalchemy.orm.relationship"><code class="xref py py-paramref docutils literal"><span class="pre">relationship.passive_deletes</span></code></a>&#x9009;&#x9879;&#x53D1;&#x9001;&#x5230;&#x6240;&#x6709;&#x4E00;&#x5BF9;&#x591A;&#x5173;&#x7CFB;&#x7684;&#x8BF4;&#x660E;&#xFF1A;</span></p><div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sqlalchemy.ext.automap</span> <span class="kn">import</span> <span class="n">generate_relationship</span>

<span class="k">def</span> <span class="nf">_gen_relationship</span><span class="p">(</span><span class="n">base</span><span class="p">,</span> <span class="n">direction</span><span class="p">,</span> <span class="n">return_fn</span><span class="p">,</span>
                                <span class="n">attrname</span><span class="p">,</span> <span class="n">local_cls</span><span class="p">,</span> <span class="n">referred_cls</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">direction</span> <span class="ow">is</span> <span class="n">interfaces</span><span class="o">.</span><span class="n">ONETOMANY</span><span class="p">:</span>
        <span class="n">kw</span><span class="p">[</span><span class="s1">&apos;cascade&apos;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&apos;all, delete-orphan&apos;</span>
        <span class="n">kw</span><span class="p">[</span><span class="s1">&apos;passive_deletes&apos;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">True</span>
    <span class="c1"># make use of the built-in function to actually return</span>
    <span class="c1"># the result.</span>
    <span class="k">return</span> <span class="n">generate_relationship</span><span class="p">(</span><span class="n">base</span><span class="p">,</span> <span class="n">direction</span><span class="p">,</span> <span class="n">return_fn</span><span class="p">,</span>
                                 <span class="n">attrname</span><span class="p">,</span> <span class="n">local_cls</span><span class="p">,</span> <span class="n">referred_cls</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">)</span>

<span class="kn">from</span> <span class="nn">sqlalchemy.ext.automap</span> <span class="kn">import</span> <span class="n">automap_base</span>
<span class="kn">from</span> <span class="nn">sqlalchemy</span> <span class="kn">import</span> <span class="n">create_engine</span>

<span class="c1"># automap base</span>
<span class="n">Base</span> <span class="o">=</span> <span class="n">automap_base</span><span class="p">()</span>

<span class="n">engine</span> <span class="o">=</span> <span class="n">create_engine</span><span class="p">(</span><span class="s2">&quot;sqlite:///mydatabase.db&quot;</span><span class="p">)</span>
<span class="n">Base</span><span class="o">.</span><span class="n">prepare</span><span class="p">(</span><span class="n">engine</span><span class="p">,</span> <span class="n">reflect</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
            <span class="n">generate_relationship</span><span class="o">=</span><span class="n">_gen_relationship</span><span class="p">)</span></pre></div></div></div><div class="section" id="many-to-many-relationships"><h3><span class="yiyi-st" id="yiyi-110">&#x591A;&#x5BF9;&#x591A;&#x5173;&#x7CFB;<a class="headerlink" href="#many-to-many-relationships" title="Permalink to this headline">&#xB6;</a></span></h3><p><span class="yiyi-st" id="yiyi-111"><a class="reference internal" href="#module-sqlalchemy.ext.automap" title="sqlalchemy.ext.automap"><code class="xref py py-mod docutils literal"><span class="pre">sqlalchemy.ext.automap</span></code></a> will generate many-to-many relationships, e.g. those which contain a <code class="docutils literal"><span class="pre">secondary</span></code> argument. </span><span class="yiyi-st" id="yiyi-112">&#x751F;&#x4EA7;&#x8FD9;&#x4E9B;&#x4EA7;&#x54C1;&#x7684;&#x8FC7;&#x7A0B;&#x5982;&#x4E0B;&#xFF1A;</span></p><ol class="arabic simple"><li><span class="yiyi-st" id="yiyi-113">&#x5728;&#x4EFB;&#x4F55;&#x5DF2;&#x6620;&#x5C04;&#x7684;&#x7C7B;&#x5DF2;&#x88AB;&#x5206;&#x914D;&#x7ED9;&#x5B83;&#x4E4B;&#x524D;&#xFF0C;&#x4E3A;<a class="reference internal" href="core_constraints.html#sqlalchemy.schema.ForeignKeyConstraint" title="sqlalchemy.schema.ForeignKeyConstraint"><code class="xref py py-class docutils literal"><span class="pre">ForeignKeyConstraint</span></code></a>&#x5BF9;&#x8C61;&#x68C0;&#x67E5;&#x7ED9;&#x5B9A;&#x7684;<a class="reference internal" href="core_metadata.html#sqlalchemy.schema.Table" title="sqlalchemy.schema.Table"><code class="xref py py-class docutils literal"><span class="pre">Table</span></code></a>&#x5BF9;&#x8C61;&#x3002;</span></li><li><span class="yiyi-st" id="yiyi-114">If the table contains two and exactly two <a class="reference internal" href="core_constraints.html#sqlalchemy.schema.ForeignKeyConstraint" title="sqlalchemy.schema.ForeignKeyConstraint"><code class="xref py py-class docutils literal"><span class="pre">ForeignKeyConstraint</span></code></a> objects, and all columns within this table are members of these two <a class="reference internal" href="core_constraints.html#sqlalchemy.schema.ForeignKeyConstraint" title="sqlalchemy.schema.ForeignKeyConstraint"><code class="xref py py-class docutils literal"><span class="pre">ForeignKeyConstraint</span></code></a> objects, the table is assumed to be a &#x201C;secondary&#x201D; table, and will <strong>not be mapped directly</strong>.</span></li><li><span class="yiyi-st" id="yiyi-115">&#x5982;&#x679C;&#x6709;&#x7684;&#x8BDD;&#xFF0C;<a class="reference internal" href="core_metadata.html#sqlalchemy.schema.Table" title="sqlalchemy.schema.Table"><code class="xref py py-class docutils literal"><span class="pre">Table</span></code></a>&#x6307;&#x5411;&#x7684;&#x4E24;&#x4E2A;&#xFF08;&#x6216;&#x4E00;&#x4E2A;&#xFF0C;&#x7528;&#x4E8E;&#x81EA;&#x5F15;&#x7528;&#xFF09;&#x5916;&#x90E8;&#x8868;&#x4E0E;&#x5B83;&#x4EEC;&#x5C06;&#x8981;&#x6620;&#x5C04;&#x5230;&#x7684;&#x7C7B;&#x76F8;&#x5339;&#x914D;&#x3002;</span></li><li><span class="yiyi-st" id="yiyi-116">&#x5982;&#x679C;&#x4E24;&#x4FA7;&#x7684;&#x6620;&#x5C04;&#x7C7B;&#x5DF2;&#x7ECF;&#x5B9A;&#x4F4D;&#xFF0C;&#x5219;&#x5728;&#x8FD9;&#x4E24;&#x4E2A;&#x7C7B;&#x4E4B;&#x95F4;&#x521B;&#x5EFA;&#x4E00;&#x4E2A;&#x591A;&#x5BF9;&#x591A;&#x53CC;&#x5411;<a class="reference internal" href="relationship_api.html#sqlalchemy.orm.relationship" title="sqlalchemy.orm.relationship"><code class="xref py py-func docutils literal"><span class="pre">relationship()</span></code></a> / <a class="reference internal" href="relationship_api.html#sqlalchemy.orm.backref" title="sqlalchemy.orm.backref"><code class="xref py py-func docutils literal"><span class="pre">backref()</span></code></a>&#x5BF9;&#x3002;</span></li><li><span class="yiyi-st" id="yiyi-117">&#x591A;&#x5BF9;&#x591A;&#x7684;&#x8986;&#x76D6;&#x903B;&#x8F91;&#x4E0E;&#x4E00;&#x5BF9;&#x591A;/&#x591A;&#x5BF9;&#x4E00;&#x7684;&#x8986;&#x76D6;&#x903B;&#x8F91;&#x76F8;&#x540C;&#xFF1B;&#x5C06;&#x8C03;&#x7528;<a class="reference internal" href="#sqlalchemy.ext.automap.generate_relationship" title="sqlalchemy.ext.automap.generate_relationship"><code class="xref py py-func docutils literal"><span class="pre">generate_relationship()</span></code></a>&#x51FD;&#x6570;&#x6765;&#x751F;&#x6210;&#x7ED3;&#x6784;&#xFF0C;&#x5E76;&#x4FDD;&#x7559;&#x73B0;&#x6709;&#x7684;&#x5C5E;&#x6027;&#x3002;</span></li></ol></div><div class="section" id="relationships-with-inheritance"><h3><span class="yiyi-st" id="yiyi-118">&#x4E0E;&#x7EE7;&#x627F;&#x7684;&#x5173;&#x7CFB;<a class="headerlink" href="#relationships-with-inheritance" title="Permalink to this headline">&#xB6;</a></span></h3><p><span class="yiyi-st" id="yiyi-119"><a class="reference internal" href="#module-sqlalchemy.ext.automap" title="sqlalchemy.ext.automap"><code class="xref py py-mod docutils literal"><span class="pre">sqlalchemy.ext.automap</span></code></a>&#x4E0D;&#x4F1A;&#x5728;&#x4E24;&#x4E2A;&#x5904;&#x4E8E;&#x7EE7;&#x627F;&#x5173;&#x7CFB;&#x7684;&#x7C7B;&#x4E4B;&#x95F4;&#x751F;&#x6210;&#x4EFB;&#x4F55;&#x5173;&#x7CFB;&#x3002;</span><span class="yiyi-st" id="yiyi-120">&#x4E5F;&#x5C31;&#x662F;&#x8BF4;&#xFF0C;&#x6709;&#x4E24;&#x4E2A;&#x7B49;&#x7EA7;&#x7ED9;&#x51FA;&#x5982;&#x4E0B;&#xFF1A;</span></p><div class="highlight-python"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">Employee</span><span class="p">(</span><span class="n">Base</span><span class="p">):</span>
    <span class="n">__tablename__</span> <span class="o">=</span> <span class="s1">&apos;employee&apos;</span>
    <span class="nb">id</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">Integer</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    <span class="nb">type</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">String</span><span class="p">(</span><span class="mi">50</span><span class="p">))</span>
    <span class="n">__mapper_args__</span> <span class="o">=</span> <span class="p">{</span>
         <span class="s1">&apos;polymorphic_identity&apos;</span><span class="p">:</span><span class="s1">&apos;employee&apos;</span><span class="p">,</span> <span class="s1">&apos;polymorphic_on&apos;</span><span class="p">:</span> <span class="nb">type</span>
    <span class="p">}</span>

<span class="k">class</span> <span class="nc">Engineer</span><span class="p">(</span><span class="n">Employee</span><span class="p">):</span>
    <span class="n">__tablename__</span> <span class="o">=</span> <span class="s1">&apos;engineer&apos;</span>
    <span class="nb">id</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">Integer</span><span class="p">,</span> <span class="n">ForeignKey</span><span class="p">(</span><span class="s1">&apos;employee.id&apos;</span><span class="p">),</span> <span class="n">primary_key</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    <span class="n">__mapper_args__</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&apos;polymorphic_identity&apos;</span><span class="p">:</span><span class="s1">&apos;engineer&apos;</span><span class="p">,</span>
    <span class="p">}</span></pre></div></div><p><span class="yiyi-st" id="yiyi-121">&#x4ECE;<code class="docutils literal"><span class="pre">Engineer</span></code>&#x5230;<code class="docutils literal"><span class="pre">Employee</span></code>&#x7684;&#x5916;&#x952E;&#x4E0D;&#x662F;&#x7528;&#x4E8E;&#x5173;&#x7CFB;&#xFF0C;&#x800C;&#x662F;&#x7528;&#x4E8E;&#x5728;&#x4E24;&#x4E2A;&#x7C7B;&#x4E4B;&#x95F4;&#x5EFA;&#x7ACB;&#x8FDE;&#x63A5;&#x7684;&#x7EE7;&#x627F;&#x3002;</span></p><p><span class="yiyi-st" id="yiyi-122">&#x8BF7;&#x6CE8;&#x610F;&#xFF0C;&#x8FD9;&#x610F;&#x5473;&#x7740;automap&#x4E0D;&#x4F1A;&#x4E3A;&#x4ECE;&#x5B50;&#x7C7B;&#x94FE;&#x63A5;&#x5230;&#x8D85;&#x7C7B;&#x7684;&#x5916;&#x952E;&#x751F;&#x6210;<em>&#x4EFB;&#x4F55;</em>&#x5173;&#x7CFB;&#x3002;</span><span class="yiyi-st" id="yiyi-123">&#x5982;&#x679C;&#x6620;&#x5C04;&#x5177;&#x6709;&#x4ECE;&#x5B50;&#x7C7B;&#x5230;&#x8D85;&#x7C7B;&#x7684;&#x5B9E;&#x9645;&#x5173;&#x7CFB;&#xFF0C;&#x90A3;&#x4E48;&#x8FD9;&#x4E9B;&#x6620;&#x5C04;&#x9700;&#x8981;&#x662F;&#x660E;&#x786E;&#x7684;&#x3002;</span><span class="yiyi-st" id="yiyi-124">&#x4E0B;&#x9762;&#xFF0C;&#x6211;&#x4EEC;&#x6709;&#x4E24;&#x4E2A;&#x72EC;&#x7ACB;&#x7684;&#x4ECE;<code class="docutils literal"><span class="pre">Engineer</span></code>&#x5230;<code class="docutils literal"><span class="pre">Employee</span></code>&#x7684;&#x5916;&#x952E;&#xFF0C;&#x6211;&#x4EEC;&#x9700;&#x8981;&#x8BBE;&#x7F6E;&#x6211;&#x4EEC;&#x60F3;&#x8981;&#x7684;&#x5173;&#x7CFB;&#x4EE5;&#x53CA;<code class="docutils literal"><span class="pre">inherit_condition</span></code> &#xFF0C;&#x56E0;&#x4E3A;&#x8FD9;&#x4E9B;&#x4E0D;&#x662F;SQLAlchemy&#x53EF;&#x4EE5;&#x731C;&#x6D4B;&#x7684;&#x4E1C;&#x897F;&#xFF1A;</span></p><div class="highlight-python"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">Employee</span><span class="p">(</span><span class="n">Base</span><span class="p">):</span>
    <span class="n">__tablename__</span> <span class="o">=</span> <span class="s1">&apos;employee&apos;</span>
    <span class="nb">id</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">Integer</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    <span class="nb">type</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">String</span><span class="p">(</span><span class="mi">50</span><span class="p">))</span>

    <span class="n">__mapper_args__</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&apos;polymorphic_identity&apos;</span><span class="p">:</span><span class="s1">&apos;employee&apos;</span><span class="p">,</span> <span class="s1">&apos;polymorphic_on&apos;</span><span class="p">:</span><span class="nb">type</span>
    <span class="p">}</span>

<span class="k">class</span> <span class="nc">Engineer</span><span class="p">(</span><span class="n">Employee</span><span class="p">):</span>
    <span class="n">__tablename__</span> <span class="o">=</span> <span class="s1">&apos;engineer&apos;</span>
    <span class="nb">id</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">Integer</span><span class="p">,</span> <span class="n">ForeignKey</span><span class="p">(</span><span class="s1">&apos;employee.id&apos;</span><span class="p">),</span> <span class="n">primary_key</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    <span class="n">favorite_employee_id</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">Integer</span><span class="p">,</span> <span class="n">ForeignKey</span><span class="p">(</span><span class="s1">&apos;employee.id&apos;</span><span class="p">))</span>

    <span class="n">favorite_employee</span> <span class="o">=</span> <span class="n">relationship</span><span class="p">(</span><span class="n">Employee</span><span class="p">,</span>
                                     <span class="n">foreign_keys</span><span class="o">=</span><span class="n">favorite_employee_id</span><span class="p">)</span>

    <span class="n">__mapper_args__</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&apos;polymorphic_identity&apos;</span><span class="p">:</span><span class="s1">&apos;engineer&apos;</span><span class="p">,</span>
        <span class="s1">&apos;inherit_condition&apos;</span><span class="p">:</span> <span class="nb">id</span> <span class="o">==</span> <span class="n">Employee</span><span class="o">.</span><span class="n">id</span>
    <span class="p">}</span></pre></div></div></div><div class="section" id="handling-simple-naming-conflicts"><h3><span class="yiyi-st" id="yiyi-125">&#x5904;&#x7406;&#x7B80;&#x5355;&#x7684;&#x547D;&#x540D;&#x51B2;&#x7A81;<a class="headerlink" href="#handling-simple-naming-conflicts" title="Permalink to this headline">&#xB6;</a></span></h3><p><span class="yiyi-st" id="yiyi-126">&#x5728;&#x6620;&#x5C04;&#x8FC7;&#x7A0B;&#x4E2D;&#x547D;&#x540D;&#x51B2;&#x7A81;&#x7684;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;&#x6839;&#x636E;&#x9700;&#x8981;&#x8986;&#x76D6;<a class="reference internal" href="#sqlalchemy.ext.automap.classname_for_table" title="sqlalchemy.ext.automap.classname_for_table"><code class="xref py py-func docutils literal"><span class="pre">classname_for_table()</span></code></a>&#xFF0C;<a class="reference internal" href="#sqlalchemy.ext.automap.name_for_scalar_relationship" title="sqlalchemy.ext.automap.name_for_scalar_relationship"><code class="xref py py-func docutils literal"><span class="pre">name_for_scalar_relationship()</span></code></a>&#x548C;<a class="reference internal" href="#sqlalchemy.ext.automap.name_for_collection_relationship" title="sqlalchemy.ext.automap.name_for_collection_relationship"><code class="xref py py-func docutils literal"><span class="pre">name_for_collection_relationship()</span></code></a>&#x4E2D;&#x7684;&#x4EFB;&#x4F55;&#x4E00;&#x4E2A;&#x3002;</span><span class="yiyi-st" id="yiyi-127">&#x4F8B;&#x5982;&#xFF0C;&#x5982;&#x679C;automap&#x8BD5;&#x56FE;&#x547D;&#x540D;&#x4E0E;&#x73B0;&#x6709;&#x5217;&#x76F8;&#x540C;&#x7684;&#x591A;&#x5BF9;&#x4E00;&#x5173;&#x7CFB;&#xFF0C;&#x5219;&#x53EF;&#x4EE5;&#x6709;&#x6761;&#x4EF6;&#x5730;&#x9009;&#x62E9;&#x66FF;&#x4EE3;&#x7EA6;&#x5B9A;&#x3002;</span><span class="yiyi-st" id="yiyi-128">&#x7ED9;&#x5B9A;&#x4E00;&#x4E2A;&#x6A21;&#x5F0F;&#xFF1A;</span></p><div class="highlight-sql"><div class="highlight"><pre><span></span><span class="k">CREATE</span> <span class="k">TABLE</span> <span class="n">table_a</span> <span class="p">(</span>
    <span class="n">id</span> <span class="nb">INTEGER</span> <span class="k">PRIMARY</span> <span class="k">KEY</span>
<span class="p">);</span>

<span class="k">CREATE</span> <span class="k">TABLE</span> <span class="n">table_b</span> <span class="p">(</span>
    <span class="n">id</span> <span class="nb">INTEGER</span> <span class="k">PRIMARY</span> <span class="k">KEY</span><span class="p">,</span>
    <span class="n">table_a</span> <span class="nb">INTEGER</span><span class="p">,</span>
    <span class="k">FOREIGN</span> <span class="k">KEY</span><span class="p">(</span><span class="n">table_a</span><span class="p">)</span> <span class="k">REFERENCES</span> <span class="n">table_a</span><span class="p">(</span><span class="n">id</span><span class="p">)</span>
<span class="p">);</span></pre></div></div><p><span class="yiyi-st" id="yiyi-129">&#x4E0A;&#x8FF0;&#x6A21;&#x5F0F;&#x5C06;&#x9996;&#x5148;&#x5C06;<code class="docutils literal"><span class="pre">table_a</span></code>&#x8868;&#x81EA;&#x52A8;&#x6620;&#x5C04;&#x4E3A;&#x540D;&#x4E3A;<code class="docutils literal"><span class="pre">table_a</span></code>&#x7684;&#x7C7B;&#xFF1B;&#x5B83;&#x4F1A;&#x81EA;&#x52A8;&#x5C06;&#x5173;&#x7CFB;&#x6620;&#x5C04;&#x5230;<code class="docutils literal"><span class="pre">table_b</span></code>&#x7684;&#x7C7B;&#x4E0A;&#xFF0C;&#x5176;&#x540D;&#x79F0;&#x4E0E;&#x6B64;&#x76F8;&#x5173;&#x7684;&#x7C7B;&#x76F8;&#x540C;&#x3002; <code class="docutils literal"><span class="pre">table_a</span></code></span><span class="yiyi-st" id="yiyi-130">&#x8BE5;&#x5173;&#x7CFB;&#x540D;&#x79F0;&#x4E0E;&#x6620;&#x5C04;&#x5217;<code class="docutils literal"><span class="pre">table_b.table_a</span></code>&#x51B2;&#x7A81;&#xFF0C;&#x5E76;&#x4E14;&#x5C06;&#x5728;&#x6620;&#x5C04;&#x65F6;&#x53D1;&#x51FA;&#x9519;&#x8BEF;&#x3002;</span></p><p><span class="yiyi-st" id="yiyi-131">&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x4F7F;&#x7528;&#x4E0B;&#x5212;&#x7EBF;&#x6765;&#x89E3;&#x51B3;&#x8FD9;&#x4E2A;&#x51B2;&#x7A81;&#xFF0C;&#x5982;&#x4E0B;&#x6240;&#x793A;&#xFF1A;</span></p><div class="highlight-python"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">name_for_scalar_relationship</span><span class="p">(</span><span class="n">base</span><span class="p">,</span> <span class="n">local_cls</span><span class="p">,</span> <span class="n">referred_cls</span><span class="p">,</span> <span class="n">constraint</span><span class="p">):</span>
    <span class="n">name</span> <span class="o">=</span> <span class="n">referred_cls</span><span class="o">.</span><span class="n">__name__</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
    <span class="n">local_table</span> <span class="o">=</span> <span class="n">local_cls</span><span class="o">.</span><span class="n">__table__</span>
    <span class="k">if</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">local_table</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
        <span class="n">newname</span> <span class="o">=</span> <span class="n">name</span> <span class="o">+</span> <span class="s2">&quot;_&quot;</span>
        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
            <span class="s2">&quot;Already detected name </span><span class="si">%s</span><span class="s2"> present.  using </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span>
            <span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">newname</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">newname</span>
    <span class="k">return</span> <span class="n">name</span>


<span class="n">Base</span><span class="o">.</span><span class="n">prepare</span><span class="p">(</span><span class="n">engine</span><span class="p">,</span> <span class="n">reflect</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
    <span class="n">name_for_scalar_relationship</span><span class="o">=</span><span class="n">name_for_scalar_relationship</span><span class="p">)</span></pre></div></div><p><span class="yiyi-st" id="yiyi-132">&#x6216;&#x8005;&#xFF0C;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x66F4;&#x6539;&#x5217;&#x4FA7;&#x7684;&#x540D;&#x79F0;&#x3002;</span><span class="yiyi-st" id="yiyi-133">&#x88AB;&#x6620;&#x5C04;&#x7684;&#x5217;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;<a class="reference internal" href="mapping_columns.html#mapper-column-distinct-names"><span>Naming Columns Distinctly from Attribute Names</span></a>&#x533A;&#x522B;&#x547D;&#x540D;&#x5217;&#x7684;&#x65B9;&#x6CD5;&#x4FEE;&#x6539;&#xFF0C;&#x901A;&#x8FC7;&#x5C06;&#x5217;&#x660E;&#x786E;&#x5206;&#x914D;&#x7ED9;&#x65B0;&#x540D;&#x79F0;&#xFF1A;</span></p><div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">Base</span> <span class="o">=</span> <span class="n">automap_base</span><span class="p">()</span>

<span class="k">class</span> <span class="nc">TableB</span><span class="p">(</span><span class="n">Base</span><span class="p">):</span>
    <span class="n">__tablename__</span> <span class="o">=</span> <span class="s1">&apos;table_b&apos;</span>
    <span class="n">_table_a</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="s1">&apos;table_a&apos;</span><span class="p">,</span> <span class="n">ForeignKey</span><span class="p">(</span><span class="s1">&apos;table_a.id&apos;</span><span class="p">))</span>

<span class="n">Base</span><span class="o">.</span><span class="n">prepare</span><span class="p">(</span><span class="n">engine</span><span class="p">,</span> <span class="n">reflect</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span></pre></div></div></div></div><div class="section" id="using-automap-with-explicit-declarations"><h2><span class="yiyi-st" id="yiyi-134">&#x5C06;Automap&#x4E0E;&#x663E;&#x5F0F;&#x58F0;&#x660E;&#x4E00;&#x8D77;&#x4F7F;&#x7528;<a class="headerlink" href="#using-automap-with-explicit-declarations" title="Permalink to this headline">&#xB6;</a></span></h2><p><span class="yiyi-st" id="yiyi-135">&#x5982;&#x524D;&#x6240;&#x8FF0;&#xFF0C;automap&#x4E0D;&#x4F9D;&#x8D56;&#x4E8E;&#x53CD;&#x5C04;&#xFF0C;&#x5E76;&#x4E14;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;<a class="reference internal" href="core_metadata.html#sqlalchemy.schema.MetaData" title="sqlalchemy.schema.MetaData"><code class="xref py py-class docutils literal"><span class="pre">MetaData</span></code></a>&#x96C6;&#x5408;&#x4E2D;&#x4EFB;&#x4F55;<a class="reference internal" href="core_metadata.html#sqlalchemy.schema.Table" title="sqlalchemy.schema.Table"><code class="xref py py-class docutils literal"><span class="pre">Table</span></code></a>&#x5BF9;&#x8C61;&#x7684;&#x96C6;&#x5408;&#x3002;</span><span class="yiyi-st" id="yiyi-136">&#x7531;&#x6B64;&#x53EF;&#x89C1;&#xFF0C;automap&#x4E5F;&#x53EF;&#x4EE5;&#x7528;&#x4E8E;&#x751F;&#x6210;&#x7F3A;&#x5931;&#x7684;&#x5173;&#x7CFB;&#xFF0C;&#x7ED9;&#x51FA;&#x4E00;&#x4E2A;&#x5B8C;&#x5168;&#x5B9A;&#x4E49;&#x8868;&#x5143;&#x6570;&#x636E;&#x7684;&#x5B8C;&#x6574;&#x6A21;&#x578B;&#xFF1A;</span></p><div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sqlalchemy.ext.automap</span> <span class="kn">import</span> <span class="n">automap_base</span>
<span class="kn">from</span> <span class="nn">sqlalchemy</span> <span class="kn">import</span> <span class="n">Column</span><span class="p">,</span> <span class="n">Integer</span><span class="p">,</span> <span class="n">String</span><span class="p">,</span> <span class="n">ForeignKey</span>

<span class="n">Base</span> <span class="o">=</span> <span class="n">automap_base</span><span class="p">()</span>

<span class="k">class</span> <span class="nc">User</span><span class="p">(</span><span class="n">Base</span><span class="p">):</span>
    <span class="n">__tablename__</span> <span class="o">=</span> <span class="s1">&apos;user&apos;</span>

    <span class="nb">id</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">Integer</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    <span class="n">name</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">String</span><span class="p">)</span>

<span class="k">class</span> <span class="nc">Address</span><span class="p">(</span><span class="n">Base</span><span class="p">):</span>
    <span class="n">__tablename__</span> <span class="o">=</span> <span class="s1">&apos;address&apos;</span>

    <span class="nb">id</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">Integer</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    <span class="n">email</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">String</span><span class="p">)</span>
    <span class="n">user_id</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">ForeignKey</span><span class="p">(</span><span class="s1">&apos;user.id&apos;</span><span class="p">))</span>

<span class="c1"># produce relationships</span>
<span class="n">Base</span><span class="o">.</span><span class="n">prepare</span><span class="p">()</span>

<span class="c1"># mapping is complete, with &quot;address_collection&quot; and</span>
<span class="c1"># &quot;user&quot; relationships</span>
<span class="n">a1</span> <span class="o">=</span> <span class="n">Address</span><span class="p">(</span><span class="n">email</span><span class="o">=</span><span class="s1">&apos;u1&apos;</span><span class="p">)</span>
<span class="n">a2</span> <span class="o">=</span> <span class="n">Address</span><span class="p">(</span><span class="n">email</span><span class="o">=</span><span class="s1">&apos;u2&apos;</span><span class="p">)</span>
<span class="n">u1</span> <span class="o">=</span> <span class="n">User</span><span class="p">(</span><span class="n">address_collection</span><span class="o">=</span><span class="p">[</span><span class="n">a1</span><span class="p">,</span> <span class="n">a2</span><span class="p">])</span>
<span class="k">assert</span> <span class="n">a1</span><span class="o">.</span><span class="n">user</span> <span class="ow">is</span> <span class="n">u1</span></pre></div></div><p><span class="yiyi-st" id="yiyi-137">Above, given mostly complete <code class="docutils literal"><span class="pre">User</span></code> and <code class="docutils literal"><span class="pre">Address</span></code> mappings, the <a class="reference internal" href="core_constraints.html#sqlalchemy.schema.ForeignKey" title="sqlalchemy.schema.ForeignKey"><code class="xref py py-class docutils literal"><span class="pre">ForeignKey</span></code></a> which we defined on <code class="docutils literal"><span class="pre">Address.user_id</span></code> allowed a bidirectional relationship pair <code class="docutils literal"><span class="pre">Address.user</span></code> and <code class="docutils literal"><span class="pre">User.address_collection</span></code> to be generated on the mapped classes.</span></p><p><span class="yiyi-st" id="yiyi-138">&#x8BF7;&#x6CE8;&#x610F;&#xFF0C;&#x5F53;&#x7EE7;&#x627F;<a class="reference internal" href="#sqlalchemy.ext.automap.AutomapBase" title="sqlalchemy.ext.automap.AutomapBase"><code class="xref py py-class docutils literal"><span class="pre">AutomapBase</span></code></a>&#x65F6;&#xFF0C;&#x9700;&#x8981;&#x4F7F;&#x7528;<a class="reference internal" href="#sqlalchemy.ext.automap.AutomapBase.prepare" title="sqlalchemy.ext.automap.AutomapBase.prepare"><code class="xref py py-meth docutils literal"><span class="pre">AutomapBase.prepare()</span></code></a>&#x65B9;&#x6CD5;&#xFF1B;&#x5982;&#x679C;&#x672A;&#x8C03;&#x7528;&#xFF0C;&#x5219;&#x6211;&#x4EEC;&#x58F0;&#x660E;&#x7684;&#x7C7B;&#x5904;&#x4E8E;&#x672A;&#x6620;&#x5C04;&#x72B6;&#x6001;&#x3002;</span></p></div><div class="section" id="api-reference"><h2><span class="yiyi-st" id="yiyi-139">API&#x53C2;&#x8003;<a class="headerlink" href="#api-reference" title="Permalink to this headline">&#xB6;</a></span></h2><dl class="function"><dt id="sqlalchemy.ext.automap.automap_base"><span class="yiyi-st" id="yiyi-140"> <code class="descclassname">sqlalchemy.ext.automap.</code><code class="descname">automap_base</code><span class="sig-paren">(</span><em>declarative_base=None</em>, <em>**kw</em><span class="sig-paren">)</span><a class="headerlink" href="#sqlalchemy.ext.automap.automap_base" title="Permalink to this definition">&#xB6;</a></span></dt><dd><p><span class="yiyi-st" id="yiyi-141">&#x751F;&#x6210;&#x58F0;&#x660E;&#x5F0F;&#x81EA;&#x52A8;&#x6620;&#x5C04;&#x57FA;&#x7840;&#x3002;</span></p><p><span class="yiyi-st" id="yiyi-142">&#x8BE5;&#x51FD;&#x6570;&#x751F;&#x6210;&#x4E00;&#x4E2A;&#x65B0;&#x7684;&#x57FA;&#x7C7B;&#xFF0C;&#x5B83;&#x662F;<a class="reference internal" href="#sqlalchemy.ext.automap.AutomapBase" title="sqlalchemy.ext.automap.AutomapBase"><code class="xref py py-class docutils literal"><span class="pre">AutomapBase</span></code></a>&#x7C7B;&#x7684;&#x4EA7;&#x7269;&#xFF0C;&#x4E5F;&#x662F;<a class="reference internal" href="declarative_api.html#sqlalchemy.ext.declarative.declarative_base" title="sqlalchemy.ext.declarative.declarative_base"><code class="xref py py-func docutils literal"><span class="pre">declarative.declarative_base()</span></code></a>&#x751F;&#x6210;&#x7684;&#x58F0;&#x660E;&#x57FA;&#x3002;</span></p><p><span class="yiyi-st" id="yiyi-143">&#x9664;<code class="docutils literal"><span class="pre">declarative_base</span></code>&#x4EE5;&#x5916;&#x7684;&#x6240;&#x6709;&#x53C2;&#x6570;&#x90FD;&#x662F;&#x76F4;&#x63A5;&#x4F20;&#x9012;&#x7ED9;<a class="reference internal" href="declarative_api.html#sqlalchemy.ext.declarative.declarative_base" title="sqlalchemy.ext.declarative.declarative_base"><code class="xref py py-func docutils literal"><span class="pre">declarative.declarative_base()</span></code></a>&#x51FD;&#x6570;&#x7684;&#x5173;&#x952E;&#x5B57;&#x53C2;&#x6570;&#x3002;</span></p><table class="docutils field-list" frame="void" rules="none"><tbody valign="top"><tr class="field-odd field"><th class="field-name"><span class="yiyi-st" id="yiyi-144">&#x53C2;&#x6570;&#xFF1A;</span></th><td class="field-body"><ul class="first last simple"><li><span class="yiyi-st" id="yiyi-145"><span class="target" id="sqlalchemy.ext.automap.automap_base.params.declarative_base"></span><strong>declarative_base</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.ext.automap.automap_base.params.declarative_base">&#xB6;</a> &#x2013; an existing class produced by <a class="reference internal" href="declarative_api.html#sqlalchemy.ext.declarative.declarative_base" title="sqlalchemy.ext.declarative.declarative_base"><code class="xref py py-func docutils literal"><span class="pre">declarative.declarative_base()</span></code></a>. </span><span class="yiyi-st" id="yiyi-146">&#x5F53;&#x5B83;&#x88AB;&#x4F20;&#x9012;&#x65F6;&#xFF0C;&#x51FD;&#x6570;&#x672C;&#x8EAB;&#x4E0D;&#x518D;&#x8C03;&#x7528;<a class="reference internal" href="declarative_api.html#sqlalchemy.ext.declarative.declarative_base" title="sqlalchemy.ext.declarative.declarative_base"><code class="xref py py-func docutils literal"><span class="pre">declarative.declarative_base()</span></code></a>&#xFF0C;&#x6240;&#x6709;&#x5176;&#x4ED6;&#x5173;&#x952E;&#x5B57;&#x53C2;&#x6570;&#x90FD;&#x88AB;&#x5FFD;&#x7565;&#x3002;</span></li><li><span class="yiyi-st" id="yiyi-147"><span class="target" id="sqlalchemy.ext.automap.automap_base.params.**kw"></span><strong>**kw</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.ext.automap.automap_base.params.**kw">&#xB6;</a> &#x2013; keyword arguments are passed along to <a class="reference internal" href="declarative_api.html#sqlalchemy.ext.declarative.declarative_base" title="sqlalchemy.ext.declarative.declarative_base"><code class="xref py py-func docutils literal"><span class="pre">declarative.declarative_base()</span></code></a>.</span></li></ul></td></tr></tbody></table></dd></dl><dl class="class"><dt id="sqlalchemy.ext.automap.AutomapBase"><span class="yiyi-st" id="yiyi-148"><em class="property">class</em> <code class="descclassname">sqlalchemy.ext.automap&#x3002;</code> <code class="descname">AutomapBase</code> <a class="headerlink" href="#sqlalchemy.ext.automap.AutomapBase" title="Permalink to this definition">&#xB6;</a></span></dt><dd><p><span class="yiyi-st" id="yiyi-149">&#x201C;&#x81EA;&#x52A8;&#x6620;&#x5C04;&#x201D;&#x6A21;&#x5F0F;&#x7684;&#x57FA;&#x7C7B;&#x3002;</span></p><p><span class="yiyi-st" id="yiyi-150">&#x53EF;&#x4EE5;&#x5C06;<a class="reference internal" href="#sqlalchemy.ext.automap.AutomapBase" title="sqlalchemy.ext.automap.AutomapBase"><code class="xref py py-class docutils literal"><span class="pre">AutomapBase</span></code></a>&#x7C7B;&#x4E0E;&#x7531;<a class="reference internal" href="declarative_api.html#sqlalchemy.ext.declarative.declarative_base" title="sqlalchemy.ext.declarative.declarative_base"><code class="xref py py-func docutils literal"><span class="pre">declarative.declarative_base()</span></code></a>&#x51FD;&#x6570;&#x751F;&#x6210;&#x7684;&#x201C;&#x58F0;&#x660E;&#x6027;&#x57FA;&#x672C;&#x201D;&#x7C7B;&#x8FDB;&#x884C;&#x6BD4;&#x8F83;&#x3002;</span><span class="yiyi-st" id="yiyi-151">&#x5728;&#x5B9E;&#x8DF5;&#x4E2D;&#xFF0C;<a class="reference internal" href="#sqlalchemy.ext.automap.AutomapBase" title="sqlalchemy.ext.automap.AutomapBase"><code class="xref py py-class docutils literal"><span class="pre">AutomapBase</span></code></a>&#x7C7B;&#x603B;&#x662F;&#x4F5C;&#x4E3A;&#x4E00;&#x4E2A;mixin&#x4E0E;&#x4E00;&#x4E2A;&#x5B9E;&#x9645;&#x7684;&#x58F0;&#x660E;&#x57FA;&#x7840;&#x4E00;&#x8D77;&#x4F7F;&#x7528;&#x3002;</span></p><p><span class="yiyi-st" id="yiyi-152">&#x901A;&#x5E38;&#x4F7F;&#x7528;<a class="reference internal" href="#sqlalchemy.ext.automap.automap_base" title="sqlalchemy.ext.automap.automap_base"><code class="xref py py-func docutils literal"><span class="pre">automap_base()</span></code></a>&#x51FD;&#x6570;&#x5373;&#x65F6;&#x521B;&#x5EFA;&#x4E00;&#x4E2A;&#x65B0;&#x7684;&#x5B50;&#x7C7B;&#x5316;&#x7684;<a class="reference internal" href="#sqlalchemy.ext.automap.AutomapBase" title="sqlalchemy.ext.automap.AutomapBase"><code class="xref py py-class docutils literal"><span class="pre">AutomapBase</span></code></a>&#x3002;</span></p><div class="admonition seealso"><p class="first admonition-title"><span class="yiyi-st" id="yiyi-153">&#x4E5F;&#x53EF;&#x4EE5;&#x770B;&#x770B;</span></p><p class="last"><span class="yiyi-st" id="yiyi-154"><a class="reference internal" href="#"><span>Automap</span></a></span></p></div><dl class="attribute"><dt id="sqlalchemy.ext.automap.AutomapBase.classes"><span class="yiyi-st" id="yiyi-155"><code class="descname">&#x7C7B;</code> <em class="property">=&#x65E0;</em> <a class="headerlink" href="#sqlalchemy.ext.automap.AutomapBase.classes" title="Permalink to this definition">&#xB6;</a></span></dt><dd><p><span class="yiyi-st" id="yiyi-156">&#x5305;&#x542B;&#x7C7B;&#x7684;<code class="xref py py-class docutils literal"><span class="pre">util.Properties</span></code>&#x7684;&#x5B9E;&#x4F8B;&#x3002;</span></p><p><span class="yiyi-st" id="yiyi-157">&#x8BE5;&#x5BF9;&#x8C61;&#x7684;&#x884C;&#x4E3A;&#x4E0E;&#x8868;&#x4E0A;&#x7684;<code class="docutils literal"><span class="pre">.c</span></code>&#x96C6;&#x5408;&#x975E;&#x5E38;&#x76F8;&#x4F3C;&#x3002;</span><span class="yiyi-st" id="yiyi-158">&#x7C7B;&#x4EE5;&#x5B83;&#x4EEC;&#x7684;&#x540D;&#x79F0;&#x5B58;&#x5728;&#xFF0C;&#x4F8B;&#x5982;&#xFF1A;</span></p><div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">Base</span> <span class="o">=</span> <span class="n">automap_base</span><span class="p">()</span>
<span class="n">Base</span><span class="o">.</span><span class="n">prepare</span><span class="p">(</span><span class="n">engine</span><span class="o">=</span><span class="n">some_engine</span><span class="p">,</span> <span class="n">reflect</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

<span class="n">User</span><span class="p">,</span> <span class="n">Address</span> <span class="o">=</span> <span class="n">Base</span><span class="o">.</span><span class="n">classes</span><span class="o">.</span><span class="n">User</span><span class="p">,</span> <span class="n">Base</span><span class="o">.</span><span class="n">classes</span><span class="o">.</span><span class="n">Address</span></pre></div></div></dd></dl><dl class="classmethod"><dt id="sqlalchemy.ext.automap.AutomapBase.prepare"><span class="yiyi-st" id="yiyi-159"> <em class="property">classmethod </em><code class="descname">prepare</code><span class="sig-paren">(</span><em>engine=None</em>, <em>reflect=False</em>, <em>schema=None</em>, <em>classname_for_table=&lt;function classname_for_table&gt;</em>, <em>collection_class=&lt;type &apos;list&apos;&gt;</em>, <em>name_for_scalar_relationship=&lt;function name_for_scalar_relationship&gt;</em>, <em>name_for_collection_relationship=&lt;function name_for_collection_relationship&gt;</em>, <em>generate_relationship=&lt;function generate_relationship&gt;</em><span class="sig-paren">)</span><a class="headerlink" href="#sqlalchemy.ext.automap.AutomapBase.prepare" title="Permalink to this definition">&#xB6;</a></span></dt><dd><p><span class="yiyi-st" id="yiyi-160">&#x4ECE;<a class="reference internal" href="core_metadata.html#sqlalchemy.schema.MetaData" title="sqlalchemy.schema.MetaData"><code class="xref py py-class docutils literal"><span class="pre">MetaData</span></code></a>&#x4E2D;&#x63D0;&#x53D6;&#x6620;&#x5C04;&#x7684;&#x7C7B;&#x548C;&#x5173;&#x7CFB;&#x5E76;&#x6267;&#x884C;&#x6620;&#x5C04;&#x3002;</span></p><table class="docutils field-list" frame="void" rules="none"><tbody valign="top"><tr class="field-odd field"><th class="field-name"><span class="yiyi-st" id="yiyi-161">&#x53C2;&#x6570;&#xFF1A;</span></th><td class="field-body"><ul class="first last simple"><li><span class="yiyi-st" id="yiyi-162"><span class="target" id="sqlalchemy.ext.automap.AutomapBase.prepare.params.engine"></span><strong>engine</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.ext.automap.AutomapBase.prepare.params.engine">&#xB6;</a> &#x2013; an <a class="reference internal" href="core_connections.html#sqlalchemy.engine.Engine" title="sqlalchemy.engine.Engine"><code class="xref py py-class docutils literal"><span class="pre">Engine</span></code></a> or <a class="reference internal" href="core_connections.html#sqlalchemy.engine.Connection" title="sqlalchemy.engine.Connection"><code class="xref py py-class docutils literal"><span class="pre">Connection</span></code></a> with which to perform schema reflection, if specified. </span><span class="yiyi-st" id="yiyi-163">&#x5982;&#x679C;<a class="reference internal" href="#sqlalchemy.ext.automap.AutomapBase.prepare.params.reflect" title="sqlalchemy.ext.automap.AutomapBase.prepare"><code class="xref py py-paramref docutils literal"><span class="pre">AutomapBase.prepare.reflect</span></code></a>&#x53C2;&#x6570;&#x4E3A;False&#xFF0C;&#x5219;&#x4E0D;&#x4F7F;&#x7528;&#x6B64;&#x5BF9;&#x8C61;&#x3002;</span></li><li><span class="yiyi-st" id="yiyi-164"><span class="target" id="sqlalchemy.ext.automap.AutomapBase.prepare.params.reflect"></span><strong>reflect</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.ext.automap.AutomapBase.prepare.params.reflect">&#xB6;</a> &#x2013; if True, the <a class="reference internal" href="core_metadata.html#sqlalchemy.schema.MetaData.reflect" title="sqlalchemy.schema.MetaData.reflect"><code class="xref py py-meth docutils literal"><span class="pre">MetaData.reflect()</span></code></a> method is called on the <a class="reference internal" href="core_metadata.html#sqlalchemy.schema.MetaData" title="sqlalchemy.schema.MetaData"><code class="xref py py-class docutils literal"><span class="pre">MetaData</span></code></a> associated with this <a class="reference internal" href="#sqlalchemy.ext.automap.AutomapBase" title="sqlalchemy.ext.automap.AutomapBase"><code class="xref py py-class docutils literal"><span class="pre">AutomapBase</span></code></a>. </span><span class="yiyi-st" id="yiyi-165">The <a class="reference internal" href="core_connections.html#sqlalchemy.engine.Engine" title="sqlalchemy.engine.Engine"><code class="xref py py-class docutils literal"><span class="pre">Engine</span></code></a> passed via <a class="reference internal" href="#sqlalchemy.ext.automap.AutomapBase.prepare.params.engine" title="sqlalchemy.ext.automap.AutomapBase.prepare"><code class="xref py py-paramref docutils literal"><span class="pre">AutomapBase.prepare.engine</span></code></a> will be used to perform the reflection if present; else, the <a class="reference internal" href="core_metadata.html#sqlalchemy.schema.MetaData" title="sqlalchemy.schema.MetaData"><code class="xref py py-class docutils literal"><span class="pre">MetaData</span></code></a> should already be bound to some engine else the operation will fail.</span></li><li><span class="yiyi-st" id="yiyi-166"><span class="target" id="sqlalchemy.ext.automap.AutomapBase.prepare.params.classname_for_table"></span><strong>classname_for_table</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.ext.automap.AutomapBase.prepare.params.classname_for_table">&#xB6;</a> &#x2013; callable function which will be used to produce new class names, given a table name. </span><span class="yiyi-st" id="yiyi-167">&#x9ED8;&#x8BA4;&#x4E3A;<a class="reference internal" href="#sqlalchemy.ext.automap.classname_for_table" title="sqlalchemy.ext.automap.classname_for_table"><code class="xref py py-func docutils literal"><span class="pre">classname_for_table()</span></code></a>&#x3002;</span></li><li><span class="yiyi-st" id="yiyi-168"><span class="target" id="sqlalchemy.ext.automap.AutomapBase.prepare.params.name_for_scalar_relationship"></span><strong>name_for_scalar_relationship</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.ext.automap.AutomapBase.prepare.params.name_for_scalar_relationship">&#xB6;</a> &#x2013; callable function which will be used to produce relationship names for scalar relationships. </span><span class="yiyi-st" id="yiyi-169">&#x9ED8;&#x8BA4;&#x4E3A;<a class="reference internal" href="#sqlalchemy.ext.automap.name_for_scalar_relationship" title="sqlalchemy.ext.automap.name_for_scalar_relationship"><code class="xref py py-func docutils literal"><span class="pre">name_for_scalar_relationship()</span></code></a>&#x3002;</span></li><li><span class="yiyi-st" id="yiyi-170"><span class="target" id="sqlalchemy.ext.automap.AutomapBase.prepare.params.name_for_collection_relationship"></span><strong>name_for_collection_relationship</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.ext.automap.AutomapBase.prepare.params.name_for_collection_relationship">&#xB6;</a> &#x2013; callable function which will be used to produce relationship names for collection-oriented relationships. </span><span class="yiyi-st" id="yiyi-171">&#x9ED8;&#x8BA4;&#x4E3A;<a class="reference internal" href="#sqlalchemy.ext.automap.name_for_collection_relationship" title="sqlalchemy.ext.automap.name_for_collection_relationship"><code class="xref py py-func docutils literal"><span class="pre">name_for_collection_relationship()</span></code></a>&#x3002;</span></li><li><span class="yiyi-st" id="yiyi-172"><span class="target" id="sqlalchemy.ext.automap.AutomapBase.prepare.params.generate_relationship"></span><strong>generate_relationship</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.ext.automap.AutomapBase.prepare.params.generate_relationship">&#xB6;</a> &#x2013; callable function which will be used to actually generate <a class="reference internal" href="relationship_api.html#sqlalchemy.orm.relationship" title="sqlalchemy.orm.relationship"><code class="xref py py-func docutils literal"><span class="pre">relationship()</span></code></a> and <a class="reference internal" href="relationship_api.html#sqlalchemy.orm.backref" title="sqlalchemy.orm.backref"><code class="xref py py-func docutils literal"><span class="pre">backref()</span></code></a> constructs. </span><span class="yiyi-st" id="yiyi-173">&#x9ED8;&#x8BA4;&#x4E3A;<a class="reference internal" href="#sqlalchemy.ext.automap.generate_relationship" title="sqlalchemy.ext.automap.generate_relationship"><code class="xref py py-func docutils literal"><span class="pre">generate_relationship()</span></code></a>&#x3002;</span></li><li><span class="yiyi-st" id="yiyi-174"><span class="target" id="sqlalchemy.ext.automap.AutomapBase.prepare.params.collection_class"></span><strong>collection_class</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.ext.automap.AutomapBase.prepare.params.collection_class">&#xB6;</a> &#x2013; the Python collection class that will be used when a new <a class="reference internal" href="relationship_api.html#sqlalchemy.orm.relationship" title="sqlalchemy.orm.relationship"><code class="xref py py-func docutils literal"><span class="pre">relationship()</span></code></a> object is created that represents a collection. </span><span class="yiyi-st" id="yiyi-175">&#x9ED8;&#x8BA4;&#x4E3A;<code class="docutils literal"><span class="pre">list</span></code>&#x3002;</span></li><li><span class="yiyi-st" id="yiyi-179"><span class="target" id="sqlalchemy.ext.automap.AutomapBase.prepare.params.schema"></span> <strong>&#x6A21;&#x5F0F;</strong> <a class="paramlink headerlink reference internal" href="#sqlalchemy.ext.automap.AutomapBase.prepare.params.schema">&#xB6;</a>  - </span><p><span class="yiyi-st" id="yiyi-176">&#x5F53;&#x4E0E;<a class="reference internal" href="#sqlalchemy.ext.automap.AutomapBase.prepare.params.reflect" title="sqlalchemy.ext.automap.AutomapBase.prepare"><code class="xref py py-paramref docutils literal"><span class="pre">AutomapBase.prepare.reflect</span></code></a>&#x6807;&#x5FD7;&#x4E00;&#x8D77;&#x51FA;&#x73B0;&#x65F6;&#xFF0C;&#x5C06;&#x4F20;&#x9012;&#x7ED9;<a class="reference internal" href="core_metadata.html#sqlalchemy.schema.MetaData.reflect" title="sqlalchemy.schema.MetaData.reflect"><code class="xref py py-meth docutils literal"><span class="pre">MetaData.reflect()</span></code></a>&#x4EE5;&#x6307;&#x793A;&#x8868;&#x5E94;&#x8BE5;&#x4ECE;&#x54EA;&#x91CC;&#x53CD;&#x6620;&#x51FA;&#x6765;&#x7684;&#x4E3B;&#x6A21;&#x5F0F;&#x3002;</span><span class="yiyi-st" id="yiyi-177">&#x7701;&#x7565;&#x65F6;&#xFF0C;&#x5C06;&#x4F7F;&#x7528;&#x7531;&#x6570;&#x636E;&#x5E93;&#x8FDE;&#x63A5;&#x4F7F;&#x7528;&#x7684;&#x9ED8;&#x8BA4;&#x6A21;&#x5F0F;&#x3002;</span></p><div class="versionadded"><p><span class="yiyi-st" id="yiyi-178"><span class="versionmodified">&#x7248;&#x672C;1.1&#x4E2D;&#x7684;&#x65B0;&#x529F;&#x80FD;</span></span></p></div></li></ul></td></tr></tbody></table></dd></dl></dd></dl><dl class="function"><dt id="sqlalchemy.ext.automap.classname_for_table"><span class="yiyi-st" id="yiyi-180"> <code class="descclassname">sqlalchemy.ext.automap.</code><code class="descname">classname_for_table</code><span class="sig-paren">(</span><em>base</em>, <em>tablename</em>, <em>table</em><span class="sig-paren">)</span><a class="headerlink" href="#sqlalchemy.ext.automap.classname_for_table" title="Permalink to this definition">&#xB6;</a></span></dt><dd><p><span class="yiyi-st" id="yiyi-181">&#x7ED9;&#x5B9A;&#x8868;&#x540D;&#x79F0;&#xFF0C;&#x8FD4;&#x56DE;&#x5E94;&#x8BE5;&#x4F7F;&#x7528;&#x7684;&#x7C7B;&#x540D;&#x79F0;&#x3002;</span></p><p><span class="yiyi-st" id="yiyi-182">&#x9ED8;&#x8BA4;&#x7684;&#x5B9E;&#x73B0;&#x662F;&#xFF1A;</span></p><div class="highlight-python"><div class="highlight"><pre><span></span><span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="n">tablename</span><span class="p">)</span></pre></div></div><p><span class="yiyi-st" id="yiyi-183">&#x53EF;&#x4EE5;&#x4F7F;&#x7528;<a class="reference internal" href="#sqlalchemy.ext.automap.AutomapBase.prepare.params.classname_for_table" title="sqlalchemy.ext.automap.AutomapBase.prepare"><code class="xref py py-paramref docutils literal"><span class="pre">AutomapBase.prepare.classname_for_table</span></code></a>&#x53C2;&#x6570;&#x6307;&#x5B9A;&#x66FF;&#x4EE3;&#x5B9E;&#x73B0;&#x3002;</span></p><table class="docutils field-list" frame="void" rules="none"><tbody valign="top"><tr class="field-odd field"><th class="field-name"><span class="yiyi-st" id="yiyi-184">&#x53C2;&#x6570;&#xFF1A;</span></th><td class="field-body"><ul class="first simple"><li><span class="yiyi-st" id="yiyi-185"><span class="target" id="sqlalchemy.ext.automap.classname_for_table.params.base"></span><strong>base</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.ext.automap.classname_for_table.params.base">&#xB6;</a> &#x2013; the <a class="reference internal" href="#sqlalchemy.ext.automap.AutomapBase" title="sqlalchemy.ext.automap.AutomapBase"><code class="xref py py-class docutils literal"><span class="pre">AutomapBase</span></code></a> class doing the prepare.</span></li><li><span class="yiyi-st" id="yiyi-186"><span class="target" id="sqlalchemy.ext.automap.classname_for_table.params.tablename"></span><strong>tablename</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.ext.automap.classname_for_table.params.tablename">&#xB6;</a> &#x2013; string name of the <a class="reference internal" href="core_metadata.html#sqlalchemy.schema.Table" title="sqlalchemy.schema.Table"><code class="xref py py-class docutils literal"><span class="pre">Table</span></code></a>.</span></li><li><span class="yiyi-st" id="yiyi-187"><span class="target" id="sqlalchemy.ext.automap.classname_for_table.params.table"></span><strong>table</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.ext.automap.classname_for_table.params.table">&#xB6;</a> &#x2013; the <a class="reference internal" href="core_metadata.html#sqlalchemy.schema.Table" title="sqlalchemy.schema.Table"><code class="xref py py-class docutils literal"><span class="pre">Table</span></code></a> object itself.</span></li></ul></td></tr><tr class="field-even field"><th class="field-name"><span class="yiyi-st" id="yiyi-188">&#x8FD4;&#x56DE;&#xFF1A;</span></th><td class="field-body"><p class="first last"></p><p><span class="yiyi-st" id="yiyi-189">&#x4E00;&#x4E2A;&#x5B57;&#x7B26;&#x4E32;&#x7C7B;&#x7684;&#x540D;&#x5B57;&#x3002;</span></p><div class="admonition note"><p class="first admonition-title"><span class="yiyi-st" id="yiyi-190">&#x6CE8;&#x610F;</span></p><p class="last"><span class="yiyi-st" id="yiyi-191">&#x5728;Python 2&#x4E2D;&#xFF0C;&#x7528;&#x4E8E;&#x7C7B;&#x540D;<strong>&#x7684;&#x5B57;&#x7B26;&#x4E32;&#x5FC5;&#x987B;&#x662F;</strong>&#x975E;Unicode&#x5BF9;&#x8C61;&#xFF0C;&#x4F8B;&#x5982;&#x4E00;&#x4E2A;<code class="docutils literal"><span class="pre">str()</span></code>&#x5BF9;&#x8C61;&#x3002;</span><span class="yiyi-st" id="yiyi-192"><a class="reference internal" href="core_metadata.html#sqlalchemy.schema.Table" title="sqlalchemy.schema.Table"><code class="xref py py-class docutils literal"><span class="pre">Table</span></code></a>&#x7684;<code class="docutils literal"><span class="pre">.name</span></code>&#x5C5E;&#x6027;&#x901A;&#x5E38;&#x662F;&#x4E00;&#x4E2A;Python unicode&#x5B50;&#x7C7B;&#xFF0C;&#x6240;&#x4EE5;&#x5728;&#x8BA1;&#x7B97;&#x540E;&#x5E94;&#x8BE5;&#x5C06;<code class="docutils literal"><span class="pre">str()</span></code>&#x51FD;&#x6570;&#x5E94;&#x7528;&#x4E8E;&#x8BE5;&#x540D;&#x79F0;&#x4EFB;&#x4F55;&#x975E;ASCII&#x5B57;&#x7B26;&#x3002;</span></p></div></td></tr></tbody></table></dd></dl><dl class="function"><dt id="sqlalchemy.ext.automap.name_for_scalar_relationship"><span class="yiyi-st" id="yiyi-193"> <code class="descclassname">sqlalchemy.ext.automap.</code><code class="descname">name_for_scalar_relationship</code><span class="sig-paren">(</span><em>base</em>, <em>local_cls</em>, <em>referred_cls</em>, <em>constraint</em><span class="sig-paren">)</span><a class="headerlink" href="#sqlalchemy.ext.automap.name_for_scalar_relationship" title="Permalink to this definition">&#xB6;</a></span></dt><dd><p><span class="yiyi-st" id="yiyi-194">&#x5BF9;&#x4E8E;&#x6807;&#x91CF;&#x5BF9;&#x8C61;&#x5F15;&#x7528;&#xFF0C;&#x8FD4;&#x56DE;&#x5E94;&#x8BE5;&#x7528;&#x4E8E;&#x4ECE;&#x4E00;&#x4E2A;&#x7C7B;&#x5F15;&#x7528;&#x5230;&#x53E6;&#x4E00;&#x4E2A;&#x7C7B;&#x7684;&#x5C5E;&#x6027;&#x540D;&#x79F0;&#x3002;</span></p><p><span class="yiyi-st" id="yiyi-195">&#x9ED8;&#x8BA4;&#x7684;&#x5B9E;&#x73B0;&#x662F;&#xFF1A;</span></p><div class="highlight-python"><div class="highlight"><pre><span></span><span class="k">return</span> <span class="n">referred_cls</span><span class="o">.</span><span class="n">__name__</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span></pre></div></div><p><span class="yiyi-st" id="yiyi-196">&#x53EF;&#x4EE5;&#x4F7F;&#x7528;<a class="reference internal" href="#sqlalchemy.ext.automap.AutomapBase.prepare.params.name_for_scalar_relationship" title="sqlalchemy.ext.automap.AutomapBase.prepare"><code class="xref py py-paramref docutils literal"><span class="pre">AutomapBase.prepare.name_for_scalar_relationship</span></code></a>&#x53C2;&#x6570;&#x6307;&#x5B9A;&#x66FF;&#x4EE3;&#x5B9E;&#x73B0;&#x3002;</span></p><table class="docutils field-list" frame="void" rules="none"><tbody valign="top"><tr class="field-odd field"><th class="field-name"><span class="yiyi-st" id="yiyi-197">&#x53C2;&#x6570;&#xFF1A;</span></th><td class="field-body"><ul class="first last simple"><li><span class="yiyi-st" id="yiyi-198"><span class="target" id="sqlalchemy.ext.automap.name_for_scalar_relationship.params.base"></span><strong>base</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.ext.automap.name_for_scalar_relationship.params.base">&#xB6;</a> &#x2013; the <a class="reference internal" href="#sqlalchemy.ext.automap.AutomapBase" title="sqlalchemy.ext.automap.AutomapBase"><code class="xref py py-class docutils literal"><span class="pre">AutomapBase</span></code></a> class doing the prepare.</span></li><li><span class="yiyi-st" id="yiyi-199"><span class="target" id="sqlalchemy.ext.automap.name_for_scalar_relationship.params.local_cls"></span> <strong>local_cls</strong> <a class="paramlink headerlink reference internal" href="#sqlalchemy.ext.automap.name_for_scalar_relationship.params.local_cls">&#xB6;</a>  - &#x8981;&#x5728;&#x672C;&#x5730;&#x6620;&#x5C04;&#x7684;&#x7C7B;&#x3002;</span></li><li><span class="yiyi-st" id="yiyi-200"><span class="target" id="sqlalchemy.ext.automap.name_for_scalar_relationship.params.referred_cls"></span> <strong>referenced_cls</strong> <a class="paramlink headerlink reference internal" href="#sqlalchemy.ext.automap.name_for_scalar_relationship.params.referred_cls">&#xB6;</a>  - &#x8981;&#x5728;&#x5F15;&#x7528;&#x7AEF;&#x6620;&#x5C04;&#x7684;&#x7C7B;&#x3002;</span></li><li><span class="yiyi-st" id="yiyi-201"><span class="target" id="sqlalchemy.ext.automap.name_for_scalar_relationship.params.constraint"></span><strong>constraint</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.ext.automap.name_for_scalar_relationship.params.constraint">&#xB6;</a> &#x2013; the <a class="reference internal" href="core_constraints.html#sqlalchemy.schema.ForeignKeyConstraint" title="sqlalchemy.schema.ForeignKeyConstraint"><code class="xref py py-class docutils literal"><span class="pre">ForeignKeyConstraint</span></code></a> that is being inspected to produce this relationship.</span></li></ul></td></tr></tbody></table></dd></dl><dl class="function"><dt id="sqlalchemy.ext.automap.name_for_collection_relationship"><span class="yiyi-st" id="yiyi-202"> <code class="descclassname">sqlalchemy.ext.automap.</code><code class="descname">name_for_collection_relationship</code><span class="sig-paren">(</span><em>base</em>, <em>local_cls</em>, <em>referred_cls</em>, <em>constraint</em><span class="sig-paren">)</span><a class="headerlink" href="#sqlalchemy.ext.automap.name_for_collection_relationship" title="Permalink to this definition">&#xB6;</a></span></dt><dd><p><span class="yiyi-st" id="yiyi-203">&#x8FD4;&#x56DE;&#x5E94;&#x8BE5;&#x7528;&#x4E8E;&#x4ECE;&#x4E00;&#x4E2A;&#x7C7B;&#x5F15;&#x7528;&#x5230;&#x53E6;&#x4E00;&#x4E2A;&#x7C7B;&#x7684;&#x5C5E;&#x6027;&#x540D;&#x79F0;&#x4F5C;&#x4E3A;&#x96C6;&#x5408;&#x5F15;&#x7528;&#x3002;</span></p><p><span class="yiyi-st" id="yiyi-204">&#x9ED8;&#x8BA4;&#x7684;&#x5B9E;&#x73B0;&#x662F;&#xFF1A;</span></p><div class="highlight-python"><div class="highlight"><pre><span></span><span class="k">return</span> <span class="n">referred_cls</span><span class="o">.</span><span class="n">__name__</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">+</span> <span class="s2">&quot;_collection&quot;</span></pre></div></div><p><span class="yiyi-st" id="yiyi-205">&#x53EF;&#x4EE5;&#x4F7F;&#x7528;<a class="reference internal" href="#sqlalchemy.ext.automap.AutomapBase.prepare.params.name_for_collection_relationship" title="sqlalchemy.ext.automap.AutomapBase.prepare"><code class="xref py py-paramref docutils literal"><span class="pre">AutomapBase.prepare.name_for_collection_relationship</span></code></a>&#x53C2;&#x6570;&#x6307;&#x5B9A;&#x66FF;&#x4EE3;&#x5B9E;&#x73B0;&#x3002;</span></p><table class="docutils field-list" frame="void" rules="none"><tbody valign="top"><tr class="field-odd field"><th class="field-name"><span class="yiyi-st" id="yiyi-206">&#x53C2;&#x6570;&#xFF1A;</span></th><td class="field-body"><ul class="first last simple"><li><span class="yiyi-st" id="yiyi-207"><span class="target" id="sqlalchemy.ext.automap.name_for_collection_relationship.params.base"></span><strong>base</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.ext.automap.name_for_collection_relationship.params.base">&#xB6;</a> &#x2013; the <a class="reference internal" href="#sqlalchemy.ext.automap.AutomapBase" title="sqlalchemy.ext.automap.AutomapBase"><code class="xref py py-class docutils literal"><span class="pre">AutomapBase</span></code></a> class doing the prepare.</span></li><li><span class="yiyi-st" id="yiyi-208"><span class="target" id="sqlalchemy.ext.automap.name_for_collection_relationship.params.local_cls"></span> <strong>local_cls</strong> <a class="paramlink headerlink reference internal" href="#sqlalchemy.ext.automap.name_for_collection_relationship.params.local_cls">&#xB6;</a>  - &#x8981;&#x5728;&#x672C;&#x5730;&#x6620;&#x5C04;&#x7684;&#x7C7B;&#x3002;</span></li><li><span class="yiyi-st" id="yiyi-209"><span class="target" id="sqlalchemy.ext.automap.name_for_collection_relationship.params.referred_cls"></span> <strong>referenced_cls</strong> <a class="paramlink headerlink reference internal" href="#sqlalchemy.ext.automap.name_for_collection_relationship.params.referred_cls">&#xB6;</a>  - &#x8981;&#x5728;&#x5F15;&#x7528;&#x7AEF;&#x6620;&#x5C04;&#x7684;&#x7C7B;&#x3002;</span></li><li><span class="yiyi-st" id="yiyi-210"><span class="target" id="sqlalchemy.ext.automap.name_for_collection_relationship.params.constraint"></span><strong>constraint</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.ext.automap.name_for_collection_relationship.params.constraint">&#xB6;</a> &#x2013; the <a class="reference internal" href="core_constraints.html#sqlalchemy.schema.ForeignKeyConstraint" title="sqlalchemy.schema.ForeignKeyConstraint"><code class="xref py py-class docutils literal"><span class="pre">ForeignKeyConstraint</span></code></a> that is being inspected to produce this relationship.</span></li></ul></td></tr></tbody></table></dd></dl><dl class="function"><dt id="sqlalchemy.ext.automap.generate_relationship"><span class="yiyi-st" id="yiyi-211"><code class="descclassname"> sqlalchemy.ext.automap&#x3002; T0&gt; <code class="descname"> generate_relationship  T1&gt; <span class="sig-paren">&#xFF08; T2&gt; <em>&#x78B1; T3&gt;&#xFF0C;<em>&#x65B9;&#x5411; T4&gt;&#xFF0C;<em> return_fn  T5&gt;&#xFF0C;<em> attrname  T6&gt;&#xFF0C;<em> local_cls  T7&gt;&#xFF0C;<em> referred_cls  T8&gt;&#xFF0C;<em> **&#x5343;&#x74E6; T9&gt; <span class="sig-paren">&#xFF09; T10 &gt; <a class="headerlink" href="#sqlalchemy.ext.automap.generate_relationship" title="Permalink to this definition">&#xB6; T11&gt;</a></span></em></em></em></em></em></em></em></span></code></code></span></dt><dd><p><span class="yiyi-st" id="yiyi-212">&#x4EE3;&#x8868;&#x4E24;&#x4E2A;&#x6620;&#x5C04;&#x7C7B;&#x751F;&#x6210;<a class="reference internal" href="relationship_api.html#sqlalchemy.orm.relationship" title="sqlalchemy.orm.relationship"><code class="xref py py-func docutils literal"><span class="pre">relationship()</span></code></a>&#x6216;<a class="reference internal" href="relationship_api.html#sqlalchemy.orm.backref" title="sqlalchemy.orm.backref"><code class="xref py py-func docutils literal"><span class="pre">backref()</span></code></a>&#x3002;</span></p><p><span class="yiyi-st" id="yiyi-213">&#x8BE5;&#x51FD;&#x6570;&#x7684;&#x4E00;&#x4E2A;&#x66FF;&#x4EE3;&#x5B9E;&#x73B0;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;<a class="reference internal" href="#sqlalchemy.ext.automap.AutomapBase.prepare.params.generate_relationship" title="sqlalchemy.ext.automap.AutomapBase.prepare"><code class="xref py py-paramref docutils literal"><span class="pre">AutomapBase.prepare.generate_relationship</span></code></a>&#x53C2;&#x6570;&#x6307;&#x5B9A;&#x3002;</span></p><p><span class="yiyi-st" id="yiyi-214">&#x8FD9;&#x4E2A;&#x51FD;&#x6570;&#x7684;&#x9ED8;&#x8BA4;&#x5B9E;&#x73B0;&#x5982;&#x4E0B;&#xFF1A;</span></p><div class="highlight-python"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="n">return_fn</span> <span class="ow">is</span> <span class="n">backref</span><span class="p">:</span>
    <span class="k">return</span> <span class="n">return_fn</span><span class="p">(</span><span class="n">attrname</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">)</span>
<span class="k">elif</span> <span class="n">return_fn</span> <span class="ow">is</span> <span class="n">relationship</span><span class="p">:</span>
    <span class="k">return</span> <span class="n">return_fn</span><span class="p">(</span><span class="n">referred_cls</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Unknown relationship function: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">return_fn</span><span class="p">)</span></pre></div></div><table class="docutils field-list" frame="void" rules="none"><tbody valign="top"><tr class="field-odd field"><th class="field-name"><span class="yiyi-st" id="yiyi-215">&#x53C2;&#x6570;&#xFF1A;</span></th><td class="field-body"><ul class="first simple"><li><span class="yiyi-st" id="yiyi-216"><span class="target" id="sqlalchemy.ext.automap.generate_relationship.params.base"></span><strong>base</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.ext.automap.generate_relationship.params.base">&#xB6;</a> &#x2013; the <a class="reference internal" href="#sqlalchemy.ext.automap.AutomapBase" title="sqlalchemy.ext.automap.AutomapBase"><code class="xref py py-class docutils literal"><span class="pre">AutomapBase</span></code></a> class doing the prepare.</span></li><li><span class="yiyi-st" id="yiyi-217"><span class="target" id="sqlalchemy.ext.automap.generate_relationship.params.direction"></span><strong>direction</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.ext.automap.generate_relationship.params.direction">&#xB6;</a> &#x2013; indicate the &#x201C;direction&#x201D; of the relationship; this will be one of <a class="reference internal" href="internals.html#sqlalchemy.orm.interfaces.ONETOMANY" title="sqlalchemy.orm.interfaces.ONETOMANY"><code class="xref py py-data docutils literal"><span class="pre">ONETOMANY</span></code></a>, <a class="reference internal" href="internals.html#sqlalchemy.orm.interfaces.MANYTOONE" title="sqlalchemy.orm.interfaces.MANYTOONE"><code class="xref py py-data docutils literal"><span class="pre">MANYTOONE</span></code></a>, <a class="reference internal" href="internals.html#sqlalchemy.orm.interfaces.MANYTOMANY" title="sqlalchemy.orm.interfaces.MANYTOMANY"><code class="xref py py-data docutils literal"><span class="pre">MANYTOMANY</span></code></a>.</span></li><li><span class="yiyi-st" id="yiyi-218"><span class="target" id="sqlalchemy.ext.automap.generate_relationship.params.return_fn"></span> <strong>return_fn</strong> <a class="paramlink headerlink reference internal" href="#sqlalchemy.ext.automap.generate_relationship.params.return_fn">&#xB6;</a>  - &#x9ED8;&#x8BA4;&#x7528;&#x4E8E;&#x521B;&#x5EFA;&#x5173;&#x7CFB;&#x7684;&#x529F;&#x80FD;&#x3002;</span><span class="yiyi-st" id="yiyi-219">&#x8FD9;&#x5C06;&#x662F;<a class="reference internal" href="relationship_api.html#sqlalchemy.orm.relationship" title="sqlalchemy.orm.relationship"><code class="xref py py-func docutils literal"><span class="pre">relationship()</span></code></a>&#x6216;<a class="reference internal" href="relationship_api.html#sqlalchemy.orm.backref" title="sqlalchemy.orm.backref"><code class="xref py py-func docutils literal"><span class="pre">backref()</span></code></a>&#x3002;</span><span class="yiyi-st" id="yiyi-220">&#x5728;&#x7B2C;&#x4E8C;&#x6B65;&#x4E2D;&#xFF0C;&#x5C06;&#x4F7F;&#x7528;<a class="reference internal" href="relationship_api.html#sqlalchemy.orm.backref" title="sqlalchemy.orm.backref"><code class="xref py py-func docutils literal"><span class="pre">backref()</span></code></a>&#x51FD;&#x6570;&#x7684;&#x7ED3;&#x679C;&#x4EA7;&#x751F;&#x65B0;&#x7684;<a class="reference internal" href="relationship_api.html#sqlalchemy.orm.relationship" title="sqlalchemy.orm.relationship"><code class="xref py py-func docutils literal"><span class="pre">relationship()</span></code></a>&#xFF0C;&#x6240;&#x4EE5;&#x7528;&#x6237;&#x5B9A;&#x4E49;&#x7684;&#x5B9E;&#x73B0;&#x6B63;&#x786E;&#x533A;&#x5206;&#x8FD9;&#x4E24;&#x4E2A;&#x51FD;&#x6570;&#xFF0C;&#x5982;&#x679C;&#x4F7F;&#x7528;&#x81EA;&#x5B9A;&#x4E49;&#x5173;&#x7CFB;&#x51FD;&#x6570;&#x3002;</span></li><li><span class="yiyi-st" id="yiyi-221"><span class="target" id="sqlalchemy.ext.automap.generate_relationship.params.local_cls"></span><strong>local_cls</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.ext.automap.generate_relationship.params.local_cls">&#xB6;</a> &#x2013; the &#x201C;local&#x201D; class to which this relationship or backref will be locally present.</span></li><li><span class="yiyi-st" id="yiyi-222"><span class="target" id="sqlalchemy.ext.automap.generate_relationship.params.referred_cls"></span><strong>referred_cls</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.ext.automap.generate_relationship.params.referred_cls">&#xB6;</a> &#x2013; the &#x201C;referred&#x201D; class to which the relationship or backref refers to.</span></li><li><span class="yiyi-st" id="yiyi-223"><span class="target" id="sqlalchemy.ext.automap.generate_relationship.params.**kw"></span> <strong>** kw</strong> <a class="paramlink headerlink reference internal" href="#sqlalchemy.ext.automap.generate_relationship.params.**kw">&#xB6;</a>  - &#x6240;&#x6709;&#x5176;&#x4ED6;&#x5173;&#x952E;&#x5B57;&#x53C2;&#x6570;&#x90FD;&#x4F20;&#x9012;&#x7ED9;&#x8BE5;&#x51FD;&#x6570;&#x3002;</span></li></ul></td></tr><tr class="field-even field"><th class="field-name"><span class="yiyi-st" id="yiyi-224">Attrname&#xFF1A;</span></th><td class="field-body"><p class="first"><span class="yiyi-st" id="yiyi-225">&#x8BE5;&#x5173;&#x7CFB;&#x88AB;&#x5206;&#x914D;&#x5230;&#x7684;&#x5C5E;&#x6027;&#x540D;&#x79F0;&#x3002;</span><span class="yiyi-st" id="yiyi-226">&#x5982;&#x679C;<a class="reference internal" href="#sqlalchemy.ext.automap.generate_relationship.params.return_fn" title="sqlalchemy.ext.automap.generate_relationship"><code class="xref py py-paramref docutils literal"><span class="pre">generate_relationship.return_fn</span></code></a>&#x7684;&#x503C;&#x662F;<a class="reference internal" href="relationship_api.html#sqlalchemy.orm.backref" title="sqlalchemy.orm.backref"><code class="xref py py-func docutils literal"><span class="pre">backref()</span></code></a>&#x51FD;&#x6570;&#xFF0C;&#x90A3;&#x4E48;&#x8FD9;&#x4E2A;&#x540D;&#x79F0;&#x662F;&#x5206;&#x914D;&#x7ED9;&#x540E;&#x7AEF;&#x53C2;&#x8003;&#x7684;&#x540D;&#x79F0;&#x3002;</span></p></td></tr><tr class="field-odd field"><th class="field-name"><span class="yiyi-st" id="yiyi-227">&#x8FD4;&#x56DE;&#xFF1A;</span></th><td class="field-body"><p class="first last"><span class="yiyi-st" id="yiyi-228"><a class="reference internal" href="relationship_api.html#sqlalchemy.orm.relationship" title="sqlalchemy.orm.relationship"><code class="xref py py-func docutils literal"><span class="pre">relationship()</span></code></a>&#x6216;<a class="reference internal" href="relationship_api.html#sqlalchemy.orm.backref" title="sqlalchemy.orm.backref"><code class="xref py py-func docutils literal"><span class="pre">backref()</span></code></a>&#x7ED3;&#x6784;&#xFF0C;&#x5982;<a class="reference internal" href="#sqlalchemy.ext.automap.generate_relationship.params.return_fn" title="sqlalchemy.ext.automap.generate_relationship"><code class="xref py py-paramref docutils literal"><span class="pre">generate_relationship.return_fn</span></code></a>&#x53C2;&#x6570;&#x6307;&#x5B9A;&#x7684;&#x3002;</span></p></td></tr></tbody></table></dd></dl></div>