<h1><span class="yiyi-st" id="yiyi-47">&#x6C34;&#x5E73;&#x5206;&#x7247;<a class="headerlink" href="#module-sqlalchemy.ext.horizontal_shard" title="Permalink to this headline">&#xB6;</a></span></h1><p><span class="yiyi-st" id="yiyi-48">&#x6C34;&#x5E73;&#x5206;&#x7247;&#x652F;&#x6301;&#x3002;</span></p><p><span class="yiyi-st" id="yiyi-49">&#x5B9A;&#x4E49;&#x4E86;&#x4E00;&#x4E2A;&#x57FA;&#x672C;&#x7684;&#x201C;&#x6C34;&#x5E73;&#x5206;&#x5272;&#x201D;&#x7CFB;&#x7EDF;&#xFF0C;&#x5B83;&#x5141;&#x8BB8;&#x4F1A;&#x8BDD;&#x8DE8;&#x591A;&#x4E2A;&#x6570;&#x636E;&#x5E93;&#x5206;&#x53D1;&#x67E5;&#x8BE2;&#x548C;&#x6301;&#x4E45;&#x6027;&#x64CD;&#x4F5C;&#x3002;</span></p><p><span class="yiyi-st" id="yiyi-50">&#x6709;&#x5173;&#x4F7F;&#x7528;&#x793A;&#x4F8B;&#xFF0C;&#x8BF7;&#x53C2;&#x9605;&#x6E90;&#x5206;&#x5E03;&#x4E2D;&#x5305;&#x542B;&#x7684;<a class="reference internal" href="examples.html#examples-sharding"><span>Horizontal Sharding</span></a>&#x793A;&#x4F8B;&#x3002;</span></p><div class="section" id="api-documentation"><h2><span class="yiyi-st" id="yiyi-51">API&#x6587;&#x6863;<a class="headerlink" href="#api-documentation" title="Permalink to this headline">&#xB6;</a></span></h2><dl class="class"><dt id="sqlalchemy.ext.horizontal_shard.ShardedSession"><span class="yiyi-st" id="yiyi-52"> <em class="property">class </em><code class="descclassname">sqlalchemy.ext.horizontal_shard.</code><code class="descname">ShardedSession</code><span class="sig-paren">(</span><em>shard_chooser</em>, <em>id_chooser</em>, <em>query_chooser</em>, <em>shards=None</em>, <em>query_cls=&lt;class &apos;sqlalchemy.ext.horizontal_shard.ShardedQuery&apos;&gt;</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#sqlalchemy.ext.horizontal_shard.ShardedSession" title="Permalink to this definition">&#xB6;</a></span></dt><dd><p><span class="yiyi-st" id="yiyi-53">&#x57FA;&#x7840;&#xFF1A;<a class="reference internal" href="session_api.html#sqlalchemy.orm.session.Session" title="sqlalchemy.orm.session.Session"><code class="xref py py-class docutils literal"><span class="pre">sqlalchemy.orm.session.Session</span></code></a></span></p><dl class="method"><dt id="sqlalchemy.ext.horizontal_shard.ShardedSession.__init__"><span class="yiyi-st" id="yiyi-54"> <code class="descname">__init__</code><span class="sig-paren">(</span><em>shard_chooser</em>, <em>id_chooser</em>, <em>query_chooser</em>, <em>shards=None</em>, <em>query_cls=&lt;class &apos;sqlalchemy.ext.horizontal_shard.ShardedQuery&apos;&gt;</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#sqlalchemy.ext.horizontal_shard.ShardedSession.__init__" title="Permalink to this definition">&#xB6;</a></span></dt><dd><p><span class="yiyi-st" id="yiyi-55">&#x6784;&#x5EFA;ShardedSession&#x3002;</span></p><table class="docutils field-list" frame="void" rules="none"><tbody valign="top"><tr class="field-odd field"><th class="field-name"><span class="yiyi-st" id="yiyi-56">&#x53C2;&#x6570;&#xFF1A;</span></th><td class="field-body"><ul class="first last simple"><li><span class="yiyi-st" id="yiyi-57"><span class="target" id="sqlalchemy.ext.horizontal_shard.ShardedSession.params.shard_chooser"></span><strong>shard_chooser</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.ext.horizontal_shard.ShardedSession.params.shard_chooser">&#xB6;</a> &#x2013; A callable which, passed a Mapper, a mapped instance, and possibly a SQL clause, returns a shard ID. </span><span class="yiyi-st" id="yiyi-58">&#x8BE5;ID&#x53EF;&#x4EE5;&#x57FA;&#x4E8E;&#x5BF9;&#x8C61;&#x5185;&#x5B58;&#x5728;&#x7684;&#x5C5E;&#x6027;&#x6216;&#x67D0;&#x79CD;&#x5FAA;&#x73AF;&#x65B9;&#x6848;&#x3002;</span><span class="yiyi-st" id="yiyi-59">&#x5982;&#x679C;&#x8BE5;&#x65B9;&#x6848;&#x57FA;&#x4E8E;&#x9009;&#x62E9;&#xFF0C;&#x5219;&#x5E94;&#x8BBE;&#x7F6E;&#x5B9E;&#x4F8B;&#x4E0A;&#x7684;&#x4EFB;&#x4F55;&#x72B6;&#x6001;&#x4EE5;&#x5C06;&#x5176;&#x6807;&#x8BB0;&#x4E3A;&#x53C2;&#x4E0E;&#x8BE5;&#x5206;&#x7247;&#x3002;</span></li><li><span class="yiyi-st" id="yiyi-60"><span class="target" id="sqlalchemy.ext.horizontal_shard.ShardedSession.params.id_chooser"></span><strong>id_chooser</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.ext.horizontal_shard.ShardedSession.params.id_chooser">&#xB6;</a> &#x2013; A callable, passed a query and a tuple of identity values, which should return a list of shard ids where the ID might reside. </span><span class="yiyi-st" id="yiyi-61">&#x6570;&#x636E;&#x5E93;&#x5C06;&#x6309;&#x7167;&#x6B64;&#x5217;&#x8868;&#x7684;&#x987A;&#x5E8F;&#x8FDB;&#x884C;&#x67E5;&#x8BE2;&#x3002;</span></li><li><span class="yiyi-st" id="yiyi-62"><span class="target" id="sqlalchemy.ext.horizontal_shard.ShardedSession.params.query_chooser"></span><strong>query_chooser</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.ext.horizontal_shard.ShardedSession.params.query_chooser">&#xB6;</a> &#x2013; For a given Query, returns the list of shard_ids where the query should be issued. </span><span class="yiyi-st" id="yiyi-63">&#x6240;&#x6709;&#x8FD4;&#x56DE;&#x7684;&#x788E;&#x7247;&#x7ED3;&#x679C;&#x5C06;&#x5408;&#x5E76;&#x6210;&#x4E00;&#x4E2A;&#x5217;&#x8868;&#x3002;</span></li><li><span class="yiyi-st" id="yiyi-64"><span class="target" id="sqlalchemy.ext.horizontal_shard.ShardedSession.params.shards"></span><strong>shards</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.ext.horizontal_shard.ShardedSession.params.shards">&#xB6;</a> &#x2013; A dictionary of string shard names to <a class="reference internal" href="core_connections.html#sqlalchemy.engine.Engine" title="sqlalchemy.engine.Engine"><code class="xref py py-class docutils literal"><span class="pre">Engine</span></code></a> objects.</span></li></ul></td></tr></tbody></table></dd></dl></dd></dl><dl class="class"><dt id="sqlalchemy.ext.horizontal_shard.ShardedQuery"><span class="yiyi-st" id="yiyi-65"> <em class="property">class </em><code class="descclassname">sqlalchemy.ext.horizontal_shard.</code><code class="descname">ShardedQuery</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#sqlalchemy.ext.horizontal_shard.ShardedQuery" title="Permalink to this definition">&#xB6;</a></span></dt><dd><p><span class="yiyi-st" id="yiyi-66">&#x57FA;&#x7840;&#xFF1A;<a class="reference internal" href="query.html#sqlalchemy.orm.query.Query" title="sqlalchemy.orm.query.Query"><code class="xref py py-class docutils literal"><span class="pre">sqlalchemy.orm.query.Query</span></code></a></span></p><dl class="method"><dt id="sqlalchemy.ext.horizontal_shard.ShardedQuery.set_shard"><span class="yiyi-st" id="yiyi-67"><code class="descname"> set_shard  T0&gt; <span class="sig-paren">&#xFF08; T1&gt; <em> shard_id  T2&gt; <span class="sig-paren">&#xFF09; T3&gt; <a class="headerlink" href="#sqlalchemy.ext.horizontal_shard.ShardedQuery.set_shard" title="Permalink to this definition">&#xB6; T4&gt;</a></span></em></span></code></span></dt><dd><p><span class="yiyi-st" id="yiyi-68">&#x8FD4;&#x56DE;&#x4E00;&#x4E2A;&#x65B0;&#x7684;&#x67E5;&#x8BE2;&#xFF0C;&#x9650;&#x4E8E;&#x5355;&#x4E2A;&#x5206;&#x7247;ID&#x3002;</span></p><p><span class="yiyi-st" id="yiyi-69">&#x65E0;&#x8BBA;&#x5176;&#x4ED6;&#x72B6;&#x6001;&#x5982;&#x4F55;&#xFF0C;&#x8FD4;&#x56DE;&#x67E5;&#x8BE2;&#x7684;&#x6240;&#x6709;&#x540E;&#x7EED;&#x64CD;&#x4F5C;&#x90FD;&#x5C06;&#x9488;&#x5BF9;&#x5355;&#x4E2A;&#x5206;&#x7247;&#x3002;</span></p></dd></dl></dd></dl></div>