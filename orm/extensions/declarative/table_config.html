<h1><span class="yiyi-st" id="yiyi-54">&#x8868;&#x683C;&#x914D;&#x7F6E;<a class="headerlink" href="#table-configuration" title="Permalink to this headline">&#xB6;</a></span></h1><p><span class="yiyi-st" id="yiyi-55">&#x9664;&#x4E86;&#x540D;&#x79F0;&#xFF0C;&#x5143;&#x6570;&#x636E;&#x548C;&#x6620;&#x5C04;&#x5217;&#x53C2;&#x6570;&#x4E4B;&#x5916;&#x7684;&#x8868;&#x53C2;&#x6570;&#x662F;&#x4F7F;&#x7528;<code class="docutils literal"><span class="pre">__table_args__</span></code>&#x7C7B;&#x5C5E;&#x6027;&#x6307;&#x5B9A;&#x7684;&#x3002;</span><span class="yiyi-st" id="yiyi-56">&#x8BE5;&#x5C5E;&#x6027;&#x5305;&#x542B;&#x901A;&#x5E38;&#x53D1;&#x9001;&#x5230;<a class="reference internal" href="core_metadata.html#sqlalchemy.schema.Table" title="sqlalchemy.schema.Table"><code class="xref py py-class docutils literal"><span class="pre">Table</span></code></a>&#x6784;&#x9020;&#x51FD;&#x6570;&#x7684;&#x4F4D;&#x7F6E;&#x548C;&#x5173;&#x952E;&#x5B57;&#x53C2;&#x6570;&#x3002;</span><span class="yiyi-st" id="yiyi-57">&#x8BE5;&#x5C5E;&#x6027;&#x53EF;&#x4EE5;&#x7528;&#x4E24;&#x79CD;&#x5F62;&#x5F0F;&#x4E4B;&#x4E00;&#x6765;&#x6307;&#x5B9A;&#x3002;</span><span class="yiyi-st" id="yiyi-58">&#x4E00;&#x4E2A;&#x662F;&#x5B57;&#x5178;&#xFF1A;</span></p><div class="highlight-python"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">MyClass</span><span class="p">(</span><span class="n">Base</span><span class="p">):</span>
    <span class="n">__tablename__</span> <span class="o">=</span> <span class="s1">&apos;sometable&apos;</span>
    <span class="n">__table_args__</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&apos;mysql_engine&apos;</span><span class="p">:</span><span class="s1">&apos;InnoDB&apos;</span><span class="p">}</span></pre></div></div><p><span class="yiyi-st" id="yiyi-59">&#x53E6;&#x4E00;&#x4E2A;&#x662F;&#x5143;&#x7EC4;&#xFF0C;&#x6BCF;&#x4E2A;&#x53C2;&#x6570;&#x90FD;&#x662F;&#x4F4D;&#x7F6E;&#x7684;&#xFF08;&#x901A;&#x5E38;&#x662F;&#x7EA6;&#x675F;&#x6761;&#x4EF6;&#xFF09;&#xFF1A;</span></p><div class="highlight-python"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">MyClass</span><span class="p">(</span><span class="n">Base</span><span class="p">):</span>
    <span class="n">__tablename__</span> <span class="o">=</span> <span class="s1">&apos;sometable&apos;</span>
    <span class="n">__table_args__</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">ForeignKeyConstraint</span><span class="p">([</span><span class="s1">&apos;id&apos;</span><span class="p">],</span> <span class="p">[</span><span class="s1">&apos;remote_table.id&apos;</span><span class="p">]),</span>
            <span class="n">UniqueConstraint</span><span class="p">(</span><span class="s1">&apos;foo&apos;</span><span class="p">),</span>
            <span class="p">)</span></pre></div></div><p><span class="yiyi-st" id="yiyi-60">&#x901A;&#x8FC7;&#x5C06;&#x6700;&#x540E;&#x4E00;&#x4E2A;&#x53C2;&#x6570;&#x6307;&#x5B9A;&#x4E3A;&#x5B57;&#x5178;&#xFF0C;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;&#x4E0A;&#x8FF0;&#x5F62;&#x5F0F;&#x6307;&#x5B9A;&#x5173;&#x952E;&#x5B57;&#x53C2;&#x6570;&#xFF1A;</span></p><div class="highlight-python"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">MyClass</span><span class="p">(</span><span class="n">Base</span><span class="p">):</span>
    <span class="n">__tablename__</span> <span class="o">=</span> <span class="s1">&apos;sometable&apos;</span>
    <span class="n">__table_args__</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">ForeignKeyConstraint</span><span class="p">([</span><span class="s1">&apos;id&apos;</span><span class="p">],</span> <span class="p">[</span><span class="s1">&apos;remote_table.id&apos;</span><span class="p">]),</span>
            <span class="n">UniqueConstraint</span><span class="p">(</span><span class="s1">&apos;foo&apos;</span><span class="p">),</span>
            <span class="p">{</span><span class="s1">&apos;autoload&apos;</span><span class="p">:</span><span class="bp">True</span><span class="p">}</span>
            <span class="p">)</span></pre></div></div><div class="section" id="using-a-hybrid-approach-with-table"><h2><span class="yiyi-st" id="yiyi-61">&#x4F7F;&#x7528;__table __ <a class="headerlink" href="#using-a-hybrid-approach-with-table" title="Permalink to this headline">&#xB6;</a>&#x7684;&#x6DF7;&#x5408;&#x65B9;&#x6CD5;</span></h2><p><span class="yiyi-st" id="yiyi-62">&#x4F5C;&#x4E3A;<code class="docutils literal"><span class="pre">__tablename__</span></code>&#x7684;&#x66FF;&#x4EE3;&#x65B9;&#x6848;&#xFF0C;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;&#x76F4;&#x63A5;&#x7684;<a class="reference internal" href="core_metadata.html#sqlalchemy.schema.Table" title="sqlalchemy.schema.Table"><code class="xref py py-class docutils literal"><span class="pre">Table</span></code></a>&#x7ED3;&#x6784;&#x3002;</span><span class="yiyi-st" id="yiyi-63">&#x5728;&#x8FD9;&#x79CD;&#x60C5;&#x51B5;&#x4E0B;&#x9700;&#x8981;&#x540D;&#x79F0;&#x7684;<a class="reference internal" href="core_metadata.html#sqlalchemy.schema.Column" title="sqlalchemy.schema.Column"><code class="xref py py-class docutils literal"><span class="pre">Column</span></code></a>&#x5BF9;&#x8C61;&#x5C06;&#x88AB;&#x6DFB;&#x52A0;&#x5230;&#x6620;&#x5C04;&#x4E2D;&#xFF0C;&#x5C31;&#x50CF;&#x6B63;&#x5E38;&#x6620;&#x5C04;&#x5230;&#x8868;&#x4E00;&#x6837;&#xFF1A;</span></p><div class="highlight-python"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">MyClass</span><span class="p">(</span><span class="n">Base</span><span class="p">):</span>
    <span class="n">__table__</span> <span class="o">=</span> <span class="n">Table</span><span class="p">(</span><span class="s1">&apos;my_table&apos;</span><span class="p">,</span> <span class="n">Base</span><span class="o">.</span><span class="n">metadata</span><span class="p">,</span>
        <span class="n">Column</span><span class="p">(</span><span class="s1">&apos;id&apos;</span><span class="p">,</span> <span class="n">Integer</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="bp">True</span><span class="p">),</span>
        <span class="n">Column</span><span class="p">(</span><span class="s1">&apos;name&apos;</span><span class="p">,</span> <span class="n">String</span><span class="p">(</span><span class="mi">50</span><span class="p">))</span>
    <span class="p">)</span></pre></div></div><p><span class="yiyi-st" id="yiyi-64"><code class="docutils literal"><span class="pre">__table__</span></code> provides a more focused point of control for establishing table metadata, while still getting most of the benefits of using declarative. </span><span class="yiyi-st" id="yiyi-65">&#x4F7F;&#x7528;&#x53CD;&#x5C04;&#x7684;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x53EF;&#x80FD;&#x5E0C;&#x671B;&#x5728;&#x5176;&#x4ED6;&#x5730;&#x65B9;&#x52A0;&#x8F7D;&#x8868;&#x5143;&#x6570;&#x636E;&#x5E76;&#x5C06;&#x5176;&#x4F20;&#x9012;&#x7ED9;&#x58F0;&#x660E;&#x6027;&#x7C7B;&#xFF1A;</span></p><div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sqlalchemy.ext.declarative</span> <span class="kn">import</span> <span class="n">declarative_base</span>

<span class="n">Base</span> <span class="o">=</span> <span class="n">declarative_base</span><span class="p">()</span>
<span class="n">Base</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">reflect</span><span class="p">(</span><span class="n">some_engine</span><span class="p">)</span>

<span class="k">class</span> <span class="nc">User</span><span class="p">(</span><span class="n">Base</span><span class="p">):</span>
    <span class="n">__table__</span> <span class="o">=</span> <span class="n">metadata</span><span class="o">.</span><span class="n">tables</span><span class="p">[</span><span class="s1">&apos;user&apos;</span><span class="p">]</span>

<span class="k">class</span> <span class="nc">Address</span><span class="p">(</span><span class="n">Base</span><span class="p">):</span>
    <span class="n">__table__</span> <span class="o">=</span> <span class="n">metadata</span><span class="o">.</span><span class="n">tables</span><span class="p">[</span><span class="s1">&apos;address&apos;</span><span class="p">]</span></pre></div></div><p><span class="yiyi-st" id="yiyi-66">&#x4E00;&#x4E9B;&#x914D;&#x7F6E;&#x65B9;&#x6848;&#x53EF;&#x80FD;&#x4F1A;&#x53D1;&#x73B0;&#x4F7F;&#x7528;<code class="docutils literal"><span class="pre">__table__</span></code>&#x66F4;&#x5408;&#x9002;&#xFF0C;&#x4F8B;&#x5982;&#x90A3;&#x4E9B;&#x5DF2;&#x7ECF;&#x5229;&#x7528;<a class="reference internal" href="core_metadata.html#sqlalchemy.schema.Table" title="sqlalchemy.schema.Table"><code class="xref py py-class docutils literal"><span class="pre">Table</span></code></a>&#x7684;&#x6570;&#x636E;&#x9A71;&#x52A8;&#x6027;&#x8D28;&#x6765;&#x81EA;&#x5B9A;&#x4E49;&#x548C;/&#x6216;&#x81EA;&#x52A8;&#x5316;&#x6A21;&#x5F0F;&#x5B9A;&#x4E49;&#x7684;&#x914D;&#x7F6E;&#x65B9;&#x6848;&#x3002;</span></p><p><span class="yiyi-st" id="yiyi-67">&#x8BF7;&#x6CE8;&#x610F;&#xFF0C;&#x5F53;&#x4F7F;&#x7528;<code class="docutils literal"><span class="pre">__table__</span></code>&#x65B9;&#x6CD5;&#x65F6;&#xFF0C;&#x8BE5;&#x5BF9;&#x8C61;&#x53EF;&#x7ACB;&#x5373;&#x7528;&#x4F5C;&#x7C7B;&#x58F0;&#x660E;&#x4E3B;&#x4F53;&#x672C;&#x8EAB;&#x5185;&#x7684;<a class="reference internal" href="core_metadata.html#sqlalchemy.schema.Table" title="sqlalchemy.schema.Table"><code class="xref py py-class docutils literal"><span class="pre">Table</span></code></a>&#xFF0C;&#x56E0;&#x4E3A;Python&#x7C7B;&#x53EA;&#x662F;&#x53E6;&#x4E00;&#x4E2A;&#x8BED;&#x6CD5;&#x5757;&#x3002;</span><span class="yiyi-st" id="yiyi-68">&#x5728;<a class="reference internal" href="relationship_api.html#sqlalchemy.orm.relationship" title="sqlalchemy.orm.relationship"><code class="xref py py-func docutils literal"><span class="pre">relationship()</span></code></a>&#x7684;<code class="docutils literal"><span class="pre">primaryjoin</span></code>&#x6761;&#x4EF6;&#x4E2D;&#x4F7F;&#x7528;<code class="docutils literal"><span class="pre">id</span></code>&#x5217;&#x6765;&#x8BF4;&#x660E;&#x4EE5;&#x4E0B;&#x60C5;&#x51B5;&#xFF1A;</span></p><div class="highlight-python"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">MyClass</span><span class="p">(</span><span class="n">Base</span><span class="p">):</span>
    <span class="n">__table__</span> <span class="o">=</span> <span class="n">Table</span><span class="p">(</span><span class="s1">&apos;my_table&apos;</span><span class="p">,</span> <span class="n">Base</span><span class="o">.</span><span class="n">metadata</span><span class="p">,</span>
        <span class="n">Column</span><span class="p">(</span><span class="s1">&apos;id&apos;</span><span class="p">,</span> <span class="n">Integer</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="bp">True</span><span class="p">),</span>
        <span class="n">Column</span><span class="p">(</span><span class="s1">&apos;name&apos;</span><span class="p">,</span> <span class="n">String</span><span class="p">(</span><span class="mi">50</span><span class="p">))</span>
    <span class="p">)</span>

    <span class="n">widgets</span> <span class="o">=</span> <span class="n">relationship</span><span class="p">(</span><span class="n">Widget</span><span class="p">,</span>
                <span class="n">primaryjoin</span><span class="o">=</span><span class="n">Widget</span><span class="o">.</span><span class="n">myclass_id</span><span class="o">==</span><span class="n">__table__</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">id</span><span class="p">)</span></pre></div></div><p><span class="yiyi-st" id="yiyi-69">&#x7C7B;&#x4F3C;&#x5730;&#xFF0C;&#x5F15;&#x7528;<code class="docutils literal"><span class="pre">__table__</span></code>&#x7684;&#x6620;&#x5C04;&#x5C5E;&#x6027;&#x53EF;&#x4EE5;&#x5185;&#x8054;&#x653E;&#x7F6E;&#xFF0C;&#x5982;&#x4E0B;&#x6211;&#x4EEC;&#x5C06;<code class="docutils literal"><span class="pre">name</span></code>&#x5217;&#x5206;&#x914D;&#x7ED9;&#x5C5E;&#x6027;<code class="docutils literal"><span class="pre">_name</span></code>&#xFF0C;&#x751F;&#x6210;&#x540C;&#x4E49;&#x8BCD;&#x5BF9;&#x4E8E;<code class="docutils literal"><span class="pre">name</span></code>&#xFF1A;</span></p><div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sqlalchemy.ext.declarative</span> <span class="kn">import</span> <span class="n">synonym_for</span>

<span class="k">class</span> <span class="nc">MyClass</span><span class="p">(</span><span class="n">Base</span><span class="p">):</span>
    <span class="n">__table__</span> <span class="o">=</span> <span class="n">Table</span><span class="p">(</span><span class="s1">&apos;my_table&apos;</span><span class="p">,</span> <span class="n">Base</span><span class="o">.</span><span class="n">metadata</span><span class="p">,</span>
        <span class="n">Column</span><span class="p">(</span><span class="s1">&apos;id&apos;</span><span class="p">,</span> <span class="n">Integer</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="bp">True</span><span class="p">),</span>
        <span class="n">Column</span><span class="p">(</span><span class="s1">&apos;name&apos;</span><span class="p">,</span> <span class="n">String</span><span class="p">(</span><span class="mi">50</span><span class="p">))</span>
    <span class="p">)</span>

    <span class="n">_name</span> <span class="o">=</span> <span class="n">__table__</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">name</span>

    <span class="nd">@synonym_for</span><span class="p">(</span><span class="s2">&quot;_name&quot;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">name</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s2">&quot;Name: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">_name</span></pre></div></div></div><div class="section" id="using-reflection-with-declarative"><h2><span class="yiyi-st" id="yiyi-70">&#x7528;&#x58F0;&#x660E;<a class="headerlink" href="#using-reflection-with-declarative" title="Permalink to this headline">&#xB6;</a>&#x4F7F;&#x7528;&#x53CD;&#x5C04;</span></h2><p><span class="yiyi-st" id="yiyi-71">&#x5C06;<code class="docutils literal"><span class="pre">autoload=True</span></code>&#x4E0E;&#x6620;&#x5C04;&#x7C7B;&#x7ED3;&#x5408;&#x4F7F;&#x7528;&#x7684;<a class="reference internal" href="core_metadata.html#sqlalchemy.schema.Table" title="sqlalchemy.schema.Table"><code class="xref py py-class docutils literal"><span class="pre">Table</span></code></a>&#x5F88;&#x5BB9;&#x6613;&#xFF1A;</span></p><div class="highlight-python"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">MyClass</span><span class="p">(</span><span class="n">Base</span><span class="p">):</span>
    <span class="n">__table__</span> <span class="o">=</span> <span class="n">Table</span><span class="p">(</span><span class="s1">&apos;mytable&apos;</span><span class="p">,</span> <span class="n">Base</span><span class="o">.</span><span class="n">metadata</span><span class="p">,</span>
                    <span class="n">autoload</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">autoload_with</span><span class="o">=</span><span class="n">some_engine</span><span class="p">)</span></pre></div></div><p><span class="yiyi-st" id="yiyi-72">&#x7136;&#x800C;&#xFF0C;&#x8FD9;&#x91CC;&#x53EF;&#x4EE5;&#x505A;&#x51FA;&#x7684;&#x4E00;&#x4E2A;&#x6539;&#x8FDB;&#x662F;&#x5728;&#x9996;&#x6B21;&#x58F0;&#x660E;&#x7C7B;&#x65F6;&#x4E0D;&#x8981;&#x6C42;<a class="reference internal" href="core_connections.html#sqlalchemy.engine.Engine" title="sqlalchemy.engine.Engine"><code class="xref py py-class docutils literal"><span class="pre">Engine</span></code></a>&#x53EF;&#x7528;&#x3002;</span><span class="yiyi-st" id="yiyi-73">&#x4E3A;&#x4E86;&#x8FBE;&#x5230;&#x8FD9;&#x4E2A;&#x76EE;&#x7684;&#xFF0C;&#x4F7F;&#x7528;<a class="reference internal" href="api.html#sqlalchemy.ext.declarative.DeferredReflection" title="sqlalchemy.ext.declarative.DeferredReflection"><code class="xref py py-class docutils literal"><span class="pre">DeferredReflection</span></code></a> mixin&#xFF0C;&#x5B83;&#x53EA;&#x6709;&#x5728;&#x8C03;&#x7528;&#x4E00;&#x4E2A;&#x7279;&#x6B8A;&#x7684;<code class="docutils literal"><span class="pre">prepare(engine)</span></code>&#x6B65;&#x9AA4;&#x540E;&#x624D;&#x80FD;&#x8BBE;&#x7F6E;&#x6620;&#x5C04;&#xFF1A;</span></p><div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sqlalchemy.ext.declarative</span> <span class="kn">import</span> <span class="n">declarative_base</span><span class="p">,</span> <span class="n">DeferredReflection</span>

<span class="n">Base</span> <span class="o">=</span> <span class="n">declarative_base</span><span class="p">(</span><span class="n">cls</span><span class="o">=</span><span class="n">DeferredReflection</span><span class="p">)</span>

<span class="k">class</span> <span class="nc">Foo</span><span class="p">(</span><span class="n">Base</span><span class="p">):</span>
    <span class="n">__tablename__</span> <span class="o">=</span> <span class="s1">&apos;foo&apos;</span>
    <span class="n">bars</span> <span class="o">=</span> <span class="n">relationship</span><span class="p">(</span><span class="s2">&quot;Bar&quot;</span><span class="p">)</span>

<span class="k">class</span> <span class="nc">Bar</span><span class="p">(</span><span class="n">Base</span><span class="p">):</span>
    <span class="n">__tablename__</span> <span class="o">=</span> <span class="s1">&apos;bar&apos;</span>

    <span class="c1"># illustrate overriding of &quot;bar.foo_id&quot; to have</span>
    <span class="c1"># a foreign key constraint otherwise not</span>
    <span class="c1"># reflected, such as when using MySQL</span>
    <span class="n">foo_id</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">Integer</span><span class="p">,</span> <span class="n">ForeignKey</span><span class="p">(</span><span class="s1">&apos;foo.id&apos;</span><span class="p">))</span>

<span class="n">Base</span><span class="o">.</span><span class="n">prepare</span><span class="p">(</span><span class="n">e</span><span class="p">)</span></pre></div></div><div class="versionadded"><p><span class="yiyi-st" id="yiyi-74"><span class="versionmodified">&#x7248;&#x672C;0.8&#x65B0;&#x589E;&#xFF1A;</span>&#x65B0;&#x589E;<a class="reference internal" href="api.html#sqlalchemy.ext.declarative.DeferredReflection" title="sqlalchemy.ext.declarative.DeferredReflection"><code class="xref py py-class docutils literal"><span class="pre">DeferredReflection</span></code></a>&#x3002;</span></p></div></div>