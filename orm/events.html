<h1><span class="yiyi-st" id="yiyi-46">ORM&#x4E8B;&#x4EF6;<a class="headerlink" href="#orm-events" title="Permalink to this headline">&#xB6;</a></span></h1><p><span class="yiyi-st" id="yiyi-47">ORM&#x5305;&#x542B;&#x5404;&#x79CD;&#x53EF;&#x7528;&#x4E8E;&#x8BA2;&#x9605;&#x7684;&#x6302;&#x94A9;&#x3002;</span></p><p><span class="yiyi-st" id="yiyi-48">&#x6709;&#x5173;&#x6700;&#x5E38;&#x7528;&#x7684;ORM&#x4E8B;&#x4EF6;&#x7684;&#x4ECB;&#x7ECD;&#xFF0C;&#x8BF7;&#x53C2;&#x89C1;<a class="reference internal" href="session_events.html"><span>Tracking Object and Session Changes with Events</span></a>&#x90E8;&#x5206;&#x3002;</span><span class="yiyi-st" id="yiyi-49">&#x4E00;&#x822C;&#x7684;&#x4E8B;&#x4EF6;&#x7CFB;&#x7EDF;&#x5728;<a class="reference internal" href="core_event.html"><span>Events</span></a>&#x8BA8;&#x8BBA;&#x3002;</span><span class="yiyi-st" id="yiyi-50">&#x975E;ORM&#x4E8B;&#x4EF6;&#xFF08;&#x5982;&#x5173;&#x4E8E;&#x8FDE;&#x63A5;&#x548C;&#x4F4E;&#x7EA7;&#x8BED;&#x53E5;&#x6267;&#x884C;&#x7684;&#x4E8B;&#x4EF6;&#xFF09;&#x5728;<a class="reference internal" href="core_events.html"><span>Core Events</span></a>&#x4E2D;&#x63CF;&#x8FF0;&#x3002;</span></p><div class="section" id="attribute-events"><h2><span class="yiyi-st" id="yiyi-51">&#x5C5E;&#x6027;&#x4E8B;&#x4EF6;<a class="headerlink" href="#attribute-events" title="Permalink to this headline">&#xB6;</a></span></h2><dl class="class"><dt id="sqlalchemy.orm.events.AttributeEvents"><span class="yiyi-st" id="yiyi-52"><em class="property">class</em> <code class="descclassname">sqlalchemy.orm.events&#x3002;</code> <code class="descname">AttributeEvents</code> <a class="headerlink" href="#sqlalchemy.orm.events.AttributeEvents" title="Permalink to this definition">&#xB6;</a></span></dt><dd><p><span class="yiyi-st" id="yiyi-53">&#x57FA;&#x7840;&#xFF1A;<a class="reference internal" href="core_events.html#sqlalchemy.event.base.Events" title="sqlalchemy.event.base.Events"><code class="xref py py-class docutils literal"><span class="pre">sqlalchemy.event.base.Events</span></code></a></span></p><p><span class="yiyi-st" id="yiyi-54">&#x5B9A;&#x4E49;&#x5BF9;&#x8C61;&#x5C5E;&#x6027;&#x7684;&#x4E8B;&#x4EF6;&#x3002;</span></p><p><span class="yiyi-st" id="yiyi-55">&#x8FD9;&#x4E9B;&#x901A;&#x5E38;&#x5728;&#x76EE;&#x6807;&#x7C7B;&#x7684;&#x7C7B;&#x7ED1;&#x5B9A;&#x63CF;&#x8FF0;&#x7B26;&#x4E0A;&#x5B9A;&#x4E49;&#x3002;</span></p><p><span class="yiyi-st" id="yiyi-56">&#x4F8B;&#x5982;&#x3002;&#xFF1A;</span></p><div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sqlalchemy</span> <span class="kn">import</span> <span class="n">event</span>

<span class="k">def</span> <span class="nf">my_append_listener</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">initiator</span><span class="p">):</span>
    <span class="k">print</span> <span class="s2">&quot;received append event for target: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">target</span>

<span class="n">event</span><span class="o">.</span><span class="n">listen</span><span class="p">(</span><span class="n">MyClass</span><span class="o">.</span><span class="n">collection</span><span class="p">,</span> <span class="s1">&apos;append&apos;</span><span class="p">,</span> <span class="n">my_append_listener</span><span class="p">)</span></pre></div></div><p><span class="yiyi-st" id="yiyi-57">&#x5F53;<code class="docutils literal"><span class="pre">retval=True</span></code>&#x6807;&#x5FD7;&#x4F20;&#x9012;&#x7ED9;<a class="reference internal" href="core_event.html#sqlalchemy.event.listen" title="sqlalchemy.event.listen"><code class="xref py py-func docutils literal"><span class="pre">listen()</span></code></a>&#x65F6;&#xFF0C;&#x76D1;&#x542C;&#x5668;&#x53EF;&#x4EE5;&#x9009;&#x62E9;&#x8FD4;&#x56DE;&#x503C;&#x7684;&#x53EF;&#x80FD;&#x4FEE;&#x6539;&#x7248;&#x672C;&#xFF1A;</span></p><div class="highlight-python"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">validate_phone</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">oldvalue</span><span class="p">,</span> <span class="n">initiator</span><span class="p">):</span>
    <span class="s2">&quot;Strip non-numeric characters from a phone number&quot;</span>

    <span class="k">return</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s1">r&apos;(?![0-9])&apos;</span><span class="p">,</span> <span class="s1">&apos;&apos;</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>

<span class="c1"># setup listener on UserContact.phone attribute, instructing</span>
<span class="c1"># it to use the return value</span>
<span class="n">listen</span><span class="p">(</span><span class="n">UserContact</span><span class="o">.</span><span class="n">phone</span><span class="p">,</span> <span class="s1">&apos;set&apos;</span><span class="p">,</span> <span class="n">validate_phone</span><span class="p">,</span> <span class="n">retval</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span></pre></div></div><p><span class="yiyi-st" id="yiyi-58">&#x7C7B;&#x4F3C;&#x4E0A;&#x9762;&#x7684;&#x9A8C;&#x8BC1;&#x51FD;&#x6570;&#x4E5F;&#x4F1A;&#x5F15;&#x53D1;&#x5F02;&#x5E38;&#xFF0C;&#x4F8B;&#x5982;<code class="xref py py-exc docutils literal"><span class="pre">ValueError</span></code>&#x6765;&#x6682;&#x505C;&#x64CD;&#x4F5C;&#x3002;</span></p><p><span class="yiyi-st" id="yiyi-59"><a class="reference internal" href="core_event.html#sqlalchemy.event.listen" title="sqlalchemy.event.listen"><code class="xref py py-func docutils literal"><span class="pre">listen()</span></code></a>&#x51FD;&#x6570;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;&#x51E0;&#x4E2A;&#x4FEE;&#x9970;&#x7B26;&#x3002;</span></p><table class="docutils field-list" frame="void" rules="none"><tbody valign="top"><tr class="field-odd field"><th class="field-name"><span class="yiyi-st" id="yiyi-60">&#x53C2;&#x6570;&#xFF1A;</span></th><td class="field-body"><ul class="first last simple"><li><span class="yiyi-st" id="yiyi-61"><span class="target" id="sqlalchemy.orm.events.AttributeEvents.params.active_history"></span><strong>active_history=False</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.orm.events.AttributeEvents.params.active_history">&#xB6;</a> &#x2013; When True, indicates that the &#x201C;set&#x201D; event would like to receive the &#x201C;old&#x201D; value being replaced unconditionally, even if this requires firing off database loads. </span><span class="yiyi-st" id="yiyi-62">&#x8BF7;&#x6CE8;&#x610F;&#xFF0C;<code class="docutils literal"><span class="pre">active_history</span></code>&#x4E5F;&#x53EF;&#x4EE5;&#x76F4;&#x63A5;&#x901A;&#x8FC7;<a class="reference internal" href="mapping_columns.html#sqlalchemy.orm.column_property" title="sqlalchemy.orm.column_property"><code class="xref py py-func docutils literal"><span class="pre">column_property()</span></code></a>&#x548C;<a class="reference internal" href="relationship_api.html#sqlalchemy.orm.relationship" title="sqlalchemy.orm.relationship"><code class="xref py py-func docutils literal"><span class="pre">relationship()</span></code></a>&#x8BBE;&#x7F6E;&#x3002;</span></li><li><span class="yiyi-st" id="yiyi-63"><span class="target" id="sqlalchemy.orm.events.AttributeEvents.params.propagate"></span><strong>propagate=False</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.orm.events.AttributeEvents.params.propagate">&#xB6;</a> &#x2013; When True, the listener function will be established not just for the class attribute given, but for attributes of the same name on all current subclasses of that class, as well as all future subclasses of that class, using an additional listener that listens for instrumentation events.</span></li><li><span class="yiyi-st" id="yiyi-64"><span class="target" id="sqlalchemy.orm.events.AttributeEvents.params.raw"></span><strong>raw=False</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.orm.events.AttributeEvents.params.raw">&#xB6;</a> &#x2013; When True, the &#x201C;target&#x201D; argument to the event will be the <a class="reference internal" href="internals.html#sqlalchemy.orm.state.InstanceState" title="sqlalchemy.orm.state.InstanceState"><code class="xref py py-class docutils literal"><span class="pre">InstanceState</span></code></a> management object, rather than the mapped instance itself.</span></li><li><span class="yiyi-st" id="yiyi-65"><span class="target" id="sqlalchemy.orm.events.AttributeEvents.params.retval"></span><strong>retval=False</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.orm.events.AttributeEvents.params.retval">&#xB6;</a> &#x2013; when True, the user-defined event listening must return the &#x201C;value&#x201D; argument from the function. </span><span class="yiyi-st" id="yiyi-66">&#x8FD9;&#x4F7F;&#x5F97;&#x76D1;&#x542C;&#x529F;&#x80FD;&#x6709;&#x673A;&#x4F1A;&#x6539;&#x53D8;&#x6700;&#x7EC8;&#x7528;&#x4E8E;&#x201C;&#x8BBE;&#x7F6E;&#x201D;&#x6216;&#x201C;&#x8FFD;&#x52A0;&#x201D;&#x4E8B;&#x4EF6;&#x7684;&#x503C;&#x3002;</span></li></ul></td></tr></tbody></table><dl class="method"><dt id="sqlalchemy.orm.events.AttributeEvents.append"><span class="yiyi-st" id="yiyi-67"><code class="descname">append</code> <span class="sig-paren">&#xFF08;</span> <em>target</em>&#xFF0C;<em>&#x503C;</em>&#xFF0C;<em>&#x53D1;&#x8D77;&#x4EBA;</em> <span class="sig-paren">&#xFF09;</span> <a class="headerlink" href="#sqlalchemy.orm.events.AttributeEvents.append" title="Permalink to this definition">&#xB6; T6&gt;</a></span></dt><dd><p><span class="yiyi-st" id="yiyi-68">&#x6536;&#x5230;&#x8FFD;&#x52A0;&#x8FFD;&#x52A0;&#x4E8B;&#x4EF6;&#x3002;</span></p><div class="event-signatures container"><p><span class="yiyi-st" id="yiyi-69">&#x793A;&#x4F8B;&#x53C2;&#x6570;&#x8868;&#x5355;&#xFF1A;</span></p><div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sqlalchemy</span> <span class="kn">import</span> <span class="n">event</span>

<span class="c1"># standard decorator style</span>
<span class="nd">@event.listens_for</span><span class="p">(</span><span class="n">SomeClass</span><span class="o">.</span><span class="n">some_attribute</span><span class="p">,</span> <span class="s1">&apos;append&apos;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">receive_append</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">initiator</span><span class="p">):</span>
    <span class="s2">&quot;listen for the &apos;append&apos; event&quot;</span>

    <span class="c1"># ... (event handling logic) ...</span></pre></div></div></div><table class="docutils field-list" frame="void" rules="none"><tbody valign="top"><tr class="field-odd field"><th class="field-name"><span class="yiyi-st" id="yiyi-70">&#x53C2;&#x6570;&#xFF1A;</span></th><td class="field-body"><ul class="first simple"><li><span class="yiyi-st" id="yiyi-71"><span class="target" id="sqlalchemy.orm.events.AttributeEvents.append.params.target"></span><strong>target</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.orm.events.AttributeEvents.append.params.target">&#xB6;</a> &#x2013; the object instance receiving the event. </span><span class="yiyi-st" id="yiyi-72">&#x5982;&#x679C;&#x4FA6;&#x542C;&#x5668;&#x4F7F;&#x7528;<code class="docutils literal"><span class="pre">raw=True</span></code>&#x8FDB;&#x884C;&#x6CE8;&#x518C;&#xFF0C;&#x5219;&#x8FD9;&#x5C06;&#x662F;<a class="reference internal" href="internals.html#sqlalchemy.orm.state.InstanceState" title="sqlalchemy.orm.state.InstanceState"><code class="xref py py-class docutils literal"><span class="pre">InstanceState</span></code></a>&#x5BF9;&#x8C61;&#x3002;</span></li><li><span class="yiyi-st" id="yiyi-73"><span class="target" id="sqlalchemy.orm.events.AttributeEvents.append.params.value"></span><strong>value</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.orm.events.AttributeEvents.append.params.value">&#xB6;</a> &#x2013; the value being appended. </span><span class="yiyi-st" id="yiyi-74">&#x5982;&#x679C;&#x6B64;&#x4FA6;&#x542C;&#x5668;&#x4F7F;&#x7528;<code class="docutils literal"><span class="pre">retval=True</span></code>&#x8FDB;&#x884C;&#x6CE8;&#x518C;&#xFF0C;&#x90A3;&#x4E48;&#x4FA6;&#x542C;&#x5668;&#x51FD;&#x6570;&#x5FC5;&#x987B;&#x8FD4;&#x56DE;&#x6B64;&#x503C;&#x6216;&#x66FF;&#x6362;&#x5B83;&#x7684;&#x65B0;&#x503C;&#x3002;</span></li><li><span class="yiyi-st" id="yiyi-78"><span class="target" id="sqlalchemy.orm.events.AttributeEvents.append.params.initiator"></span> <strong>&#x53D1;&#x8D77;&#x4EBA;</strong> <a class="paramlink headerlink reference internal" href="#sqlalchemy.orm.events.AttributeEvents.append.params.initiator">&#xB6;</a>  - </span><p><span class="yiyi-st" id="yiyi-75">&#x8868;&#x793A;&#x4E8B;&#x4EF6;&#x542F;&#x52A8;&#x7684;<a class="reference internal" href="internals.html#sqlalchemy.orm.attributes.Event" title="sqlalchemy.orm.attributes.Event"><code class="xref py py-class docutils literal"><span class="pre">attributes.Event</span></code></a>&#x5B9E;&#x4F8B;&#x3002;</span><span class="yiyi-st" id="yiyi-76">&#x53EF;&#x4EE5;&#x901A;&#x8FC7;backref&#x5904;&#x7406;&#x7A0B;&#x5E8F;&#x4ECE;&#x5176;&#x539F;&#x59CB;&#x503C;&#x8FDB;&#x884C;&#x4FEE;&#x6539;&#xFF0C;&#x4EE5;&#x63A7;&#x5236;&#x94FE;&#x5F0F;&#x4E8B;&#x4EF6;&#x4F20;&#x64AD;&#x3002;</span></p><div class="versionchanged"><p><span class="yiyi-st" id="yiyi-77"><span class="versionmodified">&#x5728;&#x7248;&#x672C;0.9.0&#x4E2D;&#x66F4;&#x6539;&#xFF1A;</span> <code class="docutils literal"><span class="pre">initiator</span></code>&#x53C2;&#x6570;&#x73B0;&#x5728;&#x4F5C;&#x4E3A;<a class="reference internal" href="internals.html#sqlalchemy.orm.attributes.Event" title="sqlalchemy.orm.attributes.Event"><code class="xref py py-class docutils literal"><span class="pre">attributes.Event</span></code></a>&#x5BF9;&#x8C61;&#x4F20;&#x9012;&#xFF0C;&#x5E76;&#x4E14;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x4E00;&#x4E2A;backref&#x5904;&#x7406;&#x7A0B;&#x5E8F;&#x53CD;&#x5411;&#x94FE;&#x63A5;&#x4E8B;&#x4EF6;&#x94FE;&#x3002;</span></p></div></li></ul></td></tr><tr class="field-even field"><th class="field-name"><span class="yiyi-st" id="yiyi-79">&#x8FD4;&#x56DE;&#xFF1A;</span></th><td class="field-body"><p class="first last"><span class="yiyi-st" id="yiyi-80">&#x5982;&#x679C;&#x4E8B;&#x4EF6;&#x4F7F;&#x7528;<code class="docutils literal"><span class="pre">retval=True</span></code>&#x6CE8;&#x518C;&#xFF0C;&#x5219;&#x5E94;&#x8FD4;&#x56DE;&#x7ED9;&#x5B9A;&#x503C;&#x6216;&#x65B0;&#x7684;&#x6709;&#x6548;&#x503C;&#x3002;</span></p></td></tr></tbody></table></dd></dl><dl class="method"><dt id="sqlalchemy.orm.events.AttributeEvents.dispose_collection"><span class="yiyi-st" id="yiyi-81"> <code class="descname">dispose_collection</code><span class="sig-paren">(</span><em>target</em>, <em>collection</em>, <em>collection_adpater</em><span class="sig-paren">)</span><a class="headerlink" href="#sqlalchemy.orm.events.AttributeEvents.dispose_collection" title="Permalink to this definition">&#xB6;</a></span></dt><dd><p><span class="yiyi-st" id="yiyi-82">&#x6536;&#x5230;&#x201C;&#x6536;&#x96C6;&#x5904;&#x7406;&#x201D;&#x4E8B;&#x4EF6;&#x3002;</span></p><div class="event-signatures container"><p><span class="yiyi-st" id="yiyi-83">&#x793A;&#x4F8B;&#x53C2;&#x6570;&#x8868;&#x5355;&#xFF1A;</span></p><div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sqlalchemy</span> <span class="kn">import</span> <span class="n">event</span>

<span class="c1"># standard decorator style</span>
<span class="nd">@event.listens_for</span><span class="p">(</span><span class="n">SomeClass</span><span class="o">.</span><span class="n">some_attribute</span><span class="p">,</span> <span class="s1">&apos;dispose_collection&apos;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">receive_dispose_collection</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="n">collection</span><span class="p">,</span> <span class="n">collection_adpater</span><span class="p">):</span>
    <span class="s2">&quot;listen for the &apos;dispose_collection&apos; event&quot;</span>

    <span class="c1"># ... (event handling logic) ...</span></pre></div></div></div><p><span class="yiyi-st" id="yiyi-84">&#x5F53;&#x96C6;&#x5408;&#x88AB;&#x66FF;&#x6362;&#x65F6;&#xFF0C;&#x6B64;&#x4E8B;&#x4EF6;&#x4F1A;&#x89E6;&#x53D1;&#x57FA;&#x4E8E;&#x96C6;&#x5408;&#x7684;&#x5C5E;&#x6027;&#xFF0C;&#x5373;&#xFF1A;</span></p><div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">u1</span><span class="o">.</span><span class="n">addresses</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">a1</span><span class="p">)</span>

<span class="n">u1</span><span class="o">.</span><span class="n">addresses</span> <span class="o">=</span> <span class="p">[</span><span class="n">a2</span><span class="p">,</span> <span class="n">a3</span><span class="p">]</span>  <span class="c1"># &lt;- old collection is disposed</span></pre></div></div><p><span class="yiyi-st" id="yiyi-85">&#x4E8B;&#x4EF6;&#x7684;&#x673A;&#x5236;&#x901A;&#x5E38;&#x5305;&#x62EC;&#x7ED9;&#x5B9A;&#x7684;&#x96C6;&#x5408;&#x662F;&#x7A7A;&#x7684;&#xFF0C;&#x5373;&#x4F7F;&#x5B83;&#x5728;&#x88AB;&#x66FF;&#x6362;&#x65F6;&#x5B58;&#x50A8;&#x5BF9;&#x8C61;&#x3002;</span></p><div class="versionadded"><p><span class="yiyi-st" id="yiyi-86"><span class="versionmodified">&#x7248;&#x672C;1.0.0&#x65B0;&#x589E;&#xFF1A;</span> <a class="reference internal" href="#sqlalchemy.orm.events.AttributeEvents.init_collection" title="sqlalchemy.orm.events.AttributeEvents.init_collection"><code class="xref py py-meth docutils literal"><span class="pre">AttributeEvents.init_collection()</span></code></a>&#x548C;<a class="reference internal" href="#sqlalchemy.orm.events.AttributeEvents.dispose_collection" title="sqlalchemy.orm.events.AttributeEvents.dispose_collection"><code class="xref py py-meth docutils literal"><span class="pre">AttributeEvents.dispose_collection()</span></code></a>&#x4E8B;&#x4EF6;&#x53D6;&#x4EE3;<code class="xref py py-class docutils literal"><span class="pre">collection.linker</span></code></span></p></div></dd></dl><dl class="method"><dt id="sqlalchemy.orm.events.AttributeEvents.init_collection"><span class="yiyi-st" id="yiyi-87"><code class="descname">init_collection</code> <span class="sig-paren">&#xFF08;</span> <em>target</em>&#xFF0C;<em>collection</em>&#xFF0C;<em>collection_adapter</em> <span class="sig-paren">&#xFF09;</span> <a class="headerlink" href="#sqlalchemy.orm.events.AttributeEvents.init_collection" title="Permalink to this definition">&#xB6; T6&gt;</a></span></dt><dd><p><span class="yiyi-st" id="yiyi-88">&#x63A5;&#x6536;&apos;collection init&apos;&#x4E8B;&#x4EF6;&#x3002;</span></p><div class="event-signatures container"><p><span class="yiyi-st" id="yiyi-89">&#x793A;&#x4F8B;&#x53C2;&#x6570;&#x8868;&#x5355;&#xFF1A;</span></p><div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sqlalchemy</span> <span class="kn">import</span> <span class="n">event</span>

<span class="c1"># standard decorator style</span>
<span class="nd">@event.listens_for</span><span class="p">(</span><span class="n">SomeClass</span><span class="o">.</span><span class="n">some_attribute</span><span class="p">,</span> <span class="s1">&apos;init_collection&apos;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">receive_init_collection</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="n">collection</span><span class="p">,</span> <span class="n">collection_adapter</span><span class="p">):</span>
    <span class="s2">&quot;listen for the &apos;init_collection&apos; event&quot;</span>

    <span class="c1"># ... (event handling logic) ...</span></pre></div></div></div><p><span class="yiyi-st" id="yiyi-90">&#x5F53;&#x4E3A;&#x7A7A;&#x767D;&#x5C5E;&#x6027;&#x9996;&#x6B21;&#x751F;&#x6210;&#x521D;&#x59CB;&#x201C;&#x7A7A;&#x96C6;&#x5408;&#x201D;&#x65F6;&#xFF0C;&#x4EE5;&#x53CA;&#x96C6;&#x5408;&#x88AB;&#x66FF;&#x6362;&#x4E3A;&#x65B0;&#x96C6;&#x5408;&#x65F6;&#xFF08;&#x4F8B;&#x5982;&#x901A;&#x8FC7;&#x8BBE;&#x7F6E;&#x4E8B;&#x4EF6;&#xFF09;&#xFF0C;&#x6B64;&#x4E8B;&#x4EF6;&#x5C06;&#x89E6;&#x53D1;&#x57FA;&#x4E8E;&#x96C6;&#x5408;&#x7684;&#x5C5E;&#x6027;&#x3002;</span></p><p><span class="yiyi-st" id="yiyi-91">&#x4F8B;&#x5982;&#xFF0C;&#x5047;&#x8BBE;<code class="docutils literal"><span class="pre">User.addresses</span></code>&#x662F;&#x4E00;&#x4E2A;&#x57FA;&#x4E8E;&#x5173;&#x7CFB;&#x7684;&#x96C6;&#x5408;&#xFF0C;&#x4E8B;&#x4EF6;&#x5728;&#x8FD9;&#x91CC;&#x89E6;&#x53D1;&#xFF1A;</span></p><div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">u1</span> <span class="o">=</span> <span class="n">User</span><span class="p">()</span>
<span class="n">u1</span><span class="o">.</span><span class="n">addresses</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">a1</span><span class="p">)</span>  <span class="c1">#  &lt;- new collection</span></pre></div></div><p><span class="yiyi-st" id="yiyi-92">&#x5E76;&#x4E14;&#x5728;&#x66F4;&#x6362;&#x64CD;&#x4F5C;&#x671F;&#x95F4;&#xFF1A;</span></p><div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">u1</span><span class="o">.</span><span class="n">addresses</span> <span class="o">=</span> <span class="p">[</span><span class="n">a2</span><span class="p">,</span> <span class="n">a3</span><span class="p">]</span>  <span class="c1">#  &lt;- new collection</span></pre></div></div><table class="docutils field-list" frame="void" rules="none"><tbody valign="top"><tr class="field-odd field"><th class="field-name"><span class="yiyi-st" id="yiyi-93">&#x53C2;&#x6570;&#xFF1A;</span></th><td class="field-body"><ul class="first last simple"><li><span class="yiyi-st" id="yiyi-94"><span class="target" id="sqlalchemy.orm.events.AttributeEvents.init_collection.params.target"></span><strong>target</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.orm.events.AttributeEvents.init_collection.params.target">&#xB6;</a> &#x2013; the object instance receiving the event. </span><span class="yiyi-st" id="yiyi-95">&#x5982;&#x679C;&#x4FA6;&#x542C;&#x5668;&#x4F7F;&#x7528;<code class="docutils literal"><span class="pre">raw=True</span></code>&#x8FDB;&#x884C;&#x6CE8;&#x518C;&#xFF0C;&#x5219;&#x8FD9;&#x5C06;&#x662F;<a class="reference internal" href="internals.html#sqlalchemy.orm.state.InstanceState" title="sqlalchemy.orm.state.InstanceState"><code class="xref py py-class docutils literal"><span class="pre">InstanceState</span></code></a>&#x5BF9;&#x8C61;&#x3002;</span></li><li><span class="yiyi-st" id="yiyi-96"><span class="target" id="sqlalchemy.orm.events.AttributeEvents.init_collection.params.collection"></span> <strong>&#x96C6;&#x5408;</strong> <a class="paramlink headerlink reference internal" href="#sqlalchemy.orm.events.AttributeEvents.init_collection.params.collection">&#xB6;</a>  - &#x65B0;&#x96C6;&#x5408;&#x3002;</span><span class="yiyi-st" id="yiyi-97">&#x8FD9;&#x5C06;&#x59CB;&#x7EC8;&#x7531;&#x6307;&#x5B9A;&#x4E3A;<a class="reference internal" href="internals.html#sqlalchemy.orm.properties.RelationshipProperty.params.collection_class" title="sqlalchemy.orm.properties.RelationshipProperty"><code class="xref py py-paramref docutils literal"><span class="pre">RelationshipProperty.collection_class</span></code></a>&#x7684;&#x5185;&#x5BB9;&#x751F;&#x6210;&#xFF0C;&#x5E76;&#x4E14;&#x5C06;&#x59CB;&#x7EC8;&#x4E3A;&#x7A7A;&#x3002;</span></li><li><span class="yiyi-st" id="yiyi-98"><span class="target" id="sqlalchemy.orm.events.AttributeEvents.init_collection.params.collection_adpater"></span><strong>collection_adpater</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.orm.events.AttributeEvents.init_collection.params.collection_adpater">&#xB6;</a> &#x2013; the <a class="reference internal" href="collections.html#sqlalchemy.orm.collections.CollectionAdapter" title="sqlalchemy.orm.collections.CollectionAdapter"><code class="xref py py-class docutils literal"><span class="pre">CollectionAdapter</span></code></a> that will mediate internal access to the collection.</span></li></ul></td></tr></tbody></table><div class="versionadded"><p><span class="yiyi-st" id="yiyi-99"><span class="versionmodified">&#x7248;&#x672C;1.0.0&#x65B0;&#x589E;&#xFF1A;</span> <a class="reference internal" href="#sqlalchemy.orm.events.AttributeEvents.init_collection" title="sqlalchemy.orm.events.AttributeEvents.init_collection"><code class="xref py py-meth docutils literal"><span class="pre">AttributeEvents.init_collection()</span></code></a>&#x548C;<a class="reference internal" href="#sqlalchemy.orm.events.AttributeEvents.dispose_collection" title="sqlalchemy.orm.events.AttributeEvents.dispose_collection"><code class="xref py py-meth docutils literal"><span class="pre">AttributeEvents.dispose_collection()</span></code></a>&#x4E8B;&#x4EF6;&#x53D6;&#x4EE3;<code class="xref py py-class docutils literal"><span class="pre">collection.linker</span></code></span></p></div></dd></dl><dl class="method"><dt id="sqlalchemy.orm.events.AttributeEvents.init_scalar"><span class="yiyi-st" id="yiyi-100"> <code class="descname">init_scalar</code><span class="sig-paren">(</span><em>target</em>, <em>value</em>, <em>dict_</em><span class="sig-paren">)</span><a class="headerlink" href="#sqlalchemy.orm.events.AttributeEvents.init_scalar" title="Permalink to this definition">&#xB6;</a></span></dt><dd><p><span class="yiyi-st" id="yiyi-101">&#x63A5;&#x6536;&#x6807;&#x91CF;&#x201C;init&#x201D;&#x4E8B;&#x4EF6;&#x3002;</span></p><div class="event-signatures container"><p><span class="yiyi-st" id="yiyi-102">&#x793A;&#x4F8B;&#x53C2;&#x6570;&#x8868;&#x5355;&#xFF1A;</span></p><div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sqlalchemy</span> <span class="kn">import</span> <span class="n">event</span>

<span class="c1"># standard decorator style</span>
<span class="nd">@event.listens_for</span><span class="p">(</span><span class="n">SomeClass</span><span class="o">.</span><span class="n">some_attribute</span><span class="p">,</span> <span class="s1">&apos;init_scalar&apos;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">receive_init_scalar</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">dict_</span><span class="p">):</span>
    <span class="s2">&quot;listen for the &apos;init_scalar&apos; event&quot;</span>

    <span class="c1"># ... (event handling logic) ...</span></pre></div></div></div><p><span class="yiyi-st" id="yiyi-103">&#x5F53;&#x8BBF;&#x95EE;&#x672A;&#x521D;&#x59CB;&#x5316;&#x7684;&#xFF0C;&#x672A;&#x6267;&#x884C;&#x7684;&#x6807;&#x91CF;&#x5C5E;&#x6027;&#x65F6;&#xFF0C;&#x5C06;&#x8C03;&#x7528;&#x6B64;&#x4E8B;&#x4EF6;&#x3002;</span><span class="yiyi-st" id="yiyi-104">&#x5728;&#x8FD9;&#x79CD;&#x60C5;&#x51B5;&#x4E0B;&#x901A;&#x5E38;&#x4F1A;&#x8FD4;&#x56DE;<code class="docutils literal"><span class="pre">None</span></code>&#x7684;&#x503C;&#xFF1B;&#x5BF9;&#x5BF9;&#x8C61;&#x7684;&#x72B6;&#x6001;&#x4E0D;&#x505A;&#x4EFB;&#x4F55;&#x66F4;&#x6539;&#x3002;</span></p><p><span class="yiyi-st" id="yiyi-105">&#x4E8B;&#x4EF6;&#x5904;&#x7406;&#x7A0B;&#x5E8F;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x4E24;&#x79CD;&#x65B9;&#x5F0F;&#x6765;&#x6539;&#x53D8;&#x8FD9;&#x79CD;&#x884C;&#x4E3A;&#x3002;</span><span class="yiyi-st" id="yiyi-106">&#x4E00;&#x79CD;&#x662F;&#x53EF;&#x4EE5;&#x8FD4;&#x56DE;<code class="docutils literal"><span class="pre">None</span></code>&#x4EE5;&#x5916;&#x7684;&#x503C;&#x3002;</span><span class="yiyi-st" id="yiyi-107">&#x53E6;&#x4E00;&#x4E2A;&#x539F;&#x56E0;&#x662F;&#x8BE5;&#x503C;&#x53EF;&#x80FD;&#x88AB;&#x5EFA;&#x7ACB;&#x4E3A;&#x5BF9;&#x8C61;&#x72B6;&#x6001;&#x7684;&#x4E00;&#x90E8;&#x5206;&#xFF0C;&#x8FD9;&#x4E5F;&#x4F1A;&#x4EA7;&#x751F;&#x6301;&#x7EED;&#x7684;&#x6548;&#x679C;&#x3002;</span></p><p><span class="yiyi-st" id="yiyi-108">&#x5178;&#x578B;&#x7528;&#x9014;&#x662F;&#x5728;&#x8BBF;&#x95EE;&#x65F6;&#x5EFA;&#x7ACB;&#x5C5E;&#x6027;&#x7684;&#x7279;&#x5B9A;&#x9ED8;&#x8BA4;&#x503C;&#xFF1A;</span></p><div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">SOME_CONSTANT</span> <span class="o">=</span> <span class="mf">3.1415926</span>

<span class="nd">@event.listens_for</span><span class="p">(</span>
    <span class="n">MyClass</span><span class="o">.</span><span class="n">some_attribute</span><span class="p">,</span> <span class="s2">&quot;init_scalar&quot;</span><span class="p">,</span>
    <span class="n">retval</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">propagate</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">_init_some_attribute</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="n">dict_</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
    <span class="n">dict_</span><span class="p">[</span><span class="s1">&apos;some_attribute&apos;</span><span class="p">]</span> <span class="o">=</span> <span class="n">SOME_CONSTANT</span>
    <span class="k">return</span> <span class="n">SOME_CONSTANT</span></pre></div></div><p><span class="yiyi-st" id="yiyi-109">&#x4E0A;&#x9762;&#xFF0C;&#x6211;&#x4EEC;&#x5C06;&#x5C5E;&#x6027;<code class="docutils literal"><span class="pre">MyClass.some_attribute</span></code>&#x521D;&#x59CB;&#x5316;&#x4E3A;<code class="docutils literal"><span class="pre">SOME_CONSTANT</span></code>&#x7684;&#x503C;&#x3002;</span><span class="yiyi-st" id="yiyi-110">&#x4EE5;&#x4E0A;&#x4EE3;&#x7801;&#x5305;&#x542B;&#x4EE5;&#x4E0B;&#x529F;&#x80FD;&#xFF1A;</span></p><ul class="simple"><li><span class="yiyi-st" id="yiyi-111">&#x901A;&#x8FC7;&#x5728;&#x7ED9;&#x5B9A;&#x7684;<code class="docutils literal"><span class="pre">dict_</span></code>&#x4E2D;&#x8BBE;&#x7F6E;&#x503C;<code class="docutils literal"><span class="pre">SOME_CONSTANT</span></code>&#xFF0C;&#x6211;&#x4EEC;&#x8868;&#x660E;&#x8BE5;&#x503C;&#x5C06;&#x88AB;&#x6301;&#x4E45;&#x5316;&#x5230;&#x6570;&#x636E;&#x5E93;&#x3002;</span><span class="yiyi-st" id="yiyi-112"><strong>&#x5982;&#x679C;&#x6211;&#x4EEC;&#x660E;&#x786E;&#x5730;&#x5C06;&#x5B83;&#x4E0E;&#x5BF9;&#x8C61;</strong>&#x5173;&#x8054;&#xFF0C;&#x90A3;&#x4E48;&#x7ED9;&#x5B9A;&#x7684;&#x503C;&#x53EA;&#x80FD;&#x4FDD;&#x5B58;&#x5230;&#x6570;&#x636E;&#x5E93;&#x4E2D;&#x3002;</span><span class="yiyi-st" id="yiyi-113">&#x7ED9;&#x5B9A;&#x7684;<code class="docutils literal"><span class="pre">dict_</span></code>&#x662F;&#x6620;&#x5C04;&#x5BF9;&#x8C61;&#x7684;<code class="docutils literal"><span class="pre">__dict__</span></code>&#x5143;&#x7D20;&#xFF0C;&#x5047;&#x5B9A;&#x9ED8;&#x8BA4;&#x7684;&#x5C5E;&#x6027;&#x68C0;&#x6D4B;&#x7CFB;&#x7EDF;&#x5C31;&#x4F4D;&#x3002;</span></li><li><span class="yiyi-st" id="yiyi-114">&#x901A;&#x8FC7;&#x5EFA;&#x7ACB;<code class="docutils literal"><span class="pre">retval=True</span></code>&#x6807;&#x5FD7;&#xFF0C;&#x6211;&#x4EEC;&#x4ECE;&#x51FD;&#x6570;&#x8FD4;&#x56DE;&#x7684;&#x503C;&#x5C06;&#x7531;&#x5C5E;&#x6027;getter&#x8FD4;&#x56DE;&#x3002;</span><span class="yiyi-st" id="yiyi-115">&#x6CA1;&#x6709;&#x8FD9;&#x4E2A;&#x6807;&#x5FD7;&#xFF0C;&#x4E8B;&#x4EF6;&#x88AB;&#x8BA4;&#x4E3A;&#x662F;&#x4E00;&#x4E2A;&#x88AB;&#x52A8;&#x7684;&#x89C2;&#x5BDF;&#x8005;&#xFF0C;&#x6211;&#x4EEC;&#x7684;&#x51FD;&#x6570;&#x7684;&#x8FD4;&#x56DE;&#x503C;&#x88AB;&#x5FFD;&#x7565;&#x3002;</span></li><li><span class="yiyi-st" id="yiyi-116">&#x5982;&#x679C;&#x6620;&#x5C04;&#x7C7B;&#x5305;&#x542B;&#x7EE7;&#x627F;&#x5B50;&#x7C7B;&#xFF0C;&#x90A3;&#x4E48;<code class="docutils literal"><span class="pre">propagate=True</span></code>&#x6807;&#x5FD7;&#x662F;&#x6709;&#x610F;&#x4E49;&#x7684;&#xFF0C;&#x5B83;&#x4E5F;&#x4F1A;&#x4F7F;&#x7528;&#x6B64;&#x4E8B;&#x4EF6;&#x4FA6;&#x542C;&#x5668;&#x3002;</span><span class="yiyi-st" id="yiyi-117">&#x6CA1;&#x6709;&#x8FD9;&#x4E2A;&#x6807;&#x5FD7;&#xFF0C;&#x7EE7;&#x627F;&#x7684;&#x5B50;&#x7C7B;&#x5C06;&#x4E0D;&#x4F1A;&#x4F7F;&#x7528;&#x6211;&#x4EEC;&#x7684;&#x4E8B;&#x4EF6;&#x5904;&#x7406;&#x7A0B;&#x5E8F;&#x3002;</span></li></ul><p><span class="yiyi-st" id="yiyi-118">&#x5F53;&#x6211;&#x4EEC;&#x5728;&#x7ED9;&#x5B9A;&#x5B57;&#x5178;&#x4E2D;&#x5EFA;&#x7ACB;&#x503C;&#x65F6;&#xFF0C;&#x8BE5;&#x503C;&#x5C06;&#x7528;&#x4E8E;&#x7531;&#x5DE5;&#x4F5C;&#x5355;&#x5143;&#x5EFA;&#x7ACB;&#x7684;INSERT&#x8BED;&#x53E5;&#x4E2D;&#x3002;</span><span class="yiyi-st" id="yiyi-119">&#x901A;&#x5E38;&#xFF0C;<code class="docutils literal"><span class="pre">None</span></code>&#x7684;&#x9ED8;&#x8BA4;&#x8FD4;&#x56DE;&#x503C;&#x4E0D;&#x662F;&#x4F5C;&#x4E3A;&#x5BF9;&#x8C61;&#x7684;&#x4E00;&#x90E8;&#x5206;&#x5EFA;&#x7ACB;&#x7684;&#xFF0C;&#x4EE5;&#x907F;&#x514D;&#x54CD;&#x5E94;&#x6B63;&#x5E38;&#x88AB;&#x52A8;&#x7684;&#x201C;get&#x201D;&#x64CD;&#x4F5C;&#x800C;&#x53D1;&#x751F;&#x5BF9;&#x8C61;&#x53D8;&#x5316;&#x7684;&#x95EE;&#x9898;&#xFF0C;&#x5E76;&#x907F;&#x514D;&#x51FA;&#x73B0;&#x95EE;&#x9898;&#x662F;&#x5426;&#x5728;&#x5C5E;&#x6027;&#x8BBF;&#x95EE;&#x64CD;&#x4F5C;&#x671F;&#x95F4;&#x4E0D;&#x5E94;&#x8BE5;&#x89E6;&#x53D1;<a class="reference internal" href="#sqlalchemy.orm.events.AttributeEvents.set" title="sqlalchemy.orm.events.AttributeEvents.set"><code class="xref py py-meth docutils literal"><span class="pre">AttributeEvents.set()</span></code></a>&#x4E8B;&#x4EF6;&#x3002;</span><span class="yiyi-st" id="yiyi-120">&#x8FD9;&#x4E0D;&#x4F1A;&#x5F71;&#x54CD;INSERT&#x64CD;&#x4F5C;&#xFF0C;&#x56E0;&#x4E3A;<code class="docutils literal"><span class="pre">None</span></code>&#x503C;&#x4E0E;&#x4EFB;&#x4F55;&#x60C5;&#x51B5;&#x4E0B;&#x8FDB;&#x5165;&#x6570;&#x636E;&#x5E93;&#x7684;<code class="docutils literal"><span class="pre">NULL</span></code>&#x7684;&#x503C;&#x5339;&#x914D;&#xFF1B;&#x8BF7;&#x6CE8;&#x610F;&#xFF0C;&#x5728;INSERT&#x671F;&#x95F4;&#x8DF3;&#x8FC7;&#x4E86;<code class="docutils literal"><span class="pre">None</span></code>&#xFF0C;&#x4EE5;&#x786E;&#x4FDD;&#x5217;&#x548C;SQL&#x7EA7;&#x522B;&#x7684;&#x9ED8;&#x8BA4;&#x529F;&#x80FD;&#x53EF;&#x4EE5;&#x89E6;&#x53D1;&#x3002;</span></p><p><span class="yiyi-st" id="yiyi-121">&#x5F53;&#x6211;&#x4EEC;&#x5E94;&#x7528;&#x6211;&#x4EEC;&#x7684;&#x503C;&#x65F6;&#xFF0C;&#x5C5E;&#x6027;&#x8BBE;&#x7F6E;&#x4E8B;&#x4EF6;<a class="reference internal" href="#sqlalchemy.orm.events.AttributeEvents.set" title="sqlalchemy.orm.events.AttributeEvents.set"><code class="xref py py-meth docutils literal"><span class="pre">AttributeEvents.set()</span></code></a>&#x4EE5;&#x53CA;&#x7531;<a class="reference internal" href="mapped_attributes.html#sqlalchemy.orm.validates" title="sqlalchemy.orm.validates"><code class="xref py py-obj docutils literal"><span class="pre">orm.validates</span></code></a>&#x63D0;&#x4F9B;&#x7684;&#x76F8;&#x5173;&#x9A8C;&#x8BC1;&#x529F;&#x80FD;<strong></strong>&#x5230;&#x7ED9;&#x5B9A;&#x7684;<code class="docutils literal"><span class="pre">dict_</span></code>&#x3002;</span><span class="yiyi-st" id="yiyi-122">&#x8981;&#x4F7F;&#x8FD9;&#x4E9B;&#x4E8B;&#x4EF6;&#x54CD;&#x5E94;&#x6211;&#x4EEC;&#x65B0;&#x751F;&#x6210;&#x7684;&#x503C;&#x800C;&#x8C03;&#x7528;&#xFF0C;&#x8BF7;&#x5C06;&#x8BE5;&#x503C;&#x4F5C;&#x4E3A;&#x666E;&#x901A;&#x5C5E;&#x6027;&#x96C6;&#x64CD;&#x4F5C;&#x5E94;&#x7528;&#x4E8E;&#x7ED9;&#x5B9A;&#x5BF9;&#x8C61;&#xFF1A;</span></p><div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">SOME_CONSTANT</span> <span class="o">=</span> <span class="mf">3.1415926</span>

<span class="nd">@event.listens_for</span><span class="p">(</span>
    <span class="n">MyClass</span><span class="o">.</span><span class="n">some_attribute</span><span class="p">,</span> <span class="s2">&quot;init_scalar&quot;</span><span class="p">,</span>
    <span class="n">retval</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">propagate</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">_init_some_attribute</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="n">dict_</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
    <span class="c1"># will also fire off attribute set events</span>
    <span class="n">target</span><span class="o">.</span><span class="n">some_attribute</span> <span class="o">=</span> <span class="n">SOME_CONSTANT</span>
    <span class="k">return</span> <span class="n">SOME_CONSTANT</span></pre></div></div><p><span class="yiyi-st" id="yiyi-123">&#x5F53;&#x8BBE;&#x7F6E;&#x591A;&#x4E2A;&#x4FA6;&#x542C;&#x5668;&#x65F6;&#xFF0C;&#x901A;&#x8FC7;&#x5C06;&#x6307;&#x5B9A;<code class="docutils literal"><span class="pre">retval=True</span></code>&#x7684;&#x524D;&#x4E00;&#x4E2A;&#x4FA6;&#x542C;&#x5668;&#x8FD4;&#x56DE;&#x7684;&#x503C;&#x4F5C;&#x4E3A;<code class="docutils literal"><span class="pre">value</span></code></span></p><p><span class="yiyi-st" id="yiyi-124"><a class="reference internal" href="#sqlalchemy.orm.events.AttributeEvents.init_scalar" title="sqlalchemy.orm.events.AttributeEvents.init_scalar"><code class="xref py py-meth docutils literal"><span class="pre">AttributeEvents.init_scalar()</span></code></a>&#x4E8B;&#x4EF6;&#x53EF;&#x7528;&#x4E8E;&#x4ECE;&#x6620;&#x5C04;&#x7684;<a class="reference internal" href="core_metadata.html#sqlalchemy.schema.Column" title="sqlalchemy.schema.Column"><code class="xref py py-class docutils literal"><span class="pre">Column</span></code></a>&#x5BF9;&#x8C61;&#x4E0A;&#x5EFA;&#x7ACB;&#x7684;&#x9ED8;&#x8BA4;&#x503C;&#x548C;/&#x6216;&#x53EF;&#x8C03;&#x7528;&#x503C;&#x4E2D;&#x63D0;&#x53D6;&#x503C;&#x3002;</span><span class="yiyi-st" id="yiyi-125">&#x6709;&#x5173;&#x6B64;&#x793A;&#x4F8B;&#xFF0C;&#x8BF7;&#x53C2;&#x9605;<a class="reference internal" href="examples.html#examples-instrumentation"><span>Attribute Instrumentation</span></a>&#x4E2D;&#x7684;&#x201C;&#x6709;&#x6548;&#x5217;&#x9ED8;&#x8BA4;&#x503C;&#x201D;&#x793A;&#x4F8B;&#x3002;</span></p><div class="versionadded"><p><span class="yiyi-st" id="yiyi-126"><span class="versionmodified">&#x7248;&#x672C;1.1&#x4E2D;&#x7684;&#x65B0;&#x529F;&#x80FD;</span></span></p></div><table class="docutils field-list" frame="void" rules="none"><tbody valign="top"><tr class="field-odd field"><th class="field-name"><span class="yiyi-st" id="yiyi-127">&#x53C2;&#x6570;&#xFF1A;</span></th><td class="field-body"><ul class="first last simple"><li><span class="yiyi-st" id="yiyi-128"><span class="target" id="sqlalchemy.orm.events.AttributeEvents.init_scalar.params.target"></span><strong>target</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.orm.events.AttributeEvents.init_scalar.params.target">&#xB6;</a> &#x2013; the object instance receiving the event. </span><span class="yiyi-st" id="yiyi-129">&#x5982;&#x679C;&#x4FA6;&#x542C;&#x5668;&#x4F7F;&#x7528;<code class="docutils literal"><span class="pre">raw=True</span></code>&#x8FDB;&#x884C;&#x6CE8;&#x518C;&#xFF0C;&#x5219;&#x8FD9;&#x5C06;&#x662F;<a class="reference internal" href="internals.html#sqlalchemy.orm.state.InstanceState" title="sqlalchemy.orm.state.InstanceState"><code class="xref py py-class docutils literal"><span class="pre">InstanceState</span></code></a>&#x5BF9;&#x8C61;&#x3002;</span></li><li><span class="yiyi-st" id="yiyi-130"><span class="target" id="sqlalchemy.orm.events.AttributeEvents.init_scalar.params.value"></span><strong>value</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.orm.events.AttributeEvents.init_scalar.params.value">&#xB6;</a> &#x2013; the value that is to be returned before this event listener were invoked. </span><span class="yiyi-st" id="yiyi-131">&#x8BE5;&#x503C;&#x4EE5;<code class="docutils literal"><span class="pre">None</span></code>&#x503C;&#x5F00;&#x59CB;&#xFF0C;&#x4F46;&#x5982;&#x679C;&#x5B58;&#x5728;&#x591A;&#x4E2A;&#x4FA6;&#x542C;&#x5668;&#xFF0C;&#x5219;&#x8BE5;&#x503C;&#x5C06;&#x6210;&#x4E3A;&#x5148;&#x524D;&#x4E8B;&#x4EF6;&#x5904;&#x7406;&#x51FD;&#x6570;&#x7684;&#x8FD4;&#x56DE;&#x503C;&#x3002;</span></li><li><span class="yiyi-st" id="yiyi-132"><span class="target" id="sqlalchemy.orm.events.AttributeEvents.init_scalar.params.dict_"></span> <strong>dict _</strong> <a class="paramlink headerlink reference internal" href="#sqlalchemy.orm.events.AttributeEvents.init_scalar.params.dict_">&#xB6;</a>  - &#x6B64;&#x6620;&#x5C04;&#x5BF9;&#x8C61;&#x7684;&#x5C5E;&#x6027;&#x5B57;&#x5178;&#x3002;</span><span class="yiyi-st" id="yiyi-133">&#x8FD9;&#x901A;&#x5E38;&#x662F;&#x5BF9;&#x8C61;&#x7684;<code class="docutils literal"><span class="pre">__dict__</span></code>&#xFF0C;&#x4F46;&#x5728;&#x4EFB;&#x4F55;&#x60C5;&#x51B5;&#x4E0B;&#x90FD;&#x4EE3;&#x8868;&#x5C5E;&#x6027;&#x7CFB;&#x7EDF;&#x7528;&#x4E8E;&#x83B7;&#x53D6;&#x6B64;&#x5C5E;&#x6027;&#x5B9E;&#x9645;&#x503C;&#x7684;&#x76EE;&#x6807;&#x3002;</span><span class="yiyi-st" id="yiyi-134">&#x5728;&#x6B64;&#x5B57;&#x5178;&#x4E2D;&#x653E;&#x7F6E;&#x503C;&#x4F1A;&#x5F71;&#x54CD;&#x8BE5;&#x503C;&#x5C06;&#x5728;&#x7531;&#x5DE5;&#x4F5C;&#x5355;&#x5143;&#x751F;&#x6210;&#x7684;INSERT&#x8BED;&#x53E5;&#x4E2D;&#x4F7F;&#x7528;&#x3002;</span></li></ul></td></tr></tbody></table><div class="admonition seealso"><p class="first admonition-title"><span class="yiyi-st" id="yiyi-135">&#x4E5F;&#x53EF;&#x4EE5;&#x770B;&#x770B;</span></p><p class="last"><span class="yiyi-st" id="yiyi-136"><a class="reference internal" href="examples.html#examples-instrumentation"><span>Attribute Instrumentation</span></a>  - &#x8BF7;&#x53C2;&#x9605;<code class="docutils literal"><span class="pre">active_column_defaults.py</span></code>&#x793A;&#x4F8B;&#x3002;</span></p></div></dd></dl><dl class="method"><dt id="sqlalchemy.orm.events.AttributeEvents.remove"><span class="yiyi-st" id="yiyi-137"><code class="descname">&#x5220;&#x9664;</code> <span class="sig-paren">&#xFF08;</span> <em>target</em>&#xFF0C;<em>&#x503C;</em>&#xFF0C;<em>&#x53D1;&#x8D77;&#x4EBA;</em> <span class="sig-paren">&#xFF09;</span> <a class="headerlink" href="#sqlalchemy.orm.events.AttributeEvents.remove" title="Permalink to this definition">&#xB6; T6&gt;</a></span></dt><dd><p><span class="yiyi-st" id="yiyi-138">&#x63A5;&#x6536;&#x6536;&#x96C6;&#x79FB;&#x9664;&#x4E8B;&#x4EF6;&#x3002;</span></p><div class="event-signatures container"><p><span class="yiyi-st" id="yiyi-139">&#x793A;&#x4F8B;&#x53C2;&#x6570;&#x8868;&#x5355;&#xFF1A;</span></p><div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sqlalchemy</span> <span class="kn">import</span> <span class="n">event</span>

<span class="c1"># standard decorator style</span>
<span class="nd">@event.listens_for</span><span class="p">(</span><span class="n">SomeClass</span><span class="o">.</span><span class="n">some_attribute</span><span class="p">,</span> <span class="s1">&apos;remove&apos;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">receive_remove</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">initiator</span><span class="p">):</span>
    <span class="s2">&quot;listen for the &apos;remove&apos; event&quot;</span>

    <span class="c1"># ... (event handling logic) ...</span></pre></div></div></div><table class="docutils field-list" frame="void" rules="none"><tbody valign="top"><tr class="field-odd field"><th class="field-name"><span class="yiyi-st" id="yiyi-140">&#x53C2;&#x6570;&#xFF1A;</span></th><td class="field-body"><ul class="first simple"><li><span class="yiyi-st" id="yiyi-141"><span class="target" id="sqlalchemy.orm.events.AttributeEvents.remove.params.target"></span><strong>target</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.orm.events.AttributeEvents.remove.params.target">&#xB6;</a> &#x2013; the object instance receiving the event. </span><span class="yiyi-st" id="yiyi-142">&#x5982;&#x679C;&#x4FA6;&#x542C;&#x5668;&#x4F7F;&#x7528;<code class="docutils literal"><span class="pre">raw=True</span></code>&#x8FDB;&#x884C;&#x6CE8;&#x518C;&#xFF0C;&#x5219;&#x8FD9;&#x5C06;&#x662F;<a class="reference internal" href="internals.html#sqlalchemy.orm.state.InstanceState" title="sqlalchemy.orm.state.InstanceState"><code class="xref py py-class docutils literal"><span class="pre">InstanceState</span></code></a>&#x5BF9;&#x8C61;&#x3002;</span></li><li><span class="yiyi-st" id="yiyi-143"><span class="target" id="sqlalchemy.orm.events.AttributeEvents.remove.params.value"></span> <strong>&#x503C;</strong> <a class="paramlink headerlink reference internal" href="#sqlalchemy.orm.events.AttributeEvents.remove.params.value">&#xB6;</a>  - &#x88AB;&#x5220;&#x9664;&#x7684;&#x503C;&#x3002;</span></li><li><span class="yiyi-st" id="yiyi-147"><span class="target" id="sqlalchemy.orm.events.AttributeEvents.remove.params.initiator"></span> <strong>&#x53D1;&#x8D77;&#x4EBA;</strong> <a class="paramlink headerlink reference internal" href="#sqlalchemy.orm.events.AttributeEvents.remove.params.initiator">&#xB6;</a>  - </span><p><span class="yiyi-st" id="yiyi-144">&#x8868;&#x793A;&#x4E8B;&#x4EF6;&#x542F;&#x52A8;&#x7684;<a class="reference internal" href="internals.html#sqlalchemy.orm.attributes.Event" title="sqlalchemy.orm.attributes.Event"><code class="xref py py-class docutils literal"><span class="pre">attributes.Event</span></code></a>&#x5B9E;&#x4F8B;&#x3002;</span><span class="yiyi-st" id="yiyi-145">&#x53EF;&#x4EE5;&#x901A;&#x8FC7;backref&#x5904;&#x7406;&#x7A0B;&#x5E8F;&#x4ECE;&#x5176;&#x539F;&#x59CB;&#x503C;&#x8FDB;&#x884C;&#x4FEE;&#x6539;&#xFF0C;&#x4EE5;&#x63A7;&#x5236;&#x94FE;&#x5F0F;&#x4E8B;&#x4EF6;&#x4F20;&#x64AD;&#x3002;</span></p><div class="versionchanged"><p><span class="yiyi-st" id="yiyi-146"><span class="versionmodified">&#x5728;&#x7248;&#x672C;0.9.0&#x4E2D;&#x66F4;&#x6539;&#xFF1A;</span> <code class="docutils literal"><span class="pre">initiator</span></code>&#x53C2;&#x6570;&#x73B0;&#x5728;&#x4F5C;&#x4E3A;<a class="reference internal" href="internals.html#sqlalchemy.orm.attributes.Event" title="sqlalchemy.orm.attributes.Event"><code class="xref py py-class docutils literal"><span class="pre">attributes.Event</span></code></a>&#x5BF9;&#x8C61;&#x4F20;&#x9012;&#xFF0C;&#x5E76;&#x4E14;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x4E00;&#x4E2A;backref&#x5904;&#x7406;&#x7A0B;&#x5E8F;&#x53CD;&#x5411;&#x94FE;&#x63A5;&#x4E8B;&#x4EF6;&#x94FE;&#x3002;</span></p></div></li></ul></td></tr><tr class="field-even field"><th class="field-name"><span class="yiyi-st" id="yiyi-148">&#x8FD4;&#x56DE;&#xFF1A;</span></th><td class="field-body"><p class="first last"><span class="yiyi-st" id="yiyi-149">&#x6CA1;&#x6709;&#x4E3A;&#x6B64;&#x4E8B;&#x4EF6;&#x5B9A;&#x4E49;&#x8FD4;&#x56DE;&#x503C;&#x3002;</span></p></td></tr></tbody></table></dd></dl><dl class="method"><dt id="sqlalchemy.orm.events.AttributeEvents.set"><span class="yiyi-st" id="yiyi-150"> <code class="descname">set</code><span class="sig-paren">(</span><em>target</em>, <em>value</em>, <em>oldvalue</em>, <em>initiator</em><span class="sig-paren">)</span><a class="headerlink" href="#sqlalchemy.orm.events.AttributeEvents.set" title="Permalink to this definition">&#xB6;</a></span></dt><dd><p><span class="yiyi-st" id="yiyi-151">&#x63A5;&#x6536;&#x6807;&#x91CF;&#x8BBE;&#x7F6E;&#x4E8B;&#x4EF6;&#x3002;</span></p><div class="event-signatures container"><p><span class="yiyi-st" id="yiyi-152">&#x793A;&#x4F8B;&#x53C2;&#x6570;&#x8868;&#x5355;&#xFF1A;</span></p><div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sqlalchemy</span> <span class="kn">import</span> <span class="n">event</span>

<span class="c1"># standard decorator style</span>
<span class="nd">@event.listens_for</span><span class="p">(</span><span class="n">SomeClass</span><span class="o">.</span><span class="n">some_attribute</span><span class="p">,</span> <span class="s1">&apos;set&apos;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">receive_set</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">oldvalue</span><span class="p">,</span> <span class="n">initiator</span><span class="p">):</span>
    <span class="s2">&quot;listen for the &apos;set&apos; event&quot;</span>

    <span class="c1"># ... (event handling logic) ...</span>

<span class="c1"># named argument style (new in 0.9)</span>
<span class="nd">@event.listens_for</span><span class="p">(</span><span class="n">SomeClass</span><span class="o">.</span><span class="n">some_attribute</span><span class="p">,</span> <span class="s1">&apos;set&apos;</span><span class="p">,</span> <span class="n">named</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">receive_set</span><span class="p">(</span><span class="o">**</span><span class="n">kw</span><span class="p">):</span>
    <span class="s2">&quot;listen for the &apos;set&apos; event&quot;</span>
    <span class="n">target</span> <span class="o">=</span> <span class="n">kw</span><span class="p">[</span><span class="s1">&apos;target&apos;</span><span class="p">]</span>
    <span class="n">value</span> <span class="o">=</span> <span class="n">kw</span><span class="p">[</span><span class="s1">&apos;value&apos;</span><span class="p">]</span>

    <span class="c1"># ... (event handling logic) ...</span></pre></div></div></div><table class="docutils field-list" frame="void" rules="none"><tbody valign="top"><tr class="field-odd field"><th class="field-name"><span class="yiyi-st" id="yiyi-153">&#x53C2;&#x6570;&#xFF1A;</span></th><td class="field-body"><ul class="first simple"><li><span class="yiyi-st" id="yiyi-154"><span class="target" id="sqlalchemy.orm.events.AttributeEvents.set.params.target"></span><strong>target</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.orm.events.AttributeEvents.set.params.target">&#xB6;</a> &#x2013; the object instance receiving the event. </span><span class="yiyi-st" id="yiyi-155">&#x5982;&#x679C;&#x4FA6;&#x542C;&#x5668;&#x4F7F;&#x7528;<code class="docutils literal"><span class="pre">raw=True</span></code>&#x8FDB;&#x884C;&#x6CE8;&#x518C;&#xFF0C;&#x5219;&#x8FD9;&#x5C06;&#x662F;<a class="reference internal" href="internals.html#sqlalchemy.orm.state.InstanceState" title="sqlalchemy.orm.state.InstanceState"><code class="xref py py-class docutils literal"><span class="pre">InstanceState</span></code></a>&#x5BF9;&#x8C61;&#x3002;</span></li><li><span class="yiyi-st" id="yiyi-156"><span class="target" id="sqlalchemy.orm.events.AttributeEvents.set.params.value"></span> <strong>&#x503C;</strong> <a class="paramlink headerlink reference internal" href="#sqlalchemy.orm.events.AttributeEvents.set.params.value">&#xB6;</a>  - &#x6B63;&#x5728;&#x8BBE;&#x7F6E;&#x7684;&#x503C;&#x3002;</span><span class="yiyi-st" id="yiyi-157">&#x5982;&#x679C;&#x6B64;&#x4FA6;&#x542C;&#x5668;&#x4F7F;&#x7528;<code class="docutils literal"><span class="pre">retval=True</span></code>&#x8FDB;&#x884C;&#x6CE8;&#x518C;&#xFF0C;&#x90A3;&#x4E48;&#x4FA6;&#x542C;&#x5668;&#x51FD;&#x6570;&#x5FC5;&#x987B;&#x8FD4;&#x56DE;&#x6B64;&#x503C;&#x6216;&#x66FF;&#x6362;&#x5B83;&#x7684;&#x65B0;&#x503C;&#x3002;</span></li><li><span class="yiyi-st" id="yiyi-158"><span class="target" id="sqlalchemy.orm.events.AttributeEvents.set.params.oldvalue"></span> <strong>oldvalue</strong> <a class="paramlink headerlink reference internal" href="#sqlalchemy.orm.events.AttributeEvents.set.params.oldvalue">&#xB6;</a>  - &#x4E4B;&#x524D;&#x7684;&#x503C;&#x88AB;&#x66FF;&#x6362;&#x3002;</span><span class="yiyi-st" id="yiyi-159">&#x8FD9;&#x4E5F;&#x53EF;&#x80FD;&#x662F;<code class="docutils literal"><span class="pre">NEVER_SET</span></code>&#x6216;<code class="docutils literal"><span class="pre">NO_VALUE</span></code>&#x7684;&#x7B26;&#x53F7;&#x3002;</span><span class="yiyi-st" id="yiyi-160">&#x5982;&#x679C;&#x4FA6;&#x542C;&#x5668;&#x4F7F;&#x7528;<code class="docutils literal"><span class="pre">active_history=True</span></code>&#x8FDB;&#x884C;&#x6CE8;&#x518C;&#xFF0C;&#x5219;&#x5982;&#x679C;&#x73B0;&#x6709;&#x503C;&#x5F53;&#x524D;&#x5DF2;&#x5378;&#x8F7D;&#x6216;&#x8FC7;&#x671F;&#xFF0C;&#x5219;&#x5C06;&#x4ECE;&#x6570;&#x636E;&#x5E93;&#x52A0;&#x8F7D;&#x8BE5;&#x5C5E;&#x6027;&#x7684;&#x5148;&#x524D;&#x503C;&#x3002;</span></li><li><span class="yiyi-st" id="yiyi-164"><span class="target" id="sqlalchemy.orm.events.AttributeEvents.set.params.initiator"></span> <strong>&#x53D1;&#x8D77;&#x4EBA;</strong> <a class="paramlink headerlink reference internal" href="#sqlalchemy.orm.events.AttributeEvents.set.params.initiator">&#xB6;</a>  - </span><p><span class="yiyi-st" id="yiyi-161">&#x8868;&#x793A;&#x4E8B;&#x4EF6;&#x542F;&#x52A8;&#x7684;<a class="reference internal" href="internals.html#sqlalchemy.orm.attributes.Event" title="sqlalchemy.orm.attributes.Event"><code class="xref py py-class docutils literal"><span class="pre">attributes.Event</span></code></a>&#x5B9E;&#x4F8B;&#x3002;</span><span class="yiyi-st" id="yiyi-162">&#x53EF;&#x4EE5;&#x901A;&#x8FC7;backref&#x5904;&#x7406;&#x7A0B;&#x5E8F;&#x4ECE;&#x5176;&#x539F;&#x59CB;&#x503C;&#x8FDB;&#x884C;&#x4FEE;&#x6539;&#xFF0C;&#x4EE5;&#x63A7;&#x5236;&#x94FE;&#x5F0F;&#x4E8B;&#x4EF6;&#x4F20;&#x64AD;&#x3002;</span></p><div class="versionchanged"><p><span class="yiyi-st" id="yiyi-163"><span class="versionmodified">&#x5728;&#x7248;&#x672C;0.9.0&#x4E2D;&#x66F4;&#x6539;&#xFF1A;</span> <code class="docutils literal"><span class="pre">initiator</span></code>&#x53C2;&#x6570;&#x73B0;&#x5728;&#x4F5C;&#x4E3A;<a class="reference internal" href="internals.html#sqlalchemy.orm.attributes.Event" title="sqlalchemy.orm.attributes.Event"><code class="xref py py-class docutils literal"><span class="pre">attributes.Event</span></code></a>&#x5BF9;&#x8C61;&#x4F20;&#x9012;&#xFF0C;&#x5E76;&#x4E14;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x4E00;&#x4E2A;backref&#x5904;&#x7406;&#x7A0B;&#x5E8F;&#x53CD;&#x5411;&#x94FE;&#x63A5;&#x4E8B;&#x4EF6;&#x94FE;&#x3002;</span></p></div></li></ul></td></tr><tr class="field-even field"><th class="field-name"><span class="yiyi-st" id="yiyi-165">&#x8FD4;&#x56DE;&#xFF1A;</span></th><td class="field-body"><p class="first last"><span class="yiyi-st" id="yiyi-166">&#x5982;&#x679C;&#x4E8B;&#x4EF6;&#x4F7F;&#x7528;<code class="docutils literal"><span class="pre">retval=True</span></code>&#x6CE8;&#x518C;&#xFF0C;&#x5219;&#x5E94;&#x8FD4;&#x56DE;&#x7ED9;&#x5B9A;&#x503C;&#x6216;&#x65B0;&#x7684;&#x6709;&#x6548;&#x503C;&#x3002;</span></p></td></tr></tbody></table></dd></dl></dd></dl></div><div class="section" id="mapper-events"><h2><span class="yiyi-st" id="yiyi-167">Mapper&#x4E8B;&#x4EF6;<a class="headerlink" href="#mapper-events" title="Permalink to this headline">&#xB6;</a></span></h2><dl class="class"><dt id="sqlalchemy.orm.events.MapperEvents"><span class="yiyi-st" id="yiyi-168"><em class="property">class</em> <code class="descclassname">sqlalchemy.orm.events&#x3002;</code> <code class="descname">MapperEvents</code> <a class="headerlink" href="#sqlalchemy.orm.events.MapperEvents" title="Permalink to this definition">&#xB6;</a></span></dt><dd><p><span class="yiyi-st" id="yiyi-169">&#x57FA;&#x7840;&#xFF1A;<a class="reference internal" href="core_events.html#sqlalchemy.event.base.Events" title="sqlalchemy.event.base.Events"><code class="xref py py-class docutils literal"><span class="pre">sqlalchemy.event.base.Events</span></code></a></span></p><p><span class="yiyi-st" id="yiyi-170">&#x5B9A;&#x4E49;&#x7279;&#x5B9A;&#x4E8E;&#x6620;&#x5C04;&#x7684;&#x4E8B;&#x4EF6;&#x3002;</span></p><p><span class="yiyi-st" id="yiyi-171">&#x4F8B;&#x5982;&#x3002;&#xFF1A;</span></p><div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sqlalchemy</span> <span class="kn">import</span> <span class="n">event</span>

<span class="k">def</span> <span class="nf">my_before_insert_listener</span><span class="p">(</span><span class="n">mapper</span><span class="p">,</span> <span class="n">connection</span><span class="p">,</span> <span class="n">target</span><span class="p">):</span>
    <span class="c1"># execute a stored procedure upon INSERT,</span>
    <span class="c1"># apply the value to the row to be inserted</span>
    <span class="n">target</span><span class="o">.</span><span class="n">calculated_value</span> <span class="o">=</span> <span class="n">connection</span><span class="o">.</span><span class="n">scalar</span><span class="p">(</span>
                                <span class="s2">&quot;select my_special_function(</span><span class="si">%d</span><span class="s2">)&quot;</span>
                                <span class="o">%</span> <span class="n">target</span><span class="o">.</span><span class="n">special_number</span><span class="p">)</span>

<span class="c1"># associate the listener function with SomeClass,</span>
<span class="c1"># to execute during the &quot;before_insert&quot; hook</span>
<span class="n">event</span><span class="o">.</span><span class="n">listen</span><span class="p">(</span>
    <span class="n">SomeClass</span><span class="p">,</span> <span class="s1">&apos;before_insert&apos;</span><span class="p">,</span> <span class="n">my_before_insert_listener</span><span class="p">)</span></pre></div></div><p><span class="yiyi-st" id="yiyi-172">&#x53EF;&#x7528;&#x76EE;&#x6807;&#x5305;&#x62EC;&#xFF1A;</span></p><ul class="simple"><li><span class="yiyi-st" id="yiyi-173">&#x6620;&#x5C04;&#x7C7B;</span></li><li><span class="yiyi-st" id="yiyi-174">&#x672A;&#x6620;&#x5C04;&#x7684;&#x6620;&#x5C04;&#x6216;&#x5F85;&#x6620;&#x5C04;&#x7C7B;&#x7684;&#x8D85;&#x7C7B;&#xFF08;&#x4F7F;&#x7528;<code class="docutils literal"><span class="pre">propagate=True</span></code>&#x6807;&#x5FD7;&#xFF09;</span></li><li><span class="yiyi-st" id="yiyi-175"><a class="reference internal" href="mapping_api.html#sqlalchemy.orm.mapper.Mapper" title="sqlalchemy.orm.mapper.Mapper"><code class="xref py py-class docutils literal"><span class="pre">Mapper</span></code></a>&#x5BF9;&#x8C61;</span></li><li><span class="yiyi-st" id="yiyi-176"><a class="reference internal" href="mapping_api.html#sqlalchemy.orm.mapper.Mapper" title="sqlalchemy.orm.mapper.Mapper"><code class="xref py py-class docutils literal"><span class="pre">Mapper</span></code></a>&#x7C7B;&#x672C;&#x8EAB;&#x548C;<a class="reference internal" href="mapping_api.html#sqlalchemy.orm.mapper" title="sqlalchemy.orm.mapper"><code class="xref py py-func docutils literal"><span class="pre">mapper()</span></code></a>&#x51FD;&#x6570;&#x6307;&#x793A;&#x4FA6;&#x542C;&#x6240;&#x6709;&#x6620;&#x5C04;&#x5668;&#x3002;</span></li></ul><div class="versionchanged"><p><span class="yiyi-st" id="yiyi-177"><span class="versionmodified">&#x5728;&#x7248;&#x672C;0.8.0&#x4E2D;&#x66F4;&#x6539;&#xFF1A;</span>&#x6620;&#x200B;&#x200B;&#x5C04;&#x5668;&#x4E8B;&#x4EF6;&#x53EF;&#x4EE5;&#x4E0E;&#x6620;&#x5C04;&#x7C7B;&#x7684;&#x672A;&#x6620;&#x5C04;&#x8D85;&#x7C7B;&#x76F8;&#x5173;&#x8054;&#x3002;</span></p></div><p><span class="yiyi-st" id="yiyi-178">Mapper&#x4E8B;&#x4EF6;&#x63D0;&#x4F9B;&#x4E86;&#x6620;&#x5C04;&#x5668;&#x5173;&#x952E;&#x90E8;&#x5206;&#x7684;&#x94A9;&#x5B50;&#xFF0C;&#x5305;&#x62EC;&#x4E0E;&#x5BF9;&#x8C61;&#x68C0;&#x6D4B;&#xFF0C;&#x5BF9;&#x8C61;&#x52A0;&#x8F7D;&#x548C;&#x5BF9;&#x8C61;&#x6301;&#x4E45;&#x6027;&#x76F8;&#x5173;&#x7684;&#x90E8;&#x5206;&#x3002;</span><span class="yiyi-st" id="yiyi-179">In particular, the persistence methods <a class="reference internal" href="#sqlalchemy.orm.events.MapperEvents.before_insert" title="sqlalchemy.orm.events.MapperEvents.before_insert"><code class="xref py py-meth docutils literal"><span class="pre">before_insert()</span></code></a>, and <a class="reference internal" href="#sqlalchemy.orm.events.MapperEvents.before_update" title="sqlalchemy.orm.events.MapperEvents.before_update"><code class="xref py py-meth docutils literal"><span class="pre">before_update()</span></code></a> are popular places to augment the state being persisted - however, these methods operate with several significant restrictions. </span><span class="yiyi-st" id="yiyi-180">&#x9F13;&#x52B1;&#x7528;&#x6237;&#x8BC4;&#x4F30;<a class="reference internal" href="#sqlalchemy.orm.events.SessionEvents.before_flush" title="sqlalchemy.orm.events.SessionEvents.before_flush"><code class="xref py py-meth docutils literal"><span class="pre">SessionEvents.before_flush()</span></code></a>&#x548C;<a class="reference internal" href="#sqlalchemy.orm.events.SessionEvents.after_flush" title="sqlalchemy.orm.events.SessionEvents.after_flush"><code class="xref py py-meth docutils literal"><span class="pre">SessionEvents.after_flush()</span></code></a>&#x65B9;&#x6CD5;&#x4F5C;&#x4E3A;&#x66F4;&#x7075;&#x6D3B;&#x548C;&#x7528;&#x6237;&#x53CB;&#x597D;&#x7684;&#x94A9;&#x5B50;&#xFF0C;&#x4EE5;&#x4FBF;&#x5728;&#x5176;&#x4E2D;&#x5E94;&#x7528;&#x989D;&#x5916;&#x7684;&#x6570;&#x636E;&#x5E93;&#x72B6;&#x6001;&#x9F50;&#x5E73;&#x3002;</span></p><p><span class="yiyi-st" id="yiyi-181">&#x5F53;&#x4F7F;&#x7528;<a class="reference internal" href="#sqlalchemy.orm.events.MapperEvents" title="sqlalchemy.orm.events.MapperEvents"><code class="xref py py-class docutils literal"><span class="pre">MapperEvents</span></code></a>&#x65F6;&#xFF0C;<a class="reference internal" href="core_event.html#sqlalchemy.event.listen" title="sqlalchemy.event.listen"><code class="xref py py-func docutils literal"><span class="pre">event.listen()</span></code></a>&#x51FD;&#x6570;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;&#x51E0;&#x4E2A;&#x4FEE;&#x9970;&#x7B26;&#x3002;</span></p><table class="docutils field-list" frame="void" rules="none"><tbody valign="top"><tr class="field-odd field"><th class="field-name"><span class="yiyi-st" id="yiyi-182">&#x53C2;&#x6570;&#xFF1A;</span></th><td class="field-body"><ul class="first last simple"><li><span class="yiyi-st" id="yiyi-183"><span class="target" id="sqlalchemy.orm.events.MapperEvents.params.propagate"></span><strong>propagate=False</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.orm.events.MapperEvents.params.propagate">&#xB6;</a> &#x2013; When True, the event listener should be applied to all inheriting mappers and/or the mappers of inheriting classes, as well as any mapper which is the target of this listener.</span></li><li><span class="yiyi-st" id="yiyi-184"><span class="target" id="sqlalchemy.orm.events.MapperEvents.params.raw"></span><strong>raw=False</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.orm.events.MapperEvents.params.raw">&#xB6;</a> &#x2013; When True, the &#x201C;target&#x201D; argument passed to applicable event listener functions will be the instance&#x2019;s <a class="reference internal" href="internals.html#sqlalchemy.orm.state.InstanceState" title="sqlalchemy.orm.state.InstanceState"><code class="xref py py-class docutils literal"><span class="pre">InstanceState</span></code></a> management object, rather than the mapped instance itself.</span></li><li><span class="yiyi-st" id="yiyi-190"><span class="target" id="sqlalchemy.orm.events.MapperEvents.params.retval"></span> <strong>retval = False</strong> <a class="paramlink headerlink reference internal" href="#sqlalchemy.orm.events.MapperEvents.params.retval">&#xB6;</a>  - </span><p><span class="yiyi-st" id="yiyi-185">&#x5F53;&#x4E3A;True&#x65F6;&#xFF0C;&#x7528;&#x6237;&#x5B9A;&#x4E49;&#x7684;&#x4E8B;&#x4EF6;&#x51FD;&#x6570;&#x5FC5;&#x987B;&#x5177;&#x6709;&#x8FD4;&#x56DE;&#x503C;&#xFF0C;&#x5176;&#x76EE;&#x7684;&#x662F;&#x63A7;&#x5236;&#x540E;&#x7EED;&#x4E8B;&#x4EF6;&#x4F20;&#x64AD;&#xFF0C;&#x6216;&#x8005;&#x4EE5;&#x5176;&#x4ED6;&#x65B9;&#x5F0F;&#x66F4;&#x6539;&#x6620;&#x5C04;&#x5668;&#x6B63;&#x5728;&#x8FDB;&#x884C;&#x7684;&#x64CD;&#x4F5C;&#x3002;</span><span class="yiyi-st" id="yiyi-186">&#x53EF;&#x80FD;&#x7684;&#x8FD4;&#x56DE;&#x503C;&#x662F;&#xFF1A;</span></p><ul><li><span class="yiyi-st" id="yiyi-187"><code class="docutils literal"><span class="pre">sqlalchemy.orm.interfaces.EXT_CONTINUE</span></code>  - &#x7EE7;&#x7EED;&#x6B63;&#x5E38;&#x5904;&#x7406;&#x4E8B;&#x4EF6;&#x3002;</span></li><li><span class="yiyi-st" id="yiyi-188"><code class="docutils literal"><span class="pre">sqlalchemy.orm.interfaces.EXT_STOP</span></code>  - &#x53D6;&#x6D88;&#x94FE;&#x4E2D;&#x7684;&#x6240;&#x6709;&#x540E;&#x7EED;&#x4E8B;&#x4EF6;&#x5904;&#x7406;&#x7A0B;&#x5E8F;&#x3002;</span></li><li><span class="yiyi-st" id="yiyi-189">&#x5176;&#x4ED6;&#x503C; - &#x7531;&#x7279;&#x5B9A;&#x4FA6;&#x542C;&#x5668;&#x6307;&#x5B9A;&#x7684;&#x8FD4;&#x56DE;&#x503C;&#x3002;</span></li></ul></li></ul></td></tr></tbody></table><dl class="method"><dt id="sqlalchemy.orm.events.MapperEvents.after_configured"><span class="yiyi-st" id="yiyi-191"><code class="descname"> after_configured  T0&gt; <span class="sig-paren">&#xFF08; T1&gt; <span class="sig-paren">&#xFF09; T2&gt; <a class="headerlink" href="#sqlalchemy.orm.events.MapperEvents.after_configured" title="Permalink to this definition">&#xB6; T3&gt;</a></span></span></code></span></dt><dd><p><span class="yiyi-st" id="yiyi-192">&#x5728;&#x914D;&#x7F6E;&#x4E86;&#x4E00;&#x7CFB;&#x5217;&#x6620;&#x5C04;&#x5668;&#x4E4B;&#x540E;&#x8C03;&#x7528;&#x3002;</span></p><div class="event-signatures container"><p><span class="yiyi-st" id="yiyi-193">&#x793A;&#x4F8B;&#x53C2;&#x6570;&#x8868;&#x5355;&#xFF1A;</span></p><div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sqlalchemy</span> <span class="kn">import</span> <span class="n">event</span>

<span class="c1"># standard decorator style</span>
<span class="nd">@event.listens_for</span><span class="p">(</span><span class="n">SomeClass</span><span class="p">,</span> <span class="s1">&apos;after_configured&apos;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">receive_after_configured</span><span class="p">():</span>
    <span class="s2">&quot;listen for the &apos;after_configured&apos; event&quot;</span>

    <span class="c1"># ... (event handling logic) ...</span></pre></div></div></div><p><span class="yiyi-st" id="yiyi-194">&#x5728;&#x51FD;&#x6570;&#x5B8C;&#x6210;&#x5176;&#x5DE5;&#x4F5C;&#x540E;&#xFF0C;&#x6BCF;&#x6B21;&#x8C03;&#x7528;<a class="reference internal" href="mapping_api.html#sqlalchemy.orm.configure_mappers" title="sqlalchemy.orm.configure_mappers"><code class="xref py py-func docutils literal"><span class="pre">orm.configure_mappers()</span></code></a>&#x51FD;&#x6570;&#x65F6;&#x90FD;&#x4F1A;&#x8C03;&#x7528;<a class="reference internal" href="#sqlalchemy.orm.events.MapperEvents.after_configured" title="sqlalchemy.orm.events.MapperEvents.after_configured"><code class="xref py py-meth docutils literal"><span class="pre">MapperEvents.after_configured()</span></code></a>&#x4E8B;&#x4EF6;&#x3002;</span><span class="yiyi-st" id="yiyi-195"><a class="reference internal" href="mapping_api.html#sqlalchemy.orm.configure_mappers" title="sqlalchemy.orm.configure_mappers"><code class="xref py py-func docutils literal"><span class="pre">orm.configure_mappers()</span></code></a> is typically invoked automatically as mappings are first used, as well as each time new mappers have been made available and new mapper use is detected.</span></p><p><span class="yiyi-st" id="yiyi-196">&#x5C06;&#x6B64;&#x4E8B;&#x4EF6;&#x4E0E;<a class="reference internal" href="#sqlalchemy.orm.events.MapperEvents.mapper_configured" title="sqlalchemy.orm.events.MapperEvents.mapper_configured"><code class="xref py py-meth docutils literal"><span class="pre">MapperEvents.mapper_configured()</span></code></a>&#x4E8B;&#x4EF6;&#x8FDB;&#x884C;&#x6BD4;&#x8F83;&#xFF0C;&#x8BE5;&#x4E8B;&#x4EF6;&#x5728;&#x914D;&#x7F6E;&#x64CD;&#x4F5C;&#x7EE7;&#x7EED;&#x65F6;&#x4EE5;&#x6BCF;&#x4E2A;&#x6620;&#x5C04;&#x5668;&#x4E3A;&#x57FA;&#x7840;&#x8C03;&#x7528;&#xFF1B;&#x4E0E;&#x8BE5;&#x4E8B;&#x4EF6;&#x4E0D;&#x540C;&#xFF0C;&#x5F53;&#x8C03;&#x7528;&#x6B64;&#x4E8B;&#x4EF6;&#x65F6;&#xFF0C;&#x6240;&#x6709;&#x4EA4;&#x53C9;&#x914D;&#x7F6E;&#xFF08;&#x4F8B;&#x5982;backrefs&#xFF09;&#x4E5F;&#x5C06;&#x53EF;&#x7528;&#x4E8E;&#x4EFB;&#x4F55;&#x6302;&#x8D77;&#x7684;&#x6620;&#x5C04;&#x5668;&#x3002;</span><span class="yiyi-st" id="yiyi-197">&#x4E5F;&#x53EF;&#x4EE5;&#x4E0E;<a class="reference internal" href="#sqlalchemy.orm.events.MapperEvents.before_configured" title="sqlalchemy.orm.events.MapperEvents.before_configured"><code class="xref py py-meth docutils literal"><span class="pre">MapperEvents.before_configured()</span></code></a>&#x76F8;&#x5BF9;&#x7167;&#xFF0C;&#x8BE5;&#x6620;&#x5C04;&#x5728;&#x914D;&#x7F6E;&#x4E00;&#x7CFB;&#x5217;&#x6620;&#x5C04;&#x5668;&#x4E4B;&#x524D;&#x8C03;&#x7528;&#x3002;</span></p><p><span class="yiyi-st" id="yiyi-198">This event can <strong>only</strong> be applied to the <a class="reference internal" href="mapping_api.html#sqlalchemy.orm.mapper.Mapper" title="sqlalchemy.orm.mapper.Mapper"><code class="xref py py-class docutils literal"><span class="pre">Mapper</span></code></a> class or <a class="reference internal" href="mapping_api.html#sqlalchemy.orm.mapper" title="sqlalchemy.orm.mapper"><code class="xref py py-func docutils literal"><span class="pre">mapper()</span></code></a> function, and not to individual mappings or mapped classes. </span><span class="yiyi-st" id="yiyi-199">&#x5B83;&#x4EC5;&#x9488;&#x5BF9;&#x6574;&#x4E2A;&#x6620;&#x5C04;&#x8FDB;&#x884C;&#x8C03;&#x7528;&#xFF1A;</span></p><div class="highlight-python"><div class="highlight"><pre><span></span>from sqlalchemy.orm import mapper

@event.listens_for(mapper, &quot;after_configured&quot;)
def go():
    # ...</pre></div></div><p><span class="yiyi-st" id="yiyi-200">&#x7406;&#x8BBA;&#x4E0A;&#x8FD9;&#x4E2A;&#x4E8B;&#x4EF6;&#x5728;&#x6BCF;&#x4E2A;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x4E2D;&#x88AB;&#x8C03;&#x7528;&#x4E00;&#x6B21;&#xFF0C;&#x4F46;&#x5B9E;&#x9645;&#x4E0A;&#x5728;&#x4EFB;&#x4F55;&#x65F6;&#x5019;&#x8C03;&#x7528;&#x65B0;&#x7684;&#x6620;&#x5C04;&#x5668;&#x90FD;&#x4F1A;&#x53D7;&#x5230;<a class="reference internal" href="mapping_api.html#sqlalchemy.orm.configure_mappers" title="sqlalchemy.orm.configure_mappers"><code class="xref py py-func docutils literal"><span class="pre">orm.configure_mappers()</span></code></a>&#x8C03;&#x7528;&#x7684;&#x5F71;&#x54CD;&#x3002;</span><span class="yiyi-st" id="yiyi-201">&#x5982;&#x679C;&#x5728;&#x5DF2;&#x7ECF;&#x4F7F;&#x7528;&#x73B0;&#x6709;&#x6620;&#x5C04;&#x7684;&#x60C5;&#x51B5;&#x4E0B;&#x6784;&#x5EFA;&#x65B0;&#x7684;&#x6620;&#x5C04;&#xFF0C;&#x5219;&#x53EF;&#x80FD;&#x518D;&#x6B21;&#x8C03;&#x7528;&#x8BE5;&#x4E8B;&#x4EF6;&#x3002;</span><span class="yiyi-st" id="yiyi-202">&#x4E3A;&#x4E86;&#x786E;&#x4FDD;&#x4E00;&#x4E2A;&#x7279;&#x5B9A;&#x7684;&#x4E8B;&#x4EF6;&#x53EA;&#x88AB;&#x8C03;&#x7528;&#x4E00;&#x6B21;&#x800C;&#x4E0D;&#x518D;&#x8FDB;&#x884C;&#xFF0C;&#x53EF;&#x4EE5;&#x5E94;&#x7528;<code class="docutils literal"><span class="pre">once=True</span></code>&#x53C2;&#x6570;&#xFF08;0.9.4&#x4E2D;&#x7684;&#x65B0;&#x503C;&#xFF09;&#xFF1A;</span></p><div class="highlight-python"><div class="highlight"><pre><span></span>from sqlalchemy.orm import mapper

@event.listens_for(mapper, &quot;after_configured&quot;, once=True)
def go():
    # ...</pre></div></div><div class="admonition seealso"><p class="first admonition-title"><span class="yiyi-st" id="yiyi-203">&#x4E5F;&#x53EF;&#x4EE5;&#x770B;&#x770B;</span></p><p><span class="yiyi-st" id="yiyi-204"><a class="reference internal" href="#sqlalchemy.orm.events.MapperEvents.mapper_configured" title="sqlalchemy.orm.events.MapperEvents.mapper_configured"><code class="xref py py-meth docutils literal"><span class="pre">MapperEvents.mapper_configured()</span></code></a></span></p><p class="last"><span class="yiyi-st" id="yiyi-205"><a class="reference internal" href="#sqlalchemy.orm.events.MapperEvents.before_configured" title="sqlalchemy.orm.events.MapperEvents.before_configured"><code class="xref py py-meth docutils literal"><span class="pre">MapperEvents.before_configured()</span></code></a></span></p></div></dd></dl><dl class="method"><dt id="sqlalchemy.orm.events.MapperEvents.after_delete"><span class="yiyi-st" id="yiyi-206"><code class="descname">after_delete</code> <span class="sig-paren">&#xFF08;</span> <em>mapper</em>&#xFF0C;<em>connection</em>&#xFF0C;<em>target</em> <span class="sig-paren">&#xFF09;</span> <a class="headerlink" href="#sqlalchemy.orm.events.MapperEvents.after_delete" title="Permalink to this definition">&#xB6; T6&gt;</a></span></dt><dd><p><span class="yiyi-st" id="yiyi-207">&#x5728;&#x53D1;&#x51FA;&#x4E0E;&#x8BE5;&#x5B9E;&#x4F8B;&#x76F8;&#x5BF9;&#x5E94;&#x7684;DELETE&#x8BED;&#x53E5;&#x4E4B;&#x540E;&#x63A5;&#x6536;&#x5BF9;&#x8C61;&#x5B9E;&#x4F8B;&#x3002;</span></p><div class="event-signatures container"><p><span class="yiyi-st" id="yiyi-208">&#x793A;&#x4F8B;&#x53C2;&#x6570;&#x8868;&#x5355;&#xFF1A;</span></p><div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sqlalchemy</span> <span class="kn">import</span> <span class="n">event</span>

<span class="c1"># standard decorator style</span>
<span class="nd">@event.listens_for</span><span class="p">(</span><span class="n">SomeClass</span><span class="p">,</span> <span class="s1">&apos;after_delete&apos;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">receive_after_delete</span><span class="p">(</span><span class="n">mapper</span><span class="p">,</span> <span class="n">connection</span><span class="p">,</span> <span class="n">target</span><span class="p">):</span>
    <span class="s2">&quot;listen for the &apos;after_delete&apos; event&quot;</span>

    <span class="c1"># ... (event handling logic) ...</span></pre></div></div></div><p><span class="yiyi-st" id="yiyi-209">&#x6B64;&#x4E8B;&#x4EF6;&#x7528;&#x4E8E;&#x5728;&#x7ED9;&#x5B9A;&#x8FDE;&#x63A5;&#x4E0A;&#x53D1;&#x51FA;&#x5176;&#x4ED6;SQL&#x8BED;&#x53E5;&#xFF0C;&#x4EE5;&#x53CA;&#x6267;&#x884C;&#x4E0E;&#x5220;&#x9664;&#x4E8B;&#x4EF6;&#x76F8;&#x5173;&#x7684;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x7279;&#x5B9A;&#x7C3F;&#x8BB0;&#x3002;</span></p><p><span class="yiyi-st" id="yiyi-210">&#x5728;&#x4E0A;&#x4E00;&#x6B65;&#x4E2D;&#xFF0C;&#x5B83;&#x4EEC;&#x7684;DELETE&#x8BED;&#x53E5;&#x540C;&#x65F6;&#x53D1;&#x51FA;&#x540E;&#xFF0C;&#x8BE5;&#x4E8B;&#x4EF6;&#x901A;&#x5E38;&#x88AB;&#x79F0;&#x4E3A;&#x540C;&#x4E00;&#x7C7B;&#x7684;&#x4E00;&#x6279;&#x5BF9;&#x8C61;&#x3002;</span></p><div class="admonition warning"><p class="first admonition-title"><span class="yiyi-st" id="yiyi-211">&#x8B66;&#x544A;</span></p><p class="last"><span class="yiyi-st" id="yiyi-212">Mapper&#x7EA7;&#x522B;&#x7684;&#x5237;&#x65B0;&#x4E8B;&#x4EF6;&#x53EA;&#x5141;&#x8BB8;<strong>&#x975E;&#x5E38;&#x6709;&#x9650;&#x7684;&#x64CD;&#x4F5C;</strong>&#xFF0C;&#x4EC5;&#x5BF9;&#x672C;&#x5730;&#x884C;&#x7684;&#x5C5E;&#x6027;&#x8FDB;&#x884C;&#x64CD;&#x4F5C;&#xFF0C;&#x5E76;&#x5141;&#x8BB8;&#x5728;&#x7ED9;&#x5B9A;&#x7684;<a class="reference internal" href="core_connections.html#sqlalchemy.engine.Connection" title="sqlalchemy.engine.Connection"><code class="xref py py-class docutils literal"><span class="pre">Connection</span></code></a>&#x4E0A;&#x53D1;&#x51FA;&#x4EFB;&#x4F55;SQL&#x3002;</span><span class="yiyi-st" id="yiyi-213"><strong>&#x8BF7;&#x5B8C;&#x6574;&#x9605;&#x8BFB;<a class="reference internal" href="session_events.html#session-persistence-mapper"><span>Mapper-level Events</span></a>&#x4E2D;&#x7684;&#x6CE8;&#x91CA;&#x4EE5;&#x83B7;&#x53D6;&#x4F7F;&#x7528;&#x8FD9;&#x4E9B;&#x65B9;&#x6CD5;&#x7684;&#x6307;&#x5BFC;&#x539F;&#x5219;&#xFF1B;&#x901A;&#x5E38;&#xFF0C;<a class="reference internal" href="#sqlalchemy.orm.events.SessionEvents.before_flush" title="sqlalchemy.orm.events.SessionEvents.before_flush"><code class="xref py py-meth docutils literal"><span class="pre">SessionEvents.before_flush()</span></code></a>&#x65B9;&#x6CD5;&#x5BF9;&#x4E8E;&#x4E00;&#x822C;&#x7684;&#x51B2;&#x6D17;&#x66F4;&#x6539;&#x5E94;&#x8BE5;&#x662F;&#x9996;&#x9009;&#x3002;</strong></span></p></div><table class="docutils field-list" frame="void" rules="none"><tbody valign="top"><tr class="field-odd field"><th class="field-name"><span class="yiyi-st" id="yiyi-214">&#x53C2;&#x6570;&#xFF1A;</span></th><td class="field-body"><ul class="first simple"><li><span class="yiyi-st" id="yiyi-215"><span class="target" id="sqlalchemy.orm.events.MapperEvents.after_delete.params.mapper"></span><strong>mapper</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.orm.events.MapperEvents.after_delete.params.mapper">&#xB6;</a> &#x2013; the <a class="reference internal" href="mapping_api.html#sqlalchemy.orm.mapper.Mapper" title="sqlalchemy.orm.mapper.Mapper"><code class="xref py py-class docutils literal"><span class="pre">Mapper</span></code></a> which is the target of this event.</span></li><li><span class="yiyi-st" id="yiyi-216"><span class="target" id="sqlalchemy.orm.events.MapperEvents.after_delete.params.connection"></span><strong>connection</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.orm.events.MapperEvents.after_delete.params.connection">&#xB6;</a> &#x2013; the <a class="reference internal" href="core_connections.html#sqlalchemy.engine.Connection" title="sqlalchemy.engine.Connection"><code class="xref py py-class docutils literal"><span class="pre">Connection</span></code></a> being used to emit DELETE statements for this instance. </span><span class="yiyi-st" id="yiyi-217">&#x8FD9;&#x4E3A;&#x7279;&#x5B9A;&#x4E8E;&#x6B64;&#x5B9E;&#x4F8B;&#x7684;&#x76EE;&#x6807;&#x6570;&#x636E;&#x5E93;&#x4E0A;&#x7684;&#x5F53;&#x524D;&#x4E8B;&#x52A1;&#x63D0;&#x4F9B;&#x4E86;&#x4E00;&#x4E2A;&#x53E5;&#x67C4;&#x3002;</span></li><li><span class="yiyi-st" id="yiyi-218"><span class="target" id="sqlalchemy.orm.events.MapperEvents.after_delete.params.target"></span> <strong>target</strong> <a class="paramlink headerlink reference internal" href="#sqlalchemy.orm.events.MapperEvents.after_delete.params.target">&#xB6;</a>  - &#x88AB;&#x5220;&#x9664;&#x7684;&#x6620;&#x5C04;&#x5B9E;&#x4F8B;&#x3002;</span><span class="yiyi-st" id="yiyi-219">&#x5982;&#x679C;&#x4E8B;&#x4EF6;&#x914D;&#x7F6E;&#x4E3A;<code class="docutils literal"><span class="pre">raw=True</span></code>&#xFF0C;&#x5219;&#x8FD9;&#x5C06;&#x6539;&#x4E3A;&#x4E0E;&#x8BE5;&#x5B9E;&#x4F8B;&#x5173;&#x8054;&#x7684;<a class="reference internal" href="internals.html#sqlalchemy.orm.state.InstanceState" title="sqlalchemy.orm.state.InstanceState"><code class="xref py py-class docutils literal"><span class="pre">InstanceState</span></code></a>&#x72B6;&#x6001;&#x7BA1;&#x7406;&#x5BF9;&#x8C61;&#x3002;</span></li></ul></td></tr><tr class="field-even field"><th class="field-name"><span class="yiyi-st" id="yiyi-220">&#x8FD4;&#x56DE;&#xFF1A;</span></th><td class="field-body"><p class="first last"><span class="yiyi-st" id="yiyi-221">&#x6B64;&#x4E8B;&#x4EF6;&#x4E0D;&#x652F;&#x6301;&#x8FD4;&#x56DE;&#x503C;&#x3002;</span></p></td></tr></tbody></table><div class="admonition seealso"><p class="first admonition-title"><span class="yiyi-st" id="yiyi-222">&#x4E5F;&#x53EF;&#x4EE5;&#x770B;&#x770B;</span></p><p class="last"><span class="yiyi-st" id="yiyi-223"><a class="reference internal" href="session_events.html#session-persistence-events"><span>Persistence Events</span></a></span></p></div></dd></dl><dl class="method"><dt id="sqlalchemy.orm.events.MapperEvents.after_insert"><span class="yiyi-st" id="yiyi-224"> <code class="descname">after_insert</code><span class="sig-paren">(</span><em>mapper</em>, <em>connection</em>, <em>target</em><span class="sig-paren">)</span><a class="headerlink" href="#sqlalchemy.orm.events.MapperEvents.after_insert" title="Permalink to this definition">&#xB6;</a></span></dt><dd><p><span class="yiyi-st" id="yiyi-225">&#x5728;&#x5BF9;&#x5E94;&#x4E8E;&#x8BE5;&#x5B9E;&#x4F8B;&#x7684;INSERT&#x8BED;&#x53E5;&#x53D1;&#x51FA;&#x540E;&#x63A5;&#x6536;&#x5BF9;&#x8C61;&#x5B9E;&#x4F8B;&#x3002;</span></p><div class="event-signatures container"><p><span class="yiyi-st" id="yiyi-226">&#x793A;&#x4F8B;&#x53C2;&#x6570;&#x8868;&#x5355;&#xFF1A;</span></p><div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sqlalchemy</span> <span class="kn">import</span> <span class="n">event</span>

<span class="c1"># standard decorator style</span>
<span class="nd">@event.listens_for</span><span class="p">(</span><span class="n">SomeClass</span><span class="p">,</span> <span class="s1">&apos;after_insert&apos;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">receive_after_insert</span><span class="p">(</span><span class="n">mapper</span><span class="p">,</span> <span class="n">connection</span><span class="p">,</span> <span class="n">target</span><span class="p">):</span>
    <span class="s2">&quot;listen for the &apos;after_insert&apos; event&quot;</span>

    <span class="c1"># ... (event handling logic) ...</span></pre></div></div></div><p><span class="yiyi-st" id="yiyi-227">&#x5728;&#x53D1;&#x751F;INSERT&#x4E4B;&#x540E;&#xFF0C;&#x6B64;&#x4E8B;&#x4EF6;&#x7528;&#x4E8E;&#x4FEE;&#x6539;&#x5B9E;&#x4F8B;&#x4E2D;&#x7684;&#x7EAF;Python&#x5185;&#x90E8;&#x72B6;&#x6001;&#xFF0C;&#x4EE5;&#x53CA;&#x5728;&#x7ED9;&#x5B9A;&#x8FDE;&#x63A5;&#x4E0A;&#x53D1;&#x51FA;&#x5176;&#x4ED6;SQL&#x8BED;&#x53E5;&#x3002;</span></p><p><span class="yiyi-st" id="yiyi-228">&#x5728;&#x5148;&#x524D;&#x6B65;&#x9AA4;&#x4E2D;&#x4E00;&#x6B21;&#x53D1;&#x51FA;INSERT&#x8BED;&#x53E5;&#x540E;&#xFF0C;&#x901A;&#x5E38;&#x4F1A;&#x8C03;&#x7528;&#x8BE5;&#x4E8B;&#x4EF6;&#x7684;&#x4E00;&#x6279;&#x5BF9;&#x8C61;&#x3002;</span><span class="yiyi-st" id="yiyi-229">&#x5728;&#x6781;&#x4E0D;&#x5E38;&#x89C1;&#x7684;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;<code class="docutils literal"><span class="pre">batch=False</span></code>&#x914D;&#x7F6E;<a class="reference internal" href="mapping_api.html#sqlalchemy.orm.mapper" title="sqlalchemy.orm.mapper"><code class="xref py py-func docutils literal"><span class="pre">mapper()</span></code></a>&#xFF0C;&#x8FD9;&#x5C06;&#x5BFC;&#x81F4;&#x6279;&#x6B21;&#x5B9E;&#x4F8B;&#x88AB;&#x5206;&#x89E3;&#x4E3A;&#x5355;&#x4E2A;&#x548C;&#x66F4;&#x5DEE;&#x7684;&#x8868;&#x73B0;&#xFF09;&#x4E8B;&#x4EF6; - &gt;&#x6301;&#x7EED; - &gt;&#x4E8B;&#x4EF6;&#x6B65;&#x9AA4;&#x3002;</span></p><div class="admonition warning"><p class="first admonition-title"><span class="yiyi-st" id="yiyi-230">&#x8B66;&#x544A;</span></p><p class="last"><span class="yiyi-st" id="yiyi-231">Mapper&#x7EA7;&#x522B;&#x7684;&#x5237;&#x65B0;&#x4E8B;&#x4EF6;&#x53EA;&#x5141;&#x8BB8;<strong>&#x975E;&#x5E38;&#x6709;&#x9650;&#x7684;&#x64CD;&#x4F5C;</strong>&#xFF0C;&#x4EC5;&#x5BF9;&#x672C;&#x5730;&#x884C;&#x7684;&#x5C5E;&#x6027;&#x8FDB;&#x884C;&#x64CD;&#x4F5C;&#xFF0C;&#x5E76;&#x5141;&#x8BB8;&#x5728;&#x7ED9;&#x5B9A;&#x7684;<a class="reference internal" href="core_connections.html#sqlalchemy.engine.Connection" title="sqlalchemy.engine.Connection"><code class="xref py py-class docutils literal"><span class="pre">Connection</span></code></a>&#x4E0A;&#x53D1;&#x51FA;&#x4EFB;&#x4F55;SQL&#x3002;</span><span class="yiyi-st" id="yiyi-232"><strong>&#x8BF7;&#x5B8C;&#x6574;&#x9605;&#x8BFB;<a class="reference internal" href="session_events.html#session-persistence-mapper"><span>Mapper-level Events</span></a>&#x4E2D;&#x7684;&#x6CE8;&#x91CA;&#x4EE5;&#x83B7;&#x53D6;&#x4F7F;&#x7528;&#x8FD9;&#x4E9B;&#x65B9;&#x6CD5;&#x7684;&#x6307;&#x5BFC;&#x539F;&#x5219;&#xFF1B;&#x901A;&#x5E38;&#xFF0C;<a class="reference internal" href="#sqlalchemy.orm.events.SessionEvents.before_flush" title="sqlalchemy.orm.events.SessionEvents.before_flush"><code class="xref py py-meth docutils literal"><span class="pre">SessionEvents.before_flush()</span></code></a>&#x65B9;&#x6CD5;&#x5BF9;&#x4E8E;&#x4E00;&#x822C;&#x7684;&#x51B2;&#x6D17;&#x66F4;&#x6539;&#x5E94;&#x8BE5;&#x662F;&#x9996;&#x9009;&#x3002;</strong></span></p></div><table class="docutils field-list" frame="void" rules="none"><tbody valign="top"><tr class="field-odd field"><th class="field-name"><span class="yiyi-st" id="yiyi-233">&#x53C2;&#x6570;&#xFF1A;</span></th><td class="field-body"><ul class="first simple"><li><span class="yiyi-st" id="yiyi-234"><span class="target" id="sqlalchemy.orm.events.MapperEvents.after_insert.params.mapper"></span><strong>mapper</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.orm.events.MapperEvents.after_insert.params.mapper">&#xB6;</a> &#x2013; the <a class="reference internal" href="mapping_api.html#sqlalchemy.orm.mapper.Mapper" title="sqlalchemy.orm.mapper.Mapper"><code class="xref py py-class docutils literal"><span class="pre">Mapper</span></code></a> which is the target of this event.</span></li><li><span class="yiyi-st" id="yiyi-235"><span class="target" id="sqlalchemy.orm.events.MapperEvents.after_insert.params.connection"></span><strong>connection</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.orm.events.MapperEvents.after_insert.params.connection">&#xB6;</a> &#x2013; the <a class="reference internal" href="core_connections.html#sqlalchemy.engine.Connection" title="sqlalchemy.engine.Connection"><code class="xref py py-class docutils literal"><span class="pre">Connection</span></code></a> being used to emit INSERT statements for this instance. </span><span class="yiyi-st" id="yiyi-236">&#x8FD9;&#x4E3A;&#x7279;&#x5B9A;&#x4E8E;&#x6B64;&#x5B9E;&#x4F8B;&#x7684;&#x76EE;&#x6807;&#x6570;&#x636E;&#x5E93;&#x4E0A;&#x7684;&#x5F53;&#x524D;&#x4E8B;&#x52A1;&#x63D0;&#x4F9B;&#x4E86;&#x4E00;&#x4E2A;&#x53E5;&#x67C4;&#x3002;</span></li><li><span class="yiyi-st" id="yiyi-237"><span class="target" id="sqlalchemy.orm.events.MapperEvents.after_insert.params.target"></span><strong>target</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.orm.events.MapperEvents.after_insert.params.target">&#xB6;</a> &#x2013; the mapped instance being persisted. </span><span class="yiyi-st" id="yiyi-238">&#x5982;&#x679C;&#x4E8B;&#x4EF6;&#x914D;&#x7F6E;&#x4E3A;<code class="docutils literal"><span class="pre">raw=True</span></code>&#xFF0C;&#x5219;&#x8FD9;&#x5C06;&#x6539;&#x4E3A;&#x4E0E;&#x8BE5;&#x5B9E;&#x4F8B;&#x5173;&#x8054;&#x7684;<a class="reference internal" href="internals.html#sqlalchemy.orm.state.InstanceState" title="sqlalchemy.orm.state.InstanceState"><code class="xref py py-class docutils literal"><span class="pre">InstanceState</span></code></a>&#x72B6;&#x6001;&#x7BA1;&#x7406;&#x5BF9;&#x8C61;&#x3002;</span></li></ul></td></tr><tr class="field-even field"><th class="field-name"><span class="yiyi-st" id="yiyi-239">&#x8FD4;&#x56DE;&#xFF1A;</span></th><td class="field-body"><p class="first last"><span class="yiyi-st" id="yiyi-240">&#x6B64;&#x4E8B;&#x4EF6;&#x4E0D;&#x652F;&#x6301;&#x8FD4;&#x56DE;&#x503C;&#x3002;</span></p></td></tr></tbody></table><div class="admonition seealso"><p class="first admonition-title"><span class="yiyi-st" id="yiyi-241">&#x4E5F;&#x53EF;&#x4EE5;&#x770B;&#x770B;</span></p><p class="last"><span class="yiyi-st" id="yiyi-242"><a class="reference internal" href="session_events.html#session-persistence-events"><span>Persistence Events</span></a></span></p></div></dd></dl><dl class="method"><dt id="sqlalchemy.orm.events.MapperEvents.after_update"><span class="yiyi-st" id="yiyi-243"> <code class="descname">after_update</code><span class="sig-paren">(</span><em>mapper</em>, <em>connection</em>, <em>target</em><span class="sig-paren">)</span><a class="headerlink" href="#sqlalchemy.orm.events.MapperEvents.after_update" title="Permalink to this definition">&#xB6;</a></span></dt><dd><p><span class="yiyi-st" id="yiyi-244">&#x5728;&#x5BF9;&#x5E94;&#x4E8E;&#x8BE5;&#x5B9E;&#x4F8B;&#x7684;UPDATE&#x8BED;&#x53E5;&#x53D1;&#x51FA;&#x540E;&#x63A5;&#x6536;&#x5BF9;&#x8C61;&#x5B9E;&#x4F8B;&#x3002;</span></p><div class="event-signatures container"><p><span class="yiyi-st" id="yiyi-245">&#x793A;&#x4F8B;&#x53C2;&#x6570;&#x8868;&#x5355;&#xFF1A;</span></p><div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sqlalchemy</span> <span class="kn">import</span> <span class="n">event</span>

<span class="c1"># standard decorator style</span>
<span class="nd">@event.listens_for</span><span class="p">(</span><span class="n">SomeClass</span><span class="p">,</span> <span class="s1">&apos;after_update&apos;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">receive_after_update</span><span class="p">(</span><span class="n">mapper</span><span class="p">,</span> <span class="n">connection</span><span class="p">,</span> <span class="n">target</span><span class="p">):</span>
    <span class="s2">&quot;listen for the &apos;after_update&apos; event&quot;</span>

    <span class="c1"># ... (event handling logic) ...</span></pre></div></div></div><p><span class="yiyi-st" id="yiyi-246">&#x5728;&#x53D1;&#x751F;UPDATE&#x4E4B;&#x540E;&#xFF0C;&#x6B64;&#x4E8B;&#x4EF6;&#x7528;&#x4E8E;&#x4FEE;&#x6539;&#x5B9E;&#x4F8B;&#x4E2D;&#x7684;&#x7EAF;Python&#x5185;&#x90E8;&#x72B6;&#x6001;&#xFF0C;&#x4EE5;&#x53CA;&#x5728;&#x7ED9;&#x5B9A;&#x8FDE;&#x63A5;&#x4E0A;&#x53D1;&#x51FA;&#x5176;&#x4ED6;SQL&#x8BED;&#x53E5;&#x3002;</span></p><p><span class="yiyi-st" id="yiyi-247">This method is called for all instances that are marked as &#x201C;dirty&#x201D;, <em>even those which have no net changes to their column-based attributes</em>, and for which no UPDATE statement has proceeded. </span><span class="yiyi-st" id="yiyi-248">&#x5F53;&#x4E00;&#x4E2A;&#x5BF9;&#x8C61;&#x7684;&#x4EFB;&#x4F55;&#x57FA;&#x4E8E;&#x5217;&#x7684;&#x5C5E;&#x6027;&#x6709;&#x4E00;&#x4E2A;&#x88AB;&#x8C03;&#x7528;&#x7684;&#x201C;set attribute&#x201D;&#x64CD;&#x4F5C;&#x6216;&#x5F53;&#x5B83;&#x7684;&#x4EFB;&#x4F55;&#x96C6;&#x5408;&#x88AB;&#x4FEE;&#x6539;&#x65F6;&#xFF0C;&#x8FD9;&#x4E2A;&#x5BF9;&#x8C61;&#x88AB;&#x6807;&#x8BB0;&#x4E3A;&#x810F;&#x3002;</span><span class="yiyi-st" id="yiyi-249">&#x5982;&#x679C;&#x5728;&#x66F4;&#x65B0;&#x65F6;&#x6CA1;&#x6709;&#x57FA;&#x4E8E;&#x5217;&#x7684;&#x5C5E;&#x6027;&#x6709;&#x4EFB;&#x4F55;&#x51C0;&#x66F4;&#x6539;&#xFF0C;&#x5219;&#x4E0D;&#x4F1A;&#x53D1;&#x5E03;UPDATE&#x8BED;&#x53E5;&#x3002;</span><span class="yiyi-st" id="yiyi-250">&#x8FD9;&#x610F;&#x5473;&#x7740;&#x53D1;&#x9001;&#x5230;<a class="reference internal" href="#sqlalchemy.orm.events.MapperEvents.after_update" title="sqlalchemy.orm.events.MapperEvents.after_update"><code class="xref py py-meth docutils literal"><span class="pre">after_update()</span></code></a>&#x7684;&#x5B9E;&#x4F8B;<em>&#x4E0D;&#x662F;</em>&#x4FDD;&#x8BC1;&#x5DF2;&#x53D1;&#x5E03;UPDATE&#x8BED;&#x53E5;&#x3002;</span></p><p><span class="yiyi-st" id="yiyi-251">&#x8981;&#x68C0;&#x6D4B;&#x5BF9;&#x8C61;&#x4E0A;&#x7684;&#x57FA;&#x4E8E;&#x5217;&#x7684;&#x5C5E;&#x6027;&#x662F;&#x5426;&#x5177;&#x6709;&#x51C0;&#x66F4;&#x6539;&#x5E76;&#x56E0;&#x6B64;&#x751F;&#x6210;UPDATE&#x8BED;&#x53E5;&#xFF0C;&#x8BF7;&#x4F7F;&#x7528;<code class="docutils literal"><span class="pre">object_session&#xFF08;instance&#xFF09;.is_modified&#xFF08;instance&#xFF0C;</span> <span class="pre">include_collections = False&#xFF09;  T2&gt;  T0&gt;&#x3002;</span></code></span></p><p><span class="yiyi-st" id="yiyi-252">&#x5728;&#x4E0A;&#x4E00;&#x6B65;&#x4E2D;&#xFF0C;&#x5B83;&#x4EEC;&#x7684;UPDATE&#x8BED;&#x53E5;&#x4E00;&#x6B21;&#x88AB;&#x53D1;&#x51FA;&#x540E;&#xFF0C;&#x8BE5;&#x4E8B;&#x4EF6;&#x901A;&#x5E38;&#x88AB;&#x79F0;&#x4E3A;&#x540C;&#x4E00;&#x7C7B;&#x7684;&#x4E00;&#x6279;&#x5BF9;&#x8C61;&#x3002;</span><span class="yiyi-st" id="yiyi-253">&#x5728;&#x6781;&#x4E0D;&#x5E38;&#x89C1;&#x7684;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;<code class="docutils literal"><span class="pre">batch=False</span></code>&#x914D;&#x7F6E;<a class="reference internal" href="mapping_api.html#sqlalchemy.orm.mapper" title="sqlalchemy.orm.mapper"><code class="xref py py-func docutils literal"><span class="pre">mapper()</span></code></a>&#xFF0C;&#x8FD9;&#x5C06;&#x5BFC;&#x81F4;&#x6279;&#x6B21;&#x5B9E;&#x4F8B;&#x88AB;&#x5206;&#x89E3;&#x4E3A;&#x5355;&#x4E2A;&#x548C;&#x66F4;&#x5DEE;&#x7684;&#x8868;&#x73B0;&#xFF09;&#x4E8B;&#x4EF6; - &gt;&#x6301;&#x7EED; - &gt;&#x4E8B;&#x4EF6;&#x6B65;&#x9AA4;&#x3002;</span></p><div class="admonition warning"><p class="first admonition-title"><span class="yiyi-st" id="yiyi-254">&#x8B66;&#x544A;</span></p><p class="last"><span class="yiyi-st" id="yiyi-255">Mapper&#x7EA7;&#x522B;&#x7684;&#x5237;&#x65B0;&#x4E8B;&#x4EF6;&#x53EA;&#x5141;&#x8BB8;<strong>&#x975E;&#x5E38;&#x6709;&#x9650;&#x7684;&#x64CD;&#x4F5C;</strong>&#xFF0C;&#x4EC5;&#x5BF9;&#x672C;&#x5730;&#x884C;&#x7684;&#x5C5E;&#x6027;&#x8FDB;&#x884C;&#x64CD;&#x4F5C;&#xFF0C;&#x5E76;&#x5141;&#x8BB8;&#x5728;&#x7ED9;&#x5B9A;&#x7684;<a class="reference internal" href="core_connections.html#sqlalchemy.engine.Connection" title="sqlalchemy.engine.Connection"><code class="xref py py-class docutils literal"><span class="pre">Connection</span></code></a>&#x4E0A;&#x53D1;&#x51FA;&#x4EFB;&#x4F55;SQL&#x3002;</span><span class="yiyi-st" id="yiyi-256"><strong>&#x8BF7;&#x5B8C;&#x6574;&#x9605;&#x8BFB;<a class="reference internal" href="session_events.html#session-persistence-mapper"><span>Mapper-level Events</span></a>&#x4E2D;&#x7684;&#x6CE8;&#x91CA;&#x4EE5;&#x83B7;&#x53D6;&#x4F7F;&#x7528;&#x8FD9;&#x4E9B;&#x65B9;&#x6CD5;&#x7684;&#x6307;&#x5BFC;&#x539F;&#x5219;&#xFF1B;&#x901A;&#x5E38;&#xFF0C;<a class="reference internal" href="#sqlalchemy.orm.events.SessionEvents.before_flush" title="sqlalchemy.orm.events.SessionEvents.before_flush"><code class="xref py py-meth docutils literal"><span class="pre">SessionEvents.before_flush()</span></code></a>&#x65B9;&#x6CD5;&#x5BF9;&#x4E8E;&#x4E00;&#x822C;&#x7684;&#x51B2;&#x6D17;&#x66F4;&#x6539;&#x5E94;&#x8BE5;&#x662F;&#x9996;&#x9009;&#x3002;</strong></span></p></div><table class="docutils field-list" frame="void" rules="none"><tbody valign="top"><tr class="field-odd field"><th class="field-name"><span class="yiyi-st" id="yiyi-257">&#x53C2;&#x6570;&#xFF1A;</span></th><td class="field-body"><ul class="first simple"><li><span class="yiyi-st" id="yiyi-258"><span class="target" id="sqlalchemy.orm.events.MapperEvents.after_update.params.mapper"></span><strong>mapper</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.orm.events.MapperEvents.after_update.params.mapper">&#xB6;</a> &#x2013; the <a class="reference internal" href="mapping_api.html#sqlalchemy.orm.mapper.Mapper" title="sqlalchemy.orm.mapper.Mapper"><code class="xref py py-class docutils literal"><span class="pre">Mapper</span></code></a> which is the target of this event.</span></li><li><span class="yiyi-st" id="yiyi-259"><span class="target" id="sqlalchemy.orm.events.MapperEvents.after_update.params.connection"></span><strong>connection</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.orm.events.MapperEvents.after_update.params.connection">&#xB6;</a> &#x2013; the <a class="reference internal" href="core_connections.html#sqlalchemy.engine.Connection" title="sqlalchemy.engine.Connection"><code class="xref py py-class docutils literal"><span class="pre">Connection</span></code></a> being used to emit UPDATE statements for this instance. </span><span class="yiyi-st" id="yiyi-260">&#x8FD9;&#x4E3A;&#x7279;&#x5B9A;&#x4E8E;&#x6B64;&#x5B9E;&#x4F8B;&#x7684;&#x76EE;&#x6807;&#x6570;&#x636E;&#x5E93;&#x4E0A;&#x7684;&#x5F53;&#x524D;&#x4E8B;&#x52A1;&#x63D0;&#x4F9B;&#x4E86;&#x4E00;&#x4E2A;&#x53E5;&#x67C4;&#x3002;</span></li><li><span class="yiyi-st" id="yiyi-261"><span class="target" id="sqlalchemy.orm.events.MapperEvents.after_update.params.target"></span><strong>target</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.orm.events.MapperEvents.after_update.params.target">&#xB6;</a> &#x2013; the mapped instance being persisted. </span><span class="yiyi-st" id="yiyi-262">&#x5982;&#x679C;&#x4E8B;&#x4EF6;&#x914D;&#x7F6E;&#x4E3A;<code class="docutils literal"><span class="pre">raw=True</span></code>&#xFF0C;&#x5219;&#x8FD9;&#x5C06;&#x6539;&#x4E3A;&#x4E0E;&#x8BE5;&#x5B9E;&#x4F8B;&#x5173;&#x8054;&#x7684;<a class="reference internal" href="internals.html#sqlalchemy.orm.state.InstanceState" title="sqlalchemy.orm.state.InstanceState"><code class="xref py py-class docutils literal"><span class="pre">InstanceState</span></code></a>&#x72B6;&#x6001;&#x7BA1;&#x7406;&#x5BF9;&#x8C61;&#x3002;</span></li></ul></td></tr><tr class="field-even field"><th class="field-name"><span class="yiyi-st" id="yiyi-263">&#x8FD4;&#x56DE;&#xFF1A;</span></th><td class="field-body"><p class="first last"><span class="yiyi-st" id="yiyi-264">&#x6B64;&#x4E8B;&#x4EF6;&#x4E0D;&#x652F;&#x6301;&#x8FD4;&#x56DE;&#x503C;&#x3002;</span></p></td></tr></tbody></table><div class="admonition seealso"><p class="first admonition-title"><span class="yiyi-st" id="yiyi-265">&#x4E5F;&#x53EF;&#x4EE5;&#x770B;&#x770B;</span></p><p class="last"><span class="yiyi-st" id="yiyi-266"><a class="reference internal" href="session_events.html#session-persistence-events"><span>Persistence Events</span></a></span></p></div></dd></dl><dl class="method"><dt id="sqlalchemy.orm.events.MapperEvents.before_configured"><span class="yiyi-st" id="yiyi-267"><code class="descname"> before_configured  T0&gt; <span class="sig-paren">&#xFF08; T1&gt; <span class="sig-paren">&#xFF09; T2&gt; <a class="headerlink" href="#sqlalchemy.orm.events.MapperEvents.before_configured" title="Permalink to this definition">&#xB6; T3&gt;</a></span></span></code></span></dt><dd><p><span class="yiyi-st" id="yiyi-268">&#x5728;&#x4E00;&#x7CFB;&#x5217;&#x6620;&#x5C04;&#x5668;&#x914D;&#x7F6E;&#x4E4B;&#x524D;&#x8C03;&#x7528;&#x3002;</span></p><div class="event-signatures container"><p><span class="yiyi-st" id="yiyi-269">&#x793A;&#x4F8B;&#x53C2;&#x6570;&#x8868;&#x5355;&#xFF1A;</span></p><div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sqlalchemy</span> <span class="kn">import</span> <span class="n">event</span>

<span class="c1"># standard decorator style</span>
<span class="nd">@event.listens_for</span><span class="p">(</span><span class="n">SomeClass</span><span class="p">,</span> <span class="s1">&apos;before_configured&apos;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">receive_before_configured</span><span class="p">():</span>
    <span class="s2">&quot;listen for the &apos;before_configured&apos; event&quot;</span>

    <span class="c1"># ... (event handling logic) ...</span></pre></div></div></div><p><span class="yiyi-st" id="yiyi-270">The <a class="reference internal" href="#sqlalchemy.orm.events.MapperEvents.before_configured" title="sqlalchemy.orm.events.MapperEvents.before_configured"><code class="xref py py-meth docutils literal"><span class="pre">MapperEvents.before_configured()</span></code></a> event is invoked each time the <a class="reference internal" href="mapping_api.html#sqlalchemy.orm.configure_mappers" title="sqlalchemy.orm.configure_mappers"><code class="xref py py-func docutils literal"><span class="pre">orm.configure_mappers()</span></code></a> function is invoked, before the function has done any of its work. </span><span class="yiyi-st" id="yiyi-271"><a class="reference internal" href="mapping_api.html#sqlalchemy.orm.configure_mappers" title="sqlalchemy.orm.configure_mappers"><code class="xref py py-func docutils literal"><span class="pre">orm.configure_mappers()</span></code></a> is typically invoked automatically as mappings are first used, as well as each time new mappers have been made available and new mapper use is detected.</span></p><p><span class="yiyi-st" id="yiyi-272">This event can <strong>only</strong> be applied to the <a class="reference internal" href="mapping_api.html#sqlalchemy.orm.mapper.Mapper" title="sqlalchemy.orm.mapper.Mapper"><code class="xref py py-class docutils literal"><span class="pre">Mapper</span></code></a> class or <a class="reference internal" href="mapping_api.html#sqlalchemy.orm.mapper" title="sqlalchemy.orm.mapper"><code class="xref py py-func docutils literal"><span class="pre">mapper()</span></code></a> function, and not to individual mappings or mapped classes. </span><span class="yiyi-st" id="yiyi-273">&#x5B83;&#x4EC5;&#x9488;&#x5BF9;&#x6574;&#x4E2A;&#x6620;&#x5C04;&#x8FDB;&#x884C;&#x8C03;&#x7528;&#xFF1A;</span></p><div class="highlight-python"><div class="highlight"><pre><span></span>from sqlalchemy.orm import mapper

@event.listens_for(mapper, &quot;before_configured&quot;)
def go():
    # ...</pre></div></div><p><span class="yiyi-st" id="yiyi-274">&#x5C06;&#x6B64;&#x4E8B;&#x4EF6;&#x4E0E;<a class="reference internal" href="#sqlalchemy.orm.events.MapperEvents.after_configured" title="sqlalchemy.orm.events.MapperEvents.after_configured"><code class="xref py py-meth docutils literal"><span class="pre">MapperEvents.after_configured()</span></code></a>&#x7EA6;&#x675F;&#x5728;&#x914D;&#x7F6E;&#x4E00;&#x7CFB;&#x5217;&#x6620;&#x5C04;&#x5668;&#x4E4B;&#x540E;&#x8C03;&#x7528;&#xFF0C;&#x4EE5;&#x53CA;<a class="reference internal" href="#sqlalchemy.orm.events.MapperEvents.mapper_configured" title="sqlalchemy.orm.events.MapperEvents.mapper_configured"><code class="xref py py-meth docutils literal"><span class="pre">MapperEvents.mapper_configured()</span></code></a>&#x5C3D;&#x53EF;&#x80FD;&#x5730;&#x914D;&#x7F6E;&#x6BCF;&#x4E2A;&#x6620;&#x5C04;&#x5668;&#x3002;</span></p><p><span class="yiyi-st" id="yiyi-275">&#x7406;&#x8BBA;&#x4E0A;&#x8FD9;&#x4E2A;&#x4E8B;&#x4EF6;&#x5728;&#x6BCF;&#x4E2A;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x4E2D;&#x88AB;&#x8C03;&#x7528;&#x4E00;&#x6B21;&#xFF0C;&#x4F46;&#x5B9E;&#x9645;&#x4E0A;&#x5728;&#x4EFB;&#x4F55;&#x65F6;&#x5019;&#x8C03;&#x7528;&#x65B0;&#x7684;&#x6620;&#x5C04;&#x5668;&#x90FD;&#x4F1A;&#x53D7;&#x5230;<a class="reference internal" href="mapping_api.html#sqlalchemy.orm.configure_mappers" title="sqlalchemy.orm.configure_mappers"><code class="xref py py-func docutils literal"><span class="pre">orm.configure_mappers()</span></code></a>&#x8C03;&#x7528;&#x7684;&#x5F71;&#x54CD;&#x3002;</span><span class="yiyi-st" id="yiyi-276">&#x5982;&#x679C;&#x5728;&#x5DF2;&#x7ECF;&#x4F7F;&#x7528;&#x73B0;&#x6709;&#x6620;&#x5C04;&#x7684;&#x60C5;&#x51B5;&#x4E0B;&#x6784;&#x5EFA;&#x65B0;&#x7684;&#x6620;&#x5C04;&#xFF0C;&#x5219;&#x53EF;&#x80FD;&#x518D;&#x6B21;&#x8C03;&#x7528;&#x8BE5;&#x4E8B;&#x4EF6;&#x3002;</span><span class="yiyi-st" id="yiyi-277">&#x4E3A;&#x4E86;&#x786E;&#x4FDD;&#x4E00;&#x4E2A;&#x7279;&#x5B9A;&#x7684;&#x4E8B;&#x4EF6;&#x53EA;&#x88AB;&#x8C03;&#x7528;&#x4E00;&#x6B21;&#x800C;&#x4E0D;&#x518D;&#x8FDB;&#x884C;&#xFF0C;&#x53EF;&#x4EE5;&#x5E94;&#x7528;<code class="docutils literal"><span class="pre">once=True</span></code>&#x53C2;&#x6570;&#xFF08;0.9.4&#x4E2D;&#x7684;&#x65B0;&#x503C;&#xFF09;&#xFF1A;</span></p><div class="highlight-python"><div class="highlight"><pre><span></span>from sqlalchemy.orm import mapper

@event.listens_for(mapper, &quot;before_configured&quot;, once=True)
def go():
    # ...</pre></div></div><div class="versionadded"><p><span class="yiyi-st" id="yiyi-278"><span class="versionmodified">&#x7248;&#x672C;0.9.3&#x4E2D;&#x7684;&#x65B0;&#x529F;&#x80FD;</span></span></p></div><div class="admonition seealso"><p class="first admonition-title"><span class="yiyi-st" id="yiyi-279">&#x4E5F;&#x53EF;&#x4EE5;&#x770B;&#x770B;</span></p><p><span class="yiyi-st" id="yiyi-280"><a class="reference internal" href="#sqlalchemy.orm.events.MapperEvents.mapper_configured" title="sqlalchemy.orm.events.MapperEvents.mapper_configured"><code class="xref py py-meth docutils literal"><span class="pre">MapperEvents.mapper_configured()</span></code></a></span></p><p class="last"><span class="yiyi-st" id="yiyi-281"><a class="reference internal" href="#sqlalchemy.orm.events.MapperEvents.after_configured" title="sqlalchemy.orm.events.MapperEvents.after_configured"><code class="xref py py-meth docutils literal"><span class="pre">MapperEvents.after_configured()</span></code></a></span></p></div></dd></dl><dl class="method"><dt id="sqlalchemy.orm.events.MapperEvents.before_delete"><span class="yiyi-st" id="yiyi-282"> <code class="descname">before_delete</code><span class="sig-paren">(</span><em>mapper</em>, <em>connection</em>, <em>target</em><span class="sig-paren">)</span><a class="headerlink" href="#sqlalchemy.orm.events.MapperEvents.before_delete" title="Permalink to this definition">&#xB6;</a></span></dt><dd><p><span class="yiyi-st" id="yiyi-283">&#x5728;&#x4E0E;&#x8BE5;&#x5B9E;&#x4F8B;&#x76F8;&#x5BF9;&#x5E94;&#x7684;DELETE&#x8BED;&#x53E5;&#x53D1;&#x51FA;&#x4E4B;&#x524D;&#x63A5;&#x6536;&#x5BF9;&#x8C61;&#x5B9E;&#x4F8B;&#x3002;</span></p><div class="event-signatures container"><p><span class="yiyi-st" id="yiyi-284">&#x793A;&#x4F8B;&#x53C2;&#x6570;&#x8868;&#x5355;&#xFF1A;</span></p><div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sqlalchemy</span> <span class="kn">import</span> <span class="n">event</span>

<span class="c1"># standard decorator style</span>
<span class="nd">@event.listens_for</span><span class="p">(</span><span class="n">SomeClass</span><span class="p">,</span> <span class="s1">&apos;before_delete&apos;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">receive_before_delete</span><span class="p">(</span><span class="n">mapper</span><span class="p">,</span> <span class="n">connection</span><span class="p">,</span> <span class="n">target</span><span class="p">):</span>
    <span class="s2">&quot;listen for the &apos;before_delete&apos; event&quot;</span>

    <span class="c1"># ... (event handling logic) ...</span></pre></div></div></div><p><span class="yiyi-st" id="yiyi-285">&#x6B64;&#x4E8B;&#x4EF6;&#x7528;&#x4E8E;&#x5728;&#x7ED9;&#x5B9A;&#x8FDE;&#x63A5;&#x4E0A;&#x53D1;&#x51FA;&#x5176;&#x4ED6;SQL&#x8BED;&#x53E5;&#xFF0C;&#x4EE5;&#x53CA;&#x6267;&#x884C;&#x4E0E;&#x5220;&#x9664;&#x4E8B;&#x4EF6;&#x76F8;&#x5173;&#x7684;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x7279;&#x5B9A;&#x7C3F;&#x8BB0;&#x3002;</span></p><p><span class="yiyi-st" id="yiyi-286">&#x5728;&#x7A0D;&#x540E;&#x7684;&#x6B65;&#x9AA4;&#x4E2D;&#x4E00;&#x6B21;&#x53D1;&#x51FA;DELETE&#x8BED;&#x53E5;&#x4E4B;&#x524D;&#xFF0C;&#x901A;&#x5E38;&#x4F1A;&#x8C03;&#x7528;&#x8BE5;&#x4E8B;&#x4EF6;&#x7684;&#x4E00;&#x6279;&#x5BF9;&#x8C61;&#x3002;</span></p><div class="admonition warning"><p class="first admonition-title"><span class="yiyi-st" id="yiyi-287">&#x8B66;&#x544A;</span></p><p class="last"><span class="yiyi-st" id="yiyi-288">Mapper&#x7EA7;&#x522B;&#x7684;&#x5237;&#x65B0;&#x4E8B;&#x4EF6;&#x53EA;&#x5141;&#x8BB8;<strong>&#x975E;&#x5E38;&#x6709;&#x9650;&#x7684;&#x64CD;&#x4F5C;</strong>&#xFF0C;&#x4EC5;&#x5BF9;&#x672C;&#x5730;&#x884C;&#x7684;&#x5C5E;&#x6027;&#x8FDB;&#x884C;&#x64CD;&#x4F5C;&#xFF0C;&#x5E76;&#x5141;&#x8BB8;&#x5728;&#x7ED9;&#x5B9A;&#x7684;<a class="reference internal" href="core_connections.html#sqlalchemy.engine.Connection" title="sqlalchemy.engine.Connection"><code class="xref py py-class docutils literal"><span class="pre">Connection</span></code></a>&#x4E0A;&#x53D1;&#x51FA;&#x4EFB;&#x4F55;SQL&#x3002;</span><span class="yiyi-st" id="yiyi-289"><strong>&#x8BF7;&#x5B8C;&#x6574;&#x9605;&#x8BFB;<a class="reference internal" href="session_events.html#session-persistence-mapper"><span>Mapper-level Events</span></a>&#x4E2D;&#x7684;&#x6CE8;&#x91CA;&#x4EE5;&#x83B7;&#x53D6;&#x4F7F;&#x7528;&#x8FD9;&#x4E9B;&#x65B9;&#x6CD5;&#x7684;&#x6307;&#x5BFC;&#x539F;&#x5219;&#xFF1B;&#x901A;&#x5E38;&#xFF0C;<a class="reference internal" href="#sqlalchemy.orm.events.SessionEvents.before_flush" title="sqlalchemy.orm.events.SessionEvents.before_flush"><code class="xref py py-meth docutils literal"><span class="pre">SessionEvents.before_flush()</span></code></a>&#x65B9;&#x6CD5;&#x5BF9;&#x4E8E;&#x4E00;&#x822C;&#x7684;&#x51B2;&#x6D17;&#x66F4;&#x6539;&#x5E94;&#x8BE5;&#x662F;&#x9996;&#x9009;&#x3002;</strong></span></p></div><table class="docutils field-list" frame="void" rules="none"><tbody valign="top"><tr class="field-odd field"><th class="field-name"><span class="yiyi-st" id="yiyi-290">&#x53C2;&#x6570;&#xFF1A;</span></th><td class="field-body"><ul class="first simple"><li><span class="yiyi-st" id="yiyi-291"><span class="target" id="sqlalchemy.orm.events.MapperEvents.before_delete.params.mapper"></span><strong>mapper</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.orm.events.MapperEvents.before_delete.params.mapper">&#xB6;</a> &#x2013; the <a class="reference internal" href="mapping_api.html#sqlalchemy.orm.mapper.Mapper" title="sqlalchemy.orm.mapper.Mapper"><code class="xref py py-class docutils literal"><span class="pre">Mapper</span></code></a> which is the target of this event.</span></li><li><span class="yiyi-st" id="yiyi-292"><span class="target" id="sqlalchemy.orm.events.MapperEvents.before_delete.params.connection"></span><strong>connection</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.orm.events.MapperEvents.before_delete.params.connection">&#xB6;</a> &#x2013; the <a class="reference internal" href="core_connections.html#sqlalchemy.engine.Connection" title="sqlalchemy.engine.Connection"><code class="xref py py-class docutils literal"><span class="pre">Connection</span></code></a> being used to emit DELETE statements for this instance. </span><span class="yiyi-st" id="yiyi-293">&#x8FD9;&#x4E3A;&#x7279;&#x5B9A;&#x4E8E;&#x6B64;&#x5B9E;&#x4F8B;&#x7684;&#x76EE;&#x6807;&#x6570;&#x636E;&#x5E93;&#x4E0A;&#x7684;&#x5F53;&#x524D;&#x4E8B;&#x52A1;&#x63D0;&#x4F9B;&#x4E86;&#x4E00;&#x4E2A;&#x53E5;&#x67C4;&#x3002;</span></li><li><span class="yiyi-st" id="yiyi-294"><span class="target" id="sqlalchemy.orm.events.MapperEvents.before_delete.params.target"></span> <strong>target</strong> <a class="paramlink headerlink reference internal" href="#sqlalchemy.orm.events.MapperEvents.before_delete.params.target">&#xB6;</a>  - &#x88AB;&#x5220;&#x9664;&#x7684;&#x6620;&#x5C04;&#x5B9E;&#x4F8B;&#x3002;</span><span class="yiyi-st" id="yiyi-295">&#x5982;&#x679C;&#x4E8B;&#x4EF6;&#x914D;&#x7F6E;&#x4E3A;<code class="docutils literal"><span class="pre">raw=True</span></code>&#xFF0C;&#x5219;&#x8FD9;&#x5C06;&#x6539;&#x4E3A;&#x4E0E;&#x8BE5;&#x5B9E;&#x4F8B;&#x5173;&#x8054;&#x7684;<a class="reference internal" href="internals.html#sqlalchemy.orm.state.InstanceState" title="sqlalchemy.orm.state.InstanceState"><code class="xref py py-class docutils literal"><span class="pre">InstanceState</span></code></a>&#x72B6;&#x6001;&#x7BA1;&#x7406;&#x5BF9;&#x8C61;&#x3002;</span></li></ul></td></tr><tr class="field-even field"><th class="field-name"><span class="yiyi-st" id="yiyi-296">&#x8FD4;&#x56DE;&#xFF1A;</span></th><td class="field-body"><p class="first last"><span class="yiyi-st" id="yiyi-297">&#x6B64;&#x4E8B;&#x4EF6;&#x4E0D;&#x652F;&#x6301;&#x8FD4;&#x56DE;&#x503C;&#x3002;</span></p></td></tr></tbody></table><div class="admonition seealso"><p class="first admonition-title"><span class="yiyi-st" id="yiyi-298">&#x4E5F;&#x53EF;&#x4EE5;&#x770B;&#x770B;</span></p><p class="last"><span class="yiyi-st" id="yiyi-299"><a class="reference internal" href="session_events.html#session-persistence-events"><span>Persistence Events</span></a></span></p></div></dd></dl><dl class="method"><dt id="sqlalchemy.orm.events.MapperEvents.before_insert"><span class="yiyi-st" id="yiyi-300"><code class="descname">before_insert</code> <span class="sig-paren">&#xFF08;</span> <em>mapper</em>&#xFF0C;<em>connection</em>&#xFF0C;<em>target</em> <span class="sig-paren">&#xFF09;</span> <a class="headerlink" href="#sqlalchemy.orm.events.MapperEvents.before_insert" title="Permalink to this definition">&#xB6; T6&gt;</a></span></dt><dd><p><span class="yiyi-st" id="yiyi-301">&#x5728;&#x5BF9;&#x5E94;&#x4E8E;&#x8BE5;&#x5B9E;&#x4F8B;&#x7684;INSERT&#x8BED;&#x53E5;&#x53D1;&#x51FA;&#x4E4B;&#x524D;&#x63A5;&#x6536;&#x5BF9;&#x8C61;&#x5B9E;&#x4F8B;&#x3002;</span></p><div class="event-signatures container"><p><span class="yiyi-st" id="yiyi-302">&#x793A;&#x4F8B;&#x53C2;&#x6570;&#x8868;&#x5355;&#xFF1A;</span></p><div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sqlalchemy</span> <span class="kn">import</span> <span class="n">event</span>

<span class="c1"># standard decorator style</span>
<span class="nd">@event.listens_for</span><span class="p">(</span><span class="n">SomeClass</span><span class="p">,</span> <span class="s1">&apos;before_insert&apos;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">receive_before_insert</span><span class="p">(</span><span class="n">mapper</span><span class="p">,</span> <span class="n">connection</span><span class="p">,</span> <span class="n">target</span><span class="p">):</span>
    <span class="s2">&quot;listen for the &apos;before_insert&apos; event&quot;</span>

    <span class="c1"># ... (event handling logic) ...</span></pre></div></div></div><p><span class="yiyi-st" id="yiyi-303">&#x5728;&#x53D1;&#x751F;INSERT&#x4E4B;&#x524D;&#xFF0C;&#x6B64;&#x4E8B;&#x4EF6;&#x7528;&#x4E8E;&#x4FEE;&#x6539;&#x5B9E;&#x4F8B;&#x4E0A;&#x7684;&#x672C;&#x5730;&#x975E;&#x5BF9;&#x8C61;&#x76F8;&#x5173;&#x5C5E;&#x6027;&#xFF0C;&#x4EE5;&#x53CA;&#x5728;&#x7ED9;&#x5B9A;&#x8FDE;&#x63A5;&#x4E0A;&#x53D1;&#x51FA;&#x5176;&#x4ED6;SQL&#x8BED;&#x53E5;&#x3002;</span></p><p><span class="yiyi-st" id="yiyi-304">&#x5728;&#x7A0D;&#x540E;&#x7684;&#x6B65;&#x9AA4;&#x4E2D;&#x4E00;&#x6B21;&#x53D1;&#x51FA;INSERT&#x8BED;&#x53E5;&#x4E4B;&#x524D;&#xFF0C;&#x901A;&#x5E38;&#x4F1A;&#x8C03;&#x7528;&#x8BE5;&#x4E8B;&#x4EF6;&#x7684;&#x4E00;&#x6279;&#x5BF9;&#x8C61;&#x3002;</span><span class="yiyi-st" id="yiyi-305">&#x5728;&#x6781;&#x4E0D;&#x5E38;&#x89C1;&#x7684;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;<code class="docutils literal"><span class="pre">batch=False</span></code>&#x914D;&#x7F6E;<a class="reference internal" href="mapping_api.html#sqlalchemy.orm.mapper" title="sqlalchemy.orm.mapper"><code class="xref py py-func docutils literal"><span class="pre">mapper()</span></code></a>&#xFF0C;&#x8FD9;&#x5C06;&#x5BFC;&#x81F4;&#x6279;&#x6B21;&#x5B9E;&#x4F8B;&#x88AB;&#x5206;&#x89E3;&#x4E3A;&#x5355;&#x4E2A;&#x548C;&#x66F4;&#x5DEE;&#x7684;&#x8868;&#x73B0;&#xFF09;&#x4E8B;&#x4EF6; - &gt;&#x6301;&#x7EED; - &gt;&#x4E8B;&#x4EF6;&#x6B65;&#x9AA4;&#x3002;</span></p><div class="admonition warning"><p class="first admonition-title"><span class="yiyi-st" id="yiyi-306">&#x8B66;&#x544A;</span></p><p class="last"><span class="yiyi-st" id="yiyi-307">Mapper&#x7EA7;&#x522B;&#x7684;&#x5237;&#x65B0;&#x4E8B;&#x4EF6;&#x53EA;&#x5141;&#x8BB8;<strong>&#x975E;&#x5E38;&#x6709;&#x9650;&#x7684;&#x64CD;&#x4F5C;</strong>&#xFF0C;&#x4EC5;&#x5BF9;&#x672C;&#x5730;&#x884C;&#x7684;&#x5C5E;&#x6027;&#x8FDB;&#x884C;&#x64CD;&#x4F5C;&#xFF0C;&#x5E76;&#x5141;&#x8BB8;&#x5728;&#x7ED9;&#x5B9A;&#x7684;<a class="reference internal" href="core_connections.html#sqlalchemy.engine.Connection" title="sqlalchemy.engine.Connection"><code class="xref py py-class docutils literal"><span class="pre">Connection</span></code></a>&#x4E0A;&#x53D1;&#x51FA;&#x4EFB;&#x4F55;SQL&#x3002;</span><span class="yiyi-st" id="yiyi-308"><strong>&#x8BF7;&#x5B8C;&#x6574;&#x9605;&#x8BFB;<a class="reference internal" href="session_events.html#session-persistence-mapper"><span>Mapper-level Events</span></a>&#x4E2D;&#x7684;&#x6CE8;&#x91CA;&#x4EE5;&#x83B7;&#x53D6;&#x4F7F;&#x7528;&#x8FD9;&#x4E9B;&#x65B9;&#x6CD5;&#x7684;&#x6307;&#x5BFC;&#x539F;&#x5219;&#xFF1B;&#x901A;&#x5E38;&#xFF0C;<a class="reference internal" href="#sqlalchemy.orm.events.SessionEvents.before_flush" title="sqlalchemy.orm.events.SessionEvents.before_flush"><code class="xref py py-meth docutils literal"><span class="pre">SessionEvents.before_flush()</span></code></a>&#x65B9;&#x6CD5;&#x5BF9;&#x4E8E;&#x4E00;&#x822C;&#x7684;&#x51B2;&#x6D17;&#x66F4;&#x6539;&#x5E94;&#x8BE5;&#x662F;&#x9996;&#x9009;&#x3002;</strong></span></p></div><table class="docutils field-list" frame="void" rules="none"><tbody valign="top"><tr class="field-odd field"><th class="field-name"><span class="yiyi-st" id="yiyi-309">&#x53C2;&#x6570;&#xFF1A;</span></th><td class="field-body"><ul class="first simple"><li><span class="yiyi-st" id="yiyi-310"><span class="target" id="sqlalchemy.orm.events.MapperEvents.before_insert.params.mapper"></span><strong>mapper</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.orm.events.MapperEvents.before_insert.params.mapper">&#xB6;</a> &#x2013; the <a class="reference internal" href="mapping_api.html#sqlalchemy.orm.mapper.Mapper" title="sqlalchemy.orm.mapper.Mapper"><code class="xref py py-class docutils literal"><span class="pre">Mapper</span></code></a> which is the target of this event.</span></li><li><span class="yiyi-st" id="yiyi-311"><span class="target" id="sqlalchemy.orm.events.MapperEvents.before_insert.params.connection"></span><strong>connection</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.orm.events.MapperEvents.before_insert.params.connection">&#xB6;</a> &#x2013; the <a class="reference internal" href="core_connections.html#sqlalchemy.engine.Connection" title="sqlalchemy.engine.Connection"><code class="xref py py-class docutils literal"><span class="pre">Connection</span></code></a> being used to emit INSERT statements for this instance. </span><span class="yiyi-st" id="yiyi-312">&#x8FD9;&#x4E3A;&#x7279;&#x5B9A;&#x4E8E;&#x6B64;&#x5B9E;&#x4F8B;&#x7684;&#x76EE;&#x6807;&#x6570;&#x636E;&#x5E93;&#x4E0A;&#x7684;&#x5F53;&#x524D;&#x4E8B;&#x52A1;&#x63D0;&#x4F9B;&#x4E86;&#x4E00;&#x4E2A;&#x53E5;&#x67C4;&#x3002;</span></li><li><span class="yiyi-st" id="yiyi-313"><span class="target" id="sqlalchemy.orm.events.MapperEvents.before_insert.params.target"></span><strong>target</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.orm.events.MapperEvents.before_insert.params.target">&#xB6;</a> &#x2013; the mapped instance being persisted. </span><span class="yiyi-st" id="yiyi-314">&#x5982;&#x679C;&#x4E8B;&#x4EF6;&#x914D;&#x7F6E;&#x4E3A;<code class="docutils literal"><span class="pre">raw=True</span></code>&#xFF0C;&#x5219;&#x8FD9;&#x5C06;&#x6539;&#x4E3A;&#x4E0E;&#x8BE5;&#x5B9E;&#x4F8B;&#x5173;&#x8054;&#x7684;<a class="reference internal" href="internals.html#sqlalchemy.orm.state.InstanceState" title="sqlalchemy.orm.state.InstanceState"><code class="xref py py-class docutils literal"><span class="pre">InstanceState</span></code></a>&#x72B6;&#x6001;&#x7BA1;&#x7406;&#x5BF9;&#x8C61;&#x3002;</span></li></ul></td></tr><tr class="field-even field"><th class="field-name"><span class="yiyi-st" id="yiyi-315">&#x8FD4;&#x56DE;&#xFF1A;</span></th><td class="field-body"><p class="first last"><span class="yiyi-st" id="yiyi-316">&#x6B64;&#x4E8B;&#x4EF6;&#x4E0D;&#x652F;&#x6301;&#x8FD4;&#x56DE;&#x503C;&#x3002;</span></p></td></tr></tbody></table><div class="admonition seealso"><p class="first admonition-title"><span class="yiyi-st" id="yiyi-317">&#x4E5F;&#x53EF;&#x4EE5;&#x770B;&#x770B;</span></p><p class="last"><span class="yiyi-st" id="yiyi-318"><a class="reference internal" href="session_events.html#session-persistence-events"><span>Persistence Events</span></a></span></p></div></dd></dl><dl class="method"><dt id="sqlalchemy.orm.events.MapperEvents.before_update"><span class="yiyi-st" id="yiyi-319"> <code class="descname">before_update</code><span class="sig-paren">(</span><em>mapper</em>, <em>connection</em>, <em>target</em><span class="sig-paren">)</span><a class="headerlink" href="#sqlalchemy.orm.events.MapperEvents.before_update" title="Permalink to this definition">&#xB6;</a></span></dt><dd><p><span class="yiyi-st" id="yiyi-320">&#x5728;&#x5BF9;&#x5E94;&#x4E8E;&#x8BE5;&#x5B9E;&#x4F8B;&#x7684;UPDATE&#x8BED;&#x53E5;&#x53D1;&#x51FA;&#x4E4B;&#x524D;&#x63A5;&#x6536;&#x5BF9;&#x8C61;&#x5B9E;&#x4F8B;&#x3002;</span></p><div class="event-signatures container"><p><span class="yiyi-st" id="yiyi-321">&#x793A;&#x4F8B;&#x53C2;&#x6570;&#x8868;&#x5355;&#xFF1A;</span></p><div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sqlalchemy</span> <span class="kn">import</span> <span class="n">event</span>

<span class="c1"># standard decorator style</span>
<span class="nd">@event.listens_for</span><span class="p">(</span><span class="n">SomeClass</span><span class="p">,</span> <span class="s1">&apos;before_update&apos;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">receive_before_update</span><span class="p">(</span><span class="n">mapper</span><span class="p">,</span> <span class="n">connection</span><span class="p">,</span> <span class="n">target</span><span class="p">):</span>
    <span class="s2">&quot;listen for the &apos;before_update&apos; event&quot;</span>

    <span class="c1"># ... (event handling logic) ...</span></pre></div></div></div><p><span class="yiyi-st" id="yiyi-322">&#x6B64;&#x4E8B;&#x4EF6;&#x7528;&#x4E8E;&#x5728;&#x53D1;&#x751F;UPDATE&#x4E4B;&#x524D;&#x4FEE;&#x6539;&#x5B9E;&#x4F8B;&#x4E0A;&#x7684;&#x672C;&#x5730;&#x975E;&#x5BF9;&#x8C61;&#x76F8;&#x5173;&#x5C5E;&#x6027;&#xFF0C;&#x4EE5;&#x53CA;&#x5728;&#x7ED9;&#x5B9A;&#x8FDE;&#x63A5;&#x4E0A;&#x53D1;&#x51FA;&#x5176;&#x4ED6;SQL&#x8BED;&#x53E5;&#x3002;</span></p><p><span class="yiyi-st" id="yiyi-323">This method is called for all instances that are marked as &#x201C;dirty&#x201D;, <em>even those which have no net changes to their column-based attributes</em>. </span><span class="yiyi-st" id="yiyi-324">&#x5F53;&#x4E00;&#x4E2A;&#x5BF9;&#x8C61;&#x7684;&#x4EFB;&#x4F55;&#x57FA;&#x4E8E;&#x5217;&#x7684;&#x5C5E;&#x6027;&#x6709;&#x4E00;&#x4E2A;&#x88AB;&#x8C03;&#x7528;&#x7684;&#x201C;set attribute&#x201D;&#x64CD;&#x4F5C;&#x6216;&#x5F53;&#x5B83;&#x7684;&#x4EFB;&#x4F55;&#x96C6;&#x5408;&#x88AB;&#x4FEE;&#x6539;&#x65F6;&#xFF0C;&#x8FD9;&#x4E2A;&#x5BF9;&#x8C61;&#x88AB;&#x6807;&#x8BB0;&#x4E3A;&#x810F;&#x3002;</span><span class="yiyi-st" id="yiyi-325">&#x5982;&#x679C;&#x5728;&#x66F4;&#x65B0;&#x65F6;&#x6CA1;&#x6709;&#x57FA;&#x4E8E;&#x5217;&#x7684;&#x5C5E;&#x6027;&#x6709;&#x4EFB;&#x4F55;&#x51C0;&#x66F4;&#x6539;&#xFF0C;&#x5219;&#x4E0D;&#x4F1A;&#x53D1;&#x5E03;UPDATE&#x8BED;&#x53E5;&#x3002;</span><span class="yiyi-st" id="yiyi-326">This means that an instance being sent to <a class="reference internal" href="#sqlalchemy.orm.events.MapperEvents.before_update" title="sqlalchemy.orm.events.MapperEvents.before_update"><code class="xref py py-meth docutils literal"><span class="pre">before_update()</span></code></a> is <em>not</em> a guarantee that an UPDATE statement will be issued, although you can affect the outcome here by modifying attributes so that a net change in value does exist.</span></p><p><span class="yiyi-st" id="yiyi-327">&#x8981;&#x68C0;&#x6D4B;&#x5BF9;&#x8C61;&#x4E0A;&#x7684;&#x57FA;&#x4E8E;&#x5217;&#x7684;&#x5C5E;&#x6027;&#x662F;&#x5426;&#x5177;&#x6709;&#x51C0;&#x66F4;&#x6539;&#xFF0C;&#x5E76;&#x56E0;&#x6B64;&#x4F1A;&#x751F;&#x6210;UPDATE&#x8BED;&#x53E5;&#xFF0C;&#x8BF7;&#x4F7F;&#x7528;<code class="docutils literal"><span class="pre">object_session&#xFF08;instance&#xFF09;.is_modified&#xFF08;instance&#xFF0C;</span> <span class="pre">include_collections = False&#xFF09;  T2&gt;  T0&gt;&#x3002;</span></code></span></p><p><span class="yiyi-st" id="yiyi-328">&#x5728;&#x7A0D;&#x540E;&#x7684;&#x6B65;&#x9AA4;&#x4E2D;&#x540C;&#x65F6;&#x53D1;&#x51FA;UPDATE&#x8BED;&#x53E5;&#x4E4B;&#x524D;&#xFF0C;&#x901A;&#x5E38;&#x4F1A;&#x8C03;&#x7528;&#x8BE5;&#x4E8B;&#x4EF6;&#x7684;&#x4E00;&#x6279;&#x5BF9;&#x8C61;&#x3002;</span><span class="yiyi-st" id="yiyi-329">&#x5728;&#x6781;&#x4E0D;&#x5E38;&#x89C1;&#x7684;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;<code class="docutils literal"><span class="pre">batch=False</span></code>&#x914D;&#x7F6E;<a class="reference internal" href="mapping_api.html#sqlalchemy.orm.mapper" title="sqlalchemy.orm.mapper"><code class="xref py py-func docutils literal"><span class="pre">mapper()</span></code></a>&#xFF0C;&#x8FD9;&#x5C06;&#x5BFC;&#x81F4;&#x6279;&#x6B21;&#x5B9E;&#x4F8B;&#x88AB;&#x5206;&#x89E3;&#x4E3A;&#x5355;&#x4E2A;&#x548C;&#x66F4;&#x5DEE;&#x7684;&#x8868;&#x73B0;&#xFF09;&#x4E8B;&#x4EF6; - &gt;&#x6301;&#x7EED; - &gt;&#x4E8B;&#x4EF6;&#x6B65;&#x9AA4;&#x3002;</span></p><div class="admonition warning"><p class="first admonition-title"><span class="yiyi-st" id="yiyi-330">&#x8B66;&#x544A;</span></p><p class="last"><span class="yiyi-st" id="yiyi-331">Mapper&#x7EA7;&#x522B;&#x7684;&#x5237;&#x65B0;&#x4E8B;&#x4EF6;&#x53EA;&#x5141;&#x8BB8;<strong>&#x975E;&#x5E38;&#x6709;&#x9650;&#x7684;&#x64CD;&#x4F5C;</strong>&#xFF0C;&#x4EC5;&#x5BF9;&#x672C;&#x5730;&#x884C;&#x7684;&#x5C5E;&#x6027;&#x8FDB;&#x884C;&#x64CD;&#x4F5C;&#xFF0C;&#x5E76;&#x5141;&#x8BB8;&#x5728;&#x7ED9;&#x5B9A;&#x7684;<a class="reference internal" href="core_connections.html#sqlalchemy.engine.Connection" title="sqlalchemy.engine.Connection"><code class="xref py py-class docutils literal"><span class="pre">Connection</span></code></a>&#x4E0A;&#x53D1;&#x51FA;&#x4EFB;&#x4F55;SQL&#x3002;</span><span class="yiyi-st" id="yiyi-332"><strong>&#x8BF7;&#x5B8C;&#x6574;&#x9605;&#x8BFB;<a class="reference internal" href="session_events.html#session-persistence-mapper"><span>Mapper-level Events</span></a>&#x4E2D;&#x7684;&#x6CE8;&#x91CA;&#x4EE5;&#x83B7;&#x53D6;&#x4F7F;&#x7528;&#x8FD9;&#x4E9B;&#x65B9;&#x6CD5;&#x7684;&#x6307;&#x5BFC;&#x539F;&#x5219;&#xFF1B;&#x901A;&#x5E38;&#xFF0C;<a class="reference internal" href="#sqlalchemy.orm.events.SessionEvents.before_flush" title="sqlalchemy.orm.events.SessionEvents.before_flush"><code class="xref py py-meth docutils literal"><span class="pre">SessionEvents.before_flush()</span></code></a>&#x65B9;&#x6CD5;&#x5BF9;&#x4E8E;&#x4E00;&#x822C;&#x7684;&#x51B2;&#x6D17;&#x66F4;&#x6539;&#x5E94;&#x8BE5;&#x662F;&#x9996;&#x9009;&#x3002;</strong></span></p></div><table class="docutils field-list" frame="void" rules="none"><tbody valign="top"><tr class="field-odd field"><th class="field-name"><span class="yiyi-st" id="yiyi-333">&#x53C2;&#x6570;&#xFF1A;</span></th><td class="field-body"><ul class="first simple"><li><span class="yiyi-st" id="yiyi-334"><span class="target" id="sqlalchemy.orm.events.MapperEvents.before_update.params.mapper"></span><strong>mapper</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.orm.events.MapperEvents.before_update.params.mapper">&#xB6;</a> &#x2013; the <a class="reference internal" href="mapping_api.html#sqlalchemy.orm.mapper.Mapper" title="sqlalchemy.orm.mapper.Mapper"><code class="xref py py-class docutils literal"><span class="pre">Mapper</span></code></a> which is the target of this event.</span></li><li><span class="yiyi-st" id="yiyi-335"><span class="target" id="sqlalchemy.orm.events.MapperEvents.before_update.params.connection"></span><strong>connection</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.orm.events.MapperEvents.before_update.params.connection">&#xB6;</a> &#x2013; the <a class="reference internal" href="core_connections.html#sqlalchemy.engine.Connection" title="sqlalchemy.engine.Connection"><code class="xref py py-class docutils literal"><span class="pre">Connection</span></code></a> being used to emit UPDATE statements for this instance. </span><span class="yiyi-st" id="yiyi-336">&#x8FD9;&#x4E3A;&#x7279;&#x5B9A;&#x4E8E;&#x6B64;&#x5B9E;&#x4F8B;&#x7684;&#x76EE;&#x6807;&#x6570;&#x636E;&#x5E93;&#x4E0A;&#x7684;&#x5F53;&#x524D;&#x4E8B;&#x52A1;&#x63D0;&#x4F9B;&#x4E86;&#x4E00;&#x4E2A;&#x53E5;&#x67C4;&#x3002;</span></li><li><span class="yiyi-st" id="yiyi-337"><span class="target" id="sqlalchemy.orm.events.MapperEvents.before_update.params.target"></span><strong>target</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.orm.events.MapperEvents.before_update.params.target">&#xB6;</a> &#x2013; the mapped instance being persisted. </span><span class="yiyi-st" id="yiyi-338">&#x5982;&#x679C;&#x4E8B;&#x4EF6;&#x914D;&#x7F6E;&#x4E3A;<code class="docutils literal"><span class="pre">raw=True</span></code>&#xFF0C;&#x5219;&#x8FD9;&#x5C06;&#x6539;&#x4E3A;&#x4E0E;&#x8BE5;&#x5B9E;&#x4F8B;&#x5173;&#x8054;&#x7684;<a class="reference internal" href="internals.html#sqlalchemy.orm.state.InstanceState" title="sqlalchemy.orm.state.InstanceState"><code class="xref py py-class docutils literal"><span class="pre">InstanceState</span></code></a>&#x72B6;&#x6001;&#x7BA1;&#x7406;&#x5BF9;&#x8C61;&#x3002;</span></li></ul></td></tr><tr class="field-even field"><th class="field-name"><span class="yiyi-st" id="yiyi-339">&#x8FD4;&#x56DE;&#xFF1A;</span></th><td class="field-body"><p class="first last"><span class="yiyi-st" id="yiyi-340">&#x6B64;&#x4E8B;&#x4EF6;&#x4E0D;&#x652F;&#x6301;&#x8FD4;&#x56DE;&#x503C;&#x3002;</span></p></td></tr></tbody></table><div class="admonition seealso"><p class="first admonition-title"><span class="yiyi-st" id="yiyi-341">&#x4E5F;&#x53EF;&#x4EE5;&#x770B;&#x770B;</span></p><p class="last"><span class="yiyi-st" id="yiyi-342"><a class="reference internal" href="session_events.html#session-persistence-events"><span>Persistence Events</span></a></span></p></div></dd></dl><dl class="method"><dt id="sqlalchemy.orm.events.MapperEvents.instrument_class"><span class="yiyi-st" id="yiyi-343"> <code class="descname">instrument_class</code><span class="sig-paren">(</span><em>mapper</em>, <em>class_</em><span class="sig-paren">)</span><a class="headerlink" href="#sqlalchemy.orm.events.MapperEvents.instrument_class" title="Permalink to this definition">&#xB6;</a></span></dt><dd><p><span class="yiyi-st" id="yiyi-344">&#x5728;&#x4EEA;&#x8868;&#x5E94;&#x7528;&#x4E8E;&#x6620;&#x5C04;&#x7C7B;&#x4E4B;&#x524D;&#xFF0C;&#x9996;&#x5148;&#x6784;&#x9020;&#x6620;&#x5C04;&#x5668;&#x65F6;&#x63A5;&#x6536;&#x7C7B;&#x3002;</span></p><div class="event-signatures container"><p><span class="yiyi-st" id="yiyi-345">&#x793A;&#x4F8B;&#x53C2;&#x6570;&#x8868;&#x5355;&#xFF1A;</span></p><div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sqlalchemy</span> <span class="kn">import</span> <span class="n">event</span>

<span class="c1"># standard decorator style</span>
<span class="nd">@event.listens_for</span><span class="p">(</span><span class="n">SomeClass</span><span class="p">,</span> <span class="s1">&apos;instrument_class&apos;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">receive_instrument_class</span><span class="p">(</span><span class="n">mapper</span><span class="p">,</span> <span class="n">class_</span><span class="p">):</span>
    <span class="s2">&quot;listen for the &apos;instrument_class&apos; event&quot;</span>

    <span class="c1"># ... (event handling logic) ...</span></pre></div></div></div><p><span class="yiyi-st" id="yiyi-346">&#x8FD9;&#x4E2A;&#x4E8B;&#x4EF6;&#x662F;mapper&#x6784;&#x5EFA;&#x7684;&#x6700;&#x65E9;&#x9636;&#x6BB5;&#x3002;</span><span class="yiyi-st" id="yiyi-347">&#x6620;&#x5C04;&#x5668;&#x7684;&#x5927;&#x591A;&#x6570;&#x5C5E;&#x6027;&#x5C1A;&#x672A;&#x521D;&#x59CB;&#x5316;&#x3002;</span></p><p><span class="yiyi-st" id="yiyi-348">&#x8FD9;&#x4E2A;&#x76D1;&#x542C;&#x5668;&#x65E2;&#x53EF;&#x4EE5;&#x5E94;&#x7528;&#x4E8E;&#x6574;&#x4E2A;<a class="reference internal" href="mapping_api.html#sqlalchemy.orm.mapper.Mapper" title="sqlalchemy.orm.mapper.Mapper"><code class="xref py py-class docutils literal"><span class="pre">Mapper</span></code></a>&#x7C7B;&#xFF0C;&#x4E5F;&#x53EF;&#x4EE5;&#x5E94;&#x7528;&#x4E8E;&#x4EFB;&#x4F55;&#x672A;&#x6620;&#x5C04;&#x7684;&#x7C7B;&#xFF0C;&#x5B83;&#x5C06;&#x4F5C;&#x4E3A;&#x6620;&#x5C04;&#x7C7B;&#x7684;&#x57FA;&#x7840;&#xFF08;&#x4F7F;&#x7528;<code class="docutils literal"><span class="pre">propagate=True</span></code>&#x65D7;&#xFF09;&#xFF1A;</span></p><div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">Base</span> <span class="o">=</span> <span class="n">declarative_base</span><span class="p">()</span>

<span class="nd">@event.listens_for</span><span class="p">(</span><span class="n">Base</span><span class="p">,</span> <span class="s2">&quot;instrument_class&quot;</span><span class="p">,</span> <span class="n">propagate</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">on_new_class</span><span class="p">(</span><span class="n">mapper</span><span class="p">,</span> <span class="n">cls_</span><span class="p">):</span>
    <span class="s2">&quot; ... &quot;</span></pre></div></div><table class="docutils field-list" frame="void" rules="none"><tbody valign="top"><tr class="field-odd field"><th class="field-name"><span class="yiyi-st" id="yiyi-349">&#x53C2;&#x6570;&#xFF1A;</span></th><td class="field-body"><ul class="first last simple"><li><span class="yiyi-st" id="yiyi-350"><span class="target" id="sqlalchemy.orm.events.MapperEvents.instrument_class.params.mapper"></span><strong>mapper</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.orm.events.MapperEvents.instrument_class.params.mapper">&#xB6;</a> &#x2013; the <a class="reference internal" href="mapping_api.html#sqlalchemy.orm.mapper.Mapper" title="sqlalchemy.orm.mapper.Mapper"><code class="xref py py-class docutils literal"><span class="pre">Mapper</span></code></a> which is the target of this event.</span></li><li><span class="yiyi-st" id="yiyi-351"><span class="target" id="sqlalchemy.orm.events.MapperEvents.instrument_class.params.class_"></span> <strong>class _</strong> <a class="paramlink headerlink reference internal" href="#sqlalchemy.orm.events.MapperEvents.instrument_class.params.class_">&#xB6;</a>  - &#x6620;&#x5C04;&#x7684;&#x7C7B;&#x3002;</span></li></ul></td></tr></tbody></table></dd></dl><dl class="method"><dt id="sqlalchemy.orm.events.MapperEvents.mapper_configured"><span class="yiyi-st" id="yiyi-352"> <code class="descname">mapper_configured</code><span class="sig-paren">(</span><em>mapper</em>, <em>class_</em><span class="sig-paren">)</span><a class="headerlink" href="#sqlalchemy.orm.events.MapperEvents.mapper_configured" title="Permalink to this definition">&#xB6;</a></span></dt><dd><p><span class="yiyi-st" id="yiyi-353">&#x5F53;&#x7279;&#x5B9A;&#x6620;&#x5C04;&#x5668;&#x5728;<a class="reference internal" href="mapping_api.html#sqlalchemy.orm.configure_mappers" title="sqlalchemy.orm.configure_mappers"><code class="xref py py-func docutils literal"><span class="pre">configure_mappers()</span></code></a>&#x8C03;&#x7528;&#x7684;&#x8303;&#x56F4;&#x5185;&#x5B8C;&#x6210;&#x81EA;&#x5DF1;&#x7684;&#x914D;&#x7F6E;&#x65F6;&#x8C03;&#x7528;&#x3002;</span></p><div class="event-signatures container"><p><span class="yiyi-st" id="yiyi-354">&#x793A;&#x4F8B;&#x53C2;&#x6570;&#x8868;&#x5355;&#xFF1A;</span></p><div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sqlalchemy</span> <span class="kn">import</span> <span class="n">event</span>

<span class="c1"># standard decorator style</span>
<span class="nd">@event.listens_for</span><span class="p">(</span><span class="n">SomeClass</span><span class="p">,</span> <span class="s1">&apos;mapper_configured&apos;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">receive_mapper_configured</span><span class="p">(</span><span class="n">mapper</span><span class="p">,</span> <span class="n">class_</span><span class="p">):</span>
    <span class="s2">&quot;listen for the &apos;mapper_configured&apos; event&quot;</span>

    <span class="c1"># ... (event handling logic) ...</span></pre></div></div></div><p><span class="yiyi-st" id="yiyi-355">&#x5F53;<a class="reference internal" href="mapping_api.html#sqlalchemy.orm.configure_mappers" title="sqlalchemy.orm.configure_mappers"><code class="xref py py-func docutils literal"><span class="pre">orm.configure_mappers()</span></code></a>&#x51FD;&#x6570;&#x7EE7;&#x7EED;&#x6267;&#x884C;&#x5C1A;&#x672A;&#x914D;&#x7F6E;&#x7684;&#x6620;&#x5C04;&#x5668;&#x7684;&#x5F53;&#x524D;&#x5217;&#x8868;&#x65F6;&#xFF0C;&#x4F1A;&#x4E3A;&#x6BCF;&#x4E2A;&#x6620;&#x5C04;&#x5668;&#x8C03;&#x7528;<a class="reference internal" href="#sqlalchemy.orm.events.MapperEvents.mapper_configured" title="sqlalchemy.orm.events.MapperEvents.mapper_configured"><code class="xref py py-meth docutils literal"><span class="pre">MapperEvents.mapper_configured()</span></code></a>&#x4E8B;&#x4EF6;&#x3002;</span><span class="yiyi-st" id="yiyi-356"><a class="reference internal" href="mapping_api.html#sqlalchemy.orm.configure_mappers" title="sqlalchemy.orm.configure_mappers"><code class="xref py py-func docutils literal"><span class="pre">orm.configure_mappers()</span></code></a> is typically invoked automatically as mappings are first used, as well as each time new mappers have been made available and new mapper use is detected.</span></p><p><span class="yiyi-st" id="yiyi-357">&#x5F53;&#x4E8B;&#x4EF6;&#x88AB;&#x8C03;&#x7528;&#x65F6;&#xFF0C;&#x6620;&#x5C04;&#x5668;&#x5E94;&#x8BE5;&#x5904;&#x4E8E;&#x6700;&#x7EC8;&#x72B6;&#x6001;&#xFF0C;&#x4F46;&#x662F;<strong>&#x4E0D;&#x5305;&#x62EC;&#x53EF;&#x80FD;&#x4ECE;&#x5176;&#x4ED6;&#x6620;&#x5C04;&#x5668;&#x8C03;&#x7528;&#x7684;backrefs</strong>&#xFF1B;&#x5B83;&#x4EEC;&#x53EF;&#x80FD;&#x4ECD;&#x7136;&#x5728;&#x914D;&#x7F6E;&#x64CD;&#x4F5C;&#x4E2D;&#x5904;&#x4E8E;&#x6302;&#x8D77;&#x72B6;&#x6001;&#x3002;</span><span class="yiyi-st" id="yiyi-358">&#x7531;<a class="reference internal" href="relationship_api.html#sqlalchemy.orm.relationship.params.back_populates" title="sqlalchemy.orm.relationship"><code class="xref py py-paramref docutils literal"><span class="pre">orm.relationship.back_populates</span></code></a>&#x53C2;&#x6570;<em>&#x66FF;&#x4EE3;&#x914D;&#x7F6E;&#x7684;&#x53CC;&#x5411;&#x5173;&#x7CFB;&#x5C06;</em>&#x5B8C;&#x5168;&#x53EF;&#x7528;&#xFF0C;&#x56E0;&#x4E3A;&#x6B64;&#x7C7B;&#x5173;&#x7CFB;&#x4E0D;&#x4F9D;&#x8D56;&#x4E8E;&#x5176;&#x4ED6;&#x53EF;&#x80FD;&#x672A;&#x914D;&#x7F6E;&#x7684;&#x6620;&#x5C04;&#x5668;&#x77E5;&#x9053;&#x5B83;&#x4EEC;&#x5B58;&#x5728;&#x3002;</span></p><p><span class="yiyi-st" id="yiyi-359">&#x5BF9;&#x4E8E;&#x786E;&#x4FDD;<strong>&#x6240;&#x6709;</strong>&#x6620;&#x200B;&#x200B;&#x5C04;&#x5668;&#x51C6;&#x5907;&#x5C31;&#x7EEA;&#x7684;&#x4E8B;&#x4EF6;&#xFF08;&#x5305;&#x62EC;&#x4EC5;&#x5728;&#x5176;&#x4ED6;&#x6620;&#x5C04;&#x4E2D;&#x5B9A;&#x4E49;&#x7684;backrefs&#xFF09;&#xFF0C;&#x8BF7;&#x4F7F;&#x7528;<a class="reference internal" href="#sqlalchemy.orm.events.MapperEvents.after_configured" title="sqlalchemy.orm.events.MapperEvents.after_configured"><code class="xref py py-meth docutils literal"><span class="pre">MapperEvents.after_configured()</span></code></a>&#x4E8B;&#x4EF6;&#xFF1B;&#x53EA;&#x6709;&#x5728;&#x5B8C;&#x5168;&#x914D;&#x7F6E;&#x4E86;&#x6240;&#x6709;&#x5DF2;&#x77E5;&#x7684;&#x6620;&#x5C04;&#x540E;&#xFF0C;&#x6B64;&#x4E8B;&#x4EF6;&#x624D;&#x4F1A;&#x8C03;&#x7528;&#x3002;</span></p><p><span class="yiyi-st" id="yiyi-360">The <a class="reference internal" href="#sqlalchemy.orm.events.MapperEvents.mapper_configured" title="sqlalchemy.orm.events.MapperEvents.mapper_configured"><code class="xref py py-meth docutils literal"><span class="pre">MapperEvents.mapper_configured()</span></code></a> event, unlike <a class="reference internal" href="#sqlalchemy.orm.events.MapperEvents.before_configured" title="sqlalchemy.orm.events.MapperEvents.before_configured"><code class="xref py py-meth docutils literal"><span class="pre">MapperEvents.before_configured()</span></code></a> or <a class="reference internal" href="#sqlalchemy.orm.events.MapperEvents.after_configured" title="sqlalchemy.orm.events.MapperEvents.after_configured"><code class="xref py py-meth docutils literal"><span class="pre">MapperEvents.after_configured()</span></code></a>, is called for each mapper/class individually, and the mapper is passed to the event itself. </span><span class="yiyi-st" id="yiyi-361">&#x5B83;&#x4E5F;&#x88AB;&#x79F0;&#x4E3A;&#x4E00;&#x6B21;&#x7279;&#x5B9A;&#x7684;&#x6620;&#x5C04;&#x5668;&#x3002;</span><span class="yiyi-st" id="yiyi-362">&#x56E0;&#x6B64;&#xFF0C;&#x8BE5;&#x4E8B;&#x4EF6;&#x5BF9;&#x4E8E;&#x914D;&#x7F6E;&#x6B65;&#x9AA4;&#x975E;&#x5E38;&#x6709;&#x7528;&#xFF0C;&#x8BE5;&#x914D;&#x7F6E;&#x6B65;&#x9AA4;&#x53EA;&#x80FD;&#x5728;&#x7279;&#x5B9A;&#x7684;&#x6620;&#x5C04;&#x5668;&#x57FA;&#x7840;&#x4E0A;&#x8C03;&#x7528;&#x4E00;&#x6B21;&#xFF0C;&#x56E0;&#x6B64;&#x4E0D;&#x9700;&#x8981;&#x201C;backref&#x201D;&#x914D;&#x7F6E;&#x5FC5;&#x987B;&#x51C6;&#x5907;&#x5C31;&#x7EEA;&#x3002;</span></p><table class="docutils field-list" frame="void" rules="none"><tbody valign="top"><tr class="field-odd field"><th class="field-name"><span class="yiyi-st" id="yiyi-363">&#x53C2;&#x6570;&#xFF1A;</span></th><td class="field-body"><ul class="first last simple"><li><span class="yiyi-st" id="yiyi-364"><span class="target" id="sqlalchemy.orm.events.MapperEvents.mapper_configured.params.mapper"></span><strong>mapper</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.orm.events.MapperEvents.mapper_configured.params.mapper">&#xB6;</a> &#x2013; the <a class="reference internal" href="mapping_api.html#sqlalchemy.orm.mapper.Mapper" title="sqlalchemy.orm.mapper.Mapper"><code class="xref py py-class docutils literal"><span class="pre">Mapper</span></code></a> which is the target of this event.</span></li><li><span class="yiyi-st" id="yiyi-365"><span class="target" id="sqlalchemy.orm.events.MapperEvents.mapper_configured.params.class_"></span> <strong>class _</strong> <a class="paramlink headerlink reference internal" href="#sqlalchemy.orm.events.MapperEvents.mapper_configured.params.class_">&#xB6;</a>  - &#x6620;&#x5C04;&#x7684;&#x7C7B;&#x3002;</span></li></ul></td></tr></tbody></table><div class="admonition seealso"><p class="first admonition-title"><span class="yiyi-st" id="yiyi-366">&#x4E5F;&#x53EF;&#x4EE5;&#x770B;&#x770B;</span></p><p><span class="yiyi-st" id="yiyi-367"><a class="reference internal" href="#sqlalchemy.orm.events.MapperEvents.before_configured" title="sqlalchemy.orm.events.MapperEvents.before_configured"><code class="xref py py-meth docutils literal"><span class="pre">MapperEvents.before_configured()</span></code></a></span></p><p class="last"><span class="yiyi-st" id="yiyi-368"><a class="reference internal" href="#sqlalchemy.orm.events.MapperEvents.after_configured" title="sqlalchemy.orm.events.MapperEvents.after_configured"><code class="xref py py-meth docutils literal"><span class="pre">MapperEvents.after_configured()</span></code></a></span></p></div></dd></dl></dd></dl></div><div class="section" id="instance-events"><h2><span class="yiyi-st" id="yiyi-369">&#x5B9E;&#x4F8B;&#x4E8B;&#x4EF6;<a class="headerlink" href="#instance-events" title="Permalink to this headline">&#xB6;</a></span></h2><dl class="class"><dt id="sqlalchemy.orm.events.InstanceEvents"><span class="yiyi-st" id="yiyi-370"><em class="property">class</em> <code class="descclassname">sqlalchemy.orm.events&#x3002;</code> <code class="descname">InstanceEvents</code> <a class="headerlink" href="#sqlalchemy.orm.events.InstanceEvents" title="Permalink to this definition">&#xB6;</a></span></dt><dd><p><span class="yiyi-st" id="yiyi-371">&#x57FA;&#x7840;&#xFF1A;<a class="reference internal" href="core_events.html#sqlalchemy.event.base.Events" title="sqlalchemy.event.base.Events"><code class="xref py py-class docutils literal"><span class="pre">sqlalchemy.event.base.Events</span></code></a></span></p><p><span class="yiyi-st" id="yiyi-372">&#x5B9A;&#x4E49;&#x7279;&#x5B9A;&#x4E8E;&#x5BF9;&#x8C61;&#x751F;&#x547D;&#x5468;&#x671F;&#x7684;&#x4E8B;&#x4EF6;&#x3002;</span></p><p><span class="yiyi-st" id="yiyi-373">&#x4F8B;&#x5982;&#x3002;&#xFF1A;</span></p><div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sqlalchemy</span> <span class="kn">import</span> <span class="n">event</span>

<span class="k">def</span> <span class="nf">my_load_listener</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="n">context</span><span class="p">):</span>
    <span class="k">print</span> <span class="s2">&quot;on load!&quot;</span>

<span class="n">event</span><span class="o">.</span><span class="n">listen</span><span class="p">(</span><span class="n">SomeClass</span><span class="p">,</span> <span class="s1">&apos;load&apos;</span><span class="p">,</span> <span class="n">my_load_listener</span><span class="p">)</span></pre></div></div><p><span class="yiyi-st" id="yiyi-374">&#x53EF;&#x7528;&#x76EE;&#x6807;&#x5305;&#x62EC;&#xFF1A;</span></p><ul class="simple"><li><span class="yiyi-st" id="yiyi-375">&#x6620;&#x5C04;&#x7C7B;</span></li><li><span class="yiyi-st" id="yiyi-376">&#x672A;&#x6620;&#x5C04;&#x7684;&#x6620;&#x5C04;&#x6216;&#x5F85;&#x6620;&#x5C04;&#x7C7B;&#x7684;&#x8D85;&#x7C7B;&#xFF08;&#x4F7F;&#x7528;<code class="docutils literal"><span class="pre">propagate=True</span></code>&#x6807;&#x5FD7;&#xFF09;</span></li><li><span class="yiyi-st" id="yiyi-377"><a class="reference internal" href="mapping_api.html#sqlalchemy.orm.mapper.Mapper" title="sqlalchemy.orm.mapper.Mapper"><code class="xref py py-class docutils literal"><span class="pre">Mapper</span></code></a>&#x5BF9;&#x8C61;</span></li><li><span class="yiyi-st" id="yiyi-378"><a class="reference internal" href="mapping_api.html#sqlalchemy.orm.mapper.Mapper" title="sqlalchemy.orm.mapper.Mapper"><code class="xref py py-class docutils literal"><span class="pre">Mapper</span></code></a>&#x7C7B;&#x672C;&#x8EAB;&#x548C;<a class="reference internal" href="mapping_api.html#sqlalchemy.orm.mapper" title="sqlalchemy.orm.mapper"><code class="xref py py-func docutils literal"><span class="pre">mapper()</span></code></a>&#x51FD;&#x6570;&#x6307;&#x793A;&#x4FA6;&#x542C;&#x6240;&#x6709;&#x6620;&#x5C04;&#x5668;&#x3002;</span></li></ul><div class="versionchanged"><p><span class="yiyi-st" id="yiyi-379"><span class="versionmodified">&#x5728;&#x7248;&#x672C;0.8.0&#x4E2D;&#x66F4;&#x6539;&#xFF1A;</span>&#x5B9E;&#x4F8B;&#x4E8B;&#x4EF6;&#x53EF;&#x4EE5;&#x4E0E;&#x6620;&#x5C04;&#x7C7B;&#x7684;&#x672A;&#x6620;&#x5C04;&#x8D85;&#x7C7B;&#x76F8;&#x5173;&#x8054;&#x3002;</span></p></div><p><span class="yiyi-st" id="yiyi-380">&#x5B9E;&#x4F8B;&#x4E8B;&#x4EF6;&#x4E0E;&#x6620;&#x5C04;&#x5668;&#x4E8B;&#x4EF6;&#x5BC6;&#x5207;&#x76F8;&#x5173;&#xFF0C;&#x4F46;&#x5BF9;&#x4E8E;&#x5B9E;&#x4F8B;&#x53CA;&#x5176;&#x5DE5;&#x5177;&#x66F4;&#x5177;&#x4F53;&#xFF0C;&#x800C;&#x4E0D;&#x662F;&#x5176;&#x6301;&#x4E45;&#x6027;&#x7CFB;&#x7EDF;&#x3002;</span></p><p><span class="yiyi-st" id="yiyi-381">&#x5F53;&#x4F7F;&#x7528;<a class="reference internal" href="#sqlalchemy.orm.events.InstanceEvents" title="sqlalchemy.orm.events.InstanceEvents"><code class="xref py py-class docutils literal"><span class="pre">InstanceEvents</span></code></a>&#x65F6;&#xFF0C;<a class="reference internal" href="core_event.html#sqlalchemy.event.listen" title="sqlalchemy.event.listen"><code class="xref py py-func docutils literal"><span class="pre">event.listen()</span></code></a>&#x51FD;&#x6570;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;&#x51E0;&#x4E2A;&#x4FEE;&#x9970;&#x7B26;&#x3002;</span></p><table class="docutils field-list" frame="void" rules="none"><tbody valign="top"><tr class="field-odd field"><th class="field-name"><span class="yiyi-st" id="yiyi-382">&#x53C2;&#x6570;&#xFF1A;</span></th><td class="field-body"><ul class="first last simple"><li><span class="yiyi-st" id="yiyi-383"><span class="target" id="sqlalchemy.orm.events.InstanceEvents.params.propagate"></span><strong>propagate=False</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.orm.events.InstanceEvents.params.propagate">&#xB6;</a> &#x2013; When True, the event listener should be applied to all inheriting classes as well as the class which is the target of this listener.</span></li><li><span class="yiyi-st" id="yiyi-384"><span class="target" id="sqlalchemy.orm.events.InstanceEvents.params.raw"></span><strong>raw=False</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.orm.events.InstanceEvents.params.raw">&#xB6;</a> &#x2013; When True, the &#x201C;target&#x201D; argument passed to applicable event listener functions will be the instance&#x2019;s <a class="reference internal" href="internals.html#sqlalchemy.orm.state.InstanceState" title="sqlalchemy.orm.state.InstanceState"><code class="xref py py-class docutils literal"><span class="pre">InstanceState</span></code></a> management object, rather than the mapped instance itself.</span></li></ul></td></tr></tbody></table><dl class="method"><dt id="sqlalchemy.orm.events.InstanceEvents.expire"><span class="yiyi-st" id="yiyi-385"><code class="descname">expire</code> <span class="sig-paren">&#xFF08;</span> <em>target</em>&#xFF0C;<em>attrs</em> <span class="sig-paren">&#xFF09;</span> <a class="headerlink" href="#sqlalchemy.orm.events.InstanceEvents.expire" title="Permalink to this definition">&#xB6;</a></span></dt><dd><p><span class="yiyi-st" id="yiyi-386">&#x5728;&#x5176;&#x5C5E;&#x6027;&#x6216;&#x67D0;&#x4E2A;&#x5B50;&#x96C6;&#x5DF2;&#x8FC7;&#x671F;&#x540E;&#x63A5;&#x6536;&#x5BF9;&#x8C61;&#x5B9E;&#x4F8B;&#x3002;</span></p><div class="event-signatures container"><p><span class="yiyi-st" id="yiyi-387">&#x793A;&#x4F8B;&#x53C2;&#x6570;&#x8868;&#x5355;&#xFF1A;</span></p><div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sqlalchemy</span> <span class="kn">import</span> <span class="n">event</span>

<span class="c1"># standard decorator style</span>
<span class="nd">@event.listens_for</span><span class="p">(</span><span class="n">SomeClass</span><span class="p">,</span> <span class="s1">&apos;expire&apos;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">receive_expire</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="n">attrs</span><span class="p">):</span>
    <span class="s2">&quot;listen for the &apos;expire&apos; event&quot;</span>

    <span class="c1"># ... (event handling logic) ...</span></pre></div></div></div><p><span class="yiyi-st" id="yiyi-388">&apos;keys&apos;&#x662F;&#x5C5E;&#x6027;&#x540D;&#x79F0;&#x7684;&#x5217;&#x8868;&#x3002;</span><span class="yiyi-st" id="yiyi-389">&#x5982;&#x679C;&#x6CA1;&#x6709;&#xFF0C;&#x5219;&#x6574;&#x4E2A;&#x5DDE;&#x90FD;&#x8FC7;&#x671F;&#x4E86;&#x3002;</span></p><table class="docutils field-list" frame="void" rules="none"><tbody valign="top"><tr class="field-odd field"><th class="field-name"><span class="yiyi-st" id="yiyi-390">&#x53C2;&#x6570;&#xFF1A;</span></th><td class="field-body"><ul class="first last simple"><li><span class="yiyi-st" id="yiyi-391"><span class="target" id="sqlalchemy.orm.events.InstanceEvents.expire.params.target"></span> <strong>target</strong> <a class="paramlink headerlink reference internal" href="#sqlalchemy.orm.events.InstanceEvents.expire.params.target">&#xB6;</a>  - &#x6620;&#x5C04;&#x7684;&#x5B9E;&#x4F8B;&#x3002;</span><span class="yiyi-st" id="yiyi-392">&#x5982;&#x679C;&#x4E8B;&#x4EF6;&#x914D;&#x7F6E;&#x4E3A;<code class="docutils literal"><span class="pre">raw=True</span></code>&#xFF0C;&#x5219;&#x8FD9;&#x5C06;&#x6539;&#x4E3A;&#x4E0E;&#x8BE5;&#x5B9E;&#x4F8B;&#x5173;&#x8054;&#x7684;<a class="reference internal" href="internals.html#sqlalchemy.orm.state.InstanceState" title="sqlalchemy.orm.state.InstanceState"><code class="xref py py-class docutils literal"><span class="pre">InstanceState</span></code></a>&#x72B6;&#x6001;&#x7BA1;&#x7406;&#x5BF9;&#x8C61;&#x3002;</span></li><li><span class="yiyi-st" id="yiyi-393"><span class="target" id="sqlalchemy.orm.events.InstanceEvents.expire.params.attrs"></span><strong>attrs</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.orm.events.InstanceEvents.expire.params.attrs">&#xB6;</a> &#x2013; sequence of attribute names which were expired, or None if all attributes were expired.</span></li></ul></td></tr></tbody></table></dd></dl><dl class="method"><dt id="sqlalchemy.orm.events.InstanceEvents.first_init"><span class="yiyi-st" id="yiyi-394"> <code class="descname">first_init</code><span class="sig-paren">(</span><em>manager</em>, <em>cls</em><span class="sig-paren">)</span><a class="headerlink" href="#sqlalchemy.orm.events.InstanceEvents.first_init" title="Permalink to this definition">&#xB6;</a></span></dt><dd><p><span class="yiyi-st" id="yiyi-395">&#x5F53;&#x8C03;&#x7528;&#x7279;&#x5B9A;&#x6620;&#x5C04;&#x7684;&#x7B2C;&#x4E00;&#x4E2A;&#x5B9E;&#x4F8B;&#x65F6;&#x8C03;&#x7528;&#x3002;</span></p><div class="event-signatures container"><p><span class="yiyi-st" id="yiyi-396">&#x793A;&#x4F8B;&#x53C2;&#x6570;&#x8868;&#x5355;&#xFF1A;</span></p><div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sqlalchemy</span> <span class="kn">import</span> <span class="n">event</span>

<span class="c1"># standard decorator style</span>
<span class="nd">@event.listens_for</span><span class="p">(</span><span class="n">SomeClass</span><span class="p">,</span> <span class="s1">&apos;first_init&apos;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">receive_first_init</span><span class="p">(</span><span class="n">manager</span><span class="p">,</span> <span class="n">cls</span><span class="p">):</span>
    <span class="s2">&quot;listen for the &apos;first_init&apos; event&quot;</span>

    <span class="c1"># ... (event handling logic) ...</span></pre></div></div></div><p><span class="yiyi-st" id="yiyi-397">&#x5F53;&#x67D0;&#x4E2A;&#x7C7B;&#x7684;<code class="docutils literal"><span class="pre">__init__</span></code>&#x65B9;&#x6CD5;&#x88AB;&#x79F0;&#x4E3A;&#x8BE5;&#x7279;&#x5B9A;&#x7C7B;&#x7684;&#x7B2C;&#x4E00;&#x6B21;&#x65F6;&#xFF0C;&#x5C06;&#x8C03;&#x7528;&#x6B64;&#x4E8B;&#x4EF6;&#x3002;</span><span class="yiyi-st" id="yiyi-398">&#x5728;&#x8C03;&#x7528;<a class="reference internal" href="#sqlalchemy.orm.events.InstanceEvents.init" title="sqlalchemy.orm.events.InstanceEvents.init"><code class="xref py py-meth docutils literal"><span class="pre">InstanceEvents.init()</span></code></a>&#x4E8B;&#x4EF6;&#x4E4B;&#x524D;&#xFF0C;&#x4E8B;&#x4EF6;&#x5728;<code class="docutils literal"><span class="pre">__init__</span></code>&#x5B9E;&#x9645;&#x8FDB;&#x884C;&#x4E4B;&#x524D;&#x8C03;&#x7528;&#x4E8B;&#x4EF6;&#x3002;</span></p></dd></dl><dl class="method"><dt id="sqlalchemy.orm.events.InstanceEvents.init"><span class="yiyi-st" id="yiyi-399"><code class="descname">init</code> <span class="sig-paren">&#xFF08;</span> <em>target</em>&#xFF0C;<em>args</em>&#xFF0C;<em>kwargs</em> <span class="sig-paren">&#xFF09;</span> <a class="headerlink" href="#sqlalchemy.orm.events.InstanceEvents.init" title="Permalink to this definition">&#xB6; T6&gt;</a></span></dt><dd><p><span class="yiyi-st" id="yiyi-400">&#x5F53;&#x5B83;&#x7684;&#x6784;&#x9020;&#x51FD;&#x6570;&#x88AB;&#x8C03;&#x7528;&#x65F6;&#x63A5;&#x6536;&#x4E00;&#x4E2A;&#x5B9E;&#x4F8B;&#x3002;</span></p><div class="event-signatures container"><p><span class="yiyi-st" id="yiyi-401">&#x793A;&#x4F8B;&#x53C2;&#x6570;&#x8868;&#x5355;&#xFF1A;</span></p><div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sqlalchemy</span> <span class="kn">import</span> <span class="n">event</span>

<span class="c1"># standard decorator style</span>
<span class="nd">@event.listens_for</span><span class="p">(</span><span class="n">SomeClass</span><span class="p">,</span> <span class="s1">&apos;init&apos;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">receive_init</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">):</span>
    <span class="s2">&quot;listen for the &apos;init&apos; event&quot;</span>

    <span class="c1"># ... (event handling logic) ...</span></pre></div></div></div><p><span class="yiyi-st" id="yiyi-402">&#x8BE5;&#x65B9;&#x6CD5;&#x4EC5;&#x5728;&#x5BF9;&#x8C61;&#x7684;&#x7528;&#x6237;&#x533A;&#x6784;&#x9020;&#x671F;&#x95F4;&#x7ED3;&#x5408;&#x5BF9;&#x8C61;&#x7684;&#x6784;&#x9020;&#x5668;&#xFF08;&#x4F8B;&#x5982;&#xFF0C;&#x5B83;&#x7684;<code class="docutils literal"><span class="pre">__init__</span></code>&#x65B9;&#x6CD5;&#x3002;</span><span class="yiyi-st" id="yiyi-403">&#x4ECE;&#x6570;&#x636E;&#x5E93;&#x52A0;&#x8F7D;&#x5BF9;&#x8C61;&#x65F6;&#x4E0D;&#x8C03;&#x7528;&#x5B83;&#xFF1B;&#x8BF7;&#x53C2;&#x9605;<a class="reference internal" href="#sqlalchemy.orm.events.InstanceEvents.load" title="sqlalchemy.orm.events.InstanceEvents.load"><code class="xref py py-meth docutils literal"><span class="pre">InstanceEvents.load()</span></code></a>&#x4E8B;&#x4EF6;&#x4EE5;&#x62E6;&#x622A;&#x6570;&#x636E;&#x5E93;&#x8D1F;&#x8F7D;&#x3002;</span></p><p><span class="yiyi-st" id="yiyi-404">&#x5728;&#x8C03;&#x7528;&#x8BE5;&#x5BF9;&#x8C61;&#x7684;&#x5B9E;&#x9645;<code class="docutils literal"><span class="pre">__init__</span></code>&#x6784;&#x9020;&#x51FD;&#x6570;&#x4E4B;&#x524D;&#x8C03;&#x7528;&#x8BE5;&#x4E8B;&#x4EF6;&#x3002;</span><span class="yiyi-st" id="yiyi-405">&#x53EF;&#x4EE5;&#x5C31;&#x5730;&#x4FEE;&#x6539;<code class="docutils literal"><span class="pre">kwargs</span></code>&#x5B57;&#x5178;&#xFF0C;&#x4EE5;&#x5F71;&#x54CD;&#x4F20;&#x9012;&#x7ED9;<code class="docutils literal"><span class="pre">__init__</span></code>&#x7684;&#x5185;&#x5BB9;&#x3002;</span></p><table class="docutils field-list" frame="void" rules="none"><tbody valign="top"><tr class="field-odd field"><th class="field-name"><span class="yiyi-st" id="yiyi-406">&#x53C2;&#x6570;&#xFF1A;</span></th><td class="field-body"><ul class="first last simple"><li><span class="yiyi-st" id="yiyi-407"><span class="target" id="sqlalchemy.orm.events.InstanceEvents.init.params.target"></span> <strong>target</strong> <a class="paramlink headerlink reference internal" href="#sqlalchemy.orm.events.InstanceEvents.init.params.target">&#xB6;</a>  - &#x6620;&#x5C04;&#x7684;&#x5B9E;&#x4F8B;&#x3002;</span><span class="yiyi-st" id="yiyi-408">&#x5982;&#x679C;&#x4E8B;&#x4EF6;&#x914D;&#x7F6E;&#x4E3A;<code class="docutils literal"><span class="pre">raw=True</span></code>&#xFF0C;&#x5219;&#x8FD9;&#x5C06;&#x6539;&#x4E3A;&#x4E0E;&#x8BE5;&#x5B9E;&#x4F8B;&#x5173;&#x8054;&#x7684;<a class="reference internal" href="internals.html#sqlalchemy.orm.state.InstanceState" title="sqlalchemy.orm.state.InstanceState"><code class="xref py py-class docutils literal"><span class="pre">InstanceState</span></code></a>&#x72B6;&#x6001;&#x7BA1;&#x7406;&#x5BF9;&#x8C61;&#x3002;</span></li><li><span class="yiyi-st" id="yiyi-409"><span class="target" id="sqlalchemy.orm.events.InstanceEvents.init.params.args"></span><strong>args</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.orm.events.InstanceEvents.init.params.args">&#xB6;</a> &#x2013; positional arguments passed to the <code class="docutils literal"><span class="pre">__init__</span></code> method. </span><span class="yiyi-st" id="yiyi-410">&#x8FD9;&#x662F;&#x4F5C;&#x4E3A;&#x4E00;&#x4E2A;&#x5143;&#x7EC4;&#x4F20;&#x9012;&#x7684;&#xFF0C;&#x76EE;&#x524D;&#x662F;&#x4E0D;&#x53EF;&#x53D8;&#x7684;&#x3002;</span></li><li><span class="yiyi-st" id="yiyi-411"><span class="target" id="sqlalchemy.orm.events.InstanceEvents.init.params.kwargs"></span><strong>kwargs</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.orm.events.InstanceEvents.init.params.kwargs">&#xB6;</a> &#x2013; keyword arguments passed to the <code class="docutils literal"><span class="pre">__init__</span></code> method. </span><span class="yiyi-st" id="yiyi-412">&#x8FD9;&#x4E2A;&#x7ED3;&#x6784;<em>&#x53EF;&#x4EE5;&#x88AB;&#x4FEE;&#x6539;&#x3002;</em></span></li></ul></td></tr></tbody></table><div class="admonition seealso"><p class="first admonition-title"><span class="yiyi-st" id="yiyi-413">&#x4E5F;&#x53EF;&#x4EE5;&#x770B;&#x770B;</span></p><p><span class="yiyi-st" id="yiyi-414"><a class="reference internal" href="#sqlalchemy.orm.events.InstanceEvents.init_failure" title="sqlalchemy.orm.events.InstanceEvents.init_failure"><code class="xref py py-meth docutils literal"><span class="pre">InstanceEvents.init_failure()</span></code></a></span></p><p class="last"><span class="yiyi-st" id="yiyi-415"><a class="reference internal" href="#sqlalchemy.orm.events.InstanceEvents.load" title="sqlalchemy.orm.events.InstanceEvents.load"><code class="xref py py-meth docutils literal"><span class="pre">InstanceEvents.load()</span></code></a></span></p></div></dd></dl><dl class="method"><dt id="sqlalchemy.orm.events.InstanceEvents.init_failure"><span class="yiyi-st" id="yiyi-416"><code class="descname">init_failure</code> <span class="sig-paren">&#xFF08;</span> <em>target</em>&#xFF0C;<em>args</em>&#xFF0C;<em>kwargs</em> <span class="sig-paren">&#xFF09;</span> <a class="headerlink" href="#sqlalchemy.orm.events.InstanceEvents.init_failure" title="Permalink to this definition">&#xB6; T6&gt;</a></span></dt><dd><p><span class="yiyi-st" id="yiyi-417">&#x5F53;&#x5B83;&#x7684;&#x6784;&#x9020;&#x51FD;&#x6570;&#x88AB;&#x8C03;&#x7528;&#x65F6;&#x63A5;&#x6536;&#x4E00;&#x4E2A;&#x5B9E;&#x4F8B;&#xFF0C;&#x5E76;&#x5F15;&#x53D1;&#x5F02;&#x5E38;&#x3002;</span></p><div class="event-signatures container"><p><span class="yiyi-st" id="yiyi-418">&#x793A;&#x4F8B;&#x53C2;&#x6570;&#x8868;&#x5355;&#xFF1A;</span></p><div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sqlalchemy</span> <span class="kn">import</span> <span class="n">event</span>

<span class="c1"># standard decorator style</span>
<span class="nd">@event.listens_for</span><span class="p">(</span><span class="n">SomeClass</span><span class="p">,</span> <span class="s1">&apos;init_failure&apos;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">receive_init_failure</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">):</span>
    <span class="s2">&quot;listen for the &apos;init_failure&apos; event&quot;</span>

    <span class="c1"># ... (event handling logic) ...</span></pre></div></div></div><p><span class="yiyi-st" id="yiyi-419">&#x8BE5;&#x65B9;&#x6CD5;&#x4EC5;&#x5728;&#x5BF9;&#x8C61;&#x7684;&#x7528;&#x6237;&#x533A;&#x6784;&#x9020;&#x671F;&#x95F4;&#x7ED3;&#x5408;&#x5BF9;&#x8C61;&#x7684;&#x6784;&#x9020;&#x5668;&#xFF08;&#x4F8B;&#x5982;&#xFF0C;&#x5B83;&#x7684;<code class="docutils literal"><span class="pre">__init__</span></code>&#x65B9;&#x6CD5;&#x3002;</span><span class="yiyi-st" id="yiyi-420">&#x4ECE;&#x6570;&#x636E;&#x5E93;&#x52A0;&#x8F7D;&#x5BF9;&#x8C61;&#x65F6;&#x4E0D;&#x4F1A;&#x8C03;&#x7528;&#x5B83;&#x3002;</span></p><p><span class="yiyi-st" id="yiyi-421">&#x4E8B;&#x4EF6;&#x5728;<code class="docutils literal"><span class="pre">__init__</span></code>&#x65B9;&#x6CD5;&#x5F15;&#x53D1;&#x7684;&#x5F02;&#x5E38;&#x88AB;&#x6355;&#x83B7;&#x540E;&#x8C03;&#x7528;&#x3002;</span><span class="yiyi-st" id="yiyi-422">&#x4E8B;&#x4EF6;&#x88AB;&#x8C03;&#x7528;&#x540E;&#xFF0C;&#x539F;&#x6765;&#x7684;&#x5F02;&#x5E38;&#x88AB;&#x91CD;&#x65B0;&#x5411;&#x5916;&#x63D0;&#x5347;&#xFF0C;&#x8FD9;&#x6837;&#x5BF9;&#x8C61;&#x7684;&#x6784;&#x9020;&#x4ECD;&#x7136;&#x4F1A;&#x5F15;&#x53D1;&#x5F02;&#x5E38;&#x3002;</span><span class="yiyi-st" id="yiyi-423">&#x5F15;&#x53D1;&#x7684;&#x5B9E;&#x9645;&#x5F02;&#x5E38;&#x548C;&#x5806;&#x6808;&#x8DDF;&#x8E2A;&#x5E94;&#x5B58;&#x5728;&#x4E8E;<code class="docutils literal"><span class="pre">sys.exc_info()</span></code>&#x4E2D;&#x3002;</span></p><table class="docutils field-list" frame="void" rules="none"><tbody valign="top"><tr class="field-odd field"><th class="field-name"><span class="yiyi-st" id="yiyi-424">&#x53C2;&#x6570;&#xFF1A;</span></th><td class="field-body"><ul class="first last simple"><li><span class="yiyi-st" id="yiyi-425"><span class="target" id="sqlalchemy.orm.events.InstanceEvents.init_failure.params.target"></span> <strong>target</strong> <a class="paramlink headerlink reference internal" href="#sqlalchemy.orm.events.InstanceEvents.init_failure.params.target">&#xB6;</a>  - &#x6620;&#x5C04;&#x7684;&#x5B9E;&#x4F8B;&#x3002;</span><span class="yiyi-st" id="yiyi-426">&#x5982;&#x679C;&#x4E8B;&#x4EF6;&#x914D;&#x7F6E;&#x4E3A;<code class="docutils literal"><span class="pre">raw=True</span></code>&#xFF0C;&#x5219;&#x8FD9;&#x5C06;&#x6539;&#x4E3A;&#x4E0E;&#x8BE5;&#x5B9E;&#x4F8B;&#x5173;&#x8054;&#x7684;<a class="reference internal" href="internals.html#sqlalchemy.orm.state.InstanceState" title="sqlalchemy.orm.state.InstanceState"><code class="xref py py-class docutils literal"><span class="pre">InstanceState</span></code></a>&#x72B6;&#x6001;&#x7BA1;&#x7406;&#x5BF9;&#x8C61;&#x3002;</span></li><li><span class="yiyi-st" id="yiyi-427"><span class="target" id="sqlalchemy.orm.events.InstanceEvents.init_failure.params.args"></span><strong>args</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.orm.events.InstanceEvents.init_failure.params.args">&#xB6;</a> &#x2013; positional arguments that were passed to the <code class="docutils literal"><span class="pre">__init__</span></code> method.</span></li><li><span class="yiyi-st" id="yiyi-428"><span class="target" id="sqlalchemy.orm.events.InstanceEvents.init_failure.params.kwargs"> <strong>kwargs</strong> <a class="paramlink headerlink reference internal" href="#sqlalchemy.orm.events.InstanceEvents.init_failure.params.kwargs">&#xB6;</a>  - &#x4F20;&#x9012;&#x7ED9;<code class="docutils literal"><span class="pre">__init__</span></code>&#x65B9;&#x6CD5;&#x7684;&#x5173;&#x952E;&#x5B57;&#x53C2;&#x6570;&#x3002;</span></span></li></ul></td></tr></tbody></table><div class="admonition seealso"><p class="first admonition-title"><span class="yiyi-st" id="yiyi-429">&#x4E5F;&#x53EF;&#x4EE5;&#x770B;&#x770B;</span></p><p><span class="yiyi-st" id="yiyi-430"><a class="reference internal" href="#sqlalchemy.orm.events.InstanceEvents.init" title="sqlalchemy.orm.events.InstanceEvents.init"><code class="xref py py-meth docutils literal"><span class="pre">InstanceEvents.init()</span></code></a></span></p><p class="last"><span class="yiyi-st" id="yiyi-431"><a class="reference internal" href="#sqlalchemy.orm.events.InstanceEvents.load" title="sqlalchemy.orm.events.InstanceEvents.load"><code class="xref py py-meth docutils literal"><span class="pre">InstanceEvents.load()</span></code></a></span></p></div></dd></dl><dl class="method"><dt id="sqlalchemy.orm.events.InstanceEvents.load"><span class="yiyi-st" id="yiyi-432"> <code class="descname">load</code><span class="sig-paren">(</span><em>target</em>, <em>context</em><span class="sig-paren">)</span><a class="headerlink" href="#sqlalchemy.orm.events.InstanceEvents.load" title="Permalink to this definition">&#xB6;</a></span></dt><dd><p><span class="yiyi-st" id="yiyi-433">&#x901A;&#x8FC7;<code class="docutils literal"><span class="pre">__new__</span></code>&#x521B;&#x5EFA;&#x5BF9;&#x8C61;&#x5B9E;&#x4F8B;&#x540E;&#xFF0C;&#x5E76;&#x5728;&#x521D;&#x59CB;&#x5C5E;&#x6027;&#x586B;&#x5145;&#x53D1;&#x751F;&#x540E;&#x63A5;&#x6536;&#x5BF9;&#x8C61;&#x5B9E;&#x4F8B;&#x3002;</span></p><div class="event-signatures container"><p><span class="yiyi-st" id="yiyi-434">&#x793A;&#x4F8B;&#x53C2;&#x6570;&#x8868;&#x5355;&#xFF1A;</span></p><div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sqlalchemy</span> <span class="kn">import</span> <span class="n">event</span>

<span class="c1"># standard decorator style</span>
<span class="nd">@event.listens_for</span><span class="p">(</span><span class="n">SomeClass</span><span class="p">,</span> <span class="s1">&apos;load&apos;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">receive_load</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="n">context</span><span class="p">):</span>
    <span class="s2">&quot;listen for the &apos;load&apos; event&quot;</span>

    <span class="c1"># ... (event handling logic) ...</span></pre></div></div></div><p><span class="yiyi-st" id="yiyi-435">&#x8FD9;&#x901A;&#x5E38;&#x5728;&#x57FA;&#x4E8E;&#x4F20;&#x5165;&#x7ED3;&#x679C;&#x884C;&#x521B;&#x5EFA;&#x5B9E;&#x4F8B;&#x65F6;&#x53D1;&#x751F;&#xFF0C;&#x5E76;&#x4E14;&#x5728;&#x8BE5;&#x5B9E;&#x4F8B;&#x7684;&#x751F;&#x5B58;&#x671F;&#x4E2D;&#x4EC5;&#x8C03;&#x7528;&#x4E00;&#x6B21;&#x3002;</span></p><p><span class="yiyi-st" id="yiyi-436">&#x8BF7;&#x6CE8;&#x610F;&#xFF0C;&#x5728;&#x7ED3;&#x679C;&#x884C;&#x52A0;&#x8F7D;&#x671F;&#x95F4;&#xFF0C;&#x5728;&#x4E3A;&#x6B64;&#x5B9E;&#x4F8B;&#x63A5;&#x6536;&#x7684;&#x7B2C;&#x4E00;&#x884C;&#x8C03;&#x7528;&#x6B64;&#x65B9;&#x6CD5;&#x3002;</span><span class="yiyi-st" id="yiyi-437">&#x8BF7;&#x6CE8;&#x610F;&#xFF0C;&#x6839;&#x636E;&#x7ED3;&#x679C;&#x884C;&#x4E2D;&#x7684;&#x5185;&#x5BB9;&#xFF0C;&#x67D0;&#x4E9B;&#x5C5E;&#x6027;&#x548C;&#x96C6;&#x5408;&#x53EF;&#x80FD;&#x88AB;&#x52A0;&#x8F7D;&#xFF0C;&#x751A;&#x81F3;&#x53EF;&#x80FD;&#x4E0D;&#x88AB;&#x52A0;&#x8F7D;&#x6216;&#x751A;&#x81F3;&#x88AB;&#x521D;&#x59CB;&#x5316;&#x3002;</span></p><table class="docutils field-list" frame="void" rules="none"><tbody valign="top"><tr class="field-odd field"><th class="field-name"><span class="yiyi-st" id="yiyi-438">&#x53C2;&#x6570;&#xFF1A;</span></th><td class="field-body"><ul class="first last simple"><li><span class="yiyi-st" id="yiyi-439"><span class="target" id="sqlalchemy.orm.events.InstanceEvents.load.params.target"></span> <strong>target</strong> <a class="paramlink headerlink reference internal" href="#sqlalchemy.orm.events.InstanceEvents.load.params.target">&#xB6;</a>  - &#x6620;&#x5C04;&#x7684;&#x5B9E;&#x4F8B;&#x3002;</span><span class="yiyi-st" id="yiyi-440">&#x5982;&#x679C;&#x4E8B;&#x4EF6;&#x914D;&#x7F6E;&#x4E3A;<code class="docutils literal"><span class="pre">raw=True</span></code>&#xFF0C;&#x5219;&#x8FD9;&#x5C06;&#x6539;&#x4E3A;&#x4E0E;&#x8BE5;&#x5B9E;&#x4F8B;&#x5173;&#x8054;&#x7684;<a class="reference internal" href="internals.html#sqlalchemy.orm.state.InstanceState" title="sqlalchemy.orm.state.InstanceState"><code class="xref py py-class docutils literal"><span class="pre">InstanceState</span></code></a>&#x72B6;&#x6001;&#x7BA1;&#x7406;&#x5BF9;&#x8C61;&#x3002;</span></li><li><span class="yiyi-st" id="yiyi-441"><span class="target" id="sqlalchemy.orm.events.InstanceEvents.load.params.context"></span><strong>context</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.orm.events.InstanceEvents.load.params.context">&#xB6;</a> &#x2013; the <a class="reference internal" href="internals.html#sqlalchemy.orm.query.QueryContext" title="sqlalchemy.orm.query.QueryContext"><code class="xref py py-class docutils literal"><span class="pre">QueryContext</span></code></a> corresponding to the current <a class="reference internal" href="query.html#sqlalchemy.orm.query.Query" title="sqlalchemy.orm.query.Query"><code class="xref py py-class docutils literal"><span class="pre">Query</span></code></a> in progress. </span><span class="yiyi-st" id="yiyi-442">&#x4F8B;&#x5982;&#xFF0C;&#x5728;<a class="reference internal" href="session_api.html#sqlalchemy.orm.session.Session.merge" title="sqlalchemy.orm.session.Session.merge"><code class="xref py py-meth docutils literal"><span class="pre">Session.merge()</span></code></a>&#x671F;&#x95F4;&#xFF0C;&#x5982;&#x679C;&#x52A0;&#x8F7D;&#x4E0D;&#x5BF9;&#x5E94;&#x4E8E;<a class="reference internal" href="query.html#sqlalchemy.orm.query.Query" title="sqlalchemy.orm.query.Query"><code class="xref py py-class docutils literal"><span class="pre">Query</span></code></a>&#xFF0C;&#x5219;&#x6B64;&#x53C2;&#x6570;&#x53EF;&#x80FD;&#x4E3A;<code class="docutils literal"><span class="pre">None</span></code>&#x3002;</span></li></ul></td></tr></tbody></table><div class="admonition seealso"><p class="first admonition-title"><span class="yiyi-st" id="yiyi-443">&#x4E5F;&#x53EF;&#x4EE5;&#x770B;&#x770B;</span></p><p><span class="yiyi-st" id="yiyi-444"><a class="reference internal" href="#sqlalchemy.orm.events.InstanceEvents.init" title="sqlalchemy.orm.events.InstanceEvents.init"><code class="xref py py-meth docutils literal"><span class="pre">InstanceEvents.init()</span></code></a></span></p><p><span class="yiyi-st" id="yiyi-445"><a class="reference internal" href="#sqlalchemy.orm.events.InstanceEvents.refresh" title="sqlalchemy.orm.events.InstanceEvents.refresh"><code class="xref py py-meth docutils literal"><span class="pre">InstanceEvents.refresh()</span></code></a></span></p><p class="last"><span class="yiyi-st" id="yiyi-446"><a class="reference internal" href="#sqlalchemy.orm.events.SessionEvents.loaded_as_persistent" title="sqlalchemy.orm.events.SessionEvents.loaded_as_persistent"><code class="xref py py-meth docutils literal"><span class="pre">SessionEvents.loaded_as_persistent()</span></code></a></span></p></div></dd></dl><dl class="method"><dt id="sqlalchemy.orm.events.InstanceEvents.pickle"><span class="yiyi-st" id="yiyi-447"> <code class="descname">pickle</code><span class="sig-paren">(</span><em>target</em>, <em>state_dict</em><span class="sig-paren">)</span><a class="headerlink" href="#sqlalchemy.orm.events.InstanceEvents.pickle" title="Permalink to this definition">&#xB6;</a></span></dt><dd><p><span class="yiyi-st" id="yiyi-448">&#x5728;&#x5176;&#x5173;&#x8054;&#x72B6;&#x6001;&#x6B63;&#x5728;&#x8FDB;&#x884C;&#x9178;&#x6D17;&#x65F6;&#x63A5;&#x6536;&#x5BF9;&#x8C61;&#x5B9E;&#x4F8B;&#x3002;</span></p><div class="event-signatures container"><p><span class="yiyi-st" id="yiyi-449">&#x793A;&#x4F8B;&#x53C2;&#x6570;&#x8868;&#x5355;&#xFF1A;</span></p><div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sqlalchemy</span> <span class="kn">import</span> <span class="n">event</span>

<span class="c1"># standard decorator style</span>
<span class="nd">@event.listens_for</span><span class="p">(</span><span class="n">SomeClass</span><span class="p">,</span> <span class="s1">&apos;pickle&apos;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">receive_pickle</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="n">state_dict</span><span class="p">):</span>
    <span class="s2">&quot;listen for the &apos;pickle&apos; event&quot;</span>

    <span class="c1"># ... (event handling logic) ...</span></pre></div></div></div><table class="docutils field-list" frame="void" rules="none"><tbody valign="top"><tr class="field-odd field"><th class="field-name"><span class="yiyi-st" id="yiyi-450">&#x53C2;&#x6570;&#xFF1A;</span></th><td class="field-body"><ul class="first last simple"><li><span class="yiyi-st" id="yiyi-451"><span class="target" id="sqlalchemy.orm.events.InstanceEvents.pickle.params.target"></span> <strong>target</strong> <a class="paramlink headerlink reference internal" href="#sqlalchemy.orm.events.InstanceEvents.pickle.params.target">&#xB6;</a>  - &#x6620;&#x5C04;&#x7684;&#x5B9E;&#x4F8B;&#x3002;</span><span class="yiyi-st" id="yiyi-452">&#x5982;&#x679C;&#x4E8B;&#x4EF6;&#x914D;&#x7F6E;&#x4E3A;<code class="docutils literal"><span class="pre">raw=True</span></code>&#xFF0C;&#x5219;&#x8FD9;&#x5C06;&#x6539;&#x4E3A;&#x4E0E;&#x8BE5;&#x5B9E;&#x4F8B;&#x5173;&#x8054;&#x7684;<a class="reference internal" href="internals.html#sqlalchemy.orm.state.InstanceState" title="sqlalchemy.orm.state.InstanceState"><code class="xref py py-class docutils literal"><span class="pre">InstanceState</span></code></a>&#x72B6;&#x6001;&#x7BA1;&#x7406;&#x5BF9;&#x8C61;&#x3002;</span></li><li><span class="yiyi-st" id="yiyi-453"><span class="target" id="sqlalchemy.orm.events.InstanceEvents.pickle.params.state_dict"></span><strong>state_dict</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.orm.events.InstanceEvents.pickle.params.state_dict">&#xB6;</a> &#x2013; the dictionary returned by <code class="xref py py-class docutils literal"><span class="pre">InstanceState.__getstate__</span></code>, containing the state to be pickled.</span></li></ul></td></tr></tbody></table></dd></dl><dl class="method"><dt id="sqlalchemy.orm.events.InstanceEvents.refresh"><span class="yiyi-st" id="yiyi-454"> <code class="descname">refresh</code><span class="sig-paren">(</span><em>target</em>, <em>context</em>, <em>attrs</em><span class="sig-paren">)</span><a class="headerlink" href="#sqlalchemy.orm.events.InstanceEvents.refresh" title="Permalink to this definition">&#xB6;</a></span></dt><dd><p><span class="yiyi-st" id="yiyi-455">&#x5728;&#x67E5;&#x8BE2;&#x4E2D;&#x5237;&#x65B0;&#x4E86;&#x4E00;&#x4E2A;&#x6216;&#x591A;&#x4E2A;&#x5C5E;&#x6027;&#x540E;&#x63A5;&#x6536;&#x5BF9;&#x8C61;&#x5B9E;&#x4F8B;&#x3002;</span></p><div class="event-signatures container"><p><span class="yiyi-st" id="yiyi-456">&#x793A;&#x4F8B;&#x53C2;&#x6570;&#x8868;&#x5355;&#xFF1A;</span></p><div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sqlalchemy</span> <span class="kn">import</span> <span class="n">event</span>

<span class="c1"># standard decorator style</span>
<span class="nd">@event.listens_for</span><span class="p">(</span><span class="n">SomeClass</span><span class="p">,</span> <span class="s1">&apos;refresh&apos;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">receive_refresh</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="n">context</span><span class="p">,</span> <span class="n">attrs</span><span class="p">):</span>
    <span class="s2">&quot;listen for the &apos;refresh&apos; event&quot;</span>

    <span class="c1"># ... (event handling logic) ...</span></pre></div></div></div><p><span class="yiyi-st" id="yiyi-457">&#x5C06;&#x5B83;&#x4E0E;<a class="reference internal" href="#sqlalchemy.orm.events.InstanceEvents.load" title="sqlalchemy.orm.events.InstanceEvents.load"><code class="xref py py-meth docutils literal"><span class="pre">InstanceEvents.load()</span></code></a>&#x65B9;&#x6CD5;&#x8FDB;&#x884C;&#x5BF9;&#x6BD4;&#xFF0C;&#x8BE5;&#x65B9;&#x6CD5;&#x5728;&#x9996;&#x6B21;&#x4ECE;&#x67E5;&#x8BE2;&#x52A0;&#x8F7D;&#x5BF9;&#x8C61;&#x65F6;&#x8C03;&#x7528;&#x3002;</span></p><table class="docutils field-list" frame="void" rules="none"><tbody valign="top"><tr class="field-odd field"><th class="field-name"><span class="yiyi-st" id="yiyi-458">&#x53C2;&#x6570;&#xFF1A;</span></th><td class="field-body"><ul class="first last simple"><li><span class="yiyi-st" id="yiyi-459"><span class="target" id="sqlalchemy.orm.events.InstanceEvents.refresh.params.target"></span> <strong>target</strong> <a class="paramlink headerlink reference internal" href="#sqlalchemy.orm.events.InstanceEvents.refresh.params.target">&#xB6;</a>  - &#x6620;&#x5C04;&#x7684;&#x5B9E;&#x4F8B;&#x3002;</span><span class="yiyi-st" id="yiyi-460">&#x5982;&#x679C;&#x4E8B;&#x4EF6;&#x914D;&#x7F6E;&#x4E3A;<code class="docutils literal"><span class="pre">raw=True</span></code>&#xFF0C;&#x5219;&#x8FD9;&#x5C06;&#x6539;&#x4E3A;&#x4E0E;&#x8BE5;&#x5B9E;&#x4F8B;&#x5173;&#x8054;&#x7684;<a class="reference internal" href="internals.html#sqlalchemy.orm.state.InstanceState" title="sqlalchemy.orm.state.InstanceState"><code class="xref py py-class docutils literal"><span class="pre">InstanceState</span></code></a>&#x72B6;&#x6001;&#x7BA1;&#x7406;&#x5BF9;&#x8C61;&#x3002;</span></li><li><span class="yiyi-st" id="yiyi-461"><span class="target" id="sqlalchemy.orm.events.InstanceEvents.refresh.params.context"></span><strong>context</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.orm.events.InstanceEvents.refresh.params.context">&#xB6;</a> &#x2013; the <a class="reference internal" href="internals.html#sqlalchemy.orm.query.QueryContext" title="sqlalchemy.orm.query.QueryContext"><code class="xref py py-class docutils literal"><span class="pre">QueryContext</span></code></a> corresponding to the current <a class="reference internal" href="query.html#sqlalchemy.orm.query.Query" title="sqlalchemy.orm.query.Query"><code class="xref py py-class docutils literal"><span class="pre">Query</span></code></a> in progress.</span></li><li><span class="yiyi-st" id="yiyi-462"><span class="target" id="sqlalchemy.orm.events.InstanceEvents.refresh.params.attrs"></span><strong>attrs</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.orm.events.InstanceEvents.refresh.params.attrs">&#xB6;</a> &#x2013; sequence of attribute names which were populated, or None if all column-mapped, non-deferred attributes were populated.</span></li></ul></td></tr></tbody></table><div class="admonition seealso"><p class="first admonition-title"><span class="yiyi-st" id="yiyi-463">&#x4E5F;&#x53EF;&#x4EE5;&#x770B;&#x770B;</span></p><p class="last"><span class="yiyi-st" id="yiyi-464"><a class="reference internal" href="#sqlalchemy.orm.events.InstanceEvents.load" title="sqlalchemy.orm.events.InstanceEvents.load"><code class="xref py py-meth docutils literal"><span class="pre">InstanceEvents.load()</span></code></a></span></p></div></dd></dl><dl class="method"><dt id="sqlalchemy.orm.events.InstanceEvents.refresh_flush"><span class="yiyi-st" id="yiyi-465"><code class="descname">refresh_flush  tt&gt; <span class="sig-paren">&#xFF08;</span> <em>target</em>&#xFF0C;<em>flush_context</em>&#xFF0C;<em>attrs</em> <span class="sig-paren">&#xFF09;</span> <a class="headerlink" href="#sqlalchemy.orm.events.InstanceEvents.refresh_flush" title="Permalink to this definition">&#xB6; T6&gt;</a></code></span></dt><dd><p><span class="yiyi-st" id="yiyi-466">&#x5728;&#x5BF9;&#x8C61;&#x7684;&#x6301;&#x4E45;&#x6027;&#x5185;&#x5237;&#x65B0;&#x4E00;&#x4E2A;&#x6216;&#x591A;&#x4E2A;&#x5C5E;&#x6027;&#x540E;&#x63A5;&#x6536;&#x5BF9;&#x8C61;&#x5B9E;&#x4F8B;&#x3002;</span></p><div class="event-signatures container"><p><span class="yiyi-st" id="yiyi-467">&#x793A;&#x4F8B;&#x53C2;&#x6570;&#x8868;&#x5355;&#xFF1A;</span></p><div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sqlalchemy</span> <span class="kn">import</span> <span class="n">event</span>

<span class="c1"># standard decorator style</span>
<span class="nd">@event.listens_for</span><span class="p">(</span><span class="n">SomeClass</span><span class="p">,</span> <span class="s1">&apos;refresh_flush&apos;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">receive_refresh_flush</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="n">flush_context</span><span class="p">,</span> <span class="n">attrs</span><span class="p">):</span>
    <span class="s2">&quot;listen for the &apos;refresh_flush&apos; event&quot;</span>

    <span class="c1"># ... (event handling logic) ...</span></pre></div></div></div><p><span class="yiyi-st" id="yiyi-468">&#x8FD9;&#x4E2A;&#x4E8B;&#x4EF6;&#x4E0E;<a class="reference internal" href="#sqlalchemy.orm.events.InstanceEvents.refresh" title="sqlalchemy.orm.events.InstanceEvents.refresh"><code class="xref py py-meth docutils literal"><span class="pre">InstanceEvents.refresh()</span></code></a>&#x76F8;&#x540C;&#xFF0C;&#x9664;&#x4E86;&#x5B83;&#x5728;&#x5DE5;&#x4F5C;&#x5355;&#x5143;flush&#x8FC7;&#x7A0B;&#x4E2D;&#x8C03;&#x7528;&#xFF0C;&#x5E76;&#x4E14;&#x8FD9;&#x91CC;&#x7684;&#x503C;&#x901A;&#x5E38;&#x6765;&#x81EA;&#x5904;&#x7406;INSERT&#x6216;UPDATE&#x7684;&#x8FC7;&#x7A0B;&#xFF0C;&#x4F8B;&#x5982;&#x901A;&#x8FC7;RETURNING&#x5B50;&#x53E5;&#x6216;&#x4ECE;Python&#x65B9;&#x9762;&#x7684;&#x9ED8;&#x8BA4;&#x503C;&#x3002;</span></p><div class="versionadded"><p><span class="yiyi-st" id="yiyi-469"><span class="versionmodified">&#x7248;&#x672C;1.0.5&#x4E2D;&#x7684;&#x65B0;&#x529F;&#x80FD;</span></span></p></div><table class="docutils field-list" frame="void" rules="none"><tbody valign="top"><tr class="field-odd field"><th class="field-name"><span class="yiyi-st" id="yiyi-470">&#x53C2;&#x6570;&#xFF1A;</span></th><td class="field-body"><ul class="first last simple"><li><span class="yiyi-st" id="yiyi-471"><span class="target" id="sqlalchemy.orm.events.InstanceEvents.refresh_flush.params.target"></span> <strong>target</strong> <a class="paramlink headerlink reference internal" href="#sqlalchemy.orm.events.InstanceEvents.refresh_flush.params.target">&#xB6;</a>  - &#x6620;&#x5C04;&#x7684;&#x5B9E;&#x4F8B;&#x3002;</span><span class="yiyi-st" id="yiyi-472">&#x5982;&#x679C;&#x4E8B;&#x4EF6;&#x914D;&#x7F6E;&#x4E3A;<code class="docutils literal"><span class="pre">raw=True</span></code>&#xFF0C;&#x5219;&#x8FD9;&#x5C06;&#x6539;&#x4E3A;&#x4E0E;&#x8BE5;&#x5B9E;&#x4F8B;&#x5173;&#x8054;&#x7684;<a class="reference internal" href="internals.html#sqlalchemy.orm.state.InstanceState" title="sqlalchemy.orm.state.InstanceState"><code class="xref py py-class docutils literal"><span class="pre">InstanceState</span></code></a>&#x72B6;&#x6001;&#x7BA1;&#x7406;&#x5BF9;&#x8C61;&#x3002;</span></li><li><span class="yiyi-st" id="yiyi-473"><span class="target" id="sqlalchemy.orm.events.InstanceEvents.refresh_flush.params.flush_context"></span><strong>flush_context</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.orm.events.InstanceEvents.refresh_flush.params.flush_context">&#xB6;</a> &#x2013; Internal <a class="reference internal" href="internals.html#sqlalchemy.orm.session.UOWTransaction" title="sqlalchemy.orm.session.UOWTransaction"><code class="xref py py-class docutils literal"><span class="pre">UOWTransaction</span></code></a> object which handles the details of the flush.</span></li><li><span class="yiyi-st" id="yiyi-474"><span class="target" id="sqlalchemy.orm.events.InstanceEvents.refresh_flush.params.attrs"></span><strong>attrs</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.orm.events.InstanceEvents.refresh_flush.params.attrs">&#xB6;</a> &#x2013; sequence of attribute names which were populated.</span></li></ul></td></tr></tbody></table></dd></dl><dl class="method"><dt id="sqlalchemy.orm.events.InstanceEvents.unpickle"><span class="yiyi-st" id="yiyi-475"><code class="descname">unpickle</code> <span class="sig-paren">&#xFF08;</span> <em>target</em>&#xFF0C;<em>state_dict</em> <span class="sig-paren">&#xFF09;</span> <a class="headerlink" href="#sqlalchemy.orm.events.InstanceEvents.unpickle" title="Permalink to this definition">&#xB6;</a></span></dt><dd><p><span class="yiyi-st" id="yiyi-476">&#x5728;&#x5176;&#x5173;&#x8054;&#x72B6;&#x6001;&#x5DF2;&#x53D6;&#x6D88;&#x4E4B;&#x540E;&#x63A5;&#x6536;&#x5BF9;&#x8C61;&#x5B9E;&#x4F8B;&#x3002;</span></p><div class="event-signatures container"><p><span class="yiyi-st" id="yiyi-477">&#x793A;&#x4F8B;&#x53C2;&#x6570;&#x8868;&#x5355;&#xFF1A;</span></p><div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sqlalchemy</span> <span class="kn">import</span> <span class="n">event</span>

<span class="c1"># standard decorator style</span>
<span class="nd">@event.listens_for</span><span class="p">(</span><span class="n">SomeClass</span><span class="p">,</span> <span class="s1">&apos;unpickle&apos;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">receive_unpickle</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="n">state_dict</span><span class="p">):</span>
    <span class="s2">&quot;listen for the &apos;unpickle&apos; event&quot;</span>

    <span class="c1"># ... (event handling logic) ...</span></pre></div></div></div><table class="docutils field-list" frame="void" rules="none"><tbody valign="top"><tr class="field-odd field"><th class="field-name"><span class="yiyi-st" id="yiyi-478">&#x53C2;&#x6570;&#xFF1A;</span></th><td class="field-body"><ul class="first last simple"><li><span class="yiyi-st" id="yiyi-479"><span class="target" id="sqlalchemy.orm.events.InstanceEvents.unpickle.params.target"></span> <strong>target</strong> <a class="paramlink headerlink reference internal" href="#sqlalchemy.orm.events.InstanceEvents.unpickle.params.target">&#xB6;</a>  - &#x6620;&#x5C04;&#x7684;&#x5B9E;&#x4F8B;&#x3002;</span><span class="yiyi-st" id="yiyi-480">&#x5982;&#x679C;&#x4E8B;&#x4EF6;&#x914D;&#x7F6E;&#x4E3A;<code class="docutils literal"><span class="pre">raw=True</span></code>&#xFF0C;&#x5219;&#x8FD9;&#x5C06;&#x6539;&#x4E3A;&#x4E0E;&#x8BE5;&#x5B9E;&#x4F8B;&#x5173;&#x8054;&#x7684;<a class="reference internal" href="internals.html#sqlalchemy.orm.state.InstanceState" title="sqlalchemy.orm.state.InstanceState"><code class="xref py py-class docutils literal"><span class="pre">InstanceState</span></code></a>&#x72B6;&#x6001;&#x7BA1;&#x7406;&#x5BF9;&#x8C61;&#x3002;</span></li><li><span class="yiyi-st" id="yiyi-481"><span class="target" id="sqlalchemy.orm.events.InstanceEvents.unpickle.params.state_dict"></span><strong>state_dict</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.orm.events.InstanceEvents.unpickle.params.state_dict">&#xB6;</a> &#x2013; the dictionary sent to <code class="xref py py-class docutils literal"><span class="pre">InstanceState.__setstate__</span></code>, containing the state dictionary which was pickled.</span></li></ul></td></tr></tbody></table></dd></dl></dd></dl></div><div class="section" id="session-events"><h2><span class="yiyi-st" id="yiyi-482">&#x4F1A;&#x8BDD;&#x4E8B;&#x4EF6;<a class="headerlink" href="#session-events" title="Permalink to this headline">&#xB6;</a></span></h2><dl class="class"><dt id="sqlalchemy.orm.events.SessionEvents"><span class="yiyi-st" id="yiyi-483"><em class="property">class</em> <code class="descclassname">sqlalchemy.orm.events&#x3002;</code> <code class="descname">SessionEvents</code> <a class="headerlink" href="#sqlalchemy.orm.events.SessionEvents" title="Permalink to this definition">&#xB6;</a></span></dt><dd><p><span class="yiyi-st" id="yiyi-484">&#x57FA;&#x7840;&#xFF1A;<a class="reference internal" href="core_events.html#sqlalchemy.event.base.Events" title="sqlalchemy.event.base.Events"><code class="xref py py-class docutils literal"><span class="pre">sqlalchemy.event.base.Events</span></code></a></span></p><p><span class="yiyi-st" id="yiyi-485">&#x5B9A;&#x4E49;&#x7279;&#x5B9A;&#x4E8E;<a class="reference internal" href="session_api.html#sqlalchemy.orm.session.Session" title="sqlalchemy.orm.session.Session"><code class="xref py py-class docutils literal"><span class="pre">Session</span></code></a>&#x751F;&#x547D;&#x5468;&#x671F;&#x7684;&#x4E8B;&#x4EF6;&#x3002;</span></p><p><span class="yiyi-st" id="yiyi-486">&#x4F8B;&#x5982;&#x3002;&#xFF1A;</span></p><div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sqlalchemy</span> <span class="kn">import</span> <span class="n">event</span>
<span class="kn">from</span> <span class="nn">sqlalchemy.orm</span> <span class="kn">import</span> <span class="n">sessionmaker</span>

<span class="k">def</span> <span class="nf">my_before_commit</span><span class="p">(</span><span class="n">session</span><span class="p">):</span>
    <span class="k">print</span> <span class="s2">&quot;before commit!&quot;</span>

<span class="n">Session</span> <span class="o">=</span> <span class="n">sessionmaker</span><span class="p">()</span>

<span class="n">event</span><span class="o">.</span><span class="n">listen</span><span class="p">(</span><span class="n">Session</span><span class="p">,</span> <span class="s2">&quot;before_commit&quot;</span><span class="p">,</span> <span class="n">my_before_commit</span><span class="p">)</span></pre></div></div><p><span class="yiyi-st" id="yiyi-487"><a class="reference internal" href="core_event.html#sqlalchemy.event.listen" title="sqlalchemy.event.listen"><code class="xref py py-func docutils literal"><span class="pre">listen()</span></code></a>&#x51FD;&#x6570;&#x5C06;&#x63A5;&#x53D7;<a class="reference internal" href="session_api.html#sqlalchemy.orm.session.Session" title="sqlalchemy.orm.session.Session"><code class="xref py py-class docutils literal"><span class="pre">Session</span></code></a>&#x5BF9;&#x8C61;&#x4EE5;&#x53CA;<a class="reference internal" href="session_api.html#sqlalchemy.orm.session.sessionmaker" title="sqlalchemy.orm.session.sessionmaker"><code class="xref py py-class docutils literal"><span class="pre">sessionmaker()</span></code></a>&#x548C;<a class="reference internal" href="contextual.html#sqlalchemy.orm.scoping.scoped_session" title="sqlalchemy.orm.scoping.scoped_session"><code class="xref py py-class docutils literal"><span class="pre">scoped_session()</span></code></a></span></p><p><span class="yiyi-st" id="yiyi-488">&#x6B64;&#x5916;&#xFF0C;&#x5B83;&#x8FD8;&#x63A5;&#x53D7;<a class="reference internal" href="session_api.html#sqlalchemy.orm.session.Session" title="sqlalchemy.orm.session.Session"><code class="xref py py-class docutils literal"><span class="pre">Session</span></code></a>&#x7C7B;&#xFF0C;&#x5B83;&#x5C06;&#x4FA6;&#x542C;&#x5668;&#x5168;&#x5C40;&#x5E94;&#x7528;&#x4E8E;&#x6240;&#x6709;<a class="reference internal" href="session_api.html#sqlalchemy.orm.session.Session" title="sqlalchemy.orm.session.Session"><code class="xref py py-class docutils literal"><span class="pre">Session</span></code></a>&#x5B9E;&#x4F8B;&#x3002;</span></p><dl class="method"><dt id="sqlalchemy.orm.events.SessionEvents.after_attach"><span class="yiyi-st" id="yiyi-489"><code class="descname">after_attach</code> <span class="sig-paren">&#xFF08;</span> <em>session</em>&#xFF0C;<em>instance</em> <span class="sig-paren">&#xFF09;</span> <a class="headerlink" href="#sqlalchemy.orm.events.SessionEvents.after_attach" title="Permalink to this definition">&#xB6;</a></span></dt><dd><p><span class="yiyi-st" id="yiyi-490">&#x5728;&#x5B9E;&#x4F8B;&#x8FDE;&#x63A5;&#x5230;&#x4F1A;&#x8BDD;&#x540E;&#x6267;&#x884C;&#x3002;</span></p><div class="event-signatures container"><p><span class="yiyi-st" id="yiyi-491">&#x793A;&#x4F8B;&#x53C2;&#x6570;&#x8868;&#x5355;&#xFF1A;</span></p><div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sqlalchemy</span> <span class="kn">import</span> <span class="n">event</span>

<span class="c1"># standard decorator style</span>
<span class="nd">@event.listens_for</span><span class="p">(</span><span class="n">SomeSessionOrFactory</span><span class="p">,</span> <span class="s1">&apos;after_attach&apos;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">receive_after_attach</span><span class="p">(</span><span class="n">session</span><span class="p">,</span> <span class="n">instance</span><span class="p">):</span>
    <span class="s2">&quot;listen for the &apos;after_attach&apos; event&quot;</span>

    <span class="c1"># ... (event handling logic) ...</span></pre></div></div></div><p><span class="yiyi-st" id="yiyi-492">&#x8FD9;&#x662F;&#x5728;&#x6DFB;&#x52A0;&#xFF0C;&#x5220;&#x9664;&#x6216;&#x5408;&#x5E76;&#x4E4B;&#x540E;&#x8C03;&#x7528;&#x7684;&#x3002;</span></p><div class="admonition note"><p class="first admonition-title"><span class="yiyi-st" id="yiyi-493">&#x6CE8;&#x610F;</span></p><p class="last"><span class="yiyi-st" id="yiyi-494">&#x4ECE;0.8&#x5F00;&#x59CB;&#xFF0C;&#x6B64;&#x4E8B;&#x4EF6;&#x5728;&#x9879;&#x76EE;&#x4E0E;&#x4F1A;&#x8BDD;&#x5B8C;&#x5168;&#x5173;&#x8054;&#x4E4B;&#x540E;&#x89E6;&#x53D1;<em>&#xFF0C;&#x8FD9;&#x4E0E;&#x4EE5;&#x524D;&#x7684;&#x7248;&#x672C;&#x4E0D;&#x540C;&#x3002;</em></span><span class="yiyi-st" id="yiyi-495">&#x5BF9;&#x4E8E;&#x9700;&#x8981;&#x5BF9;&#x8C61;&#x5C1A;&#x672A;&#x6210;&#x4E3A;&#x4F1A;&#x8BDD;&#x72B6;&#x6001;&#x4E00;&#x90E8;&#x5206;&#x7684;&#x4E8B;&#x4EF6;&#x5904;&#x7406;&#x7A0B;&#x5E8F;&#xFF08;&#x4F8B;&#x5982;&#x53EF;&#x80FD;&#x5728;&#x76EE;&#x6807;&#x5BF9;&#x8C61;&#x5C1A;&#x672A;&#x5B8C;&#x6210;&#x65F6;&#x81EA;&#x52A8;&#x5237;&#x65B0;&#x7684;&#x5904;&#x7406;&#x7A0B;&#x5E8F;&#xFF09;&#xFF0C;&#x8BF7;&#x8003;&#x8651;&#x65B0;&#x7684;<a class="reference internal" href="#sqlalchemy.orm.events.SessionEvents.before_attach" title="sqlalchemy.orm.events.SessionEvents.before_attach"><code class="xref py py-meth docutils literal"><span class="pre">before_attach()</span></code></a>&#x4E8B;&#x4EF6;&#x3002;</span></p></div><div class="admonition seealso"><p class="first admonition-title"><span class="yiyi-st" id="yiyi-496">&#x4E5F;&#x53EF;&#x4EE5;&#x770B;&#x770B;</span></p><p><span class="yiyi-st" id="yiyi-497"><a class="reference internal" href="#sqlalchemy.orm.events.SessionEvents.before_attach" title="sqlalchemy.orm.events.SessionEvents.before_attach"><code class="xref py py-meth docutils literal"><span class="pre">before_attach()</span></code></a></span></p><p class="last"><span class="yiyi-st" id="yiyi-498"><a class="reference internal" href="session_events.html#session-lifecycle-events"><span>Object Lifecycle Events</span></a></span></p></div></dd></dl><dl class="method"><dt id="sqlalchemy.orm.events.SessionEvents.after_begin"><span class="yiyi-st" id="yiyi-499"> <code class="descname">after_begin</code><span class="sig-paren">(</span><em>session</em>, <em>transaction</em>, <em>connection</em><span class="sig-paren">)</span><a class="headerlink" href="#sqlalchemy.orm.events.SessionEvents.after_begin" title="Permalink to this definition">&#xB6;</a></span></dt><dd><p><span class="yiyi-st" id="yiyi-500">&#x5728;&#x8FDE;&#x63A5;&#x5F00;&#x59CB;&#x4E8B;&#x52A1;&#x540E;&#x6267;&#x884C;</span></p><div class="event-signatures container"><p><span class="yiyi-st" id="yiyi-501">&#x793A;&#x4F8B;&#x53C2;&#x6570;&#x8868;&#x5355;&#xFF1A;</span></p><div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sqlalchemy</span> <span class="kn">import</span> <span class="n">event</span>

<span class="c1"># standard decorator style</span>
<span class="nd">@event.listens_for</span><span class="p">(</span><span class="n">SomeSessionOrFactory</span><span class="p">,</span> <span class="s1">&apos;after_begin&apos;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">receive_after_begin</span><span class="p">(</span><span class="n">session</span><span class="p">,</span> <span class="n">transaction</span><span class="p">,</span> <span class="n">connection</span><span class="p">):</span>
    <span class="s2">&quot;listen for the &apos;after_begin&apos; event&quot;</span>

    <span class="c1"># ... (event handling logic) ...</span></pre></div></div></div><table class="docutils field-list" frame="void" rules="none"><tbody valign="top"><tr class="field-odd field"><th class="field-name"><span class="yiyi-st" id="yiyi-502">&#x53C2;&#x6570;&#xFF1A;</span></th><td class="field-body"><ul class="first last simple"><li><span class="yiyi-st" id="yiyi-503"><span class="target" id="sqlalchemy.orm.events.SessionEvents.after_begin.params.session"> tt&gt; <strong>&#x4F1A;&#x8BDD;</strong> <a class="paramlink headerlink reference internal" href="#sqlalchemy.orm.events.SessionEvents.after_begin.params.session">&#xB6;</a>  - &#x76EE;&#x6807;<a class="reference internal" href="session_api.html#sqlalchemy.orm.session.Session" title="sqlalchemy.orm.session.Session"><code class="xref py py-class docutils literal"><span class="pre">Session</span></code></a>&#x3002;</span></span></li><li><span class="yiyi-st" id="yiyi-504"><span class="target" id="sqlalchemy.orm.events.SessionEvents.after_begin.params.transaction"></span><strong>transaction</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.orm.events.SessionEvents.after_begin.params.transaction">&#xB6;</a> &#x2013; The <a class="reference internal" href="session_api.html#sqlalchemy.orm.session.SessionTransaction" title="sqlalchemy.orm.session.SessionTransaction"><code class="xref py py-class docutils literal"><span class="pre">SessionTransaction</span></code></a>.</span></li><li><span class="yiyi-st" id="yiyi-505"><span class="target" id="sqlalchemy.orm.events.SessionEvents.after_begin.params.connection"></span><strong>connection</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.orm.events.SessionEvents.after_begin.params.connection">&#xB6;</a> &#x2013; The <a class="reference internal" href="core_connections.html#sqlalchemy.engine.Connection" title="sqlalchemy.engine.Connection"><code class="xref py py-class docutils literal"><span class="pre">Connection</span></code></a> object which will be used for SQL statements.</span></li></ul></td></tr></tbody></table><div class="admonition seealso"><p class="first admonition-title"><span class="yiyi-st" id="yiyi-506">&#x4E5F;&#x53EF;&#x4EE5;&#x770B;&#x770B;</span></p><p><span class="yiyi-st" id="yiyi-507"><a class="reference internal" href="#sqlalchemy.orm.events.SessionEvents.before_commit" title="sqlalchemy.orm.events.SessionEvents.before_commit"><code class="xref py py-meth docutils literal"><span class="pre">before_commit()</span></code></a></span></p><p><span class="yiyi-st" id="yiyi-508"><a class="reference internal" href="#sqlalchemy.orm.events.SessionEvents.after_commit" title="sqlalchemy.orm.events.SessionEvents.after_commit"><code class="xref py py-meth docutils literal"><span class="pre">after_commit()</span></code></a></span></p><p><span class="yiyi-st" id="yiyi-509"><a class="reference internal" href="#sqlalchemy.orm.events.SessionEvents.after_transaction_create" title="sqlalchemy.orm.events.SessionEvents.after_transaction_create"><code class="xref py py-meth docutils literal"><span class="pre">after_transaction_create()</span></code></a></span></p><p class="last"><span class="yiyi-st" id="yiyi-510"><a class="reference internal" href="#sqlalchemy.orm.events.SessionEvents.after_transaction_end" title="sqlalchemy.orm.events.SessionEvents.after_transaction_end"><code class="xref py py-meth docutils literal"><span class="pre">after_transaction_end()</span></code></a></span></p></div></dd></dl><dl class="method"><dt id="sqlalchemy.orm.events.SessionEvents.after_bulk_delete"><span class="yiyi-st" id="yiyi-511"><code class="descname"> after_bulk_delete  T0&gt; <span class="sig-paren">&#xFF08; T1&gt; <em> delete_context  T2&gt; <span class="sig-paren">&#xFF09; T3&gt; <a class="headerlink" href="#sqlalchemy.orm.events.SessionEvents.after_bulk_delete" title="Permalink to this definition">&#xB6; T4&gt;</a></span></em></span></code></span></dt><dd><p><span class="yiyi-st" id="yiyi-512">&#x5BF9;&#x4F1A;&#x8BDD;&#x8FDB;&#x884C;&#x6279;&#x91CF;&#x5220;&#x9664;&#x64CD;&#x4F5C;&#x540E;&#x6267;&#x884C;&#x3002;</span></p><div class="event-signatures container"><p><span class="yiyi-st" id="yiyi-513">&#x793A;&#x4F8B;&#x53C2;&#x6570;&#x8868;&#x5355;&#xFF1A;</span></p><div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sqlalchemy</span> <span class="kn">import</span> <span class="n">event</span>

<span class="c1"># standard decorator style (arguments as of 0.9)</span>
<span class="nd">@event.listens_for</span><span class="p">(</span><span class="n">SomeSessionOrFactory</span><span class="p">,</span> <span class="s1">&apos;after_bulk_delete&apos;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">receive_after_bulk_delete</span><span class="p">(</span><span class="n">delete_context</span><span class="p">):</span>
    <span class="s2">&quot;listen for the &apos;after_bulk_delete&apos; event&quot;</span>

    <span class="c1"># ... (event handling logic) ...</span>

<span class="c1"># legacy calling style (pre-0.9)</span>
<span class="nd">@event.listens_for</span><span class="p">(</span><span class="n">SomeSessionOrFactory</span><span class="p">,</span> <span class="s1">&apos;after_bulk_delete&apos;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">receive_after_bulk_delete</span><span class="p">(</span><span class="n">session</span><span class="p">,</span> <span class="n">query</span><span class="p">,</span> <span class="n">query_context</span><span class="p">,</span> <span class="n">result</span><span class="p">):</span>
    <span class="s2">&quot;listen for the &apos;after_bulk_delete&apos; event&quot;</span>

    <span class="c1"># ... (event handling logic) ...</span></pre></div></div></div><div class="versionchanged"><p><span class="yiyi-st" id="yiyi-514"><span class="versionmodified">&#x7248;&#x672C;0.9&#x5DF2;&#x66F4;&#x6539;&#xFF1A;</span> <code class="docutils literal"><span class="pre">after_bulk_delete</span></code>&#x4E8B;&#x4EF6;&#x73B0;&#x5728;&#x63A5;&#x53D7;&#x53C2;&#x6570;<code class="docutils literal"><span class="pre">delete_context</span></code>&#x3002;</span><span class="yiyi-st" id="yiyi-515">&#x63A5;&#x53D7;&#x4E0A;&#x9762;&#x5217;&#x51FA;&#x7684;&#x5148;&#x524D;&#x53C2;&#x6570;&#x7B7E;&#x540D;&#x7684;&#x542C;&#x4F17;&#x51FD;&#x6570;&#x5C06;&#x81EA;&#x52A8;&#x9002;&#x5E94;&#x65B0;&#x7B7E;&#x540D;&#x3002;</span></p></div><p><span class="yiyi-st" id="yiyi-516">&#x8FD9;&#x88AB;&#x79F0;&#x4E3A;<a class="reference internal" href="query.html#sqlalchemy.orm.query.Query.delete" title="sqlalchemy.orm.query.Query.delete"><code class="xref py py-meth docutils literal"><span class="pre">Query.delete()</span></code></a>&#x65B9;&#x6CD5;&#x7684;&#x7ED3;&#x679C;&#x3002;</span></p><table class="docutils field-list" frame="void" rules="none"><tbody valign="top"><tr class="field-odd field"><th class="field-name"><span class="yiyi-st" id="yiyi-517">&#x53C2;&#x6570;&#xFF1A;</span></th><td class="field-body"><span class="yiyi-st" id="yiyi-523"><span class="target" id="sqlalchemy.orm.events.SessionEvents.after_bulk_delete.params.delete_context"></span> <strong>delete_context</strong> <a class="paramlink headerlink reference internal" href="#sqlalchemy.orm.events.SessionEvents.after_bulk_delete.params.delete_context">&#xB6;</a>  - </span><p><span class="yiyi-st" id="yiyi-518">&#x4E00;&#x4E2A;&#x201C;&#x5220;&#x9664;&#x4E0A;&#x4E0B;&#x6587;&#x201D;&#x5BF9;&#x8C61;&#xFF0C;&#x5176;&#x4E2D;&#x5305;&#x542B;&#x6709;&#x5173;&#x66F4;&#x65B0;&#x7684;&#x8BE6;&#x7EC6;&#x4FE1;&#x606F;&#xFF0C;&#x5305;&#x62EC;&#x8FD9;&#x4E9B;&#x5C5E;&#x6027;&#xFF1A;</span></p><blockquote><div><ul class="simple"><li><span class="yiyi-st" id="yiyi-519"><code class="docutils literal"><span class="pre">session</span></code>  - &#x6D89;&#x53CA;<a class="reference internal" href="session_api.html#sqlalchemy.orm.session.Session" title="sqlalchemy.orm.session.Session"><code class="xref py py-class docutils literal"><span class="pre">Session</span></code></a></span></li><li><span class="yiyi-st" id="yiyi-520"><code class="docutils literal"><span class="pre">query</span></code>  -  <a class="reference internal" href="query.html#sqlalchemy.orm.query.Query" title="sqlalchemy.orm.query.Query"><code class="xref py py-class docutils literal"><span class="pre">Query</span></code></a>&#x5BF9;&#x8C61;&#x662F;&#x5426;&#x8C03;&#x7528;&#x4E86;&#x6B64;&#x66F4;&#x65B0;&#x64CD;&#x4F5C;&#x3002;</span></li><li><span class="yiyi-st" id="yiyi-521"><code class="docutils literal"><span class="pre">context</span></code> <a class="reference internal" href="internals.html#sqlalchemy.orm.query.QueryContext" title="sqlalchemy.orm.query.QueryContext"><code class="xref py py-class docutils literal"><span class="pre">QueryContext</span></code></a>&#x5BF9;&#x8C61;&#xFF0C;&#x5BF9;&#x5E94;&#x4E8E;&#x8C03;&#x7528;ORM&#x67E5;&#x8BE2;&#x3002;</span></li><li><span class="yiyi-st" id="yiyi-522"><code class="docutils literal"><span class="pre">result</span></code> the <a class="reference internal" href="core_connections.html#sqlalchemy.engine.ResultProxy" title="sqlalchemy.engine.ResultProxy"><code class="xref py py-class docutils literal"><span class="pre">ResultProxy</span></code></a> returned as a result of the bulk DELETE operation.</span></li></ul></div></blockquote></td></tr></tbody></table></dd></dl><dl class="method"><dt id="sqlalchemy.orm.events.SessionEvents.after_bulk_update"><span class="yiyi-st" id="yiyi-524"><code class="descname"> after_bulk_update  T0&gt; <span class="sig-paren">&#xFF08; T1&gt; <em> update_context  T2&gt; <span class="sig-paren">&#xFF09; T3&gt; <a class="headerlink" href="#sqlalchemy.orm.events.SessionEvents.after_bulk_update" title="Permalink to this definition">&#xB6; T4&gt;</a></span></em></span></code></span></dt><dd><p><span class="yiyi-st" id="yiyi-525">&#x5728;&#x6279;&#x91CF;&#x66F4;&#x65B0;&#x64CD;&#x4F5C;&#x540E;&#x6267;&#x884C;&#x4F1A;&#x8BDD;&#x3002;</span></p><div class="event-signatures container"><p><span class="yiyi-st" id="yiyi-526">&#x793A;&#x4F8B;&#x53C2;&#x6570;&#x8868;&#x5355;&#xFF1A;</span></p><div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sqlalchemy</span> <span class="kn">import</span> <span class="n">event</span>

<span class="c1"># standard decorator style (arguments as of 0.9)</span>
<span class="nd">@event.listens_for</span><span class="p">(</span><span class="n">SomeSessionOrFactory</span><span class="p">,</span> <span class="s1">&apos;after_bulk_update&apos;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">receive_after_bulk_update</span><span class="p">(</span><span class="n">update_context</span><span class="p">):</span>
    <span class="s2">&quot;listen for the &apos;after_bulk_update&apos; event&quot;</span>

    <span class="c1"># ... (event handling logic) ...</span>

<span class="c1"># legacy calling style (pre-0.9)</span>
<span class="nd">@event.listens_for</span><span class="p">(</span><span class="n">SomeSessionOrFactory</span><span class="p">,</span> <span class="s1">&apos;after_bulk_update&apos;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">receive_after_bulk_update</span><span class="p">(</span><span class="n">session</span><span class="p">,</span> <span class="n">query</span><span class="p">,</span> <span class="n">query_context</span><span class="p">,</span> <span class="n">result</span><span class="p">):</span>
    <span class="s2">&quot;listen for the &apos;after_bulk_update&apos; event&quot;</span>

    <span class="c1"># ... (event handling logic) ...</span></pre></div></div></div><div class="versionchanged"><p><span class="yiyi-st" id="yiyi-527"><span class="versionmodified">&#x7248;&#x672C;0.9&#x5DF2;&#x66F4;&#x6539;&#xFF1A;</span> <code class="docutils literal"><span class="pre">after_bulk_update</span></code>&#x73B0;&#x5728;&#x63A5;&#x53D7;&#x53C2;&#x6570;<code class="docutils literal"><span class="pre">update_context</span></code>&#x3002;</span><span class="yiyi-st" id="yiyi-528">&#x63A5;&#x53D7;&#x4E0A;&#x9762;&#x5217;&#x51FA;&#x7684;&#x5148;&#x524D;&#x53C2;&#x6570;&#x7B7E;&#x540D;&#x7684;&#x542C;&#x4F17;&#x51FD;&#x6570;&#x5C06;&#x81EA;&#x52A8;&#x9002;&#x5E94;&#x65B0;&#x7B7E;&#x540D;&#x3002;</span></p></div><p><span class="yiyi-st" id="yiyi-529">&#x8FD9;&#x88AB;&#x79F0;&#x4E3A;<a class="reference internal" href="query.html#sqlalchemy.orm.query.Query.update" title="sqlalchemy.orm.query.Query.update"><code class="xref py py-meth docutils literal"><span class="pre">Query.update()</span></code></a>&#x65B9;&#x6CD5;&#x7684;&#x7ED3;&#x679C;&#x3002;</span></p><table class="docutils field-list" frame="void" rules="none"><tbody valign="top"><tr class="field-odd field"><th class="field-name"><span class="yiyi-st" id="yiyi-530">&#x53C2;&#x6570;&#xFF1A;</span></th><td class="field-body"><span class="yiyi-st" id="yiyi-536"><span class="target" id="sqlalchemy.orm.events.SessionEvents.after_bulk_update.params.update_context"></span> <strong>update_context</strong> <a class="paramlink headerlink reference internal" href="#sqlalchemy.orm.events.SessionEvents.after_bulk_update.params.update_context">&#xB6;</a>  - </span><p><span class="yiyi-st" id="yiyi-531">&#x4E00;&#x4E2A;&#x201C;&#x66F4;&#x65B0;&#x4E0A;&#x4E0B;&#x6587;&#x201D;&#x5BF9;&#x8C61;&#xFF0C;&#x5176;&#x4E2D;&#x5305;&#x542B;&#x6709;&#x5173;&#x66F4;&#x65B0;&#x7684;&#x8BE6;&#x7EC6;&#x4FE1;&#x606F;&#xFF0C;&#x5305;&#x62EC;&#x8FD9;&#x4E9B;&#x5C5E;&#x6027;&#xFF1A;</span></p><blockquote><div><ul class="simple"><li><span class="yiyi-st" id="yiyi-532"><code class="docutils literal"><span class="pre">session</span></code>  - &#x6D89;&#x53CA;<a class="reference internal" href="session_api.html#sqlalchemy.orm.session.Session" title="sqlalchemy.orm.session.Session"><code class="xref py py-class docutils literal"><span class="pre">Session</span></code></a></span></li><li><span class="yiyi-st" id="yiyi-533"><code class="docutils literal"><span class="pre">query</span></code>  -  <a class="reference internal" href="query.html#sqlalchemy.orm.query.Query" title="sqlalchemy.orm.query.Query"><code class="xref py py-class docutils literal"><span class="pre">Query</span></code></a>&#x5BF9;&#x8C61;&#x662F;&#x5426;&#x8C03;&#x7528;&#x4E86;&#x6B64;&#x66F4;&#x65B0;&#x64CD;&#x4F5C;&#x3002;</span></li><li><span class="yiyi-st" id="yiyi-534"><code class="docutils literal"><span class="pre">context</span></code> <a class="reference internal" href="internals.html#sqlalchemy.orm.query.QueryContext" title="sqlalchemy.orm.query.QueryContext"><code class="xref py py-class docutils literal"><span class="pre">QueryContext</span></code></a>&#x5BF9;&#x8C61;&#xFF0C;&#x5BF9;&#x5E94;&#x4E8E;&#x8C03;&#x7528;ORM&#x67E5;&#x8BE2;&#x3002;</span></li><li><span class="yiyi-st" id="yiyi-535"><code class="docutils literal"><span class="pre">result</span></code>&#x7531;&#x4E8E;&#x6279;&#x91CF;UPDATE&#x64CD;&#x4F5C;&#x8FD4;&#x56DE;&#x7684;<a class="reference internal" href="core_connections.html#sqlalchemy.engine.ResultProxy" title="sqlalchemy.engine.ResultProxy"><code class="xref py py-class docutils literal"><span class="pre">ResultProxy</span></code></a>&#x3002;</span></li></ul></div></blockquote></td></tr></tbody></table></dd></dl><dl class="method"><dt id="sqlalchemy.orm.events.SessionEvents.after_commit"><span class="yiyi-st" id="yiyi-537"><code class="descname"> after_commit  T0&gt; <span class="sig-paren">&#xFF08; T1&gt; <em>&#x4F1A;&#x8BDD; T2&gt; <span class="sig-paren">&#xFF09; T3&gt; <a class="headerlink" href="#sqlalchemy.orm.events.SessionEvents.after_commit" title="Permalink to this definition">&#xB6; T4&gt;</a></span></em></span></code></span></dt><dd><p><span class="yiyi-st" id="yiyi-538">&#x5728;&#x63D0;&#x4EA4;&#x53D1;&#x751F;&#x540E;&#x6267;&#x884C;&#x3002;</span></p><div class="event-signatures container"><p><span class="yiyi-st" id="yiyi-539">&#x793A;&#x4F8B;&#x53C2;&#x6570;&#x8868;&#x5355;&#xFF1A;</span></p><div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sqlalchemy</span> <span class="kn">import</span> <span class="n">event</span>

<span class="c1"># standard decorator style</span>
<span class="nd">@event.listens_for</span><span class="p">(</span><span class="n">SomeSessionOrFactory</span><span class="p">,</span> <span class="s1">&apos;after_commit&apos;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">receive_after_commit</span><span class="p">(</span><span class="n">session</span><span class="p">):</span>
    <span class="s2">&quot;listen for the &apos;after_commit&apos; event&quot;</span>

    <span class="c1"># ... (event handling logic) ...</span></pre></div></div></div><div class="admonition note"><p class="first admonition-title"><span class="yiyi-st" id="yiyi-540">&#x6CE8;&#x610F;</span></p><p class="last"><span class="yiyi-st" id="yiyi-541"><a class="reference internal" href="#sqlalchemy.orm.events.SessionEvents.after_commit" title="sqlalchemy.orm.events.SessionEvents.after_commit"><code class="xref py py-meth docutils literal"><span class="pre">after_commit()</span></code></a>&#x94A9;&#x5B50;&#x4E0D;&#x662F;&#x6BCF;&#x6B21;&#x5237;&#x65B0;&#x7684;<em>&#xFF0C;&#x4E5F;&#x5C31;&#x662F;&#x8BF4;&#xFF0C;<a class="reference internal" href="session_api.html#sqlalchemy.orm.session.Session" title="sqlalchemy.orm.session.Session"><code class="xref py py-class docutils literal"><span class="pre">Session</span></code></a>&#x53EF;&#x4EE5;&#x5C06;SQL&#x53D1;&#x9001;&#x5230;&#x6570;&#x636E;&#x5E93;&#x591A;&#x6B21;&#x4EA4;&#x6613;&#x3002;</em></span><span class="yiyi-st" id="yiyi-542">&#x8981;&#x62E6;&#x622A;&#x8FD9;&#x4E9B;&#x4E8B;&#x4EF6;&#xFF0C;&#x8BF7;&#x4F7F;&#x7528;<a class="reference internal" href="#sqlalchemy.orm.events.SessionEvents.before_flush" title="sqlalchemy.orm.events.SessionEvents.before_flush"><code class="xref py py-meth docutils literal"><span class="pre">before_flush()</span></code></a>&#xFF0C;<a class="reference internal" href="#sqlalchemy.orm.events.SessionEvents.after_flush" title="sqlalchemy.orm.events.SessionEvents.after_flush"><code class="xref py py-meth docutils literal"><span class="pre">after_flush()</span></code></a>&#x6216;<a class="reference internal" href="#sqlalchemy.orm.events.SessionEvents.after_flush_postexec" title="sqlalchemy.orm.events.SessionEvents.after_flush_postexec"><code class="xref py py-meth docutils literal"><span class="pre">after_flush_postexec()</span></code></a>&#x4E8B;&#x4EF6;&#x3002;</span></p></div><div class="admonition note"><p class="first admonition-title"><span class="yiyi-st" id="yiyi-543">&#x6CE8;&#x610F;</span></p><p class="last"><span class="yiyi-st" id="yiyi-544">&#x5F53;&#x8C03;&#x7528;<a class="reference internal" href="#sqlalchemy.orm.events.SessionEvents.after_commit" title="sqlalchemy.orm.events.SessionEvents.after_commit"><code class="xref py py-meth docutils literal"><span class="pre">after_commit()</span></code></a>&#x4E8B;&#x4EF6;&#x65F6;&#xFF0C;<a class="reference internal" href="session_api.html#sqlalchemy.orm.session.Session" title="sqlalchemy.orm.session.Session"><code class="xref py py-class docutils literal"><span class="pre">Session</span></code></a>&#x4E0D;&#x5904;&#x4E8E;&#x6D3B;&#x52A8;&#x4E8B;&#x52A1;&#x4E2D;&#xFF0C;&#x56E0;&#x6B64;&#x65E0;&#x6CD5;&#x53D1;&#x51FA;SQL&#x3002;</span><span class="yiyi-st" id="yiyi-545">&#x8981;&#x53D1;&#x51FA;&#x5BF9;&#x5E94;&#x4E8E;&#x6BCF;&#x4E2A;&#x4E8B;&#x52A1;&#x7684;SQL&#xFF0C;&#x8BF7;&#x4F7F;&#x7528;<a class="reference internal" href="#sqlalchemy.orm.events.SessionEvents.before_commit" title="sqlalchemy.orm.events.SessionEvents.before_commit"><code class="xref py py-meth docutils literal"><span class="pre">before_commit()</span></code></a>&#x4E8B;&#x4EF6;&#x3002;</span></p></div><table class="docutils field-list" frame="void" rules="none"><tbody valign="top"><tr class="field-odd field"><th class="field-name"><span class="yiyi-st" id="yiyi-546">&#x53C2;&#x6570;&#xFF1A;</span></th><td class="field-body"><span class="yiyi-st" id="yiyi-547"><span class="target" id="sqlalchemy.orm.events.SessionEvents.after_commit.params.session"> tt&gt; <strong>&#x4F1A;&#x8BDD;</strong> <a class="paramlink headerlink reference internal" href="#sqlalchemy.orm.events.SessionEvents.after_commit.params.session">&#xB6;</a>  - &#x76EE;&#x6807;<a class="reference internal" href="session_api.html#sqlalchemy.orm.session.Session" title="sqlalchemy.orm.session.Session"><code class="xref py py-class docutils literal"><span class="pre">Session</span></code></a>&#x3002;</span></span></td></tr></tbody></table><div class="admonition seealso"><p class="first admonition-title"><span class="yiyi-st" id="yiyi-548">&#x4E5F;&#x53EF;&#x4EE5;&#x770B;&#x770B;</span></p><p><span class="yiyi-st" id="yiyi-549"><a class="reference internal" href="#sqlalchemy.orm.events.SessionEvents.before_commit" title="sqlalchemy.orm.events.SessionEvents.before_commit"><code class="xref py py-meth docutils literal"><span class="pre">before_commit()</span></code></a></span></p><p><span class="yiyi-st" id="yiyi-550"><a class="reference internal" href="#sqlalchemy.orm.events.SessionEvents.after_begin" title="sqlalchemy.orm.events.SessionEvents.after_begin"><code class="xref py py-meth docutils literal"><span class="pre">after_begin()</span></code></a></span></p><p><span class="yiyi-st" id="yiyi-551"><a class="reference internal" href="#sqlalchemy.orm.events.SessionEvents.after_transaction_create" title="sqlalchemy.orm.events.SessionEvents.after_transaction_create"><code class="xref py py-meth docutils literal"><span class="pre">after_transaction_create()</span></code></a></span></p><p class="last"><span class="yiyi-st" id="yiyi-552"><a class="reference internal" href="#sqlalchemy.orm.events.SessionEvents.after_transaction_end" title="sqlalchemy.orm.events.SessionEvents.after_transaction_end"><code class="xref py py-meth docutils literal"><span class="pre">after_transaction_end()</span></code></a></span></p></div></dd></dl><dl class="method"><dt id="sqlalchemy.orm.events.SessionEvents.after_flush"><span class="yiyi-st" id="yiyi-553"><code class="descname">after_flush</code> <span class="sig-paren">&#xFF08;</span> <em>session</em>&#xFF0C;<em>flush_context</em> <span class="sig-paren">&#xFF09;</span> <a class="headerlink" href="#sqlalchemy.orm.events.SessionEvents.after_flush" title="Permalink to this definition">&#xB6;</a></span></dt><dd><p><span class="yiyi-st" id="yiyi-554">&#x5237;&#x65B0;&#x5B8C;&#x6210;&#x540E;&#x6267;&#x884C;&#xFF0C;&#x4F46;&#x5728;&#x8C03;&#x7528;&#x63D0;&#x4EA4;&#x4E4B;&#x524D;&#x6267;&#x884C;&#x3002;</span></p><div class="event-signatures container"><p><span class="yiyi-st" id="yiyi-555">&#x793A;&#x4F8B;&#x53C2;&#x6570;&#x8868;&#x5355;&#xFF1A;</span></p><div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sqlalchemy</span> <span class="kn">import</span> <span class="n">event</span>

<span class="c1"># standard decorator style</span>
<span class="nd">@event.listens_for</span><span class="p">(</span><span class="n">SomeSessionOrFactory</span><span class="p">,</span> <span class="s1">&apos;after_flush&apos;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">receive_after_flush</span><span class="p">(</span><span class="n">session</span><span class="p">,</span> <span class="n">flush_context</span><span class="p">):</span>
    <span class="s2">&quot;listen for the &apos;after_flush&apos; event&quot;</span>

    <span class="c1"># ... (event handling logic) ...</span></pre></div></div></div><p><span class="yiyi-st" id="yiyi-556">&#x8BF7;&#x6CE8;&#x610F;&#xFF0C;&#x4F1A;&#x8BDD;&#x7684;&#x72B6;&#x6001;&#x4ECD;&#x5904;&#x4E8E;&#x9884;&#x5148;&#x5237;&#x65B0;&#x72B6;&#x6001;&#xFF0C;&#x5373;&#x201C;&#x65B0;&#x5EFA;&#x201D;&#xFF0C;&#x201C;&#x810F;&#x201D;&#x548C;&#x201C;&#x5DF2;&#x5220;&#x9664;&#x201D;&#x5217;&#x8868;&#x4ECD;&#x663E;&#x793A;&#x9884;&#x5237;&#x65B0;&#x72B6;&#x6001;&#x4EE5;&#x53CA;&#x5B9E;&#x4F8B;&#x5C5E;&#x6027;&#x7684;&#x5386;&#x53F2;&#x8BB0;&#x5F55;&#x8BBE;&#x7F6E;&#x3002;</span></p><table class="docutils field-list" frame="void" rules="none"><tbody valign="top"><tr class="field-odd field"><th class="field-name"><span class="yiyi-st" id="yiyi-557">&#x53C2;&#x6570;&#xFF1A;</span></th><td class="field-body"><ul class="first last simple"><li><span class="yiyi-st" id="yiyi-558"><span class="target" id="sqlalchemy.orm.events.SessionEvents.after_flush.params.session"> tt&gt; <strong>&#x4F1A;&#x8BDD;</strong> <a class="paramlink headerlink reference internal" href="#sqlalchemy.orm.events.SessionEvents.after_flush.params.session">&#xB6;</a>  - &#x76EE;&#x6807;<a class="reference internal" href="session_api.html#sqlalchemy.orm.session.Session" title="sqlalchemy.orm.session.Session"><code class="xref py py-class docutils literal"><span class="pre">Session</span></code></a>&#x3002;</span></span></li><li><span class="yiyi-st" id="yiyi-559"><span class="target" id="sqlalchemy.orm.events.SessionEvents.after_flush.params.flush_context"></span><strong>flush_context</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.orm.events.SessionEvents.after_flush.params.flush_context">&#xB6;</a> &#x2013; Internal <a class="reference internal" href="internals.html#sqlalchemy.orm.session.UOWTransaction" title="sqlalchemy.orm.session.UOWTransaction"><code class="xref py py-class docutils literal"><span class="pre">UOWTransaction</span></code></a> object which handles the details of the flush.</span></li></ul></td></tr></tbody></table><div class="admonition seealso"><p class="first admonition-title"><span class="yiyi-st" id="yiyi-560">&#x4E5F;&#x53EF;&#x4EE5;&#x770B;&#x770B;</span></p><p><span class="yiyi-st" id="yiyi-561"><a class="reference internal" href="#sqlalchemy.orm.events.SessionEvents.before_flush" title="sqlalchemy.orm.events.SessionEvents.before_flush"><code class="xref py py-meth docutils literal"><span class="pre">before_flush()</span></code></a></span></p><p><span class="yiyi-st" id="yiyi-562"><a class="reference internal" href="#sqlalchemy.orm.events.SessionEvents.after_flush_postexec" title="sqlalchemy.orm.events.SessionEvents.after_flush_postexec"><code class="xref py py-meth docutils literal"><span class="pre">after_flush_postexec()</span></code></a></span></p><p class="last"><span class="yiyi-st" id="yiyi-563"><a class="reference internal" href="session_events.html#session-persistence-events"><span>Persistence Events</span></a></span></p></div></dd></dl><dl class="method"><dt id="sqlalchemy.orm.events.SessionEvents.after_flush_postexec"><span class="yiyi-st" id="yiyi-564"><code class="descname">after_flush_postexec</code> <span class="sig-paren">&#xFF08;</span> <em>session</em>&#xFF0C;<em>flush_context</em> <span class="sig-paren">&#xFF09;</span> <a class="headerlink" href="#sqlalchemy.orm.events.SessionEvents.after_flush_postexec" title="Permalink to this definition"></a></span></dt><dd><p><span class="yiyi-st" id="yiyi-565">&#x5237;&#x65B0;&#x5B8C;&#x6210;&#x540E;&#x4EE5;&#x53CA;&#x6267;&#x884C;&#x540E;&#x72B6;&#x6001;&#x53D1;&#x751F;&#x540E;&#x6267;&#x884C;&#x3002;</span></p><div class="event-signatures container"><p><span class="yiyi-st" id="yiyi-566">&#x793A;&#x4F8B;&#x53C2;&#x6570;&#x8868;&#x5355;&#xFF1A;</span></p><div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sqlalchemy</span> <span class="kn">import</span> <span class="n">event</span>

<span class="c1"># standard decorator style</span>
<span class="nd">@event.listens_for</span><span class="p">(</span><span class="n">SomeSessionOrFactory</span><span class="p">,</span> <span class="s1">&apos;after_flush_postexec&apos;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">receive_after_flush_postexec</span><span class="p">(</span><span class="n">session</span><span class="p">,</span> <span class="n">flush_context</span><span class="p">):</span>
    <span class="s2">&quot;listen for the &apos;after_flush_postexec&apos; event&quot;</span>

    <span class="c1"># ... (event handling logic) ...</span></pre></div></div></div><p><span class="yiyi-st" id="yiyi-567">&#x8FD9;&#x5C06;&#x662F;&apos;&#x65B0;&apos;&#xFF0C;&apos;&#x810F;&apos;&#x548C;&apos;&#x5220;&#x9664;&apos;&#x5217;&#x8868;&#x5904;&#x4E8E;&#x6700;&#x7EC8;&#x72B6;&#x6001;&#x7684;&#x65F6;&#x5019;&#x3002;</span><span class="yiyi-st" id="yiyi-568">&#x5B9E;&#x9645;&#x63D0;&#x4EA4;()&#x53EF;&#x80FD;&#x53D1;&#x751F;&#x4E5F;&#x53EF;&#x80FD;&#x6CA1;&#x6709;&#x53D1;&#x751F;&#xFF0C;&#x5177;&#x4F53;&#x53D6;&#x51B3;&#x4E8E;flush&#x662F;&#x5426;&#x5F00;&#x59CB;&#x81EA;&#x5DF1;&#x7684;&#x4E8B;&#x52A1;&#x6216;&#x53C2;&#x4E0E;&#x66F4;&#x5927;&#x7684;&#x4E8B;&#x52A1;&#x3002;</span></p><table class="docutils field-list" frame="void" rules="none"><tbody valign="top"><tr class="field-odd field"><th class="field-name"><span class="yiyi-st" id="yiyi-569">&#x53C2;&#x6570;&#xFF1A;</span></th><td class="field-body"><ul class="first last simple"><li><span class="yiyi-st" id="yiyi-570"><span class="target" id="sqlalchemy.orm.events.SessionEvents.after_flush_postexec.params.session"> tt&gt; <strong>&#x4F1A;&#x8BDD;</strong> <a class="paramlink headerlink reference internal" href="#sqlalchemy.orm.events.SessionEvents.after_flush_postexec.params.session">&#xB6;</a>  - &#x76EE;&#x6807;<a class="reference internal" href="session_api.html#sqlalchemy.orm.session.Session" title="sqlalchemy.orm.session.Session"><code class="xref py py-class docutils literal"><span class="pre">Session</span></code></a>&#x3002;</span></span></li><li><span class="yiyi-st" id="yiyi-571"><span class="target" id="sqlalchemy.orm.events.SessionEvents.after_flush_postexec.params.flush_context"></span><strong>flush_context</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.orm.events.SessionEvents.after_flush_postexec.params.flush_context">&#xB6;</a> &#x2013; Internal <a class="reference internal" href="internals.html#sqlalchemy.orm.session.UOWTransaction" title="sqlalchemy.orm.session.UOWTransaction"><code class="xref py py-class docutils literal"><span class="pre">UOWTransaction</span></code></a> object which handles the details of the flush.</span></li></ul></td></tr></tbody></table><div class="admonition seealso"><p class="first admonition-title"><span class="yiyi-st" id="yiyi-572">&#x4E5F;&#x53EF;&#x4EE5;&#x770B;&#x770B;</span></p><p><span class="yiyi-st" id="yiyi-573"><a class="reference internal" href="#sqlalchemy.orm.events.SessionEvents.before_flush" title="sqlalchemy.orm.events.SessionEvents.before_flush"><code class="xref py py-meth docutils literal"><span class="pre">before_flush()</span></code></a></span></p><p><span class="yiyi-st" id="yiyi-574"><a class="reference internal" href="#sqlalchemy.orm.events.SessionEvents.after_flush" title="sqlalchemy.orm.events.SessionEvents.after_flush"><code class="xref py py-meth docutils literal"><span class="pre">after_flush()</span></code></a></span></p><p class="last"><span class="yiyi-st" id="yiyi-575"><a class="reference internal" href="session_events.html#session-persistence-events"><span>Persistence Events</span></a></span></p></div></dd></dl><dl class="method"><dt id="sqlalchemy.orm.events.SessionEvents.after_rollback"><span class="yiyi-st" id="yiyi-576"><code class="descname"> after_rollback  T0&gt; <span class="sig-paren">&#xFF08; T1&gt; <em>&#x4F1A;&#x8BDD; T2&gt; <span class="sig-paren">&#xFF09; T3&gt; <a class="headerlink" href="#sqlalchemy.orm.events.SessionEvents.after_rollback" title="Permalink to this definition">&#xB6; T4&gt;</a></span></em></span></code></span></dt><dd><p><span class="yiyi-st" id="yiyi-577">&#x5728;&#x53D1;&#x751F;&#x771F;&#x6B63;&#x7684;DBAPI&#x56DE;&#x6EDA;&#x540E;&#x6267;&#x884C;&#x3002;</span></p><div class="event-signatures container"><p><span class="yiyi-st" id="yiyi-578">&#x793A;&#x4F8B;&#x53C2;&#x6570;&#x8868;&#x5355;&#xFF1A;</span></p><div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sqlalchemy</span> <span class="kn">import</span> <span class="n">event</span>

<span class="c1"># standard decorator style</span>
<span class="nd">@event.listens_for</span><span class="p">(</span><span class="n">SomeSessionOrFactory</span><span class="p">,</span> <span class="s1">&apos;after_rollback&apos;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">receive_after_rollback</span><span class="p">(</span><span class="n">session</span><span class="p">):</span>
    <span class="s2">&quot;listen for the &apos;after_rollback&apos; event&quot;</span>

    <span class="c1"># ... (event handling logic) ...</span></pre></div></div></div><p><span class="yiyi-st" id="yiyi-579">&#x8BF7;&#x6CE8;&#x610F;&#xFF0C;&#x53EA;&#x6709;&#x5F53;&#x9488;&#x5BF9;&#x6570;&#x636E;&#x5E93;&#x7684;<em>&#x5B9E;&#x9645;</em>&#x56DE;&#x6EDA;&#x53D1;&#x751F;&#x65F6;&#x624D;&#x4F1A;&#x89E6;&#x53D1;&#x6B64;&#x4E8B;&#x4EF6; - &#x6BCF;&#x6B21;<a class="reference internal" href="session_api.html#sqlalchemy.orm.session.Session.rollback" title="sqlalchemy.orm.session.Session.rollback"><code class="xref py py-meth docutils literal"><span class="pre">Session.rollback()</span></code></a>&#x65B9;&#x6CD5;&#x89E6;&#x53D1;&#x65F6;&#xFF0C;&#x90FD;&#x4F1A;&#x89E6;&#x53D1;<em>&#x800C;&#x4E0D;&#x662F;</em>&#x5982;&#x679C;&#x5E95;&#x5C42;&#x7684;DBAPI&#x4E8B;&#x52A1;&#x5DF2;&#x7ECF;&#x88AB;&#x56DE;&#x6EDA;&#xFF0C;&#x5219;&#x79F0;&#x4E3A;&#x201C;</span><span class="yiyi-st" id="yiyi-580">&#x5728;&#x5F88;&#x591A;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;&#x7531;&#x4E8E;&#x5F53;&#x524D;&#x4E8B;&#x52A1;&#x65E0;&#x6548;&#xFF0C;<a class="reference internal" href="session_api.html#sqlalchemy.orm.session.Session" title="sqlalchemy.orm.session.Session"><code class="xref py py-class docutils literal"><span class="pre">Session</span></code></a>&#x5728;&#x6B64;&#x4E8B;&#x4EF6;&#x671F;&#x95F4;&#x4E0D;&#x4F1A;&#x5904;&#x4E8E;&#x201C;&#x6D3B;&#x52A8;&#x201D;&#x72B6;&#x6001;&#x3002;</span><span class="yiyi-st" id="yiyi-581">&#x8981;&#x83B7;&#x53D6;&#x5728;&#x6700;&#x540E;&#x4E00;&#x4E2A;&#x56DE;&#x6EDA;&#x8FDB;&#x884C;&#x4E4B;&#x540E;&#x5904;&#x4E8E;&#x6D3B;&#x52A8;&#x72B6;&#x6001;&#x7684;<a class="reference internal" href="session_api.html#sqlalchemy.orm.session.Session" title="sqlalchemy.orm.session.Session"><code class="xref py py-class docutils literal"><span class="pre">Session</span></code></a>&#xFF0C;&#x8BF7;&#x4F7F;&#x7528;<a class="reference internal" href="#sqlalchemy.orm.events.SessionEvents.after_soft_rollback" title="sqlalchemy.orm.events.SessionEvents.after_soft_rollback"><code class="xref py py-meth docutils literal"><span class="pre">SessionEvents.after_soft_rollback()</span></code></a>&#x4E8B;&#x4EF6;&#xFF0C;&#x68C0;&#x67E5;<a class="reference internal" href="session_api.html#sqlalchemy.orm.session.Session.is_active" title="sqlalchemy.orm.session.Session.is_active"><code class="xref py py-attr docutils literal"><span class="pre">Session.is_active</span></code></a>&#x6807;&#x5FD7;&#x3002;</span></p><table class="docutils field-list" frame="void" rules="none"><tbody valign="top"><tr class="field-odd field"><th class="field-name"><span class="yiyi-st" id="yiyi-582">&#x53C2;&#x6570;&#xFF1A;</span></th><td class="field-body"><span class="yiyi-st" id="yiyi-583"><span class="target" id="sqlalchemy.orm.events.SessionEvents.after_rollback.params.session"> tt&gt; <strong>&#x4F1A;&#x8BDD;</strong> <a class="paramlink headerlink reference internal" href="#sqlalchemy.orm.events.SessionEvents.after_rollback.params.session">&#xB6;</a>  - &#x76EE;&#x6807;<a class="reference internal" href="session_api.html#sqlalchemy.orm.session.Session" title="sqlalchemy.orm.session.Session"><code class="xref py py-class docutils literal"><span class="pre">Session</span></code></a>&#x3002;</span></span></td></tr></tbody></table></dd></dl><dl class="method"><dt id="sqlalchemy.orm.events.SessionEvents.after_soft_rollback"><span class="yiyi-st" id="yiyi-584"> <code class="descname">after_soft_rollback</code><span class="sig-paren">(</span><em>session</em>, <em>previous_transaction</em><span class="sig-paren">)</span><a class="headerlink" href="#sqlalchemy.orm.events.SessionEvents.after_soft_rollback" title="Permalink to this definition">&#xB6;</a></span></dt><dd><p><span class="yiyi-st" id="yiyi-585">&#x5728;&#x53D1;&#x751F;&#x4EFB;&#x4F55;&#x56DE;&#x6EDA;&#x4E4B;&#x540E;&#x6267;&#x884C;&#xFF0C;&#x5305;&#x62EC;&#x5B9E;&#x9645;&#x4E0A;&#x4E0D;&#x4F1A;&#x5728;DBAPI&#x7EA7;&#x522B;&#x53D1;&#x51FA;&#x7684;&#x201C;&#x8F6F;&#x201D;&#x56DE;&#x6EDA;&#x3002;</span></p><div class="event-signatures container"><p><span class="yiyi-st" id="yiyi-586">&#x793A;&#x4F8B;&#x53C2;&#x6570;&#x8868;&#x5355;&#xFF1A;</span></p><div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sqlalchemy</span> <span class="kn">import</span> <span class="n">event</span>

<span class="c1"># standard decorator style</span>
<span class="nd">@event.listens_for</span><span class="p">(</span><span class="n">SomeSessionOrFactory</span><span class="p">,</span> <span class="s1">&apos;after_soft_rollback&apos;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">receive_after_soft_rollback</span><span class="p">(</span><span class="n">session</span><span class="p">,</span> <span class="n">previous_transaction</span><span class="p">):</span>
    <span class="s2">&quot;listen for the &apos;after_soft_rollback&apos; event&quot;</span>

    <span class="c1"># ... (event handling logic) ...</span></pre></div></div></div><p><span class="yiyi-st" id="yiyi-587">&#x8FD9;&#x5BF9;&#x5E94;&#x4E8E;&#x5D4C;&#x5957;&#x548C;&#x5916;&#x90E8;&#x56DE;&#x6EDA;&#xFF0C;&#x5373;&#x8C03;&#x7528;DBAPI&#x7684;rollback()&#x65B9;&#x6CD5;&#x7684;&#x6700;&#x5185;&#x90E8;&#x56DE;&#x6EDA;&#xFF0C;&#x4EE5;&#x53CA;&#x53EA;&#x4ECE;&#x4E8B;&#x52A1;&#x5806;&#x6808;&#x4E2D;&#x81EA;&#x884C;&#x5F39;&#x51FA;&#x7684;&#x5C01;&#x95ED;&#x56DE;&#x6EDA;&#x8C03;&#x7528;&#x3002;</span></p><p><span class="yiyi-st" id="yiyi-588">&#x901A;&#x8FC7;&#x9996;&#x5148;&#x68C0;&#x67E5;<a class="reference internal" href="session_api.html#sqlalchemy.orm.session.Session.is_active" title="sqlalchemy.orm.session.Session.is_active"><code class="xref py py-attr docutils literal"><span class="pre">Session.is_active</span></code></a>&#x6807;&#x5FD7;&#xFF0C;&#x7ED9;&#x5B9A;&#x7684;<a class="reference internal" href="session_api.html#sqlalchemy.orm.session.Session" title="sqlalchemy.orm.session.Session"><code class="xref py py-class docutils literal"><span class="pre">Session</span></code></a>&#x53EF;&#x7528;&#x4E8E;&#x5728;&#x6700;&#x5916;&#x4FA7;&#x56DE;&#x6EDA;&#x4E4B;&#x540E;&#x8C03;&#x7528;SQL&#x548C;<a class="reference internal" href="session_api.html#sqlalchemy.orm.session.Session.query" title="sqlalchemy.orm.session.Session.query"><code class="xref py py-meth docutils literal"><span class="pre">Session.query()</span></code></a></span></p><div class="highlight-python"><div class="highlight"><pre><span></span><span class="nd">@event.listens_for</span><span class="p">(</span><span class="n">Session</span><span class="p">,</span> <span class="s2">&quot;after_soft_rollback&quot;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">do_something</span><span class="p">(</span><span class="n">session</span><span class="p">,</span> <span class="n">previous_transaction</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">session</span><span class="o">.</span><span class="n">is_active</span><span class="p">:</span>
        <span class="n">session</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;select * from some_table&quot;</span><span class="p">)</span></pre></div></div><table class="docutils field-list" frame="void" rules="none"><tbody valign="top"><tr class="field-odd field"><th class="field-name"><span class="yiyi-st" id="yiyi-589">&#x53C2;&#x6570;&#xFF1A;</span></th><td class="field-body"><ul class="first last simple"><li><span class="yiyi-st" id="yiyi-590"><span class="target" id="sqlalchemy.orm.events.SessionEvents.after_soft_rollback.params.session"> tt&gt; <strong>&#x4F1A;&#x8BDD;</strong> <a class="paramlink headerlink reference internal" href="#sqlalchemy.orm.events.SessionEvents.after_soft_rollback.params.session">&#xB6;</a>  - &#x76EE;&#x6807;<a class="reference internal" href="session_api.html#sqlalchemy.orm.session.Session" title="sqlalchemy.orm.session.Session"><code class="xref py py-class docutils literal"><span class="pre">Session</span></code></a>&#x3002;</span></span></li><li><span class="yiyi-st" id="yiyi-591"><span class="target" id="sqlalchemy.orm.events.SessionEvents.after_soft_rollback.params.previous_transaction"></span><strong>previous_transaction</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.orm.events.SessionEvents.after_soft_rollback.params.previous_transaction">&#xB6;</a> &#x2013; The <a class="reference internal" href="session_api.html#sqlalchemy.orm.session.SessionTransaction" title="sqlalchemy.orm.session.SessionTransaction"><code class="xref py py-class docutils literal"><span class="pre">SessionTransaction</span></code></a> transactional marker object which was just closed. </span><span class="yiyi-st" id="yiyi-592">&#x7ED9;&#x5B9A;<a class="reference internal" href="session_api.html#sqlalchemy.orm.session.Session" title="sqlalchemy.orm.session.Session"><code class="xref py py-class docutils literal"><span class="pre">Session</span></code></a>&#x7684;&#x5F53;&#x524D;<a class="reference internal" href="session_api.html#sqlalchemy.orm.session.SessionTransaction" title="sqlalchemy.orm.session.SessionTransaction"><code class="xref py py-class docutils literal"><span class="pre">SessionTransaction</span></code></a>&#x53EF;&#x4EE5;&#x901A;&#x8FC7;<a class="reference internal" href="session_api.html#sqlalchemy.orm.session.Session.transaction" title="sqlalchemy.orm.session.Session.transaction"><code class="xref py py-attr docutils literal"><span class="pre">Session.transaction</span></code></a>&#x5C5E;&#x6027;&#x83B7;&#x5F97;&#x3002;</span></li></ul></td></tr></tbody></table><div class="versionadded"><p><span class="yiyi-st" id="yiyi-593"><span class="versionmodified">New in version 0.7.3.</span></span></p></div></dd></dl><dl class="method"><dt id="sqlalchemy.orm.events.SessionEvents.after_transaction_create"><span class="yiyi-st" id="yiyi-594"><code class="descname">after_transaction_create</code> <span class="sig-paren">&#xFF08;</span> <em>session</em>&#xFF0C;<em>transaction</em> <span class="sig-paren">&#xFF09;</span> <a class="headerlink" href="#sqlalchemy.orm.events.SessionEvents.after_transaction_create" title="Permalink to this definition">&#xB6;</a></span></dt><dd><p><span class="yiyi-st" id="yiyi-595">&#x5F53;&#x521B;&#x5EFA;&#x65B0;&#x7684;<a class="reference internal" href="session_api.html#sqlalchemy.orm.session.SessionTransaction" title="sqlalchemy.orm.session.SessionTransaction"><code class="xref py py-class docutils literal"><span class="pre">SessionTransaction</span></code></a>&#x65F6;&#x6267;&#x884C;&#x3002;</span></p><div class="event-signatures container"><p><span class="yiyi-st" id="yiyi-596">&#x793A;&#x4F8B;&#x53C2;&#x6570;&#x8868;&#x5355;&#xFF1A;</span></p><div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sqlalchemy</span> <span class="kn">import</span> <span class="n">event</span>

<span class="c1"># standard decorator style</span>
<span class="nd">@event.listens_for</span><span class="p">(</span><span class="n">SomeSessionOrFactory</span><span class="p">,</span> <span class="s1">&apos;after_transaction_create&apos;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">receive_after_transaction_create</span><span class="p">(</span><span class="n">session</span><span class="p">,</span> <span class="n">transaction</span><span class="p">):</span>
    <span class="s2">&quot;listen for the &apos;after_transaction_create&apos; event&quot;</span>

    <span class="c1"># ... (event handling logic) ...</span></pre></div></div></div><p><span class="yiyi-st" id="yiyi-597">&#x8FD9;&#x4E2A;&#x4E8B;&#x4EF6;&#x4E0E;<a class="reference internal" href="#sqlalchemy.orm.events.SessionEvents.after_begin" title="sqlalchemy.orm.events.SessionEvents.after_begin"><code class="xref py py-meth docutils literal"><span class="pre">after_begin()</span></code></a>&#x4E0D;&#x540C;&#xFF0C;&#x5B83;&#x53D1;&#x751F;&#x5728;&#x6BCF;&#x4E2A;<a class="reference internal" href="session_api.html#sqlalchemy.orm.session.SessionTransaction" title="sqlalchemy.orm.session.SessionTransaction"><code class="xref py py-class docutils literal"><span class="pre">SessionTransaction</span></code></a>&#x6574;&#x4F53;&#x4E0A;&#xFF0C;&#x800C;&#x4E0D;&#x662F;&#x5728;&#x5355;&#x4E2A;&#x6570;&#x636E;&#x5E93;&#x8FDE;&#x63A5;&#x4E0A;&#x5F00;&#x59CB;&#x4E8B;&#x52A1;&#x3002;</span><span class="yiyi-st" id="yiyi-598">&#x5B83;&#x4E5F;&#x88AB;&#x5D4C;&#x5957;&#x4E8B;&#x52A1;&#x548C;&#x5B50;&#x4E8B;&#x52A1;&#x8C03;&#x7528;&#xFF0C;&#x5E76;&#x4E14;&#x603B;&#x662F;&#x4E0E;&#x76F8;&#x5E94;&#x7684;<a class="reference internal" href="#sqlalchemy.orm.events.SessionEvents.after_transaction_end" title="sqlalchemy.orm.events.SessionEvents.after_transaction_end"><code class="xref py py-meth docutils literal"><span class="pre">after_transaction_end()</span></code></a>&#x4E8B;&#x4EF6;&#x5339;&#x914D;&#xFF08;&#x5047;&#x8BBE;<a class="reference internal" href="session_api.html#sqlalchemy.orm.session.Session" title="sqlalchemy.orm.session.Session"><code class="xref py py-class docutils literal"><span class="pre">Session</span></code></a>&#x6B63;&#x5E38;&#x8FD0;&#x884C;&#xFF09;&#x3002;</span></p><table class="docutils field-list" frame="void" rules="none"><tbody valign="top"><tr class="field-odd field"><th class="field-name"><span class="yiyi-st" id="yiyi-599">&#x53C2;&#x6570;&#xFF1A;</span></th><td class="field-body"><ul class="first last simple"><li><span class="yiyi-st" id="yiyi-600"><span class="target" id="sqlalchemy.orm.events.SessionEvents.after_transaction_create.params.session"></span> <strong>&#x4F1A;&#x8BDD;</strong> <a class="paramlink headerlink reference internal" href="#sqlalchemy.orm.events.SessionEvents.after_transaction_create.params.session">&#xB6;</a>  - &#x76EE;&#x6807;<a class="reference internal" href="session_api.html#sqlalchemy.orm.session.Session" title="sqlalchemy.orm.session.Session"><code class="xref py py-class docutils literal"><span class="pre">Session</span></code></a>&#x3002;</span></li><li><span class="yiyi-st" id="yiyi-601"><span class="target" id="sqlalchemy.orm.events.SessionEvents.after_transaction_create.params.transaction"></span><strong>transaction</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.orm.events.SessionEvents.after_transaction_create.params.transaction">&#xB6;</a> &#x2013; the target <a class="reference internal" href="session_api.html#sqlalchemy.orm.session.SessionTransaction" title="sqlalchemy.orm.session.SessionTransaction"><code class="xref py py-class docutils literal"><span class="pre">SessionTransaction</span></code></a>.</span></li></ul></td></tr></tbody></table><div class="versionadded"><p><span class="yiyi-st" id="yiyi-602"><span class="versionmodified">0.8&#x7248;&#x672C;&#x4E2D;&#x7684;&#x65B0;&#x529F;&#x80FD;</span></span></p></div><div class="admonition seealso"><p class="first admonition-title"><span class="yiyi-st" id="yiyi-603">&#x4E5F;&#x53EF;&#x4EE5;&#x770B;&#x770B;</span></p><p class="last"><span class="yiyi-st" id="yiyi-604"><a class="reference internal" href="#sqlalchemy.orm.events.SessionEvents.after_transaction_end" title="sqlalchemy.orm.events.SessionEvents.after_transaction_end"><code class="xref py py-meth docutils literal"><span class="pre">after_transaction_end()</span></code></a></span></p></div></dd></dl><dl class="method"><dt id="sqlalchemy.orm.events.SessionEvents.after_transaction_end"><span class="yiyi-st" id="yiyi-605"><code class="descname">after_transaction_end</code> <span class="sig-paren">&#xFF08;</span> <em>session</em>&#xFF0C;<em>transaction</em> <span class="sig-paren">&#xFF09;</span> <a class="headerlink" href="#sqlalchemy.orm.events.SessionEvents.after_transaction_end" title="Permalink to this definition">&#xB6;</a></span></dt><dd><p><span class="yiyi-st" id="yiyi-606">&#x5F53;<a class="reference internal" href="session_api.html#sqlalchemy.orm.session.SessionTransaction" title="sqlalchemy.orm.session.SessionTransaction"><code class="xref py py-class docutils literal"><span class="pre">SessionTransaction</span></code></a>&#x7684;&#x8DE8;&#x5EA6;&#x7ED3;&#x675F;&#x65F6;&#x6267;&#x884C;&#x3002;</span></p><div class="event-signatures container"><p><span class="yiyi-st" id="yiyi-607">&#x793A;&#x4F8B;&#x53C2;&#x6570;&#x8868;&#x5355;&#xFF1A;</span></p><div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sqlalchemy</span> <span class="kn">import</span> <span class="n">event</span>

<span class="c1"># standard decorator style</span>
<span class="nd">@event.listens_for</span><span class="p">(</span><span class="n">SomeSessionOrFactory</span><span class="p">,</span> <span class="s1">&apos;after_transaction_end&apos;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">receive_after_transaction_end</span><span class="p">(</span><span class="n">session</span><span class="p">,</span> <span class="n">transaction</span><span class="p">):</span>
    <span class="s2">&quot;listen for the &apos;after_transaction_end&apos; event&quot;</span>

    <span class="c1"># ... (event handling logic) ...</span></pre></div></div></div><p><span class="yiyi-st" id="yiyi-608">&#x8FD9;&#x4E2A;&#x4E8B;&#x4EF6;&#x4E0E;<a class="reference internal" href="#sqlalchemy.orm.events.SessionEvents.after_commit" title="sqlalchemy.orm.events.SessionEvents.after_commit"><code class="xref py py-meth docutils literal"><span class="pre">after_commit()</span></code></a>&#x7684;&#x4E0D;&#x540C;&#x4E4B;&#x5904;&#x5728;&#x4E8E;&#x5B83;&#x5BF9;&#x5E94;&#x4E8E;&#x6240;&#x6709;&#x6B63;&#x5728;&#x4F7F;&#x7528;&#x7684;<a class="reference internal" href="session_api.html#sqlalchemy.orm.session.SessionTransaction" title="sqlalchemy.orm.session.SessionTransaction"><code class="xref py py-class docutils literal"><span class="pre">SessionTransaction</span></code></a>&#x5BF9;&#x8C61;&#xFF0C;&#x5305;&#x62EC;&#x5D4C;&#x5957;&#x4E8B;&#x52A1;&#x548C;&#x5B50;&#x4E8B;&#x52A1;&#x7684;&#x5BF9;&#x8C61;&#xFF0C;&#x5E76;&#x4E14;&#x603B;&#x662F;&#x4E0E;&#x76F8;&#x5E94;&#x7684;<a class="reference internal" href="#sqlalchemy.orm.events.SessionEvents.after_transaction_create" title="sqlalchemy.orm.events.SessionEvents.after_transaction_create"><code class="xref py py-meth docutils literal"><span class="pre">after_transaction_create()</span></code></a>&#x4E8B;&#x4EF6;&#x3002;</span></p><table class="docutils field-list" frame="void" rules="none"><tbody valign="top"><tr class="field-odd field"><th class="field-name"><span class="yiyi-st" id="yiyi-609">&#x53C2;&#x6570;&#xFF1A;</span></th><td class="field-body"><ul class="first last simple"><li><span class="yiyi-st" id="yiyi-610"><span class="target" id="sqlalchemy.orm.events.SessionEvents.after_transaction_end.params.session"></span> <strong>&#x4F1A;&#x8BDD;</strong> <a class="paramlink headerlink reference internal" href="#sqlalchemy.orm.events.SessionEvents.after_transaction_end.params.session">&#xB6;</a>  - &#x76EE;&#x6807;<a class="reference internal" href="session_api.html#sqlalchemy.orm.session.Session" title="sqlalchemy.orm.session.Session"><code class="xref py py-class docutils literal"><span class="pre">Session</span></code></a>&#x3002;</span></li><li><span class="yiyi-st" id="yiyi-611"><span class="target" id="sqlalchemy.orm.events.SessionEvents.after_transaction_end.params.transaction"></span><strong>transaction</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.orm.events.SessionEvents.after_transaction_end.params.transaction">&#xB6;</a> &#x2013; the target <a class="reference internal" href="session_api.html#sqlalchemy.orm.session.SessionTransaction" title="sqlalchemy.orm.session.SessionTransaction"><code class="xref py py-class docutils literal"><span class="pre">SessionTransaction</span></code></a>.</span></li></ul></td></tr></tbody></table><div class="versionadded"><p><span class="yiyi-st" id="yiyi-612"><span class="versionmodified">0.8&#x7248;&#x672C;&#x4E2D;&#x7684;&#x65B0;&#x529F;&#x80FD;</span></span></p></div><div class="admonition seealso"><p class="first admonition-title"><span class="yiyi-st" id="yiyi-613">&#x4E5F;&#x53EF;&#x4EE5;&#x770B;&#x770B;</span></p><p class="last"><span class="yiyi-st" id="yiyi-614"><a class="reference internal" href="#sqlalchemy.orm.events.SessionEvents.after_transaction_create" title="sqlalchemy.orm.events.SessionEvents.after_transaction_create"><code class="xref py py-meth docutils literal"><span class="pre">after_transaction_create()</span></code></a></span></p></div></dd></dl><dl class="method"><dt id="sqlalchemy.orm.events.SessionEvents.before_attach"><span class="yiyi-st" id="yiyi-615"><code class="descname">before_attach</code> <span class="sig-paren">&#xFF08;</span> <em>session</em>&#xFF0C;<em>instance</em> <span class="sig-paren">&#xFF09;</span> <a class="headerlink" href="#sqlalchemy.orm.events.SessionEvents.before_attach" title="Permalink to this definition">&#xB6;</a></span></dt><dd><p><span class="yiyi-st" id="yiyi-616">&#x5728;&#x5B9E;&#x4F8B;&#x8FDE;&#x63A5;&#x5230;&#x4F1A;&#x8BDD;&#x4E4B;&#x524D;&#x6267;&#x884C;&#x3002;</span></p><div class="event-signatures container"><p><span class="yiyi-st" id="yiyi-617">&#x793A;&#x4F8B;&#x53C2;&#x6570;&#x8868;&#x5355;&#xFF1A;</span></p><div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sqlalchemy</span> <span class="kn">import</span> <span class="n">event</span>

<span class="c1"># standard decorator style</span>
<span class="nd">@event.listens_for</span><span class="p">(</span><span class="n">SomeSessionOrFactory</span><span class="p">,</span> <span class="s1">&apos;before_attach&apos;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">receive_before_attach</span><span class="p">(</span><span class="n">session</span><span class="p">,</span> <span class="n">instance</span><span class="p">):</span>
    <span class="s2">&quot;listen for the &apos;before_attach&apos; event&quot;</span>

    <span class="c1"># ... (event handling logic) ...</span></pre></div></div></div><p><span class="yiyi-st" id="yiyi-618">&#x8FD9;&#x5728;&#x6DFB;&#x52A0;&#xFF0C;&#x5220;&#x9664;&#x6216;&#x5408;&#x5E76;&#x4E4B;&#x524D;&#x8C03;&#x7528;&#x4F1A;&#x5BFC;&#x81F4;&#x5BF9;&#x8C61;&#x6210;&#x4E3A;&#x4F1A;&#x8BDD;&#x7684;&#x4E00;&#x90E8;&#x5206;&#x3002;</span></p><div class="versionadded"><p><span class="yiyi-st" id="yiyi-619"><span class="versionmodified">New in version 0.8.: </span>Note that <a class="reference internal" href="#sqlalchemy.orm.events.SessionEvents.after_attach" title="sqlalchemy.orm.events.SessionEvents.after_attach"><code class="xref py py-meth docutils literal"><span class="pre">after_attach()</span></code></a> now fires off after the item is part of the session. </span><span class="yiyi-st" id="yiyi-620"><a class="reference internal" href="#sqlalchemy.orm.events.SessionEvents.before_attach" title="sqlalchemy.orm.events.SessionEvents.before_attach"><code class="xref py py-meth docutils literal"><span class="pre">before_attach()</span></code></a> is provided for those cases where the item should not yet be part of the session state.</span></p></div><div class="admonition seealso"><p class="first admonition-title"><span class="yiyi-st" id="yiyi-621">&#x4E5F;&#x53EF;&#x4EE5;&#x770B;&#x770B;</span></p><p><span class="yiyi-st" id="yiyi-622"><a class="reference internal" href="#sqlalchemy.orm.events.SessionEvents.after_attach" title="sqlalchemy.orm.events.SessionEvents.after_attach"><code class="xref py py-meth docutils literal"><span class="pre">after_attach()</span></code></a></span></p><p class="last"><span class="yiyi-st" id="yiyi-623"><a class="reference internal" href="session_events.html#session-lifecycle-events"><span>Object Lifecycle Events</span></a></span></p></div></dd></dl><dl class="method"><dt id="sqlalchemy.orm.events.SessionEvents.before_commit"><span class="yiyi-st" id="yiyi-624"><code class="descname"> before_commit  T0&gt; <span class="sig-paren">&#xFF08; T1&gt; <em>&#x4F1A;&#x8BDD; T2&gt; <span class="sig-paren">&#xFF09; T3&gt; <a class="headerlink" href="#sqlalchemy.orm.events.SessionEvents.before_commit" title="Permalink to this definition">&#xB6; T4&gt;</a></span></em></span></code></span></dt><dd><p><span class="yiyi-st" id="yiyi-625">&#x5728;&#x8C03;&#x7528;&#x63D0;&#x4EA4;&#x4E4B;&#x524D;&#x6267;&#x884C;&#x3002;</span></p><div class="event-signatures container"><p><span class="yiyi-st" id="yiyi-626">&#x793A;&#x4F8B;&#x53C2;&#x6570;&#x8868;&#x5355;&#xFF1A;</span></p><div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sqlalchemy</span> <span class="kn">import</span> <span class="n">event</span>

<span class="c1"># standard decorator style</span>
<span class="nd">@event.listens_for</span><span class="p">(</span><span class="n">SomeSessionOrFactory</span><span class="p">,</span> <span class="s1">&apos;before_commit&apos;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">receive_before_commit</span><span class="p">(</span><span class="n">session</span><span class="p">):</span>
    <span class="s2">&quot;listen for the &apos;before_commit&apos; event&quot;</span>

    <span class="c1"># ... (event handling logic) ...</span></pre></div></div></div><div class="admonition note"><p class="first admonition-title"><span class="yiyi-st" id="yiyi-627">&#x6CE8;&#x610F;</span></p><p class="last"><span class="yiyi-st" id="yiyi-628"><a class="reference internal" href="#sqlalchemy.orm.events.SessionEvents.before_commit" title="sqlalchemy.orm.events.SessionEvents.before_commit"><code class="xref py py-meth docutils literal"><span class="pre">before_commit()</span></code></a>&#x94A9;&#x5B50;&#x662F;<em>&#x4E0D;&#x662F;</em>&#x6BCF;&#x6B21;&#x5237;&#x65B0;&#xFF0C;&#x4E5F;&#x5C31;&#x662F;&#x8BF4;&#xFF0C;<a class="reference internal" href="session_api.html#sqlalchemy.orm.session.Session" title="sqlalchemy.orm.session.Session"><code class="xref py py-class docutils literal"><span class="pre">Session</span></code></a>&#x53EF;&#x4EE5;&#x5C06;SQL&#x53D1;&#x9001;&#x5230;&#x6570;&#x636E;&#x5E93;&#x591A;&#x6B21;&#x4EA4;&#x6613;&#x3002;</span><span class="yiyi-st" id="yiyi-629">&#x8981;&#x62E6;&#x622A;&#x8FD9;&#x4E9B;&#x4E8B;&#x4EF6;&#xFF0C;&#x8BF7;&#x4F7F;&#x7528;<a class="reference internal" href="#sqlalchemy.orm.events.SessionEvents.before_flush" title="sqlalchemy.orm.events.SessionEvents.before_flush"><code class="xref py py-meth docutils literal"><span class="pre">before_flush()</span></code></a>&#xFF0C;<a class="reference internal" href="#sqlalchemy.orm.events.SessionEvents.after_flush" title="sqlalchemy.orm.events.SessionEvents.after_flush"><code class="xref py py-meth docutils literal"><span class="pre">after_flush()</span></code></a>&#x6216;<a class="reference internal" href="#sqlalchemy.orm.events.SessionEvents.after_flush_postexec" title="sqlalchemy.orm.events.SessionEvents.after_flush_postexec"><code class="xref py py-meth docutils literal"><span class="pre">after_flush_postexec()</span></code></a>&#x4E8B;&#x4EF6;&#x3002;</span></p></div><table class="docutils field-list" frame="void" rules="none"><tbody valign="top"><tr class="field-odd field"><th class="field-name"><span class="yiyi-st" id="yiyi-630">&#x53C2;&#x6570;&#xFF1A;</span></th><td class="field-body"><span class="yiyi-st" id="yiyi-631"><span class="target" id="sqlalchemy.orm.events.SessionEvents.before_commit.params.session"> tt&gt; <strong>&#x4F1A;&#x8BDD;</strong> <a class="paramlink headerlink reference internal" href="#sqlalchemy.orm.events.SessionEvents.before_commit.params.session">&#xB6;</a>  - &#x76EE;&#x6807;<a class="reference internal" href="session_api.html#sqlalchemy.orm.session.Session" title="sqlalchemy.orm.session.Session"><code class="xref py py-class docutils literal"><span class="pre">Session</span></code></a>&#x3002;</span></span></td></tr></tbody></table><div class="admonition seealso"><p class="first admonition-title"><span class="yiyi-st" id="yiyi-632">&#x4E5F;&#x53EF;&#x4EE5;&#x770B;&#x770B;</span></p><p><span class="yiyi-st" id="yiyi-633"><a class="reference internal" href="#sqlalchemy.orm.events.SessionEvents.after_commit" title="sqlalchemy.orm.events.SessionEvents.after_commit"><code class="xref py py-meth docutils literal"><span class="pre">after_commit()</span></code></a></span></p><p><span class="yiyi-st" id="yiyi-634"><a class="reference internal" href="#sqlalchemy.orm.events.SessionEvents.after_begin" title="sqlalchemy.orm.events.SessionEvents.after_begin"><code class="xref py py-meth docutils literal"><span class="pre">after_begin()</span></code></a></span></p><p><span class="yiyi-st" id="yiyi-635"><a class="reference internal" href="#sqlalchemy.orm.events.SessionEvents.after_transaction_create" title="sqlalchemy.orm.events.SessionEvents.after_transaction_create"><code class="xref py py-meth docutils literal"><span class="pre">after_transaction_create()</span></code></a></span></p><p class="last"><span class="yiyi-st" id="yiyi-636"><a class="reference internal" href="#sqlalchemy.orm.events.SessionEvents.after_transaction_end" title="sqlalchemy.orm.events.SessionEvents.after_transaction_end"><code class="xref py py-meth docutils literal"><span class="pre">after_transaction_end()</span></code></a></span></p></div></dd></dl><dl class="method"><dt id="sqlalchemy.orm.events.SessionEvents.before_flush"><span class="yiyi-st" id="yiyi-637"><code class="descname"> before_flush  T0&gt; <span class="sig-paren">&#xFF08; T1&gt; <em>&#x4F1A;&#x8BDD; T2&gt;&#xFF0C;<em> flush_context  T3&gt;&#xFF0C;<em>&#x5B9E;&#x4F8B; T4&gt; <span class="sig-paren">&#xFF09; T5&gt; <a class="headerlink" href="#sqlalchemy.orm.events.SessionEvents.before_flush" title="Permalink to this definition">&#xB6; T6&gt;</a></span></em></em></em></span></code></span></dt><dd><p><span class="yiyi-st" id="yiyi-638">&#x5728;&#x5237;&#x65B0;&#x8FC7;&#x7A0B;&#x5F00;&#x59CB;&#x4E4B;&#x524D;&#x6267;&#x884C;&#x3002;</span></p><div class="event-signatures container"><p><span class="yiyi-st" id="yiyi-639">&#x793A;&#x4F8B;&#x53C2;&#x6570;&#x8868;&#x5355;&#xFF1A;</span></p><div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sqlalchemy</span> <span class="kn">import</span> <span class="n">event</span>

<span class="c1"># standard decorator style</span>
<span class="nd">@event.listens_for</span><span class="p">(</span><span class="n">SomeSessionOrFactory</span><span class="p">,</span> <span class="s1">&apos;before_flush&apos;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">receive_before_flush</span><span class="p">(</span><span class="n">session</span><span class="p">,</span> <span class="n">flush_context</span><span class="p">,</span> <span class="n">instances</span><span class="p">):</span>
    <span class="s2">&quot;listen for the &apos;before_flush&apos; event&quot;</span>

    <span class="c1"># ... (event handling logic) ...</span></pre></div></div></div><table class="docutils field-list" frame="void" rules="none"><tbody valign="top"><tr class="field-odd field"><th class="field-name"><span class="yiyi-st" id="yiyi-640">&#x53C2;&#x6570;&#xFF1A;</span></th><td class="field-body"><ul class="first last simple"><li><span class="yiyi-st" id="yiyi-641"><span class="target" id="sqlalchemy.orm.events.SessionEvents.before_flush.params.session"> tt&gt; <strong>&#x4F1A;&#x8BDD;</strong> <a class="paramlink headerlink reference internal" href="#sqlalchemy.orm.events.SessionEvents.before_flush.params.session">&#xB6;</a>  - &#x76EE;&#x6807;<a class="reference internal" href="session_api.html#sqlalchemy.orm.session.Session" title="sqlalchemy.orm.session.Session"><code class="xref py py-class docutils literal"><span class="pre">Session</span></code></a>&#x3002;</span></span></li><li><span class="yiyi-st" id="yiyi-642"><span class="target" id="sqlalchemy.orm.events.SessionEvents.before_flush.params.flush_context"></span><strong>flush_context</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.orm.events.SessionEvents.before_flush.params.flush_context">&#xB6;</a> &#x2013; Internal <a class="reference internal" href="internals.html#sqlalchemy.orm.session.UOWTransaction" title="sqlalchemy.orm.session.UOWTransaction"><code class="xref py py-class docutils literal"><span class="pre">UOWTransaction</span></code></a> object which handles the details of the flush.</span></li><li><span class="yiyi-st" id="yiyi-643"><span class="target" id="sqlalchemy.orm.events.SessionEvents.before_flush.params.instances"></span><strong>instances</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.orm.events.SessionEvents.before_flush.params.instances">&#xB6;</a> &#x2013; Usually <code class="docutils literal"><span class="pre">None</span></code>, this is the collection of objects which can be passed to the <a class="reference internal" href="session_api.html#sqlalchemy.orm.session.Session.flush" title="sqlalchemy.orm.session.Session.flush"><code class="xref py py-meth docutils literal"><span class="pre">Session.flush()</span></code></a> method (note this usage is deprecated).</span></li></ul></td></tr></tbody></table><div class="admonition seealso"><p class="first admonition-title"><span class="yiyi-st" id="yiyi-644">&#x4E5F;&#x53EF;&#x4EE5;&#x770B;&#x770B;</span></p><p><span class="yiyi-st" id="yiyi-645"><a class="reference internal" href="#sqlalchemy.orm.events.SessionEvents.after_flush" title="sqlalchemy.orm.events.SessionEvents.after_flush"><code class="xref py py-meth docutils literal"><span class="pre">after_flush()</span></code></a></span></p><p><span class="yiyi-st" id="yiyi-646"><a class="reference internal" href="#sqlalchemy.orm.events.SessionEvents.after_flush_postexec" title="sqlalchemy.orm.events.SessionEvents.after_flush_postexec"><code class="xref py py-meth docutils literal"><span class="pre">after_flush_postexec()</span></code></a></span></p><p class="last"><span class="yiyi-st" id="yiyi-647"><a class="reference internal" href="session_events.html#session-persistence-events"><span>Persistence Events</span></a></span></p></div></dd></dl><dl class="method"><dt id="sqlalchemy.orm.events.SessionEvents.deleted_to_detached"><span class="yiyi-st" id="yiyi-648"><code class="descname">deleted_to_detached</code> <span class="sig-paren">&#xFF08;</span> <em>session</em>&#xFF0C;<em>instance</em> <span class="sig-paren">&#xFF09;</span> <a class="headerlink" href="#sqlalchemy.orm.events.SessionEvents.deleted_to_detached" title="Permalink to this definition">&#xB6;</a></span></dt><dd><p><span class="yiyi-st" id="yiyi-649">&#x622A;&#x53D6;&#x7279;&#x5B9A;&#x5BF9;&#x8C61;&#x7684;&#x201C;&#x5DF2;&#x5220;&#x9664;&#x5230;&#x5DF2;&#x5206;&#x79BB;&#x201D;&#x8FC7;&#x6E21;&#x3002;</span></p><div class="event-signatures container"><p><span class="yiyi-st" id="yiyi-650">&#x793A;&#x4F8B;&#x53C2;&#x6570;&#x8868;&#x5355;&#xFF1A;</span></p><div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sqlalchemy</span> <span class="kn">import</span> <span class="n">event</span>

<span class="c1"># standard decorator style</span>
<span class="nd">@event.listens_for</span><span class="p">(</span><span class="n">SomeSessionOrFactory</span><span class="p">,</span> <span class="s1">&apos;deleted_to_detached&apos;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">receive_deleted_to_detached</span><span class="p">(</span><span class="n">session</span><span class="p">,</span> <span class="n">instance</span><span class="p">):</span>
    <span class="s2">&quot;listen for the &apos;deleted_to_detached&apos; event&quot;</span>

    <span class="c1"># ... (event handling logic) ...</span></pre></div></div></div><p><span class="yiyi-st" id="yiyi-651">&#x5F53;&#x4ECE;&#x4F1A;&#x8BDD;&#x4E2D;&#x5220;&#x9664;&#x5DF2;&#x5220;&#x9664;&#x7684;&#x5BF9;&#x8C61;&#x65F6;&#xFF0C;&#x5C06;&#x8C03;&#x7528;&#x6B64;&#x4E8B;&#x4EF6;&#x3002;</span><span class="yiyi-st" id="yiyi-652">&#x53D1;&#x751F;&#x8FD9;&#x79CD;&#x60C5;&#x51B5;&#x7684;&#x5178;&#x578B;&#x60C5;&#x51B5;&#x662F;&#xFF0C;&#x5F53;&#x5BF9;&#x8C61;&#x88AB;&#x5220;&#x9664;&#x7684;<a class="reference internal" href="session_api.html#sqlalchemy.orm.session.Session" title="sqlalchemy.orm.session.Session"><code class="xref py py-class docutils literal"><span class="pre">Session</span></code></a>&#x7684;&#x4E8B;&#x52A1;&#x88AB;&#x63D0;&#x4EA4;&#x65F6;&#xFF1B;&#x8BE5;&#x5BF9;&#x8C61;&#x4ECE;&#x5220;&#x9664;&#x72B6;&#x6001;&#x79FB;&#x81F3;&#x5206;&#x79BB;&#x72B6;&#x6001;&#x3002;</span></p><p><span class="yiyi-st" id="yiyi-653">&#x5F53;&#x8C03;&#x7528;<a class="reference internal" href="session_api.html#sqlalchemy.orm.session.Session.expunge_all" title="sqlalchemy.orm.session.Session.expunge_all"><code class="xref py py-meth docutils literal"><span class="pre">Session.expunge_all()</span></code></a>&#x6216;<a class="reference internal" href="session_api.html#sqlalchemy.orm.session.Session.close" title="sqlalchemy.orm.session.Session.close"><code class="xref py py-meth docutils literal"><span class="pre">Session.close()</span></code></a>&#x4E8B;&#x4EF6;&#x65F6;&#xFF0C;&#x4E5F;&#x4F1A;&#x8C03;&#x7528;&#x5728;flush&#x4E2D;&#x88AB;&#x5220;&#x9664;&#x7684;&#x5BF9;&#x8C61;&#xFF0C;&#x4EE5;&#x53CA;&#x5BF9;&#x8C61;&#x662F;&#x901A;&#x8FC7;<a class="reference internal" href="session_api.html#sqlalchemy.orm.session.Session.expunge" title="sqlalchemy.orm.session.Session.expunge"><code class="xref py py-meth docutils literal"><span class="pre">Session.expunge()</span></code></a>&#x5355;&#x72EC;&#x4ECE;&#x5220;&#x9664;&#x72B6;&#x6001;&#x4E2D;&#x5220;&#x9664;&#x3002;</span></p><div class="versionadded"><p><span class="yiyi-st" id="yiyi-654"><span class="versionmodified">&#x7248;&#x672C;1.1&#x4E2D;&#x7684;&#x65B0;&#x529F;&#x80FD;</span></span></p></div><div class="admonition seealso"><p class="first admonition-title"><span class="yiyi-st" id="yiyi-655">&#x4E5F;&#x53EF;&#x4EE5;&#x770B;&#x770B;</span></p><p class="last"><span class="yiyi-st" id="yiyi-656"><a class="reference internal" href="session_events.html#session-lifecycle-events"><span>Object Lifecycle Events</span></a></span></p></div></dd></dl><dl class="method"><dt id="sqlalchemy.orm.events.SessionEvents.deleted_to_persistent"><span class="yiyi-st" id="yiyi-657"><code class="descname">deleted_to_persistent</code> <span class="sig-paren">&#xFF08;</span> <em>session</em>&#xFF0C;<em>instance</em> <span class="sig-paren">&#xFF09;</span> <a class="headerlink" href="#sqlalchemy.orm.events.SessionEvents.deleted_to_persistent" title="Permalink to this definition">&#xB6;</a></span></dt><dd><p><span class="yiyi-st" id="yiyi-658">&#x622A;&#x53D6;&#x7279;&#x5B9A;&#x5BF9;&#x8C61;&#x7684;&#x201C;&#x5DF2;&#x5220;&#x9664;&#x5230;&#x6C38;&#x4E45;&#x201D;&#x8F6C;&#x6362;&#x3002;</span></p><div class="event-signatures container"><p><span class="yiyi-st" id="yiyi-659">&#x793A;&#x4F8B;&#x53C2;&#x6570;&#x8868;&#x5355;&#xFF1A;</span></p><div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sqlalchemy</span> <span class="kn">import</span> <span class="n">event</span>

<span class="c1"># standard decorator style</span>
<span class="nd">@event.listens_for</span><span class="p">(</span><span class="n">SomeSessionOrFactory</span><span class="p">,</span> <span class="s1">&apos;deleted_to_persistent&apos;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">receive_deleted_to_persistent</span><span class="p">(</span><span class="n">session</span><span class="p">,</span> <span class="n">instance</span><span class="p">):</span>
    <span class="s2">&quot;listen for the &apos;deleted_to_persistent&apos; event&quot;</span>

    <span class="c1"># ... (event handling logic) ...</span></pre></div></div></div><p><span class="yiyi-st" id="yiyi-660">&#x53EA;&#x6709;&#x5F53;&#x7531;&#x4E8E;&#x8C03;&#x7528;<a class="reference internal" href="session_api.html#sqlalchemy.orm.session.Session.rollback" title="sqlalchemy.orm.session.Session.rollback"><code class="xref py py-meth docutils literal"><span class="pre">Session.rollback()</span></code></a>&#x800C;&#x5728;&#x5237;&#x65B0;&#x4E2D;&#x6210;&#x529F;&#x5220;&#x9664;&#x7684;&#x5BF9;&#x8C61;&#x88AB;&#x6062;&#x590D;&#x65F6;&#xFF0C;&#x624D;&#x4F1A;&#x53D1;&#x751F;&#x6B64;&#x8F6C;&#x6362;&#x3002;</span><span class="yiyi-st" id="yiyi-661">&#x5728;&#x4EFB;&#x4F55;&#x5176;&#x4ED6;&#x60C5;&#x51B5;&#x4E0B;&#x4E0D;&#x4F1A;&#x8C03;&#x7528;&#x8BE5;&#x4E8B;&#x4EF6;&#x3002;</span></p><div class="versionadded"><p><span class="yiyi-st" id="yiyi-662"><span class="versionmodified">&#x7248;&#x672C;1.1&#x4E2D;&#x7684;&#x65B0;&#x529F;&#x80FD;</span></span></p></div><div class="admonition seealso"><p class="first admonition-title"><span class="yiyi-st" id="yiyi-663">&#x4E5F;&#x53EF;&#x4EE5;&#x770B;&#x770B;</span></p><p class="last"><span class="yiyi-st" id="yiyi-664"><a class="reference internal" href="session_events.html#session-lifecycle-events"><span>Object Lifecycle Events</span></a></span></p></div></dd></dl><dl class="method"><dt id="sqlalchemy.orm.events.SessionEvents.detached_to_persistent"><span class="yiyi-st" id="yiyi-665"><code class="descname">detached_to_persistent</code> <span class="sig-paren">&#xFF08;</span> <em>&#x4F1A;&#x8BDD;</em>&#xFF0C;<em>&#x5B9E;&#x4F8B;</em> <span class="sig-paren">&#xFF09;</span> <a class="headerlink" href="#sqlalchemy.orm.events.SessionEvents.detached_to_persistent" title="Permalink to this definition"></a></span></dt><dd><p><span class="yiyi-st" id="yiyi-666">&#x622A;&#x53D6;&#x7279;&#x5B9A;&#x5BF9;&#x8C61;&#x7684;&#x201C;&#x5206;&#x79BB;&#x5230;&#x6301;&#x7EED;&#x201D;&#x8F6C;&#x6362;&#x3002;</span></p><div class="event-signatures container"><p><span class="yiyi-st" id="yiyi-667">&#x793A;&#x4F8B;&#x53C2;&#x6570;&#x8868;&#x5355;&#xFF1A;</span></p><div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sqlalchemy</span> <span class="kn">import</span> <span class="n">event</span>

<span class="c1"># standard decorator style</span>
<span class="nd">@event.listens_for</span><span class="p">(</span><span class="n">SomeSessionOrFactory</span><span class="p">,</span> <span class="s1">&apos;detached_to_persistent&apos;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">receive_detached_to_persistent</span><span class="p">(</span><span class="n">session</span><span class="p">,</span> <span class="n">instance</span><span class="p">):</span>
    <span class="s2">&quot;listen for the &apos;detached_to_persistent&apos; event&quot;</span>

    <span class="c1"># ... (event handling logic) ...</span></pre></div></div></div><p><span class="yiyi-st" id="yiyi-668">&#x8FD9;&#x4E2A;&#x4E8B;&#x4EF6;&#x662F;<a class="reference internal" href="#sqlalchemy.orm.events.SessionEvents.after_attach" title="sqlalchemy.orm.events.SessionEvents.after_attach"><code class="xref py py-meth docutils literal"><span class="pre">SessionEvents.after_attach()</span></code></a>&#x4E8B;&#x4EF6;&#x7684;&#x4E00;&#x4E2A;&#x7279;&#x4F8B;&#xFF0C;&#x5B83;&#x53EA;&#x4E3A;&#x8FD9;&#x4E2A;&#x7279;&#x5B9A;&#x7684;&#x8F6C;&#x6362;&#x8C03;&#x7528;&#x3002;</span><span class="yiyi-st" id="yiyi-669">&#x5B83;&#x901A;&#x5E38;&#x5728;<a class="reference internal" href="session_api.html#sqlalchemy.orm.session.Session.add" title="sqlalchemy.orm.session.Session.add"><code class="xref py py-meth docutils literal"><span class="pre">Session.add()</span></code></a>&#x8C03;&#x7528;&#x671F;&#x95F4;&#x4EE5;&#x53CA;&#x5728;<a class="reference internal" href="session_api.html#sqlalchemy.orm.session.Session.delete" title="sqlalchemy.orm.session.Session.delete"><code class="xref py py-meth docutils literal"><span class="pre">Session.delete()</span></code></a>&#x8C03;&#x7528;&#x671F;&#x95F4;&#x8C03;&#x7528;&#xFF0C;&#x524D;&#x63D0;&#x662F;&#x5BF9;&#x8C61;&#x4E4B;&#x524D;&#x672A;&#x4E0E;<a class="reference internal" href="session_api.html#sqlalchemy.orm.session.Session" title="sqlalchemy.orm.session.Session"><code class="xref py py-class docutils literal"><span class="pre">Session</span></code></a>&#xFF08;&#x8BF7;&#x6CE8;&#x610F;&#xFF0C;&#x6807;&#x8BB0;&#x4E3A;&#x201C;&#x5DF2;&#x5220;&#x9664;&#x201D;&#x7684;&#x5BF9;&#x8C61;&#x5C06;&#x4FDD;&#x6301;&#x201C;&#x6301;&#x4E45;&#x201D;&#x72B6;&#x6001;&#xFF0C;&#x76F4;&#x5230;&#x5237;&#x65B0;&#x7ED3;&#x675F;&#xFF09;&#x3002;</span></p><div class="admonition note"><p class="first admonition-title"><span class="yiyi-st" id="yiyi-670">&#x6CE8;&#x610F;</span></p><p class="last"><span class="yiyi-st" id="yiyi-671">&#x5982;&#x679C;&#x8BE5;&#x5BF9;&#x8C61;&#x4F5C;&#x4E3A;&#x5BF9;<a class="reference internal" href="session_api.html#sqlalchemy.orm.session.Session.delete" title="sqlalchemy.orm.session.Session.delete"><code class="xref py py-meth docutils literal"><span class="pre">Session.delete()</span></code></a>&#x7684;&#x8C03;&#x7528;&#x7684;&#x4E00;&#x90E8;&#x5206;&#x800C;&#x6301;&#x4E45;&#x5316;&#xFF0C;&#x5219;&#x5728;&#x8C03;&#x7528;&#x6B64;&#x4E8B;&#x4EF6;&#x65F6;&#xFF0C;&#x8BE5;&#x5BF9;&#x8C61;<strong>&#x4E0D;&#x662F;</strong>&#xFF0C;&#x4F46;&#x6807;&#x8BB0;&#x4E3A;&#x5DF2;&#x5220;&#x9664;&#x3002;</span><span class="yiyi-st" id="yiyi-672">To detect deleted objects, check the <code class="docutils literal"><span class="pre">deleted</span></code> flag sent to the <a class="reference internal" href="#sqlalchemy.orm.events.SessionEvents.persistent_to_detached" title="sqlalchemy.orm.events.SessionEvents.persistent_to_detached"><code class="xref py py-meth docutils literal"><span class="pre">SessionEvents.persistent_to_detached()</span></code></a> to event after the flush proceeds, or check the <a class="reference internal" href="session_api.html#sqlalchemy.orm.session.Session.deleted" title="sqlalchemy.orm.session.Session.deleted"><code class="xref py py-attr docutils literal"><span class="pre">Session.deleted</span></code></a> collection within the <a class="reference internal" href="#sqlalchemy.orm.events.SessionEvents.before_flush" title="sqlalchemy.orm.events.SessionEvents.before_flush"><code class="xref py py-meth docutils literal"><span class="pre">SessionEvents.before_flush()</span></code></a> event if deleted objects need to be intercepted before the flush.</span></p></div><table class="docutils field-list" frame="void" rules="none"><tbody valign="top"><tr class="field-odd field"><th class="field-name"><span class="yiyi-st" id="yiyi-673">&#x53C2;&#x6570;&#xFF1A;</span></th><td class="field-body"><ul class="first last simple"><li><span class="yiyi-st" id="yiyi-674"><span class="target" id="sqlalchemy.orm.events.SessionEvents.detached_to_persistent.params.session"> tt&gt; <strong>&#x4F1A;&#x8BDD;</strong> <a class="paramlink headerlink reference internal" href="#sqlalchemy.orm.events.SessionEvents.detached_to_persistent.params.session">&#xB6;</a>  - &#x76EE;&#x6807;<a class="reference internal" href="session_api.html#sqlalchemy.orm.session.Session" title="sqlalchemy.orm.session.Session"><code class="xref py py-class docutils literal"><span class="pre">Session</span></code></a></span></span></li><li><span class="yiyi-st" id="yiyi-675"><span class="target" id="sqlalchemy.orm.events.SessionEvents.detached_to_persistent.params.instance"></span><strong>instance</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.orm.events.SessionEvents.detached_to_persistent.params.instance">&#xB6;</a> &#x2013; the ORM-mapped instance being operated upon.</span></li></ul></td></tr></tbody></table><div class="versionadded"><p><span class="yiyi-st" id="yiyi-676"><span class="versionmodified">&#x7248;&#x672C;1.1&#x4E2D;&#x7684;&#x65B0;&#x529F;&#x80FD;</span></span></p></div><div class="admonition seealso"><p class="first admonition-title"><span class="yiyi-st" id="yiyi-677">&#x4E5F;&#x53EF;&#x4EE5;&#x770B;&#x770B;</span></p><p class="last"><span class="yiyi-st" id="yiyi-678"><a class="reference internal" href="session_events.html#session-lifecycle-events"><span>Object Lifecycle Events</span></a></span></p></div></dd></dl><dl class="method"><dt id="sqlalchemy.orm.events.SessionEvents.loaded_as_persistent"><span class="yiyi-st" id="yiyi-679"><code class="descname">loaded_as_persistent</code> <span class="sig-paren">&#xFF08;</span> <em>&#x4F1A;&#x8BDD;</em>&#xFF0C;<em>&#x5B9E;&#x4F8B;</em> <span class="sig-paren">&#xFF09;</span> <a class="headerlink" href="#sqlalchemy.orm.events.SessionEvents.loaded_as_persistent" title="Permalink to this definition"></a></span></dt><dd><p><span class="yiyi-st" id="yiyi-680">&#x62E6;&#x622A;&#x7279;&#x5B9A;&#x5BF9;&#x8C61;&#x7684;&#x201C;&#x52A0;&#x8F7D;&#x4F5C;&#x4E3A;&#x6C38;&#x4E45;&#x201D;&#x8F6C;&#x6362;&#x3002;</span></p><div class="event-signatures container"><p><span class="yiyi-st" id="yiyi-681">&#x793A;&#x4F8B;&#x53C2;&#x6570;&#x8868;&#x5355;&#xFF1A;</span></p><div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sqlalchemy</span> <span class="kn">import</span> <span class="n">event</span>

<span class="c1"># standard decorator style</span>
<span class="nd">@event.listens_for</span><span class="p">(</span><span class="n">SomeSessionOrFactory</span><span class="p">,</span> <span class="s1">&apos;loaded_as_persistent&apos;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">receive_loaded_as_persistent</span><span class="p">(</span><span class="n">session</span><span class="p">,</span> <span class="n">instance</span><span class="p">):</span>
    <span class="s2">&quot;listen for the &apos;loaded_as_persistent&apos; event&quot;</span>

    <span class="c1"># ... (event handling logic) ...</span></pre></div></div></div><p><span class="yiyi-st" id="yiyi-682">&#x8BE5;&#x4E8B;&#x4EF6;&#x5728;ORM&#x52A0;&#x8F7D;&#x8FC7;&#x7A0B;&#x4E2D;&#x88AB;&#x8C03;&#x7528;&#xFF0C;&#x5E76;&#x4E14;&#x4E0E;<a class="reference internal" href="#sqlalchemy.orm.events.InstanceEvents.load" title="sqlalchemy.orm.events.InstanceEvents.load"><code class="xref py py-meth docutils literal"><span class="pre">InstanceEvents.load()</span></code></a>&#x4E8B;&#x4EF6;&#x975E;&#x5E38;&#x7C7B;&#x4F3C;&#x5730;&#x88AB;&#x8C03;&#x7528;&#x3002;</span><span class="yiyi-st" id="yiyi-683">&#x4F46;&#x662F;&#xFF0C;&#x6B64;&#x5904;&#x7684;&#x4E8B;&#x4EF6;&#x53EF;&#x4EE5;&#x94FE;&#x63A5;&#x5230;<a class="reference internal" href="session_api.html#sqlalchemy.orm.session.Session" title="sqlalchemy.orm.session.Session"><code class="xref py py-class docutils literal"><span class="pre">Session</span></code></a>&#x7C7B;&#x6216;&#x5B9E;&#x4F8B;&#xFF0C;&#x800C;&#x4E0D;&#x662F;&#x6620;&#x5C04;&#x5668;&#x6216;&#x7C7B;&#x5C42;&#x6B21;&#x7ED3;&#x6784;&#xFF0C;&#x5E76;&#x4E14;&#x53EF;&#x4EE5;&#x987A;&#x5229;&#x5730;&#x4E0E;&#x5176;&#x4ED6;&#x4F1A;&#x8BDD;&#x751F;&#x547D;&#x5468;&#x671F;&#x4E8B;&#x4EF6;&#x96C6;&#x6210;&#x3002;</span><span class="yiyi-st" id="yiyi-684">&#x5F53;&#x8BE5;&#x4E8B;&#x4EF6;&#x88AB;&#x8C03;&#x7528;&#x65F6;&#xFF0C;&#x8BE5;&#x5BF9;&#x8C61;&#x4FDD;&#x8BC1;&#x51FA;&#x73B0;&#x5728;&#x4F1A;&#x8BDD;&#x7684;&#x8EAB;&#x4EFD;&#x6620;&#x5C04;&#x4E2D;&#x3002;</span></p><table class="docutils field-list" frame="void" rules="none"><tbody valign="top"><tr class="field-odd field"><th class="field-name"><span class="yiyi-st" id="yiyi-685">&#x53C2;&#x6570;&#xFF1A;</span></th><td class="field-body"><ul class="first last simple"><li><span class="yiyi-st" id="yiyi-686"><span class="target" id="sqlalchemy.orm.events.SessionEvents.loaded_as_persistent.params.session"> tt&gt; <strong>&#x4F1A;&#x8BDD;</strong> <a class="paramlink headerlink reference internal" href="#sqlalchemy.orm.events.SessionEvents.loaded_as_persistent.params.session">&#xB6;</a>  - &#x76EE;&#x6807;<a class="reference internal" href="session_api.html#sqlalchemy.orm.session.Session" title="sqlalchemy.orm.session.Session"><code class="xref py py-class docutils literal"><span class="pre">Session</span></code></a></span></span></li><li><span class="yiyi-st" id="yiyi-687"><span class="target" id="sqlalchemy.orm.events.SessionEvents.loaded_as_persistent.params.instance"></span><strong>instance</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.orm.events.SessionEvents.loaded_as_persistent.params.instance">&#xB6;</a> &#x2013; the ORM-mapped instance being operated upon.</span></li></ul></td></tr></tbody></table><div class="versionadded"><p><span class="yiyi-st" id="yiyi-688"><span class="versionmodified">&#x7248;&#x672C;1.1&#x4E2D;&#x7684;&#x65B0;&#x529F;&#x80FD;</span></span></p></div><div class="admonition seealso"><p class="first admonition-title"><span class="yiyi-st" id="yiyi-689">&#x4E5F;&#x53EF;&#x4EE5;&#x770B;&#x770B;</span></p><p class="last"><span class="yiyi-st" id="yiyi-690"><a class="reference internal" href="session_events.html#session-lifecycle-events"><span>Object Lifecycle Events</span></a></span></p></div></dd></dl><dl class="method"><dt id="sqlalchemy.orm.events.SessionEvents.pending_to_persistent"><span class="yiyi-st" id="yiyi-691"><code class="descname">pending_to_persistent</code> <span class="sig-paren">&#xFF08;</span> <em>&#x4F1A;&#x8BDD;</em>&#xFF0C;<em>&#x5B9E;&#x4F8B;</em> <span class="sig-paren">&#xFF09;</span> <a class="headerlink" href="#sqlalchemy.orm.events.SessionEvents.pending_to_persistent" title="Permalink to this definition">&#xB6;</a></span></dt><dd><p><span class="yiyi-st" id="yiyi-692">&#x622A;&#x53D6;&#x7279;&#x5B9A;&#x5BF9;&#x8C61;&#x7684;&#x201C;&#x6302;&#x8D77;&#x5230;&#x6301;&#x7EED;&#x201D;&#x8F6C;&#x6362;&#x3002;</span></p><div class="event-signatures container"><p><span class="yiyi-st" id="yiyi-693">&#x793A;&#x4F8B;&#x53C2;&#x6570;&#x8868;&#x5355;&#xFF1A;</span></p><div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sqlalchemy</span> <span class="kn">import</span> <span class="n">event</span>

<span class="c1"># standard decorator style</span>
<span class="nd">@event.listens_for</span><span class="p">(</span><span class="n">SomeSessionOrFactory</span><span class="p">,</span> <span class="s1">&apos;pending_to_persistent&apos;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">receive_pending_to_persistent</span><span class="p">(</span><span class="n">session</span><span class="p">,</span> <span class="n">instance</span><span class="p">):</span>
    <span class="s2">&quot;listen for the &apos;pending_to_persistent&apos; event&quot;</span>

    <span class="c1"># ... (event handling logic) ...</span></pre></div></div></div><p><span class="yiyi-st" id="yiyi-694">&#x8BE5;&#x4E8B;&#x4EF6;&#x5728;&#x5237;&#x65B0;&#x8FC7;&#x7A0B;&#x4E2D;&#x88AB;&#x8C03;&#x7528;&#xFF0C;&#x7C7B;&#x4F3C;&#x4E8E;&#x5728;<a class="reference internal" href="#sqlalchemy.orm.events.SessionEvents.after_flush" title="sqlalchemy.orm.events.SessionEvents.after_flush"><code class="xref py py-meth docutils literal"><span class="pre">SessionEvents.after_flush()</span></code></a>&#x4E8B;&#x4EF6;&#x4E2D;&#x626B;&#x63CF;<a class="reference internal" href="session_api.html#sqlalchemy.orm.session.Session.new" title="sqlalchemy.orm.session.Session.new"><code class="xref py py-attr docutils literal"><span class="pre">Session.new</span></code></a>&#x96C6;&#x5408;&#x3002;</span><span class="yiyi-st" id="yiyi-695">&#x4F46;&#x662F;&#xFF0C;&#x5728;&#x8FD9;&#x79CD;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;&#x5F53;&#x4E8B;&#x4EF6;&#x88AB;&#x8C03;&#x7528;&#x65F6;&#xFF0C;&#x5BF9;&#x8C61;&#x5DF2;&#x7ECF;&#x79FB;&#x81F3;&#x6301;&#x4E45;&#x72B6;&#x6001;&#x3002;</span></p><table class="docutils field-list" frame="void" rules="none"><tbody valign="top"><tr class="field-odd field"><th class="field-name"><span class="yiyi-st" id="yiyi-696">&#x53C2;&#x6570;&#xFF1A;</span></th><td class="field-body"><ul class="first last simple"><li><span class="yiyi-st" id="yiyi-697"><span class="target" id="sqlalchemy.orm.events.SessionEvents.pending_to_persistent.params.session"> tt&gt; <strong>&#x4F1A;&#x8BDD;</strong> <a class="paramlink headerlink reference internal" href="#sqlalchemy.orm.events.SessionEvents.pending_to_persistent.params.session">&#xB6;</a>  - &#x76EE;&#x6807;<a class="reference internal" href="session_api.html#sqlalchemy.orm.session.Session" title="sqlalchemy.orm.session.Session"><code class="xref py py-class docutils literal"><span class="pre">Session</span></code></a></span></span></li><li><span class="yiyi-st" id="yiyi-698"><span class="target" id="sqlalchemy.orm.events.SessionEvents.pending_to_persistent.params.instance"></span><strong>instance</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.orm.events.SessionEvents.pending_to_persistent.params.instance">&#xB6;</a> &#x2013; the ORM-mapped instance being operated upon.</span></li></ul></td></tr></tbody></table><div class="versionadded"><p><span class="yiyi-st" id="yiyi-699"><span class="versionmodified">&#x7248;&#x672C;1.1&#x4E2D;&#x7684;&#x65B0;&#x529F;&#x80FD;</span></span></p></div><div class="admonition seealso"><p class="first admonition-title"><span class="yiyi-st" id="yiyi-700">&#x4E5F;&#x53EF;&#x4EE5;&#x770B;&#x770B;</span></p><p class="last"><span class="yiyi-st" id="yiyi-701"><a class="reference internal" href="session_events.html#session-lifecycle-events"><span>Object Lifecycle Events</span></a></span></p></div></dd></dl><dl class="method"><dt id="sqlalchemy.orm.events.SessionEvents.pending_to_transient"><span class="yiyi-st" id="yiyi-702"><code class="descname">pending_to_transient</code> <span class="sig-paren">&#xFF08;</span> <em>&#x4F1A;&#x8BDD;</em>&#xFF0C;<em>&#x5B9E;&#x4F8B;</em> <span class="sig-paren">&#xFF09;</span> <a class="headerlink" href="#sqlalchemy.orm.events.SessionEvents.pending_to_transient" title="Permalink to this definition"></a></span></dt><dd><p><span class="yiyi-st" id="yiyi-703">&#x622A;&#x53D6;&#x7279;&#x5B9A;&#x5BF9;&#x8C61;&#x7684;&#x201C;&#x7B49;&#x5F85;&#x5230;&#x77AC;&#x6001;&#x201D;&#x8F6C;&#x6362;&#x3002;</span></p><div class="event-signatures container"><p><span class="yiyi-st" id="yiyi-704">&#x793A;&#x4F8B;&#x53C2;&#x6570;&#x8868;&#x5355;&#xFF1A;</span></p><div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sqlalchemy</span> <span class="kn">import</span> <span class="n">event</span>

<span class="c1"># standard decorator style</span>
<span class="nd">@event.listens_for</span><span class="p">(</span><span class="n">SomeSessionOrFactory</span><span class="p">,</span> <span class="s1">&apos;pending_to_transient&apos;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">receive_pending_to_transient</span><span class="p">(</span><span class="n">session</span><span class="p">,</span> <span class="n">instance</span><span class="p">):</span>
    <span class="s2">&quot;listen for the &apos;pending_to_transient&apos; event&quot;</span>

    <span class="c1"># ... (event handling logic) ...</span></pre></div></div></div><p><span class="yiyi-st" id="yiyi-705">&#x5F53;&#x6CA1;&#x6709;&#x88AB;&#x5237;&#x65B0;&#x7684;&#x5F85;&#x5904;&#x7406;&#x5BF9;&#x8C61;&#x88AB;&#x4ECE;&#x4F1A;&#x8BDD;&#x4E2D;&#x9010;&#x51FA;&#x65F6;&#xFF0C;&#x53D1;&#x751F;&#x8FD9;&#x79CD;&#x4E0D;&#x592A;&#x5E38;&#x89C1;&#x7684;&#x8F6C;&#x6362;&#xFF1B;&#x5F53;<a class="reference internal" href="session_api.html#sqlalchemy.orm.session.Session.rollback" title="sqlalchemy.orm.session.Session.rollback"><code class="xref py py-meth docutils literal"><span class="pre">Session.rollback()</span></code></a>&#x65B9;&#x6CD5;&#x56DE;&#x9000;&#x4E8B;&#x52A1;&#x6216;&#x4F7F;&#x7528;<a class="reference internal" href="session_api.html#sqlalchemy.orm.session.Session.expunge" title="sqlalchemy.orm.session.Session.expunge"><code class="xref py py-meth docutils literal"><span class="pre">Session.expunge()</span></code></a>&#x65B9;&#x6CD5;&#x65F6;&#xFF0C;&#x4F1A;&#x53D1;&#x751F;&#x8FD9;&#x79CD;&#x60C5;&#x51B5;&#x3002;</span></p><table class="docutils field-list" frame="void" rules="none"><tbody valign="top"><tr class="field-odd field"><th class="field-name"><span class="yiyi-st" id="yiyi-706">&#x53C2;&#x6570;&#xFF1A;</span></th><td class="field-body"><ul class="first last simple"><li><span class="yiyi-st" id="yiyi-707"><span class="target" id="sqlalchemy.orm.events.SessionEvents.pending_to_transient.params.session"> tt&gt; <strong>&#x4F1A;&#x8BDD;</strong> <a class="paramlink headerlink reference internal" href="#sqlalchemy.orm.events.SessionEvents.pending_to_transient.params.session">&#xB6;</a>  - &#x76EE;&#x6807;<a class="reference internal" href="session_api.html#sqlalchemy.orm.session.Session" title="sqlalchemy.orm.session.Session"><code class="xref py py-class docutils literal"><span class="pre">Session</span></code></a></span></span></li><li><span class="yiyi-st" id="yiyi-708"><span class="target" id="sqlalchemy.orm.events.SessionEvents.pending_to_transient.params.instance"></span><strong>instance</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.orm.events.SessionEvents.pending_to_transient.params.instance">&#xB6;</a> &#x2013; the ORM-mapped instance being operated upon.</span></li></ul></td></tr></tbody></table><div class="versionadded"><p><span class="yiyi-st" id="yiyi-709"><span class="versionmodified">&#x7248;&#x672C;1.1&#x4E2D;&#x7684;&#x65B0;&#x529F;&#x80FD;</span></span></p></div><div class="admonition seealso"><p class="first admonition-title"><span class="yiyi-st" id="yiyi-710">&#x4E5F;&#x53EF;&#x4EE5;&#x770B;&#x770B;</span></p><p class="last"><span class="yiyi-st" id="yiyi-711"><a class="reference internal" href="session_events.html#session-lifecycle-events"><span>Object Lifecycle Events</span></a></span></p></div></dd></dl><dl class="method"><dt id="sqlalchemy.orm.events.SessionEvents.persistent_to_deleted"><span class="yiyi-st" id="yiyi-712"><code class="descname">persistent_to_deleted</code> <span class="sig-paren">&#xFF08;</span> <em>session</em>&#xFF0C;<em>instance</em> <span class="sig-paren">&#xFF09;</span> <a class="headerlink" href="#sqlalchemy.orm.events.SessionEvents.persistent_to_deleted" title="Permalink to this definition"></a></span></dt><dd><p><span class="yiyi-st" id="yiyi-713">&#x622A;&#x53D6;&#x7279;&#x5B9A;&#x5BF9;&#x8C61;&#x7684;&#x201C;&#x6C38;&#x4E45;&#x5220;&#x9664;&#x201D;&#x8F6C;&#x6362;&#x3002;</span></p><div class="event-signatures container"><p><span class="yiyi-st" id="yiyi-714">&#x793A;&#x4F8B;&#x53C2;&#x6570;&#x8868;&#x5355;&#xFF1A;</span></p><div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sqlalchemy</span> <span class="kn">import</span> <span class="n">event</span>

<span class="c1"># standard decorator style</span>
<span class="nd">@event.listens_for</span><span class="p">(</span><span class="n">SomeSessionOrFactory</span><span class="p">,</span> <span class="s1">&apos;persistent_to_deleted&apos;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">receive_persistent_to_deleted</span><span class="p">(</span><span class="n">session</span><span class="p">,</span> <span class="n">instance</span><span class="p">):</span>
    <span class="s2">&quot;listen for the &apos;persistent_to_deleted&apos; event&quot;</span>

    <span class="c1"># ... (event handling logic) ...</span></pre></div></div></div><p><span class="yiyi-st" id="yiyi-715">&#x5F53;&#x4E00;&#x4E2A;&#x6301;&#x4E45;&#x5316;&#x5BF9;&#x8C61;&#x7684;&#x6807;&#x8BC6;&#x4ECE;flush&#x4E2D;&#x7684;&#x6570;&#x636E;&#x5E93;&#x4E2D;&#x88AB;&#x5220;&#x9664;&#x65F6;&#xFF0C;&#x8BE5;&#x4E8B;&#x4EF6;&#x88AB;&#x8C03;&#x7528;&#xFF0C;&#x4F46;&#x662F;&#x8BE5;&#x5BF9;&#x8C61;&#x5728;&#x4E8B;&#x52A1;&#x5B8C;&#x6210;&#x4E4B;&#x524D;&#x4ECD;&#x7136;&#x4E0E;<a class="reference internal" href="session_api.html#sqlalchemy.orm.session.Session" title="sqlalchemy.orm.session.Session"><code class="xref py py-class docutils literal"><span class="pre">Session</span></code></a>&#x5173;&#x8054;&#x3002;</span></p><p><span class="yiyi-st" id="yiyi-716">&#x5982;&#x679C;&#x4E8B;&#x52A1;&#x56DE;&#x6EDA;&#xFF0C;&#x5219;&#x5BF9;&#x8C61;&#x518D;&#x6B21;&#x79FB;&#x81F3;&#x6301;&#x4E45;&#x72B6;&#x6001;&#xFF0C;&#x5E76;&#x8C03;&#x7528;<a class="reference internal" href="#sqlalchemy.orm.events.SessionEvents.deleted_to_persistent" title="sqlalchemy.orm.events.SessionEvents.deleted_to_persistent"><code class="xref py py-meth docutils literal"><span class="pre">SessionEvents.deleted_to_persistent()</span></code></a>&#x4E8B;&#x4EF6;&#x3002;</span><span class="yiyi-st" id="yiyi-717">&#x5982;&#x679C;&#x4E8B;&#x52A1;&#x5DF2;&#x63D0;&#x4EA4;&#xFF0C;&#x5219;&#x8BE5;&#x5BF9;&#x8C61;&#x5C06;&#x5206;&#x79BB;&#xFF0C;&#x8FD9;&#x5C06;&#x53D1;&#x51FA;<a class="reference internal" href="#sqlalchemy.orm.events.SessionEvents.deleted_to_detached" title="sqlalchemy.orm.events.SessionEvents.deleted_to_detached"><code class="xref py py-meth docutils literal"><span class="pre">SessionEvents.deleted_to_detached()</span></code></a>&#x4E8B;&#x4EF6;&#x3002;</span></p><p><span class="yiyi-st" id="yiyi-718">&#x8BF7;&#x6CE8;&#x610F;&#xFF0C;&#x867D;&#x7136;<a class="reference internal" href="session_api.html#sqlalchemy.orm.session.Session.delete" title="sqlalchemy.orm.session.Session.delete"><code class="xref py py-meth docutils literal"><span class="pre">Session.delete()</span></code></a>&#x65B9;&#x6CD5;&#x662F;&#x5C06;&#x5BF9;&#x8C61;&#x6807;&#x8BB0;&#x4E3A;&#x5DF2;&#x5220;&#x9664;&#x7684;&#x4E3B;&#x8981;&#x516C;&#x5171;&#x63A5;&#x53E3;&#xFF0C;&#x4F46;&#x7531;&#x4E8E;&#x7EA7;&#x8054;&#x89C4;&#x5219;&#x800C;&#x5BFC;&#x81F4;&#x8BB8;&#x591A;&#x5BF9;&#x8C61;&#x88AB;&#x5220;&#x9664;&#xFF0C;&#x76F4;&#x5230;&#x5237;&#x65B0;&#x65F6;&#x95F4;&#x624D;&#x4F1A;&#x786E;&#x5B9A;&#x8BE5;&#x5BF9;&#x8C61;&#x3002;</span><span class="yiyi-st" id="yiyi-719">&#x56E0;&#x6B64;&#xFF0C;&#x5728;&#x6E05;&#x9664;&#x8FDB;&#x884C;&#x4E4B;&#x524D;&#xFF0C;&#x6CA1;&#x6709;&#x529E;&#x6CD5;&#x6355;&#x83B7;&#x6BCF;&#x4E2A;&#x5C06;&#x88AB;&#x5220;&#x9664;&#x7684;&#x5BF9;&#x8C61;&#x3002;</span><span class="yiyi-st" id="yiyi-720">&#x56E0;&#x6B64;&#xFF0C;<a class="reference internal" href="#sqlalchemy.orm.events.SessionEvents.persistent_to_deleted" title="sqlalchemy.orm.events.SessionEvents.persistent_to_deleted"><code class="xref py py-meth docutils literal"><span class="pre">SessionEvents.persistent_to_deleted()</span></code></a>&#x4E8B;&#x4EF6;&#x5728;&#x5237;&#x65B0;&#x7ED3;&#x675F;&#x65F6;&#x88AB;&#x8C03;&#x7528;&#x3002;</span></p><div class="versionadded"><p><span class="yiyi-st" id="yiyi-721"><span class="versionmodified">&#x7248;&#x672C;1.1&#x4E2D;&#x7684;&#x65B0;&#x529F;&#x80FD;</span></span></p></div><div class="admonition seealso"><p class="first admonition-title"><span class="yiyi-st" id="yiyi-722">&#x4E5F;&#x53EF;&#x4EE5;&#x770B;&#x770B;</span></p><p class="last"><span class="yiyi-st" id="yiyi-723"><a class="reference internal" href="session_events.html#session-lifecycle-events"><span>Object Lifecycle Events</span></a></span></p></div></dd></dl><dl class="method"><dt id="sqlalchemy.orm.events.SessionEvents.persistent_to_detached"><span class="yiyi-st" id="yiyi-724"><code class="descname">persistent_to_detached</code> <span class="sig-paren">&#xFF08;</span> <em>&#x4F1A;&#x8BDD;</em>&#xFF0C;<em>&#x5B9E;&#x4F8B;</em> <span class="sig-paren">&#xFF09;</span> <a class="headerlink" href="#sqlalchemy.orm.events.SessionEvents.persistent_to_detached" title="Permalink to this definition">&#xB6;</a></span></dt><dd><p><span class="yiyi-st" id="yiyi-725">&#x622A;&#x53D6;&#x7279;&#x5B9A;&#x5BF9;&#x8C61;&#x7684;&#x201C;&#x6301;&#x7EED;&#x5230;&#x5206;&#x79BB;&#x201D;&#x8F6C;&#x6362;&#x3002;</span></p><div class="event-signatures container"><p><span class="yiyi-st" id="yiyi-726">&#x793A;&#x4F8B;&#x53C2;&#x6570;&#x8868;&#x5355;&#xFF1A;</span></p><div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sqlalchemy</span> <span class="kn">import</span> <span class="n">event</span>

<span class="c1"># standard decorator style</span>
<span class="nd">@event.listens_for</span><span class="p">(</span><span class="n">SomeSessionOrFactory</span><span class="p">,</span> <span class="s1">&apos;persistent_to_detached&apos;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">receive_persistent_to_detached</span><span class="p">(</span><span class="n">session</span><span class="p">,</span> <span class="n">instance</span><span class="p">):</span>
    <span class="s2">&quot;listen for the &apos;persistent_to_detached&apos; event&quot;</span>

    <span class="c1"># ... (event handling logic) ...</span></pre></div></div></div><p><span class="yiyi-st" id="yiyi-727">&#x5F53;&#x6301;&#x4E45;&#x5BF9;&#x8C61;&#x4ECE;&#x4F1A;&#x8BDD;&#x4E2D;&#x88AB;&#x9A71;&#x9010;&#x65F6;&#xFF0C;&#x4F1A;&#x8C03;&#x7528;&#x6B64;&#x4E8B;&#x4EF6;&#x3002;</span><span class="yiyi-st" id="yiyi-728">&#x5BFC;&#x81F4;&#x8FD9;&#x79CD;&#x60C5;&#x51B5;&#x53D1;&#x751F;&#x7684;&#x6761;&#x4EF6;&#x5F88;&#x591A;&#xFF0C;&#x5305;&#x62EC;&#xFF1A;</span></p><ul class="simple"><li><span class="yiyi-st" id="yiyi-729">&#x4F7F;&#x7528;&#x8BF8;&#x5982;<a class="reference internal" href="session_api.html#sqlalchemy.orm.session.Session.expunge" title="sqlalchemy.orm.session.Session.expunge"><code class="xref py py-meth docutils literal"><span class="pre">Session.expunge()</span></code></a>&#x6216;<a class="reference internal" href="session_api.html#sqlalchemy.orm.session.Session.close" title="sqlalchemy.orm.session.Session.close"><code class="xref py py-meth docutils literal"><span class="pre">Session.close()</span></code></a>&#x7B49;&#x65B9;&#x6CD5;</span></li><li><span class="yiyi-st" id="yiyi-730">&#x5F53;&#x5BF9;&#x8C61;&#x662F;&#x8BE5;&#x4F1A;&#x8BDD;&#x4E8B;&#x52A1;&#x7684;INSERT&#x8BED;&#x53E5;&#x7684;&#x4E00;&#x90E8;&#x5206;&#x65F6;&#xFF0C;&#x8C03;&#x7528;<a class="reference internal" href="session_api.html#sqlalchemy.orm.session.Session.rollback" title="sqlalchemy.orm.session.Session.rollback"><code class="xref py py-meth docutils literal"><span class="pre">Session.rollback()</span></code></a>&#x65B9;&#x6CD5;</span></li></ul><table class="docutils field-list" frame="void" rules="none"><tbody valign="top"><tr class="field-odd field"><th class="field-name"><span class="yiyi-st" id="yiyi-731">&#x53C2;&#x6570;&#xFF1A;</span></th><td class="field-body"><ul class="first last simple"><li><span class="yiyi-st" id="yiyi-732"><span class="target" id="sqlalchemy.orm.events.SessionEvents.persistent_to_detached.params.session"> tt&gt; <strong>&#x4F1A;&#x8BDD;</strong> <a class="paramlink headerlink reference internal" href="#sqlalchemy.orm.events.SessionEvents.persistent_to_detached.params.session">&#xB6;</a>  - &#x76EE;&#x6807;<a class="reference internal" href="session_api.html#sqlalchemy.orm.session.Session" title="sqlalchemy.orm.session.Session"><code class="xref py py-class docutils literal"><span class="pre">Session</span></code></a></span></span></li><li><span class="yiyi-st" id="yiyi-733"><span class="target" id="sqlalchemy.orm.events.SessionEvents.persistent_to_detached.params.instance"></span><strong>instance</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.orm.events.SessionEvents.persistent_to_detached.params.instance">&#xB6;</a> &#x2013; the ORM-mapped instance being operated upon.</span></li><li><span class="yiyi-st" id="yiyi-734"><span class="target" id="sqlalchemy.orm.events.SessionEvents.persistent_to_detached.params.deleted"></span> <strong>&#x5DF2;&#x5220;&#x9664;</strong> <a class="paramlink headerlink reference internal" href="#sqlalchemy.orm.events.SessionEvents.persistent_to_detached.params.deleted">&#xB6;</a>  - &#x5E03;&#x5C14;&#x503C;&#x3002;</span><span class="yiyi-st" id="yiyi-735">&#x5982;&#x679C;&#x4E3A;True&#xFF0C;&#x5219;&#x8868;&#x793A;&#x6B64;&#x5BF9;&#x8C61;&#x5DF2;&#x79FB;&#x81F3;&#x5206;&#x79BB;&#x72B6;&#x6001;&#xFF0C;&#x56E0;&#x4E3A;&#x5B83;&#x5DF2;&#x6807;&#x8BB0;&#x4E3A;&#x5DF2;&#x5220;&#x9664;&#x5E76;&#x5DF2;&#x5237;&#x65B0;&#x3002;</span></li></ul></td></tr></tbody></table><div class="versionadded"><p><span class="yiyi-st" id="yiyi-736"><span class="versionmodified">&#x7248;&#x672C;1.1&#x4E2D;&#x7684;&#x65B0;&#x529F;&#x80FD;</span></span></p></div><div class="admonition seealso"><p class="first admonition-title"><span class="yiyi-st" id="yiyi-737">&#x4E5F;&#x53EF;&#x4EE5;&#x770B;&#x770B;</span></p><p class="last"><span class="yiyi-st" id="yiyi-738"><a class="reference internal" href="session_events.html#session-lifecycle-events"><span>Object Lifecycle Events</span></a></span></p></div></dd></dl><dl class="method"><dt id="sqlalchemy.orm.events.SessionEvents.persistent_to_transient"><span class="yiyi-st" id="yiyi-739"><code class="descname">persistent_to_transient</code> <span class="sig-paren">&#xFF08;</span> <em>session</em>&#xFF0C;<em>instance</em> <span class="sig-paren">&#xFF09;</span> <a class="headerlink" href="#sqlalchemy.orm.events.SessionEvents.persistent_to_transient" title="Permalink to this definition">&#xB6;</a></span></dt><dd><p><span class="yiyi-st" id="yiyi-740">&#x622A;&#x53D6;&#x7279;&#x5B9A;&#x5BF9;&#x8C61;&#x7684;&#x201C;&#x6301;&#x4E45;&#x5230;&#x77AC;&#x6001;&#x201D;&#x8F6C;&#x6362;&#x3002;</span></p><div class="event-signatures container"><p><span class="yiyi-st" id="yiyi-741">&#x793A;&#x4F8B;&#x53C2;&#x6570;&#x8868;&#x5355;&#xFF1A;</span></p><div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sqlalchemy</span> <span class="kn">import</span> <span class="n">event</span>

<span class="c1"># standard decorator style</span>
<span class="nd">@event.listens_for</span><span class="p">(</span><span class="n">SomeSessionOrFactory</span><span class="p">,</span> <span class="s1">&apos;persistent_to_transient&apos;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">receive_persistent_to_transient</span><span class="p">(</span><span class="n">session</span><span class="p">,</span> <span class="n">instance</span><span class="p">):</span>
    <span class="s2">&quot;listen for the &apos;persistent_to_transient&apos; event&quot;</span>

    <span class="c1"># ... (event handling logic) ...</span></pre></div></div></div><p><span class="yiyi-st" id="yiyi-742">&#x5F53;&#x5DF2;&#x7ECF;&#x5237;&#x65B0;&#x7684;&#x5F85;&#x5904;&#x7406;&#x5BF9;&#x8C61;&#x88AB;&#x4ECE;&#x4F1A;&#x8BDD;&#x4E2D;&#x9010;&#x51FA;&#x65F6;&#xFF0C;&#x53D1;&#x751F;&#x8FD9;&#x79CD;&#x4E0D;&#x592A;&#x5E38;&#x89C1;&#x7684;&#x8F6C;&#x6362;&#xFF1B;&#x5F53;<a class="reference internal" href="session_api.html#sqlalchemy.orm.session.Session.rollback" title="sqlalchemy.orm.session.Session.rollback"><code class="xref py py-meth docutils literal"><span class="pre">Session.rollback()</span></code></a>&#x65B9;&#x6CD5;&#x56DE;&#x9000;&#x4E8B;&#x52A1;&#x65F6;&#x53EF;&#x80FD;&#x53D1;&#x751F;&#x8FD9;&#x79CD;&#x60C5;&#x51B5;&#x3002;</span></p><table class="docutils field-list" frame="void" rules="none"><tbody valign="top"><tr class="field-odd field"><th class="field-name"><span class="yiyi-st" id="yiyi-743">&#x53C2;&#x6570;&#xFF1A;</span></th><td class="field-body"><ul class="first last simple"><li><span class="yiyi-st" id="yiyi-744"><span class="target" id="sqlalchemy.orm.events.SessionEvents.persistent_to_transient.params.session"> tt&gt; <strong>&#x4F1A;&#x8BDD;</strong> <a class="paramlink headerlink reference internal" href="#sqlalchemy.orm.events.SessionEvents.persistent_to_transient.params.session">&#xB6;</a>  - &#x76EE;&#x6807;<a class="reference internal" href="session_api.html#sqlalchemy.orm.session.Session" title="sqlalchemy.orm.session.Session"><code class="xref py py-class docutils literal"><span class="pre">Session</span></code></a></span></span></li><li><span class="yiyi-st" id="yiyi-745"><span class="target" id="sqlalchemy.orm.events.SessionEvents.persistent_to_transient.params.instance"></span><strong>instance</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.orm.events.SessionEvents.persistent_to_transient.params.instance">&#xB6;</a> &#x2013; the ORM-mapped instance being operated upon.</span></li></ul></td></tr></tbody></table><div class="versionadded"><p><span class="yiyi-st" id="yiyi-746"><span class="versionmodified">&#x7248;&#x672C;1.1&#x4E2D;&#x7684;&#x65B0;&#x529F;&#x80FD;</span></span></p></div><div class="admonition seealso"><p class="first admonition-title"><span class="yiyi-st" id="yiyi-747">&#x4E5F;&#x53EF;&#x4EE5;&#x770B;&#x770B;</span></p><p class="last"><span class="yiyi-st" id="yiyi-748"><a class="reference internal" href="session_events.html#session-lifecycle-events"><span>Object Lifecycle Events</span></a></span></p></div></dd></dl><dl class="method"><dt id="sqlalchemy.orm.events.SessionEvents.transient_to_pending"><span class="yiyi-st" id="yiyi-749"><code class="descname">transient_to_pending</code> <span class="sig-paren">&#xFF08;</span> <em>session</em>&#xFF0C;<em>instance</em> <span class="sig-paren">&#xFF09;</span> <a class="headerlink" href="#sqlalchemy.orm.events.SessionEvents.transient_to_pending" title="Permalink to this definition">&#xB6;</a></span></dt><dd><p><span class="yiyi-st" id="yiyi-750">&#x622A;&#x53D6;&#x7279;&#x5B9A;&#x5BF9;&#x8C61;&#x7684;&#x201C;&#x6682;&#x6001;&#x5230;&#x6682;&#x6302;&#x201D;&#x8F6C;&#x6362;&#x3002;</span></p><div class="event-signatures container"><p><span class="yiyi-st" id="yiyi-751">&#x793A;&#x4F8B;&#x53C2;&#x6570;&#x8868;&#x5355;&#xFF1A;</span></p><div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sqlalchemy</span> <span class="kn">import</span> <span class="n">event</span>

<span class="c1"># standard decorator style</span>
<span class="nd">@event.listens_for</span><span class="p">(</span><span class="n">SomeSessionOrFactory</span><span class="p">,</span> <span class="s1">&apos;transient_to_pending&apos;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">receive_transient_to_pending</span><span class="p">(</span><span class="n">session</span><span class="p">,</span> <span class="n">instance</span><span class="p">):</span>
    <span class="s2">&quot;listen for the &apos;transient_to_pending&apos; event&quot;</span>

    <span class="c1"># ... (event handling logic) ...</span></pre></div></div></div><p><span class="yiyi-st" id="yiyi-752">&#x8FD9;&#x4E2A;&#x4E8B;&#x4EF6;&#x662F;<a class="reference internal" href="#sqlalchemy.orm.events.SessionEvents.after_attach" title="sqlalchemy.orm.events.SessionEvents.after_attach"><code class="xref py py-meth docutils literal"><span class="pre">SessionEvents.after_attach()</span></code></a>&#x4E8B;&#x4EF6;&#x7684;&#x4E00;&#x4E2A;&#x7279;&#x4F8B;&#xFF0C;&#x5B83;&#x53EA;&#x4E3A;&#x8FD9;&#x4E2A;&#x7279;&#x5B9A;&#x7684;&#x8F6C;&#x6362;&#x8C03;&#x7528;&#x3002;</span><span class="yiyi-st" id="yiyi-753">&#x5B83;&#x901A;&#x5E38;&#x5728;<a class="reference internal" href="session_api.html#sqlalchemy.orm.session.Session.add" title="sqlalchemy.orm.session.Session.add"><code class="xref py py-meth docutils literal"><span class="pre">Session.add()</span></code></a>&#x8C03;&#x7528;&#x671F;&#x95F4;&#x8C03;&#x7528;&#x3002;</span></p><table class="docutils field-list" frame="void" rules="none"><tbody valign="top"><tr class="field-odd field"><th class="field-name"><span class="yiyi-st" id="yiyi-754">&#x53C2;&#x6570;&#xFF1A;</span></th><td class="field-body"><ul class="first last simple"><li><span class="yiyi-st" id="yiyi-755"><span class="target" id="sqlalchemy.orm.events.SessionEvents.transient_to_pending.params.session"> tt&gt; <strong>&#x4F1A;&#x8BDD;</strong> <a class="paramlink headerlink reference internal" href="#sqlalchemy.orm.events.SessionEvents.transient_to_pending.params.session">&#xB6;</a>  - &#x76EE;&#x6807;<a class="reference internal" href="session_api.html#sqlalchemy.orm.session.Session" title="sqlalchemy.orm.session.Session"><code class="xref py py-class docutils literal"><span class="pre">Session</span></code></a></span></span></li><li><span class="yiyi-st" id="yiyi-756"><span class="target" id="sqlalchemy.orm.events.SessionEvents.transient_to_pending.params.instance"></span><strong>instance</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.orm.events.SessionEvents.transient_to_pending.params.instance">&#xB6;</a> &#x2013; the ORM-mapped instance being operated upon.</span></li></ul></td></tr></tbody></table><div class="versionadded"><p><span class="yiyi-st" id="yiyi-757"><span class="versionmodified">&#x7248;&#x672C;1.1&#x4E2D;&#x7684;&#x65B0;&#x529F;&#x80FD;</span></span></p></div><div class="admonition seealso"><p class="first admonition-title"><span class="yiyi-st" id="yiyi-758">&#x4E5F;&#x53EF;&#x4EE5;&#x770B;&#x770B;</span></p><p class="last"><span class="yiyi-st" id="yiyi-759"><a class="reference internal" href="session_events.html#session-lifecycle-events"><span>Object Lifecycle Events</span></a></span></p></div></dd></dl></dd></dl></div><div class="section" id="query-events"><h2><span class="yiyi-st" id="yiyi-760">&#x67E5;&#x8BE2;&#x4E8B;&#x4EF6;<a class="headerlink" href="#query-events" title="Permalink to this headline">&#xB6;</a></span></h2><dl class="class"><dt id="sqlalchemy.orm.events.QueryEvents"><span class="yiyi-st" id="yiyi-761"><em class="property">class</em> <code class="descclassname">sqlalchemy.orm.events&#x3002;</code> <code class="descname">QueryEvents</code> <a class="headerlink" href="#sqlalchemy.orm.events.QueryEvents" title="Permalink to this definition">&#xB6;</a></span></dt><dd><p><span class="yiyi-st" id="yiyi-762">&#x57FA;&#x7840;&#xFF1A;<a class="reference internal" href="core_events.html#sqlalchemy.event.base.Events" title="sqlalchemy.event.base.Events"><code class="xref py py-class docutils literal"><span class="pre">sqlalchemy.event.base.Events</span></code></a></span></p><p><span class="yiyi-st" id="yiyi-763">&#x8868;&#x793A;&#x6784;&#x5EFA;<a class="reference internal" href="query.html#sqlalchemy.orm.query.Query" title="sqlalchemy.orm.query.Query"><code class="xref py py-class docutils literal"><span class="pre">Query</span></code></a>&#x5BF9;&#x8C61;&#x5185;&#x7684;&#x4E8B;&#x4EF6;&#x3002;</span></p><p><span class="yiyi-st" id="yiyi-764">&#x6B64;&#x5904;&#x7684;&#x4E8B;&#x4EF6;&#x65E8;&#x5728;&#x7528;&#x4E8E;<a class="reference internal" href="query.html#sqlalchemy.orm.query.Query" title="sqlalchemy.orm.query.Query"><code class="xref py py-class docutils literal"><span class="pre">Query</span></code></a>&#x7684;&#x5C1A;&#x672A;&#x53D1;&#x5E03;&#x7684;&#x68C0;&#x67E5;&#x7CFB;&#x7EDF;&#x3002;</span><span class="yiyi-st" id="yiyi-765">&#x73B0;&#x5728;&#x53EF;&#x4EE5;&#x8FDB;&#x884C;&#x4E00;&#x4E9B;&#x975E;&#x5E38;&#x57FA;&#x672C;&#x7684;&#x64CD;&#x4F5C;&#xFF0C;&#x4F46;&#x68C0;&#x67E5;&#x7CFB;&#x7EDF;&#x65E8;&#x5728;&#x4F7F;&#x590D;&#x6742;&#x7684;&#x67E5;&#x8BE2;&#x64CD;&#x4F5C;&#x81EA;&#x52A8;&#x5316;&#x3002;</span></p><div class="versionadded"><p><span class="yiyi-st" id="yiyi-766"><span class="versionmodified">&#x7248;&#x672C;1.0.0&#x4E2D;&#x7684;&#x65B0;&#x529F;&#x80FD;</span></span></p></div><dl class="method"><dt id="sqlalchemy.orm.events.QueryEvents.before_compile"><span class="yiyi-st" id="yiyi-767"><code class="descname"> before_compile  T0&gt; <span class="sig-paren">&#xFF08; T1&gt; <em>&#x67E5;&#x8BE2; T2&gt; <span class="sig-paren">&#xFF09; T3&gt; <a class="headerlink" href="#sqlalchemy.orm.events.QueryEvents.before_compile" title="Permalink to this definition">&#xB6; T4&gt;</a></span></em></span></code></span></dt><dd><p><span class="yiyi-st" id="yiyi-768">&#x5728;&#x5C06;<a class="reference internal" href="query.html#sqlalchemy.orm.query.Query" title="sqlalchemy.orm.query.Query"><code class="xref py py-class docutils literal"><span class="pre">Query</span></code></a>&#x5BF9;&#x8C61;&#x7EC4;&#x6210;&#x6838;&#x5FC3;<a class="reference internal" href="core_selectable.html#sqlalchemy.sql.expression.Select" title="sqlalchemy.sql.expression.Select"><code class="xref py py-class docutils literal"><span class="pre">Select</span></code></a>&#x5BF9;&#x8C61;&#x4E4B;&#x524D;&#x63A5;&#x6536;&#x8BE5;&#x5BF9;&#x8C61;&#x3002;</span></p><div class="event-signatures container"><p><span class="yiyi-st" id="yiyi-769">&#x793A;&#x4F8B;&#x53C2;&#x6570;&#x8868;&#x5355;&#xFF1A;</span></p><div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sqlalchemy</span> <span class="kn">import</span> <span class="n">event</span>

<span class="c1"># standard decorator style</span>
<span class="nd">@event.listens_for</span><span class="p">(</span><span class="n">SomeQuery</span><span class="p">,</span> <span class="s1">&apos;before_compile&apos;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">receive_before_compile</span><span class="p">(</span><span class="n">query</span><span class="p">):</span>
    <span class="s2">&quot;listen for the &apos;before_compile&apos; event&quot;</span>

    <span class="c1"># ... (event handling logic) ...</span></pre></div></div></div><p><span class="yiyi-st" id="yiyi-770">&#x6B64;&#x4E8B;&#x4EF6;&#x65E8;&#x5728;&#x5141;&#x8BB8;&#x66F4;&#x6539;&#x7ED9;&#x51FA;&#x7684;&#x67E5;&#x8BE2;&#xFF1A;</span></p><div class="highlight-python"><div class="highlight"><pre><span></span><span class="nd">@event.listens_for</span><span class="p">(</span><span class="n">Query</span><span class="p">,</span> <span class="s2">&quot;before_compile&quot;</span><span class="p">,</span> <span class="n">retval</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">no_deleted</span><span class="p">(</span><span class="n">query</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">desc</span> <span class="ow">in</span> <span class="n">query</span><span class="o">.</span><span class="n">column_descriptions</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">desc</span><span class="p">[</span><span class="s1">&apos;type&apos;</span><span class="p">]</span> <span class="ow">is</span> <span class="n">User</span><span class="p">:</span>
            <span class="n">entity</span> <span class="o">=</span> <span class="n">desc</span><span class="p">[</span><span class="s1">&apos;entity&apos;</span><span class="p">]</span>
            <span class="n">query</span> <span class="o">=</span> <span class="n">query</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">entity</span><span class="o">.</span><span class="n">deleted</span> <span class="o">==</span> <span class="bp">False</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">query</span></pre></div></div><p><span class="yiyi-st" id="yiyi-771">&#x901A;&#x5E38;&#x5E94;&#x8BE5;&#x4F7F;&#x7528;<code class="docutils literal"><span class="pre">retval=True</span></code>&#x53C2;&#x6570;&#x96C6;&#x6765;&#x76D1;&#x542C;&#x4E8B;&#x4EF6;&#xFF0C;&#x4EE5;&#x4FBF;&#x53EF;&#x4EE5;&#x8FD4;&#x56DE;&#x4FEE;&#x6539;&#x540E;&#x7684;&#x67E5;&#x8BE2;&#x3002;</span></p></dd></dl></dd></dl></div><div class="section" id="module-sqlalchemy.orm.instrumentation"><h2><span class="yiyi-st" id="yiyi-772">&#x4EEA;&#x5668;&#x4E8B;&#x4EF6;<a class="headerlink" href="#module-sqlalchemy.orm.instrumentation" title="Permalink to this headline">&#xB6;</a></span></h2><p><span class="yiyi-st" id="yiyi-773">&#x5B9A;&#x4E49;SQLAlchemy&#x7684;&#x7C7B;&#x68C0;&#x6D4B;&#x7CFB;&#x7EDF;&#x3002;</span></p><p><span class="yiyi-st" id="yiyi-774">&#x8BE5;&#x6A21;&#x5757;&#x901A;&#x5E38;&#x5BF9;&#x7528;&#x6237;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x4E0D;&#x76F4;&#x63A5;&#x53EF;&#x89C1;&#xFF0C;&#x4F46;&#x5B9A;&#x4E49;&#x4E86;ORM&#x4EA4;&#x4E92;&#x6027;&#x7684;&#x5F88;&#x5927;&#x4E00;&#x90E8;&#x5206;&#x3002;</span></p><p><span class="yiyi-st" id="yiyi-775">instrumentation.py&#x5904;&#x7406;&#x6700;&#x7EC8;&#x7528;&#x6237;&#x7C7B;&#x7684;&#x72B6;&#x6001;&#x8DDF;&#x8E2A;&#x6CE8;&#x518C;&#x3002;</span><span class="yiyi-st" id="yiyi-776">&#x5B83;&#x4E0E;&#x5206;&#x522B;&#x5EFA;&#x7ACB;per-instance&#x548C;per-class-attribute&#x5DE5;&#x5177;&#x7684;state.py&#x548C;attributes.py&#x7D27;&#x5BC6;&#x4EA4;&#x4E92;&#x3002;</span></p><p><span class="yiyi-st" id="yiyi-777">&#x7C7B;&#x5DE5;&#x5177;&#x7CFB;&#x7EDF;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;<a class="reference internal" href="extensions_instrumentation.html#module-sqlalchemy.ext.instrumentation" title="sqlalchemy.ext.instrumentation"><code class="xref py py-mod docutils literal"><span class="pre">sqlalchemy.ext.instrumentation</span></code></a>&#x6A21;&#x5757;&#x5728;&#x6BCF;&#x4E2A;&#x7C7B;&#x6216;&#x5168;&#x5C40;&#x57FA;&#x7840;&#x4E0A;&#x5B9A;&#x5236;&#xFF0C;&#x8BE5;&#x6A21;&#x5757;&#x63D0;&#x4F9B;&#x4E86;&#x6784;&#x5EFA;&#x548C;&#x6307;&#x5B9A;&#x66FF;&#x4EE3;&#x5DE5;&#x5177;&#x5F62;&#x5F0F;&#x7684;&#x65B9;&#x6CD5;&#x3002;</span></p><dl class="class"><dt id="sqlalchemy.orm.events.InstrumentationEvents"><span class="yiyi-st" id="yiyi-778"><em class="property">class</em> <code class="descclassname">sqlalchemy.orm.events&#x3002;</code> <code class="descname">InstrumentationEvents</code> <a class="headerlink" href="#sqlalchemy.orm.events.InstrumentationEvents" title="Permalink to this definition">&#xB6;</a></span></dt><dd><p><span class="yiyi-st" id="yiyi-779">&#x57FA;&#x7840;&#xFF1A;<a class="reference internal" href="core_events.html#sqlalchemy.event.base.Events" title="sqlalchemy.event.base.Events"><code class="xref py py-class docutils literal"><span class="pre">sqlalchemy.event.base.Events</span></code></a></span></p><p><span class="yiyi-st" id="yiyi-780">&#x4E0E;&#x7C7B;&#x4EEA;&#x5668;&#x4E8B;&#x4EF6;&#x76F8;&#x5173;&#x7684;&#x4E8B;&#x4EF6;&#x3002;</span></p><p><span class="yiyi-st" id="yiyi-781">&#x8FD9;&#x91CC;&#x7684;&#x76D1;&#x542C;&#x5668;&#x652F;&#x6301;&#x9488;&#x5BF9;&#x4EFB;&#x4F55;&#x65B0;&#x7684;&#x6837;&#x5F0F;&#x7C7B;&#x5EFA;&#x7ACB;&#x5BF9;&#x8C61;&#xFF0C;&#x5373;&#x4EFB;&#x4F55;&#x5C5E;&#x4E8E;&#x201C;&#x7C7B;&#x578B;&#x201D;&#x7684;&#x5B50;&#x7C7B;&#x7684;&#x5BF9;&#x8C61;&#x3002;</span><span class="yiyi-st" id="yiyi-782">&#x7136;&#x540E;&#xFF0C;&#x4E8B;&#x4EF6;&#x5C06;&#x88AB;&#x9488;&#x5BF9;&#x8BE5;&#x7C7B;&#x522B;&#x7684;&#x4E8B;&#x4EF6;&#x89E3;&#x96C7;&#x3002;</span><span class="yiyi-st" id="yiyi-783">&#x5982;&#x679C;&#x201C;propagate = True&#x201D;&#x6807;&#x5FD7;&#x88AB;&#x4F20;&#x9012;&#x7ED9;event.listen()&#xFF0C;&#x90A3;&#x4E48;&#x8BE5;&#x4E8B;&#x4EF6;&#x4E5F;&#x5C06;&#x89E6;&#x53D1;&#x8BE5;&#x7C7B;&#x7684;&#x5B50;&#x7C7B;&#x3002;</span></p><p><span class="yiyi-st" id="yiyi-784">Python <code class="docutils literal"><span class="pre">type</span></code>&#x5185;&#x7F6E;&#x51FD;&#x6570;&#x4E5F;&#x88AB;&#x63A5;&#x53D7;&#x4E3A;&#x76EE;&#x6807;&#xFF0C;&#x5B83;&#x5728;&#x4F7F;&#x7528;&#x65F6;&#x5177;&#x6709;&#x4E3A;&#x6240;&#x6709;&#x7C7B;&#x53D1;&#x51FA;&#x4E8B;&#x4EF6;&#x7684;&#x6548;&#x679C;&#x3002;</span></p><p><span class="yiyi-st" id="yiyi-785">&#x8BF7;&#x6CE8;&#x610F;&#xFF0C;&#x6B64;&#x5904;&#x7684;&#x201C;&#x4F20;&#x64AD;&#x201D;&#x6807;&#x5FD7;&#x9ED8;&#x8BA4;&#x4E3A;<code class="docutils literal"><span class="pre">True</span></code>&#xFF0C;&#x4E0E;&#x9ED8;&#x8BA4;&#x4E3A;<code class="docutils literal"><span class="pre">False</span></code>&#x7684;&#x5176;&#x4ED6;&#x7C7B;&#x7EA7;&#x522B;&#x4E8B;&#x4EF6;&#x4E0D;&#x540C;&#x3002;</span><span class="yiyi-st" id="yiyi-786">&#x8FD9;&#x610F;&#x5473;&#x7740;&#x5F53;&#x4E00;&#x4E2A;&#x76D1;&#x542C;&#x5668;&#x5EFA;&#x7ACB;&#x5728;&#x8D85;&#x7C7B;&#x4E0A;&#x65F6;&#xFF0C;&#x65B0;&#x7684;&#x5B50;&#x7C7B;&#x4E5F;&#x5C06;&#x6210;&#x4E3A;&#x8FD9;&#x4E9B;&#x4E8B;&#x4EF6;&#x7684;&#x4E3B;&#x9898;&#x3002;</span></p><div class="versionchanged"><p><span class="yiyi-st" id="yiyi-787"><span class="versionmodified">&#x5728;&#x7248;&#x672C;0.8&#x4E2D;&#x66F4;&#x6539;&#xFF1A;</span>  - &#x8FD9;&#x91CC;&#x7684;&#x4E8B;&#x4EF6;&#x5C06;&#x6839;&#x636E;&#x4F20;&#x5165;&#x7C7B;&#x4E0E;&#x4F20;&#x9012;&#x7ED9;<a class="reference internal" href="core_event.html#sqlalchemy.event.listen" title="sqlalchemy.event.listen"><code class="xref py py-func docutils literal"><span class="pre">event.listen()</span></code></a>&#x7684;&#x7C7B;&#x7684;&#x7C7B;&#x578B;&#x8FDB;&#x884C;&#x6BD4;&#x8F83;&#x6765;&#x53D1;&#x51FA;&#x3002;</span><span class="yiyi-st" id="yiyi-788">&#x4EE5;&#x524D;&#xFF0C;&#x5C3D;&#x7BA1;&#x6587;&#x4EF6;&#x4E2D;&#x6709;&#x76F8;&#x53CD;&#x7684;&#x89C4;&#x5B9A;&#xFF0C;&#x4F46;&#x4E8B;&#x4EF6;&#x5C06;&#x65E0;&#x6761;&#x4EF6;&#x5730;&#x4E3A;&#x4EFB;&#x4F55;&#x73ED;&#x7EA7;&#x5F00;&#x706B;&#xFF0C;&#x65E0;&#x8BBA;&#x54EA;&#x4E2A;&#x73ED;&#x7EA7;&#x88AB;&#x53D1;&#x9001;&#x8046;&#x542C;&#x3002;</span></p></div><dl class="method"><dt id="sqlalchemy.orm.events.InstrumentationEvents.attribute_instrument"><span class="yiyi-st" id="yiyi-789"> <code class="descname">attribute_instrument</code><span class="sig-paren">(</span><em>cls</em>, <em>key</em>, <em>inst</em><span class="sig-paren">)</span><a class="headerlink" href="#sqlalchemy.orm.events.InstrumentationEvents.attribute_instrument" title="Permalink to this definition">&#xB6;</a></span></dt><dd><div class="event-signatures container"><p><span class="yiyi-st" id="yiyi-790">&#x793A;&#x4F8B;&#x53C2;&#x6570;&#x8868;&#x5355;&#xFF1A;</span></p><div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sqlalchemy</span> <span class="kn">import</span> <span class="n">event</span>

<span class="c1"># standard decorator style</span>
<span class="nd">@event.listens_for</span><span class="p">(</span><span class="n">SomeBaseClass</span><span class="p">,</span> <span class="s1">&apos;attribute_instrument&apos;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">receive_attribute_instrument</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">inst</span><span class="p">):</span>
    <span class="s2">&quot;listen for the &apos;attribute_instrument&apos; event&quot;</span>

    <span class="c1"># ... (event handling logic) ...</span></pre></div></div></div><p><span class="yiyi-st" id="yiyi-791">&#x5728;&#x68C0;&#x6D4B;&#x5C5E;&#x6027;&#x65F6;&#x8C03;&#x7528;&#x3002;</span></p></dd></dl><dl class="method"><dt id="sqlalchemy.orm.events.InstrumentationEvents.class_instrument"><span class="yiyi-st" id="yiyi-792"><code class="descname"> class_instrument  T0&gt; <span class="sig-paren">&#xFF08; T1&gt; <em> CLS  T2&gt; <span class="sig-paren">&#xFF09; T3&gt; <a class="headerlink" href="#sqlalchemy.orm.events.InstrumentationEvents.class_instrument" title="Permalink to this definition">&#xB6; T4&gt;</a></span></em></span></code></span></dt><dd><p><span class="yiyi-st" id="yiyi-793">&#x5728;&#x7ED9;&#x5B9A;&#x7684;&#x8BFE;&#x7A0B;&#x5B89;&#x88C5;&#x540E;&#x8C03;&#x7528;&#x3002;</span></p><div class="event-signatures container"><p><span class="yiyi-st" id="yiyi-794">&#x793A;&#x4F8B;&#x53C2;&#x6570;&#x8868;&#x5355;&#xFF1A;</span></p><div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sqlalchemy</span> <span class="kn">import</span> <span class="n">event</span>

<span class="c1"># standard decorator style</span>
<span class="nd">@event.listens_for</span><span class="p">(</span><span class="n">SomeBaseClass</span><span class="p">,</span> <span class="s1">&apos;class_instrument&apos;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">receive_class_instrument</span><span class="p">(</span><span class="n">cls</span><span class="p">):</span>
    <span class="s2">&quot;listen for the &apos;class_instrument&apos; event&quot;</span>

    <span class="c1"># ... (event handling logic) ...</span></pre></div></div></div><p><span class="yiyi-st" id="yiyi-795">&#x8981;&#x83B7;&#x53D6;<a class="reference internal" href="internals.html#sqlalchemy.orm.instrumentation.ClassManager" title="sqlalchemy.orm.instrumentation.ClassManager"><code class="xref py py-class docutils literal"><span class="pre">ClassManager</span></code></a>&#xFF0C;&#x8BF7;&#x4F7F;&#x7528;<code class="xref py py-func docutils literal"><span class="pre">manager_of_class()</span></code>&#x3002;</span></p></dd></dl><dl class="method"><dt id="sqlalchemy.orm.events.InstrumentationEvents.class_uninstrument"><span class="yiyi-st" id="yiyi-796"><code class="descname"> class_uninstrument  T0&gt; <span class="sig-paren">&#xFF08; T1&gt; <em> CLS  T2&gt; <span class="sig-paren">&#xFF09; T3&gt; <a class="headerlink" href="#sqlalchemy.orm.events.InstrumentationEvents.class_uninstrument" title="Permalink to this definition">&#xB6; T4&gt;</a></span></em></span></code></span></dt><dd><p><span class="yiyi-st" id="yiyi-797">&#x5728;&#x7ED9;&#x5B9A;&#x7684;&#x73ED;&#x7EA7;&#x672A;&#x88AB;&#x6253;&#x5F00;&#x4E4B;&#x524D;&#x8C03;&#x7528;&#x3002;</span></p><div class="event-signatures container"><p><span class="yiyi-st" id="yiyi-798">&#x793A;&#x4F8B;&#x53C2;&#x6570;&#x8868;&#x5355;&#xFF1A;</span></p><div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sqlalchemy</span> <span class="kn">import</span> <span class="n">event</span>

<span class="c1"># standard decorator style</span>
<span class="nd">@event.listens_for</span><span class="p">(</span><span class="n">SomeBaseClass</span><span class="p">,</span> <span class="s1">&apos;class_uninstrument&apos;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">receive_class_uninstrument</span><span class="p">(</span><span class="n">cls</span><span class="p">):</span>
    <span class="s2">&quot;listen for the &apos;class_uninstrument&apos; event&quot;</span>

    <span class="c1"># ... (event handling logic) ...</span></pre></div></div></div><p><span class="yiyi-st" id="yiyi-799">&#x8981;&#x83B7;&#x53D6;<a class="reference internal" href="internals.html#sqlalchemy.orm.instrumentation.ClassManager" title="sqlalchemy.orm.instrumentation.ClassManager"><code class="xref py py-class docutils literal"><span class="pre">ClassManager</span></code></a>&#xFF0C;&#x8BF7;&#x4F7F;&#x7528;<code class="xref py py-func docutils literal"><span class="pre">manager_of_class()</span></code>&#x3002;</span></p></dd></dl></dd></dl></div>