<h1><span class="yiyi-st" id="yiyi-43">&#x4E0D;&#x63A8;&#x8350;&#x4F7F;&#x7528;&#x7684;ORM&#x4E8B;&#x4EF6;&#x63A5;&#x53E3;<a class="headerlink" href="#module-sqlalchemy.orm.interfaces" title="Permalink to this headline">&#xB6;</a></span></h1><p><span class="yiyi-st" id="yiyi-44">&#x672C;&#x8282;&#x63CF;&#x8FF0;&#x4E86;&#x6700;&#x521D;&#x5B58;&#x5728;&#x4E8E;SQLAlchemy 0.1&#x4E2D;&#x7684;&#x57FA;&#x4E8E;&#x7C7B;&#x7684;ORM&#x4E8B;&#x4EF6;&#x63A5;&#x53E3;&#xFF0C;&#x8BE5;&#x63A5;&#x53E3;&#x5728;SQLAlchemy 0.5&#x4E4B;&#x524D;&#x6709;&#x66F4;&#x591A;&#x7C7B;&#x578B;&#x7684;&#x4E8B;&#x4EF6;&#x3002;</span><span class="yiyi-st" id="yiyi-45">&#x975E;ORM&#x6A21;&#x62DF;&#x5728;<a class="reference internal" href="core_interfaces.html"><span>Deprecated Event Interfaces</span></a>&#x4E2D;&#x63CF;&#x8FF0;&#x3002;</span></p><div class="deprecated"><p><span class="yiyi-st" id="yiyi-46"><span class="versionmodified">&#x4ECE;&#x7248;&#x672C;0.7&#x5F00;&#x59CB;&#x5F03;&#x7528;&#xFF1A;</span>&#x4ECE;SQLAlchemy 0.7&#x5F00;&#x59CB;&#xFF0C;<a class="reference internal" href="core_event.html"><span>Events</span></a>&#x4E2D;&#x63CF;&#x8FF0;&#x7684;&#x65B0;&#x4E8B;&#x4EF6;&#x7CFB;&#x7EDF;&#x53D6;&#x4EE3;&#x4E86;&#x6269;&#x5C55;/&#x4EE3;&#x7406;/&#x4FA6;&#x542C;&#x5668;&#x7CFB;&#x7EDF;&#xFF0C;&#x4E3A;&#x6240;&#x6709;&#x4E0D;&#x9700;&#x8981;&#x7684;&#x4E8B;&#x4EF6;&#x63D0;&#x4F9B;&#x4E00;&#x81F4;&#x7684;&#x63A5;&#x53E3;&#x7528;&#x4E8E;&#x5B50;&#x7C7B;&#x5316;&#x3002;</span></p></div><div class="section" id="mapper-events"><h2><span class="yiyi-st" id="yiyi-47">Mapper&#x4E8B;&#x4EF6;<a class="headerlink" href="#mapper-events" title="Permalink to this headline">&#xB6;</a></span></h2><dl class="class"><dt id="sqlalchemy.orm.interfaces.MapperExtension"><span class="yiyi-st" id="yiyi-48"><em class="property">class</em> <code class="descclassname">sqlalchemy.orm.interfaces&#x3002;</code> <code class="descname">MapperExtension</code> <a class="headerlink" href="#sqlalchemy.orm.interfaces.MapperExtension" title="Permalink to this definition">&#xB6;</a></span></dt><dd><p><span class="yiyi-st" id="yiyi-49"><a class="reference internal" href="mapping_api.html#sqlalchemy.orm.mapper.Mapper" title="sqlalchemy.orm.mapper.Mapper"><code class="xref py py-class docutils literal"><span class="pre">Mapper</span></code></a>&#x4E8B;&#x4EF6;&#x6302;&#x94A9;&#x7684;&#x57FA;&#x672C;&#x5B9E;&#x73B0;&#x3002;</span></p><div class="admonition note"><p class="first admonition-title"><span class="yiyi-st" id="yiyi-50">&#x6CE8;&#x610F;</span></p><p class="last"><span class="yiyi-st" id="yiyi-51"><a class="reference internal" href="#sqlalchemy.orm.interfaces.MapperExtension" title="sqlalchemy.orm.interfaces.MapperExtension"><code class="xref py py-class docutils literal"><span class="pre">MapperExtension</span></code></a>&#x5DF2;&#x5F03;&#x7528;&#x3002;</span><span class="yiyi-st" id="yiyi-52">&#x8BF7;&#x53C2;&#x9605;<a class="reference internal" href="core_event.html#sqlalchemy.event.listen" title="sqlalchemy.event.listen"><code class="xref py py-func docutils literal"><span class="pre">event.listen()</span></code></a>&#x4EE5;&#x53CA;<a class="reference internal" href="events.html#sqlalchemy.orm.events.MapperEvents" title="sqlalchemy.orm.events.MapperEvents"><code class="xref py py-class docutils literal"><span class="pre">MapperEvents</span></code></a>&#x3002;</span></p></div><p><span class="yiyi-st" id="yiyi-53">&#x65B0;&#x7684;&#x6269;&#x5C55;&#x7C7B;&#x662F;<a class="reference internal" href="#sqlalchemy.orm.interfaces.MapperExtension" title="sqlalchemy.orm.interfaces.MapperExtension"><code class="xref py py-class docutils literal"><span class="pre">MapperExtension</span></code></a>&#x7684;&#x5B50;&#x7C7B;&#xFF0C;&#x5B83;&#x662F;&#x4F7F;&#x7528;<code class="docutils literal"><span class="pre">extension</span></code> mapper()&#x53C2;&#x6570;&#x6307;&#x5B9A;&#x7684;&#xFF0C;&#x8BE5;&#x53C2;&#x6570;&#x662F;&#x4E00;&#x4E2A;<a class="reference internal" href="#sqlalchemy.orm.interfaces.MapperExtension" title="sqlalchemy.orm.interfaces.MapperExtension"><code class="xref py py-class docutils literal"><span class="pre">MapperExtension</span></code></a></span></p><div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sqlalchemy.orm.interfaces</span> <span class="kn">import</span> <span class="n">MapperExtension</span>

<span class="k">class</span> <span class="nc">MyExtension</span><span class="p">(</span><span class="n">MapperExtension</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">before_insert</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mapper</span><span class="p">,</span> <span class="n">connection</span><span class="p">,</span> <span class="n">instance</span><span class="p">):</span>
        <span class="k">print</span> <span class="s2">&quot;instance </span><span class="si">%s</span><span class="s2"> before insert !&quot;</span> <span class="o">%</span> <span class="n">instance</span>

<span class="n">m</span> <span class="o">=</span> <span class="n">mapper</span><span class="p">(</span><span class="n">User</span><span class="p">,</span> <span class="n">users_table</span><span class="p">,</span> <span class="n">extension</span><span class="o">=</span><span class="n">MyExtension</span><span class="p">())</span></pre></div></div><p><span class="yiyi-st" id="yiyi-54">&#x4E00;&#x4E2A;&#x6620;&#x5C04;&#x5668;&#x53EF;&#x4EE5;&#x7EF4;&#x62A4;<code class="docutils literal"><span class="pre">MapperExtension</span></code>&#x5BF9;&#x8C61;&#x94FE;&#x3002;</span><span class="yiyi-st" id="yiyi-55">&#x5F53;&#x53D1;&#x751F;&#x7279;&#x5B9A;&#x7684;&#x6620;&#x5C04;&#x4E8B;&#x4EF6;&#x65F6;&#xFF0C;&#x6BCF;&#x4E2A;<code class="docutils literal"><span class="pre">MapperExtension</span></code>&#x4E0A;&#x7684;&#x76F8;&#x5E94;&#x65B9;&#x6CD5;&#x88AB;&#x4E32;&#x884C;&#x8C03;&#x7528;&#xFF0C;&#x5E76;&#x4E14;&#x6BCF;&#x79CD;&#x65B9;&#x6CD5;&#x90FD;&#x6709;&#x80FD;&#x529B;&#x963B;&#x6B62;&#x94FE;&#x8FDB;&#x4E00;&#x6B65;&#x5904;&#x7406;&#xFF1A;</span></p><div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">m</span> <span class="o">=</span> <span class="n">mapper</span><span class="p">(</span><span class="n">User</span><span class="p">,</span> <span class="n">users_table</span><span class="p">,</span> <span class="n">extension</span><span class="o">=</span><span class="p">[</span><span class="n">ext1</span><span class="p">,</span> <span class="n">ext2</span><span class="p">,</span> <span class="n">ext3</span><span class="p">])</span></pre></div></div><p><span class="yiyi-st" id="yiyi-56">&#x6BCF;&#x4E2A;<code class="docutils literal"><span class="pre">MapperExtension</span></code>&#x65B9;&#x6CD5;&#x9ED8;&#x8BA4;&#x8FD4;&#x56DE;&#x7B26;&#x53F7;EXT_CONTINUE&#x3002;</span><span class="yiyi-st" id="yiyi-57">&#x8FD9;&#x4E2A;&#x7B26;&#x53F7;&#x901A;&#x5E38;&#x610F;&#x5473;&#x7740;&#x201C;&#x79FB;&#x52A8;&#x5230;&#x4E0B;&#x4E00;&#x4E2A;<code class="docutils literal"><span class="pre">MapperExtension</span></code>&#x8FDB;&#x884C;&#x5904;&#x7406;&#x201D;&#x3002;</span><span class="yiyi-st" id="yiyi-58">&#x5BF9;&#x4E8E;&#x8FD4;&#x56DE;&#x50CF;&#x7FFB;&#x8BD1;&#x884C;&#x6216;&#x65B0;&#x5BF9;&#x8C61;&#x5B9E;&#x4F8B;&#x8FD9;&#x6837;&#x7684;&#x5BF9;&#x8C61;&#x7684;&#x65B9;&#x6CD5;&#xFF0C;EXT_CONTINUE&#x8868;&#x793A;&#x65B9;&#x6CD5;&#x7684;&#x7ED3;&#x679C;&#x5E94;&#x8BE5;&#x88AB;&#x5FFD;&#x7565;&#x3002;</span><span class="yiyi-st" id="yiyi-59">&#x5728;&#x67D0;&#x4E9B;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;&#x9700;&#x8981;&#x6267;&#x884C;&#x9ED8;&#x8BA4;&#x7684;&#x6620;&#x5C04;&#x5668;&#x6D3B;&#x52A8;&#xFF0C;&#x4F8B;&#x5982;&#x5C06;&#x65B0;&#x5B9E;&#x4F8B;&#x6DFB;&#x52A0;&#x5230;&#x7ED3;&#x679C;&#x5217;&#x8868;&#x4E2D;&#x3002;</span></p><p><span class="yiyi-st" id="yiyi-60">&#x7B26;&#x53F7;EXT_STOP&#x5728;<code class="docutils literal"><span class="pre">MapperExtension</span></code>&#x5BF9;&#x8C61;&#x94FE;&#x4E2D;&#x5177;&#x6709;&#x91CD;&#x8981;&#x610F;&#x4E49;&#xFF0C;&#x5373;&#x8FD4;&#x56DE;&#x6B64;&#x7B26;&#x53F7;&#x65F6;&#x94FE;&#x5C06;&#x88AB;&#x505C;&#x6B62;&#x3002;</span><span class="yiyi-st" id="yiyi-61">&#x4E0E;EXT_CONTINUE&#x7C7B;&#x4F3C;&#xFF0C;&#x5728;&#x67D0;&#x4E9B;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;&#x9ED8;&#x8BA4;&#x7684;&#x6620;&#x5C04;&#x5668;&#x6D3B;&#x52A8;&#x5C06;&#x4E0D;&#x4F1A;&#x6267;&#x884C;&#xFF0C;&#x8FD9;&#x4E5F;&#x6709;&#x5176;&#x4ED6;&#x91CD;&#x8981;&#x610F;&#x4E49;&#x3002;</span></p><dl class="method"><dt id="sqlalchemy.orm.interfaces.MapperExtension.after_delete"><span class="yiyi-st" id="yiyi-62"><code class="descname">after_delete</code> <span class="sig-paren">&#xFF08;</span> <em>mapper</em>&#xFF0C;<em>connection</em>&#xFF0C;<em>instance</em> <span class="sig-paren">&#xFF09;</span> <a class="headerlink" href="#sqlalchemy.orm.interfaces.MapperExtension.after_delete" title="Permalink to this definition">&#xB6; T6&gt;</a></span></dt><dd><p><span class="yiyi-st" id="yiyi-63">&#x5728;&#x8BE5;&#x5B9E;&#x4F8B;&#x88AB;&#x5220;&#x9664;&#x540E;&#x63A5;&#x6536;&#x5BF9;&#x8C61;&#x5B9E;&#x4F8B;&#x3002;</span></p><p><span class="yiyi-st" id="yiyi-64">&#x8FD4;&#x56DE;&#x503C;&#x4EC5;&#x5728;<code class="docutils literal"><span class="pre">MapperExtension</span></code>&#x94FE;&#x4E2D;&#x6709;&#x6548;&#xFF1B;&#x7236;&#x6620;&#x5C04;&#x5668;&#x7684;&#x884C;&#x4E3A;&#x4E0D;&#x4F1A;&#x88AB;&#x6B64;&#x65B9;&#x6CD5;&#x4FEE;&#x6539;&#x3002;</span></p></dd></dl><dl class="method"><dt id="sqlalchemy.orm.interfaces.MapperExtension.after_insert"><span class="yiyi-st" id="yiyi-65"> <code class="descname">after_insert</code><span class="sig-paren">(</span><em>mapper</em>, <em>connection</em>, <em>instance</em><span class="sig-paren">)</span><a class="headerlink" href="#sqlalchemy.orm.interfaces.MapperExtension.after_insert" title="Permalink to this definition">&#xB6;</a></span></dt><dd><p><span class="yiyi-st" id="yiyi-66">&#x5728;&#x63D2;&#x5165;&#x5B9E;&#x4F8B;&#x540E;&#x63A5;&#x6536;&#x5BF9;&#x8C61;&#x5B9E;&#x4F8B;&#x3002;</span></p><p><span class="yiyi-st" id="yiyi-67">&#x8FD4;&#x56DE;&#x503C;&#x4EC5;&#x5728;<code class="docutils literal"><span class="pre">MapperExtension</span></code>&#x94FE;&#x4E2D;&#x6709;&#x6548;&#xFF1B;&#x7236;&#x6620;&#x5C04;&#x5668;&#x7684;&#x884C;&#x4E3A;&#x4E0D;&#x4F1A;&#x88AB;&#x6B64;&#x65B9;&#x6CD5;&#x4FEE;&#x6539;&#x3002;</span></p></dd></dl><dl class="method"><dt id="sqlalchemy.orm.interfaces.MapperExtension.after_update"><span class="yiyi-st" id="yiyi-68"><code class="descname">after_update</code> <span class="sig-paren">&#xFF08;</span> <em>mapper</em>&#xFF0C;<em>&#x8FDE;&#x63A5;</em>&#xFF0C;<em>&#x5B9E;&#x4F8B;</em> <span class="sig-paren">&#xFF09;</span> <a class="headerlink" href="#sqlalchemy.orm.interfaces.MapperExtension.after_update" title="Permalink to this definition">&#xB6; T6&gt;</a></span></dt><dd><p><span class="yiyi-st" id="yiyi-69">&#x5728;&#x5B9E;&#x4F8B;&#x66F4;&#x65B0;&#x540E;&#x63A5;&#x6536;&#x5BF9;&#x8C61;&#x5B9E;&#x4F8B;&#x3002;</span></p><p><span class="yiyi-st" id="yiyi-70">&#x8FD4;&#x56DE;&#x503C;&#x4EC5;&#x5728;<code class="docutils literal"><span class="pre">MapperExtension</span></code>&#x94FE;&#x4E2D;&#x6709;&#x6548;&#xFF1B;&#x7236;&#x6620;&#x5C04;&#x5668;&#x7684;&#x884C;&#x4E3A;&#x4E0D;&#x4F1A;&#x88AB;&#x6B64;&#x65B9;&#x6CD5;&#x4FEE;&#x6539;&#x3002;</span></p></dd></dl><dl class="method"><dt id="sqlalchemy.orm.interfaces.MapperExtension.before_delete"><span class="yiyi-st" id="yiyi-71"> <code class="descname">before_delete</code><span class="sig-paren">(</span><em>mapper</em>, <em>connection</em>, <em>instance</em><span class="sig-paren">)</span><a class="headerlink" href="#sqlalchemy.orm.interfaces.MapperExtension.before_delete" title="Permalink to this definition">&#xB6;</a></span></dt><dd><p><span class="yiyi-st" id="yiyi-72">&#x5728;&#x8BE5;&#x5B9E;&#x4F8B;&#x88AB;&#x5220;&#x9664;&#x4E4B;&#x524D;&#x63A5;&#x6536;&#x4E00;&#x4E2A;&#x5BF9;&#x8C61;&#x5B9E;&#x4F8B;&#x3002;</span></p><p><span class="yiyi-st" id="yiyi-73">&#x8BF7;&#x6CE8;&#x610F;&#xFF0C;&#x53EF;&#x4EE5;&#x5728;&#x6B64;&#x5904;&#x8BBE;&#x7F6E;<em>no</em>&#x66F4;&#x6539;&#x6574;&#x4F53;&#x5237;&#x65B0;&#x8BA1;&#x5212;&#xFF1B;&#x5E76;&#x4E14;&#x5BF9;<code class="docutils literal"><span class="pre">Session</span></code>&#x7684;&#x64CD;&#x7EB5;&#x4E0D;&#x4F1A;&#x4EA7;&#x751F;&#x9884;&#x671F;&#x7684;&#x6548;&#x679C;&#x3002;</span><span class="yiyi-st" id="yiyi-74">&#x8981;&#x64CD;&#x4F5C;&#x6269;&#x5C55;&#x4E2D;&#x7684;<code class="docutils literal"><span class="pre">Session</span></code>&#xFF0C;&#x8BF7;&#x4F7F;&#x7528;<code class="docutils literal"><span class="pre">SessionExtension</span></code>&#x3002;</span></p><p><span class="yiyi-st" id="yiyi-75">&#x8FD4;&#x56DE;&#x503C;&#x4EC5;&#x5728;<code class="docutils literal"><span class="pre">MapperExtension</span></code>&#x94FE;&#x4E2D;&#x6709;&#x6548;&#xFF1B;&#x7236;&#x6620;&#x5C04;&#x5668;&#x7684;&#x884C;&#x4E3A;&#x4E0D;&#x4F1A;&#x88AB;&#x6B64;&#x65B9;&#x6CD5;&#x4FEE;&#x6539;&#x3002;</span></p></dd></dl><dl class="method"><dt id="sqlalchemy.orm.interfaces.MapperExtension.before_insert"><span class="yiyi-st" id="yiyi-76"><code class="descname">before_insert</code> <span class="sig-paren">&#xFF08;</span> <em>mapper</em>&#xFF0C;<em>&#x8FDE;&#x63A5;</em>&#xFF0C;<em>&#x5B9E;&#x4F8B;</em> <span class="sig-paren">&#xFF09;</span> <a class="headerlink" href="#sqlalchemy.orm.interfaces.MapperExtension.before_insert" title="Permalink to this definition">&#xB6; T6&gt;</a></span></dt><dd><p><span class="yiyi-st" id="yiyi-77">&#x5728;&#x8BE5;&#x5B9E;&#x4F8B;&#x63D2;&#x5165;&#x5176;&#x8868;&#x4E2D;&#x4E4B;&#x524D;&#x63A5;&#x6536;&#x4E00;&#x4E2A;&#x5BF9;&#x8C61;&#x5B9E;&#x4F8B;&#x3002;</span></p><p><span class="yiyi-st" id="yiyi-78">&#x8FD9;&#x662F;&#x8BBE;&#x7F6E;&#x4E3B;&#x952E;&#x503C;&#x4EE5;&#x53CA;&#x4E0D;&#x4EE5;&#x5176;&#x4ED6;&#x65B9;&#x5F0F;&#x5904;&#x7406;&#x7684;&#x597D;&#x5730;&#x65B9;&#x3002;</span></p><p><span class="yiyi-st" id="yiyi-79">&#x53EF;&#x4EE5;&#x5728;&#x6B64;&#x65B9;&#x6CD5;&#x5185;&#x4FEE;&#x6539;&#x57FA;&#x4E8E;&#x5217;&#x7684;&#x5C5E;&#x6027;&#xFF0C;&#x8FD9;&#x5C06;&#x5BFC;&#x81F4;&#x63D2;&#x5165;&#x65B0;&#x503C;&#x3002;</span><span class="yiyi-st" id="yiyi-80">However <em>no</em> changes to the overall flush plan can be made, and manipulation of the <code class="docutils literal"><span class="pre">Session</span></code> will not have the desired effect. </span><span class="yiyi-st" id="yiyi-81">&#x8981;&#x64CD;&#x4F5C;&#x6269;&#x5C55;&#x4E2D;&#x7684;<code class="docutils literal"><span class="pre">Session</span></code>&#xFF0C;&#x8BF7;&#x4F7F;&#x7528;<code class="docutils literal"><span class="pre">SessionExtension</span></code>&#x3002;</span></p><p><span class="yiyi-st" id="yiyi-82">&#x8FD4;&#x56DE;&#x503C;&#x4EC5;&#x5728;<code class="docutils literal"><span class="pre">MapperExtension</span></code>&#x94FE;&#x4E2D;&#x6709;&#x6548;&#xFF1B;&#x7236;&#x6620;&#x5C04;&#x5668;&#x7684;&#x884C;&#x4E3A;&#x4E0D;&#x4F1A;&#x88AB;&#x6B64;&#x65B9;&#x6CD5;&#x4FEE;&#x6539;&#x3002;</span></p></dd></dl><dl class="method"><dt id="sqlalchemy.orm.interfaces.MapperExtension.before_update"><span class="yiyi-st" id="yiyi-83"><code class="descname">before_update</code> <span class="sig-paren">&#xFF08;</span> <em>mapper</em>&#xFF0C;<em>connection</em>&#xFF0C;<em>instance</em> <span class="sig-paren">&#xFF09;</span> <a class="headerlink" href="#sqlalchemy.orm.interfaces.MapperExtension.before_update" title="Permalink to this definition">&#xB6; T6&gt;</a></span></dt><dd><p><span class="yiyi-st" id="yiyi-84">&#x5728;&#x5B9E;&#x4F8B;&#x66F4;&#x65B0;&#x4E4B;&#x524D;&#x63A5;&#x6536;&#x5BF9;&#x8C61;&#x5B9E;&#x4F8B;&#x3002;</span></p><p><span class="yiyi-st" id="yiyi-85">&#x8BF7;&#x6CE8;&#x610F;&#xFF0C;&#x4E3A;&#x6240;&#x6709;&#x6807;&#x8BB0;&#x4E3A;&#x201C;&#x810F;&#x201D;&#x7684;&#x5B9E;&#x4F8B;&#x8C03;&#x7528;&#x6B64;&#x65B9;&#x6CD5;&#xFF0C;&#x5373;&#x4F7F;&#x8FD9;&#x4E9B;&#x5B9E;&#x4F8B;&#x6CA1;&#x6709;&#x5BF9;&#x5176;&#x57FA;&#x4E8E;&#x5217;&#x7684;&#x5C5E;&#x6027;&#x8FDB;&#x884C;&#x51C0;&#x66F4;&#x6539;&#x3002;</span><span class="yiyi-st" id="yiyi-86">&#x5F53;&#x4E00;&#x4E2A;&#x5BF9;&#x8C61;&#x7684;&#x4EFB;&#x4F55;&#x57FA;&#x4E8E;&#x5217;&#x7684;&#x5C5E;&#x6027;&#x6709;&#x4E00;&#x4E2A;&#x88AB;&#x8C03;&#x7528;&#x7684;&#x201C;set attribute&#x201D;&#x64CD;&#x4F5C;&#x6216;&#x5F53;&#x5B83;&#x7684;&#x4EFB;&#x4F55;&#x96C6;&#x5408;&#x88AB;&#x4FEE;&#x6539;&#x65F6;&#xFF0C;&#x8FD9;&#x4E2A;&#x5BF9;&#x8C61;&#x88AB;&#x6807;&#x8BB0;&#x4E3A;&#x810F;&#x3002;</span><span class="yiyi-st" id="yiyi-87">&#x5982;&#x679C;&#x5728;&#x66F4;&#x65B0;&#x65F6;&#x6CA1;&#x6709;&#x57FA;&#x4E8E;&#x5217;&#x7684;&#x5C5E;&#x6027;&#x6709;&#x4EFB;&#x4F55;&#x51C0;&#x66F4;&#x6539;&#xFF0C;&#x5219;&#x4E0D;&#x4F1A;&#x53D1;&#x5E03;UPDATE&#x8BED;&#x53E5;&#x3002;</span><span class="yiyi-st" id="yiyi-88">&#x8FD9;&#x610F;&#x5473;&#x7740;&#x53D1;&#x9001;&#x5230;before_update&#x7684;&#x5B9E;&#x4F8B;<em>&#x4E0D;&#x662F;</em>&#x4FDD;&#x8BC1;&#x4F1A;&#x53D1;&#x51FA;UPDATE&#x8BED;&#x53E5;&#xFF08;&#x5C3D;&#x7BA1;&#x60A8;&#x53EF;&#x4EE5;&#x5728;&#x6B64;&#x5904;&#x5F71;&#x54CD;&#x7ED3;&#x679C;&#xFF09;&#x3002;</span></p><p><span class="yiyi-st" id="yiyi-89">&#x8981;&#x68C0;&#x6D4B;&#x5BF9;&#x8C61;&#x4E0A;&#x7684;&#x57FA;&#x4E8E;&#x5217;&#x7684;&#x5C5E;&#x6027;&#x662F;&#x5426;&#x5177;&#x6709;&#x51C0;&#x66F4;&#x6539;&#xFF0C;&#x5E76;&#x56E0;&#x6B64;&#x4F1A;&#x751F;&#x6210;UPDATE&#x8BED;&#x53E5;&#xFF0C;&#x8BF7;&#x4F7F;&#x7528;<code class="docutils literal"><span class="pre">object_session&#xFF08;instance&#xFF09;.is_modified&#xFF08;instance&#xFF0C;</span> <span class="pre">include_collections = False&#xFF09;  T2&gt;  T0&gt;&#x3002;</span></code></span></p><p><span class="yiyi-st" id="yiyi-90">&#x53EF;&#x4EE5;&#x5728;&#x6B64;&#x65B9;&#x6CD5;&#x4E2D;&#x4FEE;&#x6539;&#x57FA;&#x4E8E;&#x5217;&#x7684;&#x5C5E;&#x6027;&#xFF0C;&#x8FD9;&#x5C06;&#x5BFC;&#x81F4;&#x66F4;&#x65B0;&#x65B0;&#x503C;&#x3002;</span><span class="yiyi-st" id="yiyi-91">However <em>no</em> changes to the overall flush plan can be made, and manipulation of the <code class="docutils literal"><span class="pre">Session</span></code> will not have the desired effect. </span><span class="yiyi-st" id="yiyi-92">&#x8981;&#x64CD;&#x4F5C;&#x6269;&#x5C55;&#x4E2D;&#x7684;<code class="docutils literal"><span class="pre">Session</span></code>&#xFF0C;&#x8BF7;&#x4F7F;&#x7528;<code class="docutils literal"><span class="pre">SessionExtension</span></code>&#x3002;</span></p><p><span class="yiyi-st" id="yiyi-93">&#x8FD4;&#x56DE;&#x503C;&#x4EC5;&#x5728;<code class="docutils literal"><span class="pre">MapperExtension</span></code>&#x94FE;&#x4E2D;&#x6709;&#x6548;&#xFF1B;&#x7236;&#x6620;&#x5C04;&#x5668;&#x7684;&#x884C;&#x4E3A;&#x4E0D;&#x4F1A;&#x88AB;&#x6B64;&#x65B9;&#x6CD5;&#x4FEE;&#x6539;&#x3002;</span></p></dd></dl><dl class="method"><dt id="sqlalchemy.orm.interfaces.MapperExtension.init_failed"><span class="yiyi-st" id="yiyi-94"><code class="descname">init_failed</code> <span class="sig-paren">&#xFF08;</span> <em>mapper</em>&#xFF0C;<em>class _</em>&#xFF0C;<em>oldinit</em>&#xFF0C;<em>&#x5B9E;&#x4F8B; t5 &gt;&#xFF0C;<em>args</em>&#xFF0C;<em>kwargs</em> <span class="sig-paren">&#xFF09;</span> <a class="headerlink" href="#sqlalchemy.orm.interfaces.MapperExtension.init_failed" title="Permalink to this definition">&#xB6;</a></em></span></dt><dd><p><span class="yiyi-st" id="yiyi-95">&#x5F53;&#x5B83;&#x7684;&#x6784;&#x9020;&#x51FD;&#x6570;&#x88AB;&#x8C03;&#x7528;&#x65F6;&#x63A5;&#x6536;&#x4E00;&#x4E2A;&#x5B9E;&#x4F8B;&#xFF0C;&#x5E76;&#x5F15;&#x53D1;&#x5F02;&#x5E38;&#x3002;</span></p><p><span class="yiyi-st" id="yiyi-96">&#x8BE5;&#x65B9;&#x6CD5;&#x4EC5;&#x5728;&#x5BF9;&#x8C61;&#x7684;&#x7528;&#x6237;&#x533A;&#x6784;&#x9020;&#x671F;&#x95F4;&#x88AB;&#x8C03;&#x7528;&#x3002;</span><span class="yiyi-st" id="yiyi-97">&#x4ECE;&#x6570;&#x636E;&#x5E93;&#x52A0;&#x8F7D;&#x5BF9;&#x8C61;&#x65F6;&#x4E0D;&#x4F1A;&#x8C03;&#x7528;&#x5B83;&#x3002;</span></p><p><span class="yiyi-st" id="yiyi-98">&#x8FD4;&#x56DE;&#x503C;&#x4EC5;&#x5728;<code class="docutils literal"><span class="pre">MapperExtension</span></code>&#x94FE;&#x4E2D;&#x6709;&#x6548;&#xFF1B;&#x7236;&#x6620;&#x5C04;&#x5668;&#x7684;&#x884C;&#x4E3A;&#x4E0D;&#x4F1A;&#x88AB;&#x6B64;&#x65B9;&#x6CD5;&#x4FEE;&#x6539;&#x3002;</span></p></dd></dl><dl class="method"><dt id="sqlalchemy.orm.interfaces.MapperExtension.init_instance"><span class="yiyi-st" id="yiyi-99"> <code class="descname">init_instance</code><span class="sig-paren">(</span><em>mapper</em>, <em>class_</em>, <em>oldinit</em>, <em>instance</em>, <em>args</em>, <em>kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#sqlalchemy.orm.interfaces.MapperExtension.init_instance" title="Permalink to this definition">&#xB6;</a></span></dt><dd><p><span class="yiyi-st" id="yiyi-100">&#x5F53;&#x5B83;&#x7684;&#x6784;&#x9020;&#x51FD;&#x6570;&#x88AB;&#x8C03;&#x7528;&#x65F6;&#x63A5;&#x6536;&#x4E00;&#x4E2A;&#x5B9E;&#x4F8B;&#x3002;</span></p><p><span class="yiyi-st" id="yiyi-101">&#x8BE5;&#x65B9;&#x6CD5;&#x4EC5;&#x5728;&#x5BF9;&#x8C61;&#x7684;&#x7528;&#x6237;&#x533A;&#x6784;&#x9020;&#x671F;&#x95F4;&#x88AB;&#x8C03;&#x7528;&#x3002;</span><span class="yiyi-st" id="yiyi-102">&#x4ECE;&#x6570;&#x636E;&#x5E93;&#x52A0;&#x8F7D;&#x5BF9;&#x8C61;&#x65F6;&#x4E0D;&#x4F1A;&#x8C03;&#x7528;&#x5B83;&#x3002;</span></p><p><span class="yiyi-st" id="yiyi-103">&#x8FD4;&#x56DE;&#x503C;&#x4EC5;&#x5728;<code class="docutils literal"><span class="pre">MapperExtension</span></code>&#x94FE;&#x4E2D;&#x6709;&#x6548;&#xFF1B;&#x7236;&#x6620;&#x5C04;&#x5668;&#x7684;&#x884C;&#x4E3A;&#x4E0D;&#x4F1A;&#x88AB;&#x6B64;&#x65B9;&#x6CD5;&#x4FEE;&#x6539;&#x3002;</span></p></dd></dl><dl class="method"><dt id="sqlalchemy.orm.interfaces.MapperExtension.instrument_class"><span class="yiyi-st" id="yiyi-104"> <code class="descname">instrument_class</code><span class="sig-paren">(</span><em>mapper</em>, <em>class_</em><span class="sig-paren">)</span><a class="headerlink" href="#sqlalchemy.orm.interfaces.MapperExtension.instrument_class" title="Permalink to this definition">&#xB6;</a></span></dt><dd><p><span class="yiyi-st" id="yiyi-105">&#x9996;&#x6B21;&#x6784;&#x5EFA;&#x6620;&#x5C04;&#x5668;&#x65F6;&#x63A5;&#x6536;&#x7C7B;&#xFF0C;&#x5E76;&#x5C06;&#x6620;&#x5C04;&#x5E94;&#x7528;&#x5230;&#x6620;&#x5C04;&#x7C7B;&#x3002;</span></p><p><span class="yiyi-st" id="yiyi-106">&#x8FD4;&#x56DE;&#x503C;&#x4EC5;&#x5728;<code class="docutils literal"><span class="pre">MapperExtension</span></code>&#x94FE;&#x4E2D;&#x6709;&#x6548;&#xFF1B;&#x7236;&#x6620;&#x5C04;&#x5668;&#x7684;&#x884C;&#x4E3A;&#x4E0D;&#x4F1A;&#x88AB;&#x6B64;&#x65B9;&#x6CD5;&#x4FEE;&#x6539;&#x3002;</span></p></dd></dl><dl class="method"><dt id="sqlalchemy.orm.interfaces.MapperExtension.reconstruct_instance"><span class="yiyi-st" id="yiyi-107"> <code class="descname">reconstruct_instance</code><span class="sig-paren">(</span><em>mapper</em>, <em>instance</em><span class="sig-paren">)</span><a class="headerlink" href="#sqlalchemy.orm.interfaces.MapperExtension.reconstruct_instance" title="Permalink to this definition">&#xB6;</a></span></dt><dd><p><span class="yiyi-st" id="yiyi-108">&#x901A;&#x8FC7;<code class="docutils literal"><span class="pre">__new__</span></code>&#x521B;&#x5EFA;&#x5BF9;&#x8C61;&#x5B9E;&#x4F8B;&#x540E;&#xFF0C;&#x5E76;&#x5728;&#x521D;&#x59CB;&#x5C5E;&#x6027;&#x586B;&#x5145;&#x53D1;&#x751F;&#x540E;&#x63A5;&#x6536;&#x5BF9;&#x8C61;&#x5B9E;&#x4F8B;&#x3002;</span></p><p><span class="yiyi-st" id="yiyi-109">&#x8FD9;&#x901A;&#x5E38;&#x5728;&#x57FA;&#x4E8E;&#x4F20;&#x5165;&#x7ED3;&#x679C;&#x884C;&#x521B;&#x5EFA;&#x5B9E;&#x4F8B;&#x65F6;&#x53D1;&#x751F;&#xFF0C;&#x5E76;&#x4E14;&#x5728;&#x8BE5;&#x5B9E;&#x4F8B;&#x7684;&#x751F;&#x5B58;&#x671F;&#x4E2D;&#x4EC5;&#x8C03;&#x7528;&#x4E00;&#x6B21;&#x3002;</span></p><p><span class="yiyi-st" id="yiyi-110">&#x8BF7;&#x6CE8;&#x610F;&#xFF0C;&#x5728;&#x7ED3;&#x679C;&#x884C;&#x52A0;&#x8F7D;&#x671F;&#x95F4;&#xFF0C;&#x5728;&#x4E3A;&#x6B64;&#x5B9E;&#x4F8B;&#x63A5;&#x6536;&#x7684;&#x7B2C;&#x4E00;&#x884C;&#x8C03;&#x7528;&#x6B64;&#x65B9;&#x6CD5;&#x3002;</span><span class="yiyi-st" id="yiyi-111">&#x8BF7;&#x6CE8;&#x610F;&#xFF0C;&#x6839;&#x636E;&#x7ED3;&#x679C;&#x884C;&#x4E2D;&#x7684;&#x5185;&#x5BB9;&#xFF0C;&#x67D0;&#x4E9B;&#x5C5E;&#x6027;&#x548C;&#x96C6;&#x5408;&#x53EF;&#x80FD;&#x88AB;&#x52A0;&#x8F7D;&#xFF0C;&#x751A;&#x81F3;&#x53EF;&#x80FD;&#x4E0D;&#x88AB;&#x52A0;&#x8F7D;&#x6216;&#x751A;&#x81F3;&#x88AB;&#x521D;&#x59CB;&#x5316;&#x3002;</span></p><p><span class="yiyi-st" id="yiyi-112">&#x8FD4;&#x56DE;&#x503C;&#x4EC5;&#x5728;<code class="docutils literal"><span class="pre">MapperExtension</span></code>&#x94FE;&#x4E2D;&#x6709;&#x6548;&#xFF1B;&#x7236;&#x6620;&#x5C04;&#x5668;&#x7684;&#x884C;&#x4E3A;&#x4E0D;&#x4F1A;&#x88AB;&#x6B64;&#x65B9;&#x6CD5;&#x4FEE;&#x6539;&#x3002;</span></p></dd></dl></dd></dl></div><div class="section" id="session-events"><h2><span class="yiyi-st" id="yiyi-113">&#x4F1A;&#x8BDD;&#x4E8B;&#x4EF6;<a class="headerlink" href="#session-events" title="Permalink to this headline">&#xB6;</a></span></h2><dl class="class"><dt id="sqlalchemy.orm.interfaces.SessionExtension"><span class="yiyi-st" id="yiyi-114"><em class="property">class</em> <code class="descclassname">sqlalchemy.orm.interfaces&#x3002;</code> <code class="descname">SessionExtension</code> <a class="headerlink" href="#sqlalchemy.orm.interfaces.SessionExtension" title="Permalink to this definition">&#xB6;</a></span></dt><dd><p><span class="yiyi-st" id="yiyi-115"><a class="reference internal" href="session_api.html#sqlalchemy.orm.session.Session" title="sqlalchemy.orm.session.Session"><code class="xref py py-class docutils literal"><span class="pre">Session</span></code></a>&#x4E8B;&#x4EF6;&#x6302;&#x94A9;&#x7684;&#x57FA;&#x672C;&#x5B9E;&#x73B0;&#x3002;</span></p><div class="admonition note"><p class="first admonition-title"><span class="yiyi-st" id="yiyi-116">&#x6CE8;&#x610F;</span></p><p class="last"><span class="yiyi-st" id="yiyi-117"><a class="reference internal" href="#sqlalchemy.orm.interfaces.SessionExtension" title="sqlalchemy.orm.interfaces.SessionExtension"><code class="xref py py-class docutils literal"><span class="pre">SessionExtension</span></code></a> is deprecated. </span><span class="yiyi-st" id="yiyi-118">&#x8BF7;&#x53C2;&#x9605;<a class="reference internal" href="core_event.html#sqlalchemy.event.listen" title="sqlalchemy.event.listen"><code class="xref py py-func docutils literal"><span class="pre">event.listen()</span></code></a>&#x4EE5;&#x53CA;<a class="reference internal" href="events.html#sqlalchemy.orm.events.SessionEvents" title="sqlalchemy.orm.events.SessionEvents"><code class="xref py py-class docutils literal"><span class="pre">SessionEvents</span></code></a>&#x3002;</span></p></div><p><span class="yiyi-st" id="yiyi-119">&#x53EF;&#x4EE5;&#x4F7F;&#x7528;<code class="docutils literal"><span class="pre">extension</span></code>&#x5173;&#x952E;&#x5B57;&#x53C2;&#x6570;&#x5C06;&#x5B50;&#x7C7B;&#x5B89;&#x88C5;&#x5230;<a class="reference internal" href="session_api.html#sqlalchemy.orm.session.Session" title="sqlalchemy.orm.session.Session"><code class="xref py py-class docutils literal"><span class="pre">Session</span></code></a>&#xFF08;&#x6216;<a class="reference internal" href="session_api.html#sqlalchemy.orm.session.sessionmaker" title="sqlalchemy.orm.session.sessionmaker"><code class="xref py py-class docutils literal"><span class="pre">sessionmaker</span></code></a>&#xFF09;&#x4E2D;&#xFF1A;</span></p><div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sqlalchemy.orm.interfaces</span> <span class="kn">import</span> <span class="n">SessionExtension</span>

<span class="k">class</span> <span class="nc">MySessionExtension</span><span class="p">(</span><span class="n">SessionExtension</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">before_commit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">session</span><span class="p">):</span>
        <span class="k">print</span> <span class="s2">&quot;before commit!&quot;</span>

<span class="n">Session</span> <span class="o">=</span> <span class="n">sessionmaker</span><span class="p">(</span><span class="n">extension</span><span class="o">=</span><span class="n">MySessionExtension</span><span class="p">())</span></pre></div></div><p><span class="yiyi-st" id="yiyi-120">&#x540C;&#x4E00;&#x4E2A;<a class="reference internal" href="#sqlalchemy.orm.interfaces.SessionExtension" title="sqlalchemy.orm.interfaces.SessionExtension"><code class="xref py py-class docutils literal"><span class="pre">SessionExtension</span></code></a>&#x5B9E;&#x4F8B;&#x53EF;&#x4EE5;&#x7528;&#x4E8E;&#x4EFB;&#x610F;&#x6570;&#x91CF;&#x7684;&#x4F1A;&#x8BDD;&#x3002;</span></p><dl class="method"><dt id="sqlalchemy.orm.interfaces.SessionExtension.after_attach"><span class="yiyi-st" id="yiyi-121"><code class="descname">after_attach</code> <span class="sig-paren">&#xFF08;</span> <em>session</em>&#xFF0C;<em>instance</em> <span class="sig-paren">&#xFF09;</span> <a class="headerlink" href="#sqlalchemy.orm.interfaces.SessionExtension.after_attach" title="Permalink to this definition">&#xB6;</a></span></dt><dd><p><span class="yiyi-st" id="yiyi-122">&#x5728;&#x5B9E;&#x4F8B;&#x8FDE;&#x63A5;&#x5230;&#x4F1A;&#x8BDD;&#x540E;&#x6267;&#x884C;&#x3002;</span></p><p><span class="yiyi-st" id="yiyi-123">&#x8FD9;&#x662F;&#x5728;&#x6DFB;&#x52A0;&#xFF0C;&#x5220;&#x9664;&#x6216;&#x5408;&#x5E76;&#x4E4B;&#x540E;&#x8C03;&#x7528;&#x7684;&#x3002;</span></p></dd></dl><dl class="method"><dt id="sqlalchemy.orm.interfaces.SessionExtension.after_begin"><span class="yiyi-st" id="yiyi-124"> <code class="descname">after_begin</code><span class="sig-paren">(</span><em>session</em>, <em>transaction</em>, <em>connection</em><span class="sig-paren">)</span><a class="headerlink" href="#sqlalchemy.orm.interfaces.SessionExtension.after_begin" title="Permalink to this definition">&#xB6;</a></span></dt><dd><p><span class="yiyi-st" id="yiyi-125">&#x5728;&#x8FDE;&#x63A5;&#x5F00;&#x59CB;&#x4E8B;&#x52A1;&#x540E;&#x6267;&#x884C;</span></p><p><span class="yiyi-st" id="yiyi-126"><cite>transaction</cite> is the SessionTransaction. </span><span class="yiyi-st" id="yiyi-127">&#x5728;&#x8FDE;&#x63A5;&#x4E0A;&#x542F;&#x52A8;&#x5F15;&#x64CE;&#x7EA7;&#x4E8B;&#x52A1;&#x4E4B;&#x540E;&#x8C03;&#x7528;&#x6B64;&#x65B9;&#x6CD5;&#x3002;</span></p></dd></dl><dl class="method"><dt id="sqlalchemy.orm.interfaces.SessionExtension.after_bulk_delete"><span class="yiyi-st" id="yiyi-128"><code class="descname">after_bulk_delete</code> <span class="sig-paren">&#xFF08;</span> <em>&#x4F1A;&#x8BDD;</em>&#xFF0C;<em>&#x67E5;&#x8BE2;</em>&#xFF0C;<em>query_context</em>&#xFF0C;<em>&#x7ED3;&#x679C; t5 &gt; <span class="sig-paren">&#xFF09; T6&gt; <a class="headerlink" href="#sqlalchemy.orm.interfaces.SessionExtension.after_bulk_delete" title="Permalink to this definition">&#xB6; T7&gt;</a></span></em></span></dt><dd><p><span class="yiyi-st" id="yiyi-129">&#x5BF9;&#x4F1A;&#x8BDD;&#x8FDB;&#x884C;&#x6279;&#x91CF;&#x5220;&#x9664;&#x64CD;&#x4F5C;&#x540E;&#x6267;&#x884C;&#x3002;</span></p><p><span class="yiyi-st" id="yiyi-130">&#x8FD9;&#x662F;&#x5728;session.query&#xFF08;...&#xFF09;&#x3002;delete()&#x4E4B;&#x540E;&#x8C03;&#x7528;&#x7684;&#x3002;</span></p><p><span class="yiyi-st" id="yiyi-131"><cite>query</cite>&#x662F;&#x8C03;&#x7528;&#x6B64;&#x5220;&#x9664;&#x64CD;&#x4F5C;&#x7684;&#x67E5;&#x8BE2;&#x5BF9;&#x8C61;&#x3002;</span><span class="yiyi-st" id="yiyi-132"><cite>query_context</cite> was the query context object. </span><span class="yiyi-st" id="yiyi-133"><cite>&#x7ED3;&#x679C;</cite>&#x662F;&#x6279;&#x91CF;&#x64CD;&#x4F5C;&#x8FD4;&#x56DE;&#x7684;&#x7ED3;&#x679C;&#x5BF9;&#x8C61;&#x3002;</span></p></dd></dl><dl class="method"><dt id="sqlalchemy.orm.interfaces.SessionExtension.after_bulk_update"><span class="yiyi-st" id="yiyi-134"><code class="descname">after_bulk_update</code> <span class="sig-paren">&#xFF08;</span> <em>&#x4F1A;&#x8BDD;</em>&#xFF0C;<em>&#x67E5;&#x8BE2;</em>&#xFF0C;<em>query_context</em>&#xFF0C;<em>&#x7ED3;&#x679C; t5 &gt; <span class="sig-paren">&#xFF09; T6&gt; <a class="headerlink" href="#sqlalchemy.orm.interfaces.SessionExtension.after_bulk_update" title="Permalink to this definition">&#xB6; T7&gt;</a></span></em></span></dt><dd><p><span class="yiyi-st" id="yiyi-135">&#x5728;&#x6279;&#x91CF;&#x66F4;&#x65B0;&#x64CD;&#x4F5C;&#x540E;&#x6267;&#x884C;&#x4F1A;&#x8BDD;&#x3002;</span></p><p><span class="yiyi-st" id="yiyi-136">&#x8FD9;&#x662F;&#x5728;session.query&#xFF08;...&#xFF09;&#x3002;update()&#x4E4B;&#x540E;&#x8C03;&#x7528;&#x7684;&#x3002;</span></p><p><span class="yiyi-st" id="yiyi-137"><cite>query</cite>&#x662F;&#x8C03;&#x7528;&#x6B64;&#x66F4;&#x65B0;&#x64CD;&#x4F5C;&#x7684;&#x67E5;&#x8BE2;&#x5BF9;&#x8C61;&#x3002;</span><span class="yiyi-st" id="yiyi-138"><cite>query_context</cite> was the query context object. </span><span class="yiyi-st" id="yiyi-139"><cite>&#x7ED3;&#x679C;</cite>&#x662F;&#x6279;&#x91CF;&#x64CD;&#x4F5C;&#x8FD4;&#x56DE;&#x7684;&#x7ED3;&#x679C;&#x5BF9;&#x8C61;&#x3002;</span></p></dd></dl><dl class="method"><dt id="sqlalchemy.orm.interfaces.SessionExtension.after_commit"><span class="yiyi-st" id="yiyi-140"><code class="descname"> after_commit  T0&gt; <span class="sig-paren">&#xFF08; T1&gt; <em>&#x4F1A;&#x8BDD; T2&gt; <span class="sig-paren">&#xFF09; T3&gt; <a class="headerlink" href="#sqlalchemy.orm.interfaces.SessionExtension.after_commit" title="Permalink to this definition">&#xB6; T4&gt;</a></span></em></span></code></span></dt><dd><p><span class="yiyi-st" id="yiyi-141">&#x5728;&#x63D0;&#x4EA4;&#x53D1;&#x751F;&#x540E;&#x6267;&#x884C;&#x3002;</span></p><p><span class="yiyi-st" id="yiyi-142">&#x8BF7;&#x6CE8;&#x610F;&#xFF0C;&#x5982;&#x679C;&#x957F;&#x65F6;&#x95F4;&#x8FD0;&#x884C;&#x7684;&#x4E8B;&#x52A1;&#x6B63;&#x5728;&#x8FDB;&#x884C;&#xFF0C;&#x8FD9;&#x53EF;&#x80FD;&#x4E0D;&#x662F;&#x6BCF;&#x6B21;&#x5237;&#x65B0;&#x3002;</span></p></dd></dl><dl class="method"><dt id="sqlalchemy.orm.interfaces.SessionExtension.after_flush"><span class="yiyi-st" id="yiyi-143"><code class="descname">after_flush</code> <span class="sig-paren">&#xFF08;</span> <em>session</em>&#xFF0C;<em>flush_context</em> <span class="sig-paren">&#xFF09;</span> <a class="headerlink" href="#sqlalchemy.orm.interfaces.SessionExtension.after_flush" title="Permalink to this definition">&#xB6;</a></span></dt><dd><p><span class="yiyi-st" id="yiyi-144">&#x5237;&#x65B0;&#x5B8C;&#x6210;&#x540E;&#x6267;&#x884C;&#xFF0C;&#x4F46;&#x5728;&#x8C03;&#x7528;&#x63D0;&#x4EA4;&#x4E4B;&#x524D;&#x6267;&#x884C;&#x3002;</span></p><p><span class="yiyi-st" id="yiyi-145">&#x8BF7;&#x6CE8;&#x610F;&#xFF0C;&#x4F1A;&#x8BDD;&#x7684;&#x72B6;&#x6001;&#x4ECD;&#x5904;&#x4E8E;&#x9884;&#x5148;&#x5237;&#x65B0;&#x72B6;&#x6001;&#xFF0C;&#x5373;&#x201C;&#x65B0;&#x5EFA;&#x201D;&#xFF0C;&#x201C;&#x810F;&#x201D;&#x548C;&#x201C;&#x5DF2;&#x5220;&#x9664;&#x201D;&#x5217;&#x8868;&#x4ECD;&#x663E;&#x793A;&#x9884;&#x5237;&#x65B0;&#x72B6;&#x6001;&#x4EE5;&#x53CA;&#x5B9E;&#x4F8B;&#x5C5E;&#x6027;&#x7684;&#x5386;&#x53F2;&#x8BB0;&#x5F55;&#x8BBE;&#x7F6E;&#x3002;</span></p></dd></dl><dl class="method"><dt id="sqlalchemy.orm.interfaces.SessionExtension.after_flush_postexec"><span class="yiyi-st" id="yiyi-146"><code class="descname">after_flush_postexec</code> <span class="sig-paren">&#xFF08;</span> <em>session</em>&#xFF0C;<em>flush_context</em> <span class="sig-paren">&#xFF09;</span> <a class="headerlink" href="#sqlalchemy.orm.interfaces.SessionExtension.after_flush_postexec" title="Permalink to this definition"></a></span></dt><dd><p><span class="yiyi-st" id="yiyi-147">&#x5237;&#x65B0;&#x5B8C;&#x6210;&#x540E;&#x4EE5;&#x53CA;&#x6267;&#x884C;&#x540E;&#x72B6;&#x6001;&#x53D1;&#x751F;&#x540E;&#x6267;&#x884C;&#x3002;</span></p><p><span class="yiyi-st" id="yiyi-148">&#x8FD9;&#x5C06;&#x662F;&apos;&#x65B0;&apos;&#xFF0C;&apos;&#x810F;&apos;&#x548C;&apos;&#x5220;&#x9664;&apos;&#x5217;&#x8868;&#x5904;&#x4E8E;&#x6700;&#x7EC8;&#x72B6;&#x6001;&#x7684;&#x65F6;&#x5019;&#x3002;</span><span class="yiyi-st" id="yiyi-149">&#x5B9E;&#x9645;&#x63D0;&#x4EA4;()&#x53EF;&#x80FD;&#x53D1;&#x751F;&#x4E5F;&#x53EF;&#x80FD;&#x6CA1;&#x6709;&#x53D1;&#x751F;&#xFF0C;&#x5177;&#x4F53;&#x53D6;&#x51B3;&#x4E8E;flush&#x662F;&#x5426;&#x5F00;&#x59CB;&#x81EA;&#x5DF1;&#x7684;&#x4E8B;&#x52A1;&#x6216;&#x53C2;&#x4E0E;&#x66F4;&#x5927;&#x7684;&#x4E8B;&#x52A1;&#x3002;</span></p></dd></dl><dl class="method"><dt id="sqlalchemy.orm.interfaces.SessionExtension.after_rollback"><span class="yiyi-st" id="yiyi-150"><code class="descname"> after_rollback  T0&gt; <span class="sig-paren">&#xFF08; T1&gt; <em>&#x4F1A;&#x8BDD; T2&gt; <span class="sig-paren">&#xFF09; T3&gt; <a class="headerlink" href="#sqlalchemy.orm.interfaces.SessionExtension.after_rollback" title="Permalink to this definition">&#xB6; T4&gt;</a></span></em></span></code></span></dt><dd><p><span class="yiyi-st" id="yiyi-151">&#x53D1;&#x751F;&#x56DE;&#x6EDA;&#x540E;&#x6267;&#x884C;&#x3002;</span></p><p><span class="yiyi-st" id="yiyi-152">&#x8BF7;&#x6CE8;&#x610F;&#xFF0C;&#x5982;&#x679C;&#x957F;&#x65F6;&#x95F4;&#x8FD0;&#x884C;&#x7684;&#x4E8B;&#x52A1;&#x6B63;&#x5728;&#x8FDB;&#x884C;&#xFF0C;&#x8FD9;&#x53EF;&#x80FD;&#x4E0D;&#x662F;&#x6BCF;&#x6B21;&#x5237;&#x65B0;&#x3002;</span></p></dd></dl><dl class="method"><dt id="sqlalchemy.orm.interfaces.SessionExtension.before_commit"><span class="yiyi-st" id="yiyi-153"><code class="descname"> before_commit  T0&gt; <span class="sig-paren">&#xFF08; T1&gt; <em>&#x4F1A;&#x8BDD; T2&gt; <span class="sig-paren">&#xFF09; T3&gt; <a class="headerlink" href="#sqlalchemy.orm.interfaces.SessionExtension.before_commit" title="Permalink to this definition">&#xB6; T4&gt;</a></span></em></span></code></span></dt><dd><p><span class="yiyi-st" id="yiyi-154">&#x5728;&#x8C03;&#x7528;commit&#x4E4B;&#x524D;&#x6267;&#x884C;&#x3002;</span></p><p><span class="yiyi-st" id="yiyi-155">&#x8BF7;&#x6CE8;&#x610F;&#xFF0C;&#x5982;&#x679C;&#x957F;&#x65F6;&#x95F4;&#x8FD0;&#x884C;&#x7684;&#x4E8B;&#x52A1;&#x6B63;&#x5728;&#x8FDB;&#x884C;&#xFF0C;&#x8FD9;&#x53EF;&#x80FD;&#x4E0D;&#x662F;&#x6BCF;&#x6B21;&#x5237;&#x65B0;&#x3002;</span></p></dd></dl><dl class="method"><dt id="sqlalchemy.orm.interfaces.SessionExtension.before_flush"><span class="yiyi-st" id="yiyi-156"><code class="descname"> before_flush  T0&gt; <span class="sig-paren">&#xFF08; T1&gt; <em>&#x4F1A;&#x8BDD; T2&gt;&#xFF0C;<em> flush_context  T3&gt;&#xFF0C;<em>&#x5B9E;&#x4F8B; T4&gt; <span class="sig-paren">&#xFF09; T5&gt; <a class="headerlink" href="#sqlalchemy.orm.interfaces.SessionExtension.before_flush" title="Permalink to this definition">&#xB6; T6&gt;</a></span></em></em></em></span></code></span></dt><dd><p><span class="yiyi-st" id="yiyi-157">&#x5728;&#x5237;&#x65B0;&#x8FC7;&#x7A0B;&#x5F00;&#x59CB;&#x4E4B;&#x524D;&#x6267;&#x884C;&#x3002;</span></p><p><span class="yiyi-st" id="yiyi-158"><cite>&#x5B9E;&#x4F8B;</cite>&#x662F;&#x4F20;&#x9012;&#x7ED9;<code class="docutils literal"><span class="pre">flush()</span></code>&#x65B9;&#x6CD5;&#x7684;&#x5BF9;&#x8C61;&#x7684;&#x53EF;&#x9009;&#x5217;&#x8868;&#x3002;</span></p></dd></dl></dd></dl></div><div class="section" id="attribute-events"><h2><span class="yiyi-st" id="yiyi-159">&#x5C5E;&#x6027;&#x4E8B;&#x4EF6;<a class="headerlink" href="#attribute-events" title="Permalink to this headline">&#xB6;</a></span></h2><dl class="class"><dt id="sqlalchemy.orm.interfaces.AttributeExtension"><span class="yiyi-st" id="yiyi-160"><em class="property">class</em> <code class="descclassname">sqlalchemy.orm.interfaces&#x3002;</code> <code class="descname">AttributeExtension</code> <a class="headerlink" href="#sqlalchemy.orm.interfaces.AttributeExtension" title="Permalink to this definition">&#xB6;</a></span></dt><dd><p><span class="yiyi-st" id="yiyi-161"><code class="xref py py-class docutils literal"><span class="pre">AttributeImpl</span></code>&#x4E8B;&#x4EF6;&#x6302;&#x94A9;&#x7684;&#x57FA;&#x672C;&#x5B9E;&#x73B0;&#xFF0C;&#x8FD9;&#x662F;&#x5728;&#x7528;&#x6237;&#x4EE3;&#x7801;&#x4E2D;&#x5F15;&#x53D1;&#x5C5E;&#x6027;&#x7A81;&#x53D8;&#x65F6;&#x89E6;&#x53D1;&#x7684;&#x4E8B;&#x4EF6;&#x3002;</span></p><div class="admonition note"><p class="first admonition-title"><span class="yiyi-st" id="yiyi-162">&#x6CE8;&#x610F;</span></p><p class="last"><span class="yiyi-st" id="yiyi-163"><a class="reference internal" href="#sqlalchemy.orm.interfaces.AttributeExtension" title="sqlalchemy.orm.interfaces.AttributeExtension"><code class="xref py py-class docutils literal"><span class="pre">AttributeExtension</span></code></a>&#x5DF2;&#x5F03;&#x7528;&#x3002;</span><span class="yiyi-st" id="yiyi-164">&#x8BF7;&#x53C2;&#x9605;<a class="reference internal" href="core_event.html#sqlalchemy.event.listen" title="sqlalchemy.event.listen"><code class="xref py py-func docutils literal"><span class="pre">event.listen()</span></code></a>&#x4EE5;&#x53CA;<a class="reference internal" href="events.html#sqlalchemy.orm.events.AttributeEvents" title="sqlalchemy.orm.events.AttributeEvents"><code class="xref py py-class docutils literal"><span class="pre">AttributeEvents</span></code></a>&#x3002;</span></p></div><p><span class="yiyi-st" id="yiyi-165"><a class="reference internal" href="#sqlalchemy.orm.interfaces.AttributeExtension" title="sqlalchemy.orm.interfaces.AttributeExtension"><code class="xref py py-class docutils literal"><span class="pre">AttributeExtension</span></code></a>&#x7528;&#x4E8E;&#x4FA6;&#x542C;&#x8BBE;&#x7F6E;&#xFF0C;&#x5220;&#x9664;&#x548C;&#x8FFD;&#x52A0;&#x5355;&#x4E2A;&#x6620;&#x5C04;&#x5C5E;&#x6027;&#x4E0A;&#x7684;&#x4E8B;&#x4EF6;&#x3002;</span><span class="yiyi-st" id="yiyi-166">&#x5B83;&#x4F7F;&#x7528;<a class="reference internal" href="mapping_columns.html#sqlalchemy.orm.column_property" title="sqlalchemy.orm.column_property"><code class="xref py py-func docutils literal"><span class="pre">column_property()</span></code></a>&#xFF0C;<a class="reference internal" href="relationship_api.html#sqlalchemy.orm.relationship" title="sqlalchemy.orm.relationship"><code class="xref py py-func docutils literal"><span class="pre">relationship()</span></code></a>&#x548C;&#x5176;&#x4ED6;&#x7684;<cite>&#x6269;&#x5C55;</cite>&#x53C2;&#x6570;&#x5728;&#x5355;&#x72EC;&#x7684;&#x6620;&#x5C04;&#x5C5E;&#x6027;&#x4E0A;&#x5EFA;&#x7ACB;&#xFF1A;</span></p><div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sqlalchemy.orm.interfaces</span> <span class="kn">import</span> <span class="n">AttributeExtension</span>
<span class="kn">from</span> <span class="nn">sqlalchemy.orm</span> <span class="kn">import</span> <span class="n">mapper</span><span class="p">,</span> <span class="n">relationship</span><span class="p">,</span> <span class="n">column_property</span>

<span class="k">class</span> <span class="nc">MyAttrExt</span><span class="p">(</span><span class="n">AttributeExtension</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">append</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">state</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">initiator</span><span class="p">):</span>
        <span class="k">print</span> <span class="s2">&quot;append event !&quot;</span>
        <span class="k">return</span> <span class="n">value</span>

    <span class="k">def</span> <span class="nf">set</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">state</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">oldvalue</span><span class="p">,</span> <span class="n">initiator</span><span class="p">):</span>
        <span class="k">print</span> <span class="s2">&quot;set event !&quot;</span>
        <span class="k">return</span> <span class="n">value</span>

<span class="n">mapper</span><span class="p">(</span><span class="n">SomeClass</span><span class="p">,</span> <span class="n">sometable</span><span class="p">,</span> <span class="n">properties</span><span class="o">=</span><span class="p">{</span>
    <span class="s1">&apos;foo&apos;</span><span class="p">:</span><span class="n">column_property</span><span class="p">(</span><span class="n">sometable</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">foo</span><span class="p">,</span> <span class="n">extension</span><span class="o">=</span><span class="n">MyAttrExt</span><span class="p">()),</span>
    <span class="s1">&apos;bar&apos;</span><span class="p">:</span><span class="n">relationship</span><span class="p">(</span><span class="n">Bar</span><span class="p">,</span> <span class="n">extension</span><span class="o">=</span><span class="n">MyAttrExt</span><span class="p">())</span>
<span class="p">})</span></pre></div></div><p><span class="yiyi-st" id="yiyi-167">&#x8BF7;&#x6CE8;&#x610F;&#xFF0C;<a class="reference internal" href="#sqlalchemy.orm.interfaces.AttributeExtension" title="sqlalchemy.orm.interfaces.AttributeExtension"><code class="xref py py-class docutils literal"><span class="pre">AttributeExtension</span></code></a>&#x65B9;&#x6CD5;<a class="reference internal" href="#sqlalchemy.orm.interfaces.AttributeExtension.append" title="sqlalchemy.orm.interfaces.AttributeExtension.append"><code class="xref py py-meth docutils literal"><span class="pre">append()</span></code></a>&#x548C;<a class="reference internal" href="#sqlalchemy.orm.interfaces.AttributeExtension.set" title="sqlalchemy.orm.interfaces.AttributeExtension.set"><code class="xref py py-meth docutils literal"><span class="pre">set()</span></code></a>&#x9700;&#x8981;&#x8FD4;&#x56DE;<code class="docutils literal"><span class="pre">value</span></code>&#x53C2;&#x6570;&#x3002;</span><span class="yiyi-st" id="yiyi-168">&#x8FD4;&#x56DE;&#x503C;&#x7528;&#x4F5C;&#x6709;&#x6548;&#x503C;&#xFF0C;&#x5E76;&#x5141;&#x8BB8;&#x6269;&#x5C55;&#x6539;&#x53D8;&#x6700;&#x7EC8;&#x6301;&#x7EED;&#x7684;&#x5185;&#x5BB9;&#x3002;</span></p><p><span class="yiyi-st" id="yiyi-169">AttributeExtension&#x5728;&#x4E0E;&#x6620;&#x5C04;&#x7C7B;&#x5173;&#x8054;&#x7684;&#x63CF;&#x8FF0;&#x7B26;&#x4E2D;&#x7EC4;&#x88C5;&#x3002;</span></p><dl class="attribute"><dt id="sqlalchemy.orm.interfaces.AttributeExtension.active_history"><span class="yiyi-st" id="yiyi-170"><code class="descname">active_history</code> <em class="property">= True</em> <a class="headerlink" href="#sqlalchemy.orm.interfaces.AttributeExtension.active_history" title="Permalink to this definition">&#xB6;</a></span></dt><dd><p><span class="yiyi-st" id="yiyi-171">&#x8868;&#x660E;set()&#x65B9;&#x6CD5;&#x60F3;&#x8981;&#x63A5;&#x6536;&apos;&#x65E7;&apos;&#x503C;&#xFF0C;&#x5373;&#x4F7F;&#x5B83;&#x610F;&#x5473;&#x7740;&#x91CA;&#x653E;&#x61D2;&#x60F0;&#x7684;&#x53EF;&#x8C03;&#x53C2;&#x6570;&#x3002;</span></p><p><span class="yiyi-st" id="yiyi-172">&#x8BF7;&#x6CE8;&#x610F;&#xFF0C;<code class="docutils literal"><span class="pre">active_history</span></code>&#x4E5F;&#x53EF;&#x4EE5;&#x76F4;&#x63A5;&#x901A;&#x8FC7;<a class="reference internal" href="mapping_columns.html#sqlalchemy.orm.column_property" title="sqlalchemy.orm.column_property"><code class="xref py py-func docutils literal"><span class="pre">column_property()</span></code></a>&#x548C;<a class="reference internal" href="relationship_api.html#sqlalchemy.orm.relationship" title="sqlalchemy.orm.relationship"><code class="xref py py-func docutils literal"><span class="pre">relationship()</span></code></a>&#x8BBE;&#x7F6E;&#x3002;</span></p></dd></dl><dl class="method"><dt id="sqlalchemy.orm.interfaces.AttributeExtension.append"><span class="yiyi-st" id="yiyi-173"> <code class="descname">append</code><span class="sig-paren">(</span><em>state</em>, <em>value</em>, <em>initiator</em><span class="sig-paren">)</span><a class="headerlink" href="#sqlalchemy.orm.interfaces.AttributeExtension.append" title="Permalink to this definition">&#xB6;</a></span></dt><dd><p><span class="yiyi-st" id="yiyi-174">&#x6536;&#x5230;&#x8FFD;&#x52A0;&#x8FFD;&#x52A0;&#x4E8B;&#x4EF6;&#x3002;</span></p><p><span class="yiyi-st" id="yiyi-175">&#x8FD4;&#x56DE;&#x503C;&#x5C06;&#x88AB;&#x7528;&#x4F5C;&#x8981;&#x8FFD;&#x52A0;&#x7684;&#x5B9E;&#x9645;&#x503C;&#x3002;</span></p></dd></dl><dl class="method"><dt id="sqlalchemy.orm.interfaces.AttributeExtension.remove"><span class="yiyi-st" id="yiyi-176"><code class="descname">&#x5220;&#x9664;</code> <span class="sig-paren">&#xFF08;</span> <em>&#x72B6;&#x6001;</em>&#xFF0C;<em>&#x503C;</em>&#xFF0C;<em>&#x53D1;&#x8D77;&#x4EBA;</em> <span class="sig-paren">&#xFF09;</span> <a class="headerlink" href="#sqlalchemy.orm.interfaces.AttributeExtension.remove" title="Permalink to this definition">&#xB6; T6&gt;</a></span></dt><dd><p><span class="yiyi-st" id="yiyi-177">&#x6536;&#x5230;&#x79FB;&#x9664;&#x4E8B;&#x4EF6;&#x3002;</span></p><p><span class="yiyi-st" id="yiyi-178">&#x6CA1;&#x6709;&#x5B9A;&#x4E49;&#x8FD4;&#x56DE;&#x503C;&#x3002;</span></p></dd></dl><dl class="method"><dt id="sqlalchemy.orm.interfaces.AttributeExtension.set"><span class="yiyi-st" id="yiyi-179"> <code class="descname">set</code><span class="sig-paren">(</span><em>state</em>, <em>value</em>, <em>oldvalue</em>, <em>initiator</em><span class="sig-paren">)</span><a class="headerlink" href="#sqlalchemy.orm.interfaces.AttributeExtension.set" title="Permalink to this definition">&#xB6;</a></span></dt><dd><p><span class="yiyi-st" id="yiyi-180">&#x6536;&#x5230;&#x8BBE;&#x5B9A;&#x7684;&#x4E8B;&#x4EF6;&#x3002;</span></p><p><span class="yiyi-st" id="yiyi-181">&#x8FD4;&#x56DE;&#x7684;&#x503C;&#x5C06;&#x7528;&#x4F5C;&#x8981;&#x8BBE;&#x7F6E;&#x7684;&#x5B9E;&#x9645;&#x503C;&#x3002;</span></p></dd></dl></dd></dl></div>