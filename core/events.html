<h1><span class="yiyi-st" id="yiyi-41">&#x6838;&#x5FC3;&#x6D3B;&#x52A8;<a class="headerlink" href="#core-events" title="Permalink to this headline">&#xB6;</a></span></h1><p><span class="yiyi-st" id="yiyi-42">&#x672C;&#x8282;&#x4ECB;&#x7ECD;SQLAlchemy Core&#x4E2D;&#x63D0;&#x4F9B;&#x7684;&#x4E8B;&#x4EF6;&#x63A5;&#x53E3;&#x3002;</span><span class="yiyi-st" id="yiyi-43">&#x6709;&#x5173;&#x4E8B;&#x4EF6;&#x76D1;&#x542C;API&#x7684;&#x4ECB;&#x7ECD;&#xFF0C;&#x8BF7;&#x53C2;&#x9605;<a class="reference internal" href="event.html"><span>Events</span></a>&#x3002;</span><span class="yiyi-st" id="yiyi-44">ORM&#x4E8B;&#x4EF6;&#x5728;<a class="reference internal" href="orm_events.html"><span>ORM Events</span></a>&#x4E2D;&#x63CF;&#x8FF0;&#x3002;</span></p><dl class="class"><dt id="sqlalchemy.event.base.Events"><span class="yiyi-st" id="yiyi-45"><em class="property">class</em> <code class="descclassname">sqlalchemy.event.base&#x3002;</code> <code class="descname">Events</code> <a class="headerlink" href="#sqlalchemy.event.base.Events" title="Permalink to this definition">&#xB6;</a></span></dt><dd><p><span class="yiyi-st" id="yiyi-46">&#x5B9A;&#x4E49;&#x7279;&#x5B9A;&#x76EE;&#x6807;&#x7C7B;&#x578B;&#x7684;&#x4E8B;&#x4EF6;&#x76D1;&#x542C;&#x529F;&#x80FD;&#x3002;</span></p></dd></dl><div class="section" id="connection-pool-events"><h2><span class="yiyi-st" id="yiyi-47">&#x8FDE;&#x63A5;&#x6C60;&#x4E8B;&#x4EF6;<a class="headerlink" href="#connection-pool-events" title="Permalink to this headline">&#xB6;</a></span></h2><dl class="class"><dt id="sqlalchemy.events.PoolEvents"><span class="yiyi-st" id="yiyi-48"><em class="property">class</em> <code class="descclassname">sqlalchemy.events&#x3002;</code> <code class="descname">PoolEvents</code> <a class="headerlink" href="#sqlalchemy.events.PoolEvents" title="Permalink to this definition">&#xB6;</a></span></dt><dd><p><span class="yiyi-st" id="yiyi-49">&#x57FA;&#x7840;&#xFF1A;<a class="reference internal" href="#sqlalchemy.event.base.Events" title="sqlalchemy.event.base.Events"><code class="xref py py-class docutils literal"><span class="pre">sqlalchemy.event.base.Events</span></code></a></span></p><p><span class="yiyi-st" id="yiyi-50"><a class="reference internal" href="pooling.html#sqlalchemy.pool.Pool" title="sqlalchemy.pool.Pool"><code class="xref py py-class docutils literal"><span class="pre">Pool</span></code></a>&#x7684;&#x53EF;&#x7528;&#x4E8B;&#x4EF6;&#x3002;</span></p><p><span class="yiyi-st" id="yiyi-51">&#x8FD9;&#x91CC;&#x7684;&#x65B9;&#x6CD5;&#x5B9A;&#x4E49;&#x4E86;&#x4E8B;&#x4EF6;&#x7684;&#x540D;&#x79F0;&#x4EE5;&#x53CA;&#x4F20;&#x9012;&#x7ED9;&#x4FA6;&#x542C;&#x5668;&#x51FD;&#x6570;&#x7684;&#x6210;&#x5458;&#x7684;&#x540D;&#x79F0;&#x3002;</span></p><p><span class="yiyi-st" id="yiyi-52">&#x4F8B;&#x5982;&#x3002;&#xFF1A;</span></p><div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sqlalchemy</span> <span class="kn">import</span> <span class="n">event</span>

<span class="k">def</span> <span class="nf">my_on_checkout</span><span class="p">(</span><span class="n">dbapi_conn</span><span class="p">,</span> <span class="n">connection_rec</span><span class="p">,</span> <span class="n">connection_proxy</span><span class="p">):</span>
    <span class="s2">&quot;handle an on checkout event&quot;</span>

<span class="n">event</span><span class="o">.</span><span class="n">listen</span><span class="p">(</span><span class="n">Pool</span><span class="p">,</span> <span class="s1">&apos;checkout&apos;</span><span class="p">,</span> <span class="n">my_on_checkout</span><span class="p">)</span></pre></div></div><p><span class="yiyi-st" id="yiyi-53">&#x9664;&#x4E86;&#x63A5;&#x53D7;<a class="reference internal" href="pooling.html#sqlalchemy.pool.Pool" title="sqlalchemy.pool.Pool"><code class="xref py py-class docutils literal"><span class="pre">Pool</span></code></a>&#x7C7B;&#x548C;<a class="reference internal" href="pooling.html#sqlalchemy.pool.Pool" title="sqlalchemy.pool.Pool"><code class="xref py py-class docutils literal"><span class="pre">Pool</span></code></a>&#x5B9E;&#x4F8B;&#x5916;&#xFF0C;<a class="reference internal" href="#sqlalchemy.events.PoolEvents" title="sqlalchemy.events.PoolEvents"><code class="xref py py-class docutils literal"><span class="pre">PoolEvents</span></code></a>&#x8FD8;&#x63A5;&#x53D7;<a class="reference internal" href="connections.html#sqlalchemy.engine.Engine" title="sqlalchemy.engine.Engine"><code class="xref py py-class docutils literal"><span class="pre">Engine</span></code></a>&#x5BF9;&#x8C61;&#x548C;<a class="reference internal" href="connections.html#sqlalchemy.engine.Engine" title="sqlalchemy.engine.Engine"><code class="xref py py-class docutils literal"><span class="pre">Engine</span></code></a>&#x7C7B;&#x4F5C;&#x4E3A;&#x76EE;&#x6807;&#xFF0C;&#x5C06;&#x89E3;&#x6790;&#x4E3A;&#x7ED9;&#x5B9A;&#x5F15;&#x64CE;&#x6216;<a class="reference internal" href="pooling.html#sqlalchemy.pool.Pool" title="sqlalchemy.pool.Pool"><code class="xref py py-class docutils literal"><span class="pre">Pool</span></code></a>&#x7C7B;&#x7684;<code class="docutils literal"><span class="pre">.pool</span></code>&#x5C5E;&#x6027;&#xFF1A;</span></p><div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">engine</span> <span class="o">=</span> <span class="n">create_engine</span><span class="p">(</span><span class="s2">&quot;postgresql://scott:tiger@localhost/test&quot;</span><span class="p">)</span>

<span class="c1"># will associate with engine.pool</span>
<span class="n">event</span><span class="o">.</span><span class="n">listen</span><span class="p">(</span><span class="n">engine</span><span class="p">,</span> <span class="s1">&apos;checkout&apos;</span><span class="p">,</span> <span class="n">my_on_checkout</span><span class="p">)</span></pre></div></div><dl class="method"><dt id="sqlalchemy.events.PoolEvents.checkin"><span class="yiyi-st" id="yiyi-54"><code class="descname">checkin</code> <span class="sig-paren">&#xFF08;</span> <em>dbapi_connection</em>&#xFF0C;<em>connection_record</em> <span class="sig-paren">&#xFF09;</span> <a class="headerlink" href="#sqlalchemy.events.PoolEvents.checkin" title="Permalink to this definition"></a></span></dt><dd><p><span class="yiyi-st" id="yiyi-55">&#x8FDE;&#x63A5;&#x8FD4;&#x56DE;&#x5230;&#x6C60;&#x65F6;&#x8C03;&#x7528;&#x3002;</span></p><div class="event-signatures container"><p><span class="yiyi-st" id="yiyi-56">&#x793A;&#x4F8B;&#x53C2;&#x6570;&#x8868;&#x5355;&#xFF1A;</span></p><div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sqlalchemy</span> <span class="kn">import</span> <span class="n">event</span>

<span class="c1"># standard decorator style</span>
<span class="nd">@event.listens_for</span><span class="p">(</span><span class="n">SomeEngineOrPool</span><span class="p">,</span> <span class="s1">&apos;checkin&apos;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">receive_checkin</span><span class="p">(</span><span class="n">dbapi_connection</span><span class="p">,</span> <span class="n">connection_record</span><span class="p">):</span>
    <span class="s2">&quot;listen for the &apos;checkin&apos; event&quot;</span>

    <span class="c1"># ... (event handling logic) ...</span></pre></div></div></div><p><span class="yiyi-st" id="yiyi-57">&#x8BF7;&#x6CE8;&#x610F;&#xFF0C;&#x8FDE;&#x63A5;&#x53EF;&#x80FD;&#x5DF2;&#x5173;&#x95ED;&#xFF0C;&#x5982;&#x679C;&#x8FDE;&#x63A5;&#x5DF2;&#x5931;&#x6548;&#xFF0C;&#x5219;&#x53EF;&#x80FD;&#x4E3A;&#x65E0;&#x3002;</span><span class="yiyi-st" id="yiyi-58"><code class="docutils literal"><span class="pre">checkin</span></code> will not be called for detached connections. </span><span class="yiyi-st" id="yiyi-59">&#xFF08;&#x4ED6;&#x4EEC;&#x4E0D;&#x56DE;&#x5230;&#x6E38;&#x6CF3;&#x6C60;&#x3002;&#xFF09;</span></p><table class="docutils field-list" frame="void" rules="none"><tbody valign="top"><tr class="field-odd field"><th class="field-name"><span class="yiyi-st" id="yiyi-60">&#x53C2;&#x6570;&#xFF1A;</span></th><td class="field-body"><ul class="first last simple"><li><span class="yiyi-st" id="yiyi-61"><span class="target" id="sqlalchemy.events.PoolEvents.checkin.params.dbapi_connection"></span> <strong>dbapi_connection</strong> <a class="paramlink headerlink reference internal" href="#sqlalchemy.events.PoolEvents.checkin.params.dbapi_connection">&#xB6;</a>  - &#x4E00;&#x4E2A;DBAPI&#x8FDE;&#x63A5;&#x3002;</span></li><li><span class="yiyi-st" id="yiyi-62"><span class="target" id="sqlalchemy.events.PoolEvents.checkin.params.connection_record"></span> <strong>connection_record</strong> <a class="paramlink headerlink reference internal" href="#sqlalchemy.events.PoolEvents.checkin.params.connection_record">&#xB6;</a>  - &#x7BA1;&#x7406;DBAPI&#x8FDE;&#x63A5;&#x7684;<a class="reference internal" href="pooling.html#sqlalchemy.pool._ConnectionRecord" title="sqlalchemy.pool._ConnectionRecord"><code class="xref py py-class docutils literal"><span class="pre">_ConnectionRecord</span></code></a>&#x3002;</span></li></ul></td></tr></tbody></table></dd></dl><dl class="method"><dt id="sqlalchemy.events.PoolEvents.checkout"><span class="yiyi-st" id="yiyi-63"><code class="descname">&#x7ED3;&#x5E10; tt&gt; <span class="sig-paren">&#xFF08;</span> <em>dbapi_connection</em>&#xFF0C;<em>connection_record</em>&#xFF0C;<em>connection_proxy</em> <span class="sig-paren">&#xFF09;</span> <a class="headerlink" href="#sqlalchemy.events.PoolEvents.checkout" title="Permalink to this definition">&#xB6; T6&gt;</a></code></span></dt><dd><p><span class="yiyi-st" id="yiyi-64">&#x4ECE;&#x6C60;&#x4E2D;&#x68C0;&#x7D22;&#x8FDE;&#x63A5;&#x65F6;&#x8C03;&#x7528;&#x3002;</span></p><div class="event-signatures container"><p><span class="yiyi-st" id="yiyi-65">&#x793A;&#x4F8B;&#x53C2;&#x6570;&#x8868;&#x5355;&#xFF1A;</span></p><div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sqlalchemy</span> <span class="kn">import</span> <span class="n">event</span>

<span class="c1"># standard decorator style</span>
<span class="nd">@event.listens_for</span><span class="p">(</span><span class="n">SomeEngineOrPool</span><span class="p">,</span> <span class="s1">&apos;checkout&apos;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">receive_checkout</span><span class="p">(</span><span class="n">dbapi_connection</span><span class="p">,</span> <span class="n">connection_record</span><span class="p">,</span> <span class="n">connection_proxy</span><span class="p">):</span>
    <span class="s2">&quot;listen for the &apos;checkout&apos; event&quot;</span>

    <span class="c1"># ... (event handling logic) ...</span></pre></div></div></div><table class="docutils field-list" frame="void" rules="none"><tbody valign="top"><tr class="field-odd field"><th class="field-name"><span class="yiyi-st" id="yiyi-66">&#x53C2;&#x6570;&#xFF1A;</span></th><td class="field-body"><ul class="first last simple"><li><span class="yiyi-st" id="yiyi-67"><span class="target" id="sqlalchemy.events.PoolEvents.checkout.params.dbapi_connection"></span> <strong>dbapi_connection</strong> <a class="paramlink headerlink reference internal" href="#sqlalchemy.events.PoolEvents.checkout.params.dbapi_connection">&#xB6;</a>  - &#x4E00;&#x4E2A;DBAPI&#x8FDE;&#x63A5;&#x3002;</span></li><li><span class="yiyi-st" id="yiyi-68"><span class="target" id="sqlalchemy.events.PoolEvents.checkout.params.connection_record"></span> <strong>connection_record</strong> <a class="paramlink headerlink reference internal" href="#sqlalchemy.events.PoolEvents.checkout.params.connection_record">&#xB6;</a>  - &#x7BA1;&#x7406;DBAPI&#x8FDE;&#x63A5;&#x7684;<a class="reference internal" href="pooling.html#sqlalchemy.pool._ConnectionRecord" title="sqlalchemy.pool._ConnectionRecord"><code class="xref py py-class docutils literal"><span class="pre">_ConnectionRecord</span></code></a>&#x3002;</span></li><li><span class="yiyi-st" id="yiyi-69"><span class="target" id="sqlalchemy.events.PoolEvents.checkout.params.connection_proxy"></span><strong>connection_proxy</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.events.PoolEvents.checkout.params.connection_proxy">&#xB6;</a> &#x2013; the <a class="reference internal" href="pooling.html#sqlalchemy.pool._ConnectionFairy" title="sqlalchemy.pool._ConnectionFairy"><code class="xref py py-class docutils literal"><span class="pre">_ConnectionFairy</span></code></a> object which will proxy the public interface of the DBAPI connection for the lifespan of the checkout.</span></li></ul></td></tr></tbody></table><p><span class="yiyi-st" id="yiyi-70">&#x5982;&#x679C;&#x5F15;&#x53D1;<a class="reference internal" href="exceptions.html#sqlalchemy.exc.DisconnectionError" title="sqlalchemy.exc.DisconnectionError"><code class="xref py py-class docutils literal"><span class="pre">DisconnectionError</span></code></a>&#xFF0C;&#x5219;&#x5F53;&#x524D;&#x8FDE;&#x63A5;&#x5C06;&#x88AB;&#x4E22;&#x5F03;&#x5E76;&#x91CD;&#x65B0;&#x83B7;&#x53D6;&#x8FDE;&#x63A5;&#x3002;</span><span class="yiyi-st" id="yiyi-71">&#x5904;&#x7406;&#x6240;&#x6709;&#x7ED3;&#x5E10;&#x4FA6;&#x542C;&#x5668;&#x5C06;&#x4E2D;&#x6B62;&#x5E76;&#x4F7F;&#x7528;&#x65B0;&#x8FDE;&#x63A5;&#x91CD;&#x65B0;&#x542F;&#x52A8;&#x3002;</span></p><div class="admonition seealso"><p class="first admonition-title"><span class="yiyi-st" id="yiyi-72">&#x4E5F;&#x53EF;&#x4EE5;&#x770B;&#x770B;</span></p><p class="last"><span class="yiyi-st" id="yiyi-73"><a class="reference internal" href="#sqlalchemy.events.ConnectionEvents.engine_connect" title="sqlalchemy.events.ConnectionEvents.engine_connect"><code class="xref py py-meth docutils literal"><span class="pre">ConnectionEvents.engine_connect()</span></code></a>  - &#x521B;&#x5EFA;&#x65B0;&#x7684;<a class="reference internal" href="connections.html#sqlalchemy.engine.Connection" title="sqlalchemy.engine.Connection"><code class="xref py py-class docutils literal"><span class="pre">Connection</span></code></a>&#x65F6;&#x53D1;&#x751F;&#x7684;&#x7C7B;&#x4F3C;&#x4E8B;&#x4EF6;&#x3002;</span></p></div></dd></dl><dl class="method"><dt id="sqlalchemy.events.PoolEvents.close"><span class="yiyi-st" id="yiyi-74"><code class="descname">close</code> <span class="sig-paren">&#xFF08;</span> <em>dbapi_connection</em>&#xFF0C;<em>connection_record</em> <span class="sig-paren">&#xFF09;</span> <a class="headerlink" href="#sqlalchemy.events.PoolEvents.close" title="Permalink to this definition">&#xB6;</a></span></dt><dd><p><span class="yiyi-st" id="yiyi-75">&#x5F53;DBAPI&#x8FDE;&#x63A5;&#x5173;&#x95ED;&#x65F6;&#x8C03;&#x7528;&#x3002;</span></p><div class="event-signatures container"><p><span class="yiyi-st" id="yiyi-76">&#x793A;&#x4F8B;&#x53C2;&#x6570;&#x8868;&#x5355;&#xFF1A;</span></p><div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sqlalchemy</span> <span class="kn">import</span> <span class="n">event</span>

<span class="c1"># standard decorator style</span>
<span class="nd">@event.listens_for</span><span class="p">(</span><span class="n">SomeEngineOrPool</span><span class="p">,</span> <span class="s1">&apos;close&apos;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">receive_close</span><span class="p">(</span><span class="n">dbapi_connection</span><span class="p">,</span> <span class="n">connection_record</span><span class="p">):</span>
    <span class="s2">&quot;listen for the &apos;close&apos; event&quot;</span>

    <span class="c1"># ... (event handling logic) ...</span></pre></div></div></div><p><span class="yiyi-st" id="yiyi-77">&#x4E8B;&#x4EF6;&#x5728;&#x6536;&#x76D8;&#x524D;&#x53D1;&#x51FA;&#x3002;</span></p><p><span class="yiyi-st" id="yiyi-78">&#x8FDE;&#x63A5;&#x5173;&#x95ED;&#x53EF;&#x80FD;&#x5931;&#x8D25;&#xFF1B;&#x901A;&#x5E38;&#x8FD9;&#x662F;&#x56E0;&#x4E3A;&#x8FDE;&#x63A5;&#x5DF2;&#x7ECF;&#x5173;&#x95ED;&#x3002;</span><span class="yiyi-st" id="yiyi-79">&#x5982;&#x679C;&#x5173;&#x95ED;&#x64CD;&#x4F5C;&#x5931;&#x8D25;&#xFF0C;&#x8FDE;&#x63A5;&#x5C06;&#x88AB;&#x4E22;&#x5F03;&#x3002;</span></p><p><span class="yiyi-st" id="yiyi-80"><a class="reference internal" href="connections.html#sqlalchemy.engine.Connection.close" title="sqlalchemy.engine.Connection.close"><code class="xref py py-meth docutils literal"><span class="pre">close()</span></code></a>&#x4E8B;&#x4EF6;&#x5BF9;&#x5E94;&#x4E8E;&#x4ECD;&#x4E0E;&#x8BE5;&#x6C60;&#x5173;&#x8054;&#x7684;&#x8FDE;&#x63A5;&#x3002;</span><span class="yiyi-st" id="yiyi-81">&#x8981;&#x4E3A;&#x5206;&#x79BB;&#x8FDE;&#x63A5;&#x62E6;&#x622A;&#x5173;&#x95ED;&#x4E8B;&#x4EF6;&#xFF0C;&#x8BF7;&#x4F7F;&#x7528;<a class="reference internal" href="#sqlalchemy.events.PoolEvents.close_detached" title="sqlalchemy.events.PoolEvents.close_detached"><code class="xref py py-meth docutils literal"><span class="pre">close_detached()</span></code></a>&#x3002;</span></p><div class="versionadded"><p><span class="yiyi-st" id="yiyi-82"><span class="versionmodified">&#x7248;&#x672C;1.1&#x4E2D;&#x7684;&#x65B0;&#x529F;&#x80FD;</span></span></p></div></dd></dl><dl class="method"><dt id="sqlalchemy.events.PoolEvents.close_detached"><span class="yiyi-st" id="yiyi-83"><code class="descname"> close_detached  T0&gt; <span class="sig-paren">&#xFF08; T1&gt; <em> dbapi_connection  T2&gt; <span class="sig-paren">&#xFF09; T3&gt; <a class="headerlink" href="#sqlalchemy.events.PoolEvents.close_detached" title="Permalink to this definition">&#xB6; T4&gt;</a></span></em></span></code></span></dt><dd><p><span class="yiyi-st" id="yiyi-84">&#x5F53;&#x5206;&#x79BB;&#x7684;DBAPI&#x8FDE;&#x63A5;&#x5173;&#x95ED;&#x65F6;&#x8C03;&#x7528;&#x3002;</span></p><div class="event-signatures container"><p><span class="yiyi-st" id="yiyi-85">&#x793A;&#x4F8B;&#x53C2;&#x6570;&#x8868;&#x5355;&#xFF1A;</span></p><div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sqlalchemy</span> <span class="kn">import</span> <span class="n">event</span>

<span class="c1"># standard decorator style</span>
<span class="nd">@event.listens_for</span><span class="p">(</span><span class="n">SomeEngineOrPool</span><span class="p">,</span> <span class="s1">&apos;close_detached&apos;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">receive_close_detached</span><span class="p">(</span><span class="n">dbapi_connection</span><span class="p">):</span>
    <span class="s2">&quot;listen for the &apos;close_detached&apos; event&quot;</span>

    <span class="c1"># ... (event handling logic) ...</span></pre></div></div></div><p><span class="yiyi-st" id="yiyi-86">&#x4E8B;&#x4EF6;&#x5728;&#x6536;&#x76D8;&#x524D;&#x53D1;&#x51FA;&#x3002;</span></p><p><span class="yiyi-st" id="yiyi-87">&#x8FDE;&#x63A5;&#x5173;&#x95ED;&#x53EF;&#x80FD;&#x5931;&#x8D25;&#xFF1B;&#x901A;&#x5E38;&#x8FD9;&#x662F;&#x56E0;&#x4E3A;&#x8FDE;&#x63A5;&#x5DF2;&#x7ECF;&#x5173;&#x95ED;&#x3002;</span><span class="yiyi-st" id="yiyi-88">&#x5982;&#x679C;&#x5173;&#x95ED;&#x64CD;&#x4F5C;&#x5931;&#x8D25;&#xFF0C;&#x8FDE;&#x63A5;&#x5C06;&#x88AB;&#x4E22;&#x5F03;&#x3002;</span></p><div class="versionadded"><p><span class="yiyi-st" id="yiyi-89"><span class="versionmodified">&#x7248;&#x672C;1.1&#x4E2D;&#x7684;&#x65B0;&#x529F;&#x80FD;</span></span></p></div></dd></dl><dl class="method"><dt id="sqlalchemy.events.PoolEvents.connect"><span class="yiyi-st" id="yiyi-90"><code class="descname">connect  tt&gt; <span class="sig-paren">&#xFF08;</span> <em>dbapi_connection</em>&#xFF0C;<em>connection_record</em> <span class="sig-paren">&#xFF09;</span> <a class="headerlink" href="#sqlalchemy.events.PoolEvents.connect" title="Permalink to this definition">&#xB6;</a></code></span></dt><dd><p><span class="yiyi-st" id="yiyi-91">&#x9996;&#x5148;&#x4E3A;&#x7ED9;&#x5B9A;&#x7684;<a class="reference internal" href="pooling.html#sqlalchemy.pool.Pool" title="sqlalchemy.pool.Pool"><code class="xref py py-class docutils literal"><span class="pre">Pool</span></code></a>&#x521B;&#x5EFA;&#x4E00;&#x4E2A;&#x7279;&#x5B9A;&#x7684;DBAPI&#x8FDE;&#x63A5;&#x3002;</span></p><div class="event-signatures container"><p><span class="yiyi-st" id="yiyi-92">&#x793A;&#x4F8B;&#x53C2;&#x6570;&#x8868;&#x5355;&#xFF1A;</span></p><div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sqlalchemy</span> <span class="kn">import</span> <span class="n">event</span>

<span class="c1"># standard decorator style</span>
<span class="nd">@event.listens_for</span><span class="p">(</span><span class="n">SomeEngineOrPool</span><span class="p">,</span> <span class="s1">&apos;connect&apos;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">receive_connect</span><span class="p">(</span><span class="n">dbapi_connection</span><span class="p">,</span> <span class="n">connection_record</span><span class="p">):</span>
    <span class="s2">&quot;listen for the &apos;connect&apos; event&quot;</span>

    <span class="c1"># ... (event handling logic) ...</span></pre></div></div></div><p><span class="yiyi-st" id="yiyi-93">&#x6B64;&#x4E8B;&#x4EF6;&#x5141;&#x8BB8;&#x6355;&#x83B7;&#x76F4;&#x63A5;&#x4F7F;&#x7528;DBAPI&#x6A21;&#x5757;&#x7EA7;&#x522B;<code class="docutils literal"><span class="pre">.connect()</span></code>&#x65B9;&#x6CD5;&#x751F;&#x6210;&#x65B0;&#x7684;DBAPI&#x8FDE;&#x63A5;&#x7684;&#x70B9;&#x3002;</span></p><table class="docutils field-list" frame="void" rules="none"><tbody valign="top"><tr class="field-odd field"><th class="field-name"><span class="yiyi-st" id="yiyi-94">&#x53C2;&#x6570;&#xFF1A;</span></th><td class="field-body"><ul class="first last simple"><li><span class="yiyi-st" id="yiyi-95"><span class="target" id="sqlalchemy.events.PoolEvents.connect.params.dbapi_connection"></span> <strong>dbapi_connection</strong> <a class="paramlink headerlink reference internal" href="#sqlalchemy.events.PoolEvents.connect.params.dbapi_connection">&#xB6;</a>  - &#x4E00;&#x4E2A;DBAPI&#x8FDE;&#x63A5;&#x3002;</span></li><li><span class="yiyi-st" id="yiyi-96"><span class="target" id="sqlalchemy.events.PoolEvents.connect.params.connection_record"></span> <strong>connection_record</strong> <a class="paramlink headerlink reference internal" href="#sqlalchemy.events.PoolEvents.connect.params.connection_record">&#xB6;</a>  - &#x7BA1;&#x7406;DBAPI&#x8FDE;&#x63A5;&#x7684;<a class="reference internal" href="pooling.html#sqlalchemy.pool._ConnectionRecord" title="sqlalchemy.pool._ConnectionRecord"><code class="xref py py-class docutils literal"><span class="pre">_ConnectionRecord</span></code></a>&#x3002;</span></li></ul></td></tr></tbody></table></dd></dl><dl class="method"><dt id="sqlalchemy.events.PoolEvents.detach"><span class="yiyi-st" id="yiyi-97"><code class="descname">detach</code> <span class="sig-paren">&#xFF08;</span> <em>dbapi_connection</em>&#xFF0C;<em>connection_record</em> <span class="sig-paren">&#xFF09;</span> <a class="headerlink" href="#sqlalchemy.events.PoolEvents.detach" title="Permalink to this definition">&#xB6;</a></span></dt><dd><p><span class="yiyi-st" id="yiyi-98">&#x5F53;DBAPI&#x8FDE;&#x63A5;&#x4ECE;&#x6C60;&#x4E2D;&#x201C;&#x5206;&#x79BB;&#x201D;&#x65F6;&#x8C03;&#x7528;&#x3002;</span></p><div class="event-signatures container"><p><span class="yiyi-st" id="yiyi-99">&#x793A;&#x4F8B;&#x53C2;&#x6570;&#x8868;&#x5355;&#xFF1A;</span></p><div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sqlalchemy</span> <span class="kn">import</span> <span class="n">event</span>

<span class="c1"># standard decorator style</span>
<span class="nd">@event.listens_for</span><span class="p">(</span><span class="n">SomeEngineOrPool</span><span class="p">,</span> <span class="s1">&apos;detach&apos;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">receive_detach</span><span class="p">(</span><span class="n">dbapi_connection</span><span class="p">,</span> <span class="n">connection_record</span><span class="p">):</span>
    <span class="s2">&quot;listen for the &apos;detach&apos; event&quot;</span>

    <span class="c1"># ... (event handling logic) ...</span></pre></div></div></div><p><span class="yiyi-st" id="yiyi-100">&#x6B64;&#x4E8B;&#x4EF6;&#x5728;&#x5206;&#x79BB;&#x53D1;&#x751F;&#x540E;&#x53D1;&#x51FA;&#x3002;</span><span class="yiyi-st" id="yiyi-101">&#x8BE5;&#x8FDE;&#x63A5;&#x4E0D;&#x518D;&#x4E0E;&#x7ED9;&#x5B9A;&#x7684;&#x8FDE;&#x63A5;&#x8BB0;&#x5F55;&#x76F8;&#x5173;&#x8054;&#x3002;</span></p><div class="versionadded"><p><span class="yiyi-st" id="yiyi-102"><span class="versionmodified">&#x7248;&#x672C;1.1&#x4E2D;&#x7684;&#x65B0;&#x529F;&#x80FD;</span></span></p></div></dd></dl><dl class="method"><dt id="sqlalchemy.events.PoolEvents.first_connect"><span class="yiyi-st" id="yiyi-103"> <code class="descname">first_connect</code><span class="sig-paren">(</span><em>dbapi_connection</em>, <em>connection_record</em><span class="sig-paren">)</span><a class="headerlink" href="#sqlalchemy.events.PoolEvents.first_connect" title="Permalink to this definition">&#xB6;</a></span></dt><dd><p><span class="yiyi-st" id="yiyi-104">&#x7B2C;&#x4E00;&#x6B21;&#x4ECE;&#x7279;&#x5B9A;&#x7684;<a class="reference internal" href="pooling.html#sqlalchemy.pool.Pool" title="sqlalchemy.pool.Pool"><code class="xref py py-class docutils literal"><span class="pre">Pool</span></code></a>&#x4E2D;&#x68C0;&#x51FA;DBAPI&#x8FDE;&#x63A5;&#x65F6;&#xFF0C;&#x53EA;&#x8C03;&#x7528;&#x4E00;&#x6B21;&#x3002;</span></p><div class="event-signatures container"><p><span class="yiyi-st" id="yiyi-105">&#x793A;&#x4F8B;&#x53C2;&#x6570;&#x8868;&#x5355;&#xFF1A;</span></p><div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sqlalchemy</span> <span class="kn">import</span> <span class="n">event</span>

<span class="c1"># standard decorator style</span>
<span class="nd">@event.listens_for</span><span class="p">(</span><span class="n">SomeEngineOrPool</span><span class="p">,</span> <span class="s1">&apos;first_connect&apos;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">receive_first_connect</span><span class="p">(</span><span class="n">dbapi_connection</span><span class="p">,</span> <span class="n">connection_record</span><span class="p">):</span>
    <span class="s2">&quot;listen for the &apos;first_connect&apos; event&quot;</span>

    <span class="c1"># ... (event handling logic) ...</span></pre></div></div></div><p><span class="yiyi-st" id="yiyi-106"><a class="reference internal" href="#sqlalchemy.events.PoolEvents.first_connect" title="sqlalchemy.events.PoolEvents.first_connect"><code class="xref py py-meth docutils literal"><span class="pre">PoolEvents.first_connect()</span></code></a>&#x7684;&#x57FA;&#x672C;&#x539F;&#x7406;&#x662F;&#x6839;&#x636E;&#x7528;&#x4E8E;&#x6240;&#x6709;&#x8FDE;&#x63A5;&#x7684;&#x8BBE;&#x7F6E;&#x786E;&#x5B9A;&#x6709;&#x5173;&#x7279;&#x5B9A;&#x7CFB;&#x5217;&#x6570;&#x636E;&#x5E93;&#x8FDE;&#x63A5;&#x7684;&#x4FE1;&#x606F;&#x3002;</span><span class="yiyi-st" id="yiyi-107">&#x7531;&#x4E8E;&#x7279;&#x5B9A;&#x7684;<a class="reference internal" href="pooling.html#sqlalchemy.pool.Pool" title="sqlalchemy.pool.Pool"><code class="xref py py-class docutils literal"><span class="pre">Pool</span></code></a>&#x662F;&#x6307;&#x5355;&#x4E2A;&#x201C;creator&#x201D;&#x51FD;&#x6570;&#xFF08;&#x6839;&#x636E;<a class="reference internal" href="connections.html#sqlalchemy.engine.Engine" title="sqlalchemy.engine.Engine"><code class="xref py py-class docutils literal"><span class="pre">Engine</span></code></a>&#x5F15;&#x7528;&#x6240;&#x4F7F;&#x7528;&#x7684;URL&#x548C;&#x8FDE;&#x63A5;&#x9009;&#x9879;&#xFF09;&#xFF0C;&#x56E0;&#x6B64;&#x901A;&#x5E38;&#x53EF;&#x4EE5;&#x8FDB;&#x884C;&#x89C2;&#x5BDF;&#x5173;&#x4E8E;&#x5355;&#x4E2A;&#x8FDE;&#x63A5;&#x53EF;&#x4EE5;&#x5B89;&#x5168;&#x5730;&#x5047;&#x5B9A;&#x4E3A;&#x5BF9;&#x6240;&#x6709;&#x540E;&#x7EED;&#x8FDE;&#x63A5;&#x6709;&#x6548;&#xFF0C;&#x4F8B;&#x5982;&#x6570;&#x636E;&#x5E93;&#x7248;&#x672C;&#xFF0C;&#x670D;&#x52A1;&#x5668;&#x548C;&#x5BA2;&#x6237;&#x7AEF;&#x7F16;&#x7801;&#x8BBE;&#x7F6E;&#xFF0C;&#x6392;&#x5E8F;&#x89C4;&#x5219;&#x8BBE;&#x7F6E;&#x4EE5;&#x53CA;&#x5176;&#x4ED6;&#x8BB8;&#x591A;&#x8FDE;&#x63A5;&#x3002;</span></p><table class="docutils field-list" frame="void" rules="none"><tbody valign="top"><tr class="field-odd field"><th class="field-name"><span class="yiyi-st" id="yiyi-108">&#x53C2;&#x6570;&#xFF1A;</span></th><td class="field-body"><ul class="first last simple"><li><span class="yiyi-st" id="yiyi-109"><span class="target" id="sqlalchemy.events.PoolEvents.first_connect.params.dbapi_connection"></span> <strong>dbapi_connection</strong> <a class="paramlink headerlink reference internal" href="#sqlalchemy.events.PoolEvents.first_connect.params.dbapi_connection">&#xB6;</a>  - &#x4E00;&#x4E2A;DBAPI&#x8FDE;&#x63A5;&#x3002;</span></li><li><span class="yiyi-st" id="yiyi-110"><span class="target" id="sqlalchemy.events.PoolEvents.first_connect.params.connection_record"></span> <strong>connection_record</strong> <a class="paramlink headerlink reference internal" href="#sqlalchemy.events.PoolEvents.first_connect.params.connection_record">&#xB6;</a>  - &#x7BA1;&#x7406;DBAPI&#x8FDE;&#x63A5;&#x7684;<a class="reference internal" href="pooling.html#sqlalchemy.pool._ConnectionRecord" title="sqlalchemy.pool._ConnectionRecord"><code class="xref py py-class docutils literal"><span class="pre">_ConnectionRecord</span></code></a>&#x3002;</span></li></ul></td></tr></tbody></table></dd></dl><dl class="method"><dt id="sqlalchemy.events.PoolEvents.invalidate"><span class="yiyi-st" id="yiyi-111"><code class="descname">&#x65E0;&#x6548; tt&gt; <span class="sig-paren">&#xFF08;</span> <em>dbapi_connection</em>&#xFF0C;<em>connection_record</em>&#xFF0C;<em>&#x5F02;&#x5E38;</em> <span class="sig-paren">&#xFF09;</span> <a class="headerlink" href="#sqlalchemy.events.PoolEvents.invalidate" title="Permalink to this definition">&#xB6; T6&gt;</a></code></span></dt><dd><p><span class="yiyi-st" id="yiyi-112">&#x5F53;DBAPI&#x8FDE;&#x63A5;&#x201C;&#x5931;&#x6548;&#x201D;&#x65F6;&#x8C03;&#x7528;&#x3002;</span></p><div class="event-signatures container"><p><span class="yiyi-st" id="yiyi-113">&#x793A;&#x4F8B;&#x53C2;&#x6570;&#x8868;&#x5355;&#xFF1A;</span></p><div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sqlalchemy</span> <span class="kn">import</span> <span class="n">event</span>

<span class="c1"># standard decorator style</span>
<span class="nd">@event.listens_for</span><span class="p">(</span><span class="n">SomeEngineOrPool</span><span class="p">,</span> <span class="s1">&apos;invalidate&apos;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">receive_invalidate</span><span class="p">(</span><span class="n">dbapi_connection</span><span class="p">,</span> <span class="n">connection_record</span><span class="p">,</span> <span class="n">exception</span><span class="p">):</span>
    <span class="s2">&quot;listen for the &apos;invalidate&apos; event&quot;</span>

    <span class="c1"># ... (event handling logic) ...</span></pre></div></div></div><p><span class="yiyi-st" id="yiyi-114">&#x6BCF;&#x6B21;&#x8C03;&#x7528;<a class="reference internal" href="pooling.html#sqlalchemy.pool._ConnectionRecord.invalidate" title="sqlalchemy.pool._ConnectionRecord.invalidate"><code class="xref py py-meth docutils literal"><span class="pre">_ConnectionRecord.invalidate()</span></code></a>&#x65B9;&#x6CD5;&#x65F6;&#xFF0C;&#x90FD;&#x4F1A;&#x8C03;&#x7528;&#x6B64;&#x4E8B;&#x4EF6;&#xFF0C;&#x65E0;&#x8BBA;&#x662F;API&#x4F7F;&#x7528;&#x8FD8;&#x662F;&#x901A;&#x8FC7;&#x201C;&#x81EA;&#x52A8;&#x5931;&#x6548;&#x201D;&#xFF0C;&#x90FD;&#x6CA1;&#x6709;<code class="docutils literal"><span class="pre">soft</span></code>&#x6807;&#x5FD7;&#x3002;</span></p><p><span class="yiyi-st" id="yiyi-115">&#x4E8B;&#x4EF6;&#x53D1;&#x751F;&#x5728;&#x6700;&#x7EC8;&#x5C1D;&#x8BD5;&#x5728;&#x8FDE;&#x63A5;&#x4E0A;&#x8C03;&#x7528;<code class="docutils literal"><span class="pre">.close()</span></code>&#x4E4B;&#x524D;&#x53D1;&#x751F;&#x3002;</span></p><table class="docutils field-list" frame="void" rules="none"><tbody valign="top"><tr class="field-odd field"><th class="field-name"><span class="yiyi-st" id="yiyi-116">&#x53C2;&#x6570;&#xFF1A;</span></th><td class="field-body"><ul class="first last simple"><li><span class="yiyi-st" id="yiyi-117"><span class="target" id="sqlalchemy.events.PoolEvents.invalidate.params.dbapi_connection"></span> <strong>dbapi_connection</strong> <a class="paramlink headerlink reference internal" href="#sqlalchemy.events.PoolEvents.invalidate.params.dbapi_connection">&#xB6;</a>  - &#x4E00;&#x4E2A;DBAPI&#x8FDE;&#x63A5;&#x3002;</span></li><li><span class="yiyi-st" id="yiyi-118"><span class="target" id="sqlalchemy.events.PoolEvents.invalidate.params.connection_record"></span> <strong>connection_record</strong> <a class="paramlink headerlink reference internal" href="#sqlalchemy.events.PoolEvents.invalidate.params.connection_record">&#xB6;</a>  - &#x7BA1;&#x7406;DBAPI&#x8FDE;&#x63A5;&#x7684;<a class="reference internal" href="pooling.html#sqlalchemy.pool._ConnectionRecord" title="sqlalchemy.pool._ConnectionRecord"><code class="xref py py-class docutils literal"><span class="pre">_ConnectionRecord</span></code></a>&#x3002;</span></li><li><span class="yiyi-st" id="yiyi-119"><span class="target" id="sqlalchemy.events.PoolEvents.invalidate.params.exception"></span><strong>exception</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.events.PoolEvents.invalidate.params.exception">&#xB6;</a> &#x2013; the exception object corresponding to the reason for this invalidation, if any. </span><span class="yiyi-st" id="yiyi-120">&#x53EF;&#x80FD;&#x662F;<code class="docutils literal"><span class="pre">None</span></code>&#x3002;</span></li></ul></td></tr></tbody></table><div class="versionadded"><p><span class="yiyi-st" id="yiyi-121"><span class="versionmodified">&#x7248;&#x672C;0.9.2&#x65B0;&#x589E;&#xFF1A;</span>&#x589E;&#x52A0;&#x4E86;&#x5BF9;&#x8FDE;&#x63A5;&#x5931;&#x6548;&#x4FA6;&#x542C;&#x7684;&#x652F;&#x6301;&#x3002;</span></p></div><div class="admonition seealso"><p class="first admonition-title"><span class="yiyi-st" id="yiyi-122">&#x4E5F;&#x53EF;&#x4EE5;&#x770B;&#x770B;</span></p><p class="last"><span class="yiyi-st" id="yiyi-123"><a class="reference internal" href="pooling.html#pool-connection-invalidation"><span>More on Invalidation</span></a></span></p></div></dd></dl><dl class="method"><dt id="sqlalchemy.events.PoolEvents.reset"><span class="yiyi-st" id="yiyi-124"><code class="descname">reset</code> <span class="sig-paren">&#xFF08;</span> <em>dbapi_connection</em>&#xFF0C;<em>connection_record</em> <span class="sig-paren">&#xFF09;</span> <a class="headerlink" href="#sqlalchemy.events.PoolEvents.reset" title="Permalink to this definition"></a></span></dt><dd><p><span class="yiyi-st" id="yiyi-125">&#x5728;&#x96C6;&#x4E2D;&#x8FDE;&#x63A5;&#x53D1;&#x751F;&#x201C;&#x91CD;&#x7F6E;&#x201D;&#x64CD;&#x4F5C;&#x4E4B;&#x524D;&#x8C03;&#x7528;&#x3002;</span></p><div class="event-signatures container"><p><span class="yiyi-st" id="yiyi-126">&#x793A;&#x4F8B;&#x53C2;&#x6570;&#x8868;&#x5355;&#xFF1A;</span></p><div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sqlalchemy</span> <span class="kn">import</span> <span class="n">event</span>

<span class="c1"># standard decorator style</span>
<span class="nd">@event.listens_for</span><span class="p">(</span><span class="n">SomeEngineOrPool</span><span class="p">,</span> <span class="s1">&apos;reset&apos;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">receive_reset</span><span class="p">(</span><span class="n">dbapi_connection</span><span class="p">,</span> <span class="n">connection_record</span><span class="p">):</span>
    <span class="s2">&quot;listen for the &apos;reset&apos; event&quot;</span>

    <span class="c1"># ... (event handling logic) ...</span></pre></div></div></div><p><span class="yiyi-st" id="yiyi-127">&#x6B64;&#x4E8B;&#x4EF6;&#x8868;&#x793A;&#x4F55;&#x65F6;&#x5728;&#x5C06;DBAPI&#x8FDE;&#x63A5;&#x8FD4;&#x56DE;&#x5230;&#x6C60;&#x4E4B;&#x524D;&#x8C03;&#x7528;<code class="docutils literal"><span class="pre">rollback()</span></code>&#x65B9;&#x6CD5;&#x3002;</span><span class="yiyi-st" id="yiyi-128">&#x4F7F;&#x7528;<code class="docutils literal"><span class="pre">reset_on_return</span></code>&#x6C60;&#x53C2;&#x6570;&#x53EF;&#x4EE5;&#x63A7;&#x5236;&#x201C;reset&#x201D;&#x7684;&#x884C;&#x4E3A;&#xFF0C;&#x5305;&#x62EC;&#x7981;&#x7528;&#x3002;</span></p><p><span class="yiyi-st" id="yiyi-129">The <a class="reference internal" href="#sqlalchemy.events.PoolEvents.reset" title="sqlalchemy.events.PoolEvents.reset"><code class="xref py py-meth docutils literal"><span class="pre">PoolEvents.reset()</span></code></a> event is usually followed by the <a class="reference internal" href="#sqlalchemy.events.PoolEvents.checkin" title="sqlalchemy.events.PoolEvents.checkin"><code class="xref py py-meth docutils literal"><span class="pre">PoolEvents.checkin()</span></code></a> event is called, except in those cases where the connection is discarded immediately after reset.</span></p><table class="docutils field-list" frame="void" rules="none"><tbody valign="top"><tr class="field-odd field"><th class="field-name"><span class="yiyi-st" id="yiyi-130">&#x53C2;&#x6570;&#xFF1A;</span></th><td class="field-body"><ul class="first last simple"><li><span class="yiyi-st" id="yiyi-131"><span class="target" id="sqlalchemy.events.PoolEvents.reset.params.dbapi_connection"></span> <strong>dbapi_connection</strong> <a class="paramlink headerlink reference internal" href="#sqlalchemy.events.PoolEvents.reset.params.dbapi_connection">&#xB6;</a>  - &#x4E00;&#x4E2A;DBAPI&#x8FDE;&#x63A5;&#x3002;</span></li><li><span class="yiyi-st" id="yiyi-132"><span class="target" id="sqlalchemy.events.PoolEvents.reset.params.connection_record"></span> <strong>connection_record</strong> <a class="paramlink headerlink reference internal" href="#sqlalchemy.events.PoolEvents.reset.params.connection_record">&#xB6;</a>  - &#x7BA1;&#x7406;DBAPI&#x8FDE;&#x63A5;&#x7684;<a class="reference internal" href="pooling.html#sqlalchemy.pool._ConnectionRecord" title="sqlalchemy.pool._ConnectionRecord"><code class="xref py py-class docutils literal"><span class="pre">_ConnectionRecord</span></code></a>&#x3002;</span></li></ul></td></tr></tbody></table><div class="versionadded"><p><span class="yiyi-st" id="yiyi-133"><span class="versionmodified">0.8&#x7248;&#x672C;&#x4E2D;&#x7684;&#x65B0;&#x529F;&#x80FD;</span></span></p></div><div class="admonition seealso"><p class="first admonition-title"><span class="yiyi-st" id="yiyi-134">&#x4E5F;&#x53EF;&#x4EE5;&#x770B;&#x770B;</span></p><p><span class="yiyi-st" id="yiyi-135"><a class="reference internal" href="#sqlalchemy.events.ConnectionEvents.rollback" title="sqlalchemy.events.ConnectionEvents.rollback"><code class="xref py py-meth docutils literal"><span class="pre">ConnectionEvents.rollback()</span></code></a></span></p><p class="last"><span class="yiyi-st" id="yiyi-136"><a class="reference internal" href="#sqlalchemy.events.ConnectionEvents.commit" title="sqlalchemy.events.ConnectionEvents.commit"><code class="xref py py-meth docutils literal"><span class="pre">ConnectionEvents.commit()</span></code></a></span></p></div></dd></dl><dl class="method"><dt id="sqlalchemy.events.PoolEvents.soft_invalidate"><span class="yiyi-st" id="yiyi-137"><code class="descname">soft_invalidate  tt&gt; <span class="sig-paren">&#xFF08;</span> <em>dbapi_connection</em>&#xFF0C;<em>connection_record</em>&#xFF0C;<em>&#x5F02;&#x5E38;</em> <span class="sig-paren">&#xFF09;</span> <a class="headerlink" href="#sqlalchemy.events.PoolEvents.soft_invalidate" title="Permalink to this definition">&#xB6; T6&gt;</a></code></span></dt><dd><p><span class="yiyi-st" id="yiyi-138">&#x5F53;DBAPI&#x8FDE;&#x63A5;&#x5C06;&#x88AB;&#x201C;&#x8F6F;&#x5931;&#x6548;&#x201D;&#x65F6;&#x8C03;&#x7528;&#x3002;</span></p><div class="event-signatures container"><p><span class="yiyi-st" id="yiyi-139">&#x793A;&#x4F8B;&#x53C2;&#x6570;&#x8868;&#x5355;&#xFF1A;</span></p><div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sqlalchemy</span> <span class="kn">import</span> <span class="n">event</span>

<span class="c1"># standard decorator style</span>
<span class="nd">@event.listens_for</span><span class="p">(</span><span class="n">SomeEngineOrPool</span><span class="p">,</span> <span class="s1">&apos;soft_invalidate&apos;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">receive_soft_invalidate</span><span class="p">(</span><span class="n">dbapi_connection</span><span class="p">,</span> <span class="n">connection_record</span><span class="p">,</span> <span class="n">exception</span><span class="p">):</span>
    <span class="s2">&quot;listen for the &apos;soft_invalidate&apos; event&quot;</span>

    <span class="c1"># ... (event handling logic) ...</span></pre></div></div></div><p><span class="yiyi-st" id="yiyi-140">&#x6BCF;&#x6B21;&#x4F7F;&#x7528;<code class="docutils literal"><span class="pre">soft</span></code>&#x6807;&#x5FD7;&#x8C03;&#x7528;<a class="reference internal" href="pooling.html#sqlalchemy.pool._ConnectionRecord.invalidate" title="sqlalchemy.pool._ConnectionRecord.invalidate"><code class="xref py py-meth docutils literal"><span class="pre">_ConnectionRecord.invalidate()</span></code></a>&#x65B9;&#x6CD5;&#x65F6;&#x90FD;&#x4F1A;&#x8C03;&#x7528;&#x6B64;&#x4E8B;&#x4EF6;&#x3002;</span></p><p><span class="yiyi-st" id="yiyi-141">&#x8F6F;&#x5931;&#x6548;&#x6307;&#x7684;&#x662F;&#x8DDF;&#x8E2A;&#x6B64;&#x8FDE;&#x63A5;&#x7684;&#x8FDE;&#x63A5;&#x8BB0;&#x5F55;&#x5728;&#x68C0;&#x5165;&#x5F53;&#x524D;&#x8FDE;&#x63A5;&#x540E;&#x5F3A;&#x5236;&#x91CD;&#x65B0;&#x8FDE;&#x63A5;&#x3002;</span><span class="yiyi-st" id="yiyi-142">&#x5B83;&#x4E0D;&#x4F1A;&#x5728;&#x5B83;&#x88AB;&#x8C03;&#x7528;&#x7684;&#x5730;&#x65B9;&#x4E3B;&#x52A8;&#x5173;&#x95ED;dbapi_connection&#x3002;</span></p><div class="versionadded"><p><span class="yiyi-st" id="yiyi-143"><span class="versionmodified">&#x7248;&#x672C;1.0.3&#x4E2D;&#x7684;&#x65B0;&#x529F;&#x80FD;</span></span></p></div></dd></dl></dd></dl></div><div class="section" id="sql-execution-and-connection-events"><h2><span class="yiyi-st" id="yiyi-144">SQL&#x6267;&#x884C;&#x548C;&#x8FDE;&#x63A5;&#x4E8B;&#x4EF6;<a class="headerlink" href="#sql-execution-and-connection-events" title="Permalink to this headline">&#xB6;</a></span></h2><dl class="class"><dt id="sqlalchemy.events.ConnectionEvents"><span class="yiyi-st" id="yiyi-145"><em class="property">class</em> <code class="descclassname">sqlalchemy.events&#x3002;</code> <code class="descname">ConnectionEvents</code> <a class="headerlink" href="#sqlalchemy.events.ConnectionEvents" title="Permalink to this definition">&#xB6;</a></span></dt><dd><p><span class="yiyi-st" id="yiyi-146">&#x57FA;&#x7840;&#xFF1A;<a class="reference internal" href="#sqlalchemy.event.base.Events" title="sqlalchemy.event.base.Events"><code class="xref py py-class docutils literal"><span class="pre">sqlalchemy.event.base.Events</span></code></a></span></p><p><span class="yiyi-st" id="yiyi-147"><a class="reference internal" href="connections.html#sqlalchemy.engine.Connectable" title="sqlalchemy.engine.Connectable"><code class="xref py py-class docutils literal"><span class="pre">Connectable</span></code></a>&#x7684;&#x53EF;&#x7528;&#x4E8B;&#x4EF6;&#xFF0C;&#x5176;&#x4E2D;&#x5305;&#x62EC;<a class="reference internal" href="connections.html#sqlalchemy.engine.Connection" title="sqlalchemy.engine.Connection"><code class="xref py py-class docutils literal"><span class="pre">Connection</span></code></a>&#x548C;<a class="reference internal" href="connections.html#sqlalchemy.engine.Engine" title="sqlalchemy.engine.Engine"><code class="xref py py-class docutils literal"><span class="pre">Engine</span></code></a>&#x3002;</span></p><p><span class="yiyi-st" id="yiyi-148">&#x8FD9;&#x91CC;&#x7684;&#x65B9;&#x6CD5;&#x5B9A;&#x4E49;&#x4E86;&#x4E8B;&#x4EF6;&#x7684;&#x540D;&#x79F0;&#x4EE5;&#x53CA;&#x4F20;&#x9012;&#x7ED9;&#x4FA6;&#x542C;&#x5668;&#x51FD;&#x6570;&#x7684;&#x6210;&#x5458;&#x7684;&#x540D;&#x79F0;&#x3002;</span></p><p><span class="yiyi-st" id="yiyi-149">&#x4E8B;&#x4EF6;&#x76D1;&#x542C;&#x5668;&#x53EF;&#x4EE5;&#x4E0E;&#x4EFB;&#x4F55;<a class="reference internal" href="connections.html#sqlalchemy.engine.Connectable" title="sqlalchemy.engine.Connectable"><code class="xref py py-class docutils literal"><span class="pre">Connectable</span></code></a>&#x7C7B;&#x6216;&#x5B9E;&#x4F8B;&#x76F8;&#x5173;&#x8054;&#xFF0C;&#x4F8B;&#x5982;<a class="reference internal" href="connections.html#sqlalchemy.engine.Engine" title="sqlalchemy.engine.Engine"><code class="xref py py-class docutils literal"><span class="pre">Engine</span></code></a>&#xFF0C;&#x4F8B;&#x5982;&#xFF1A;</span></p><div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sqlalchemy</span> <span class="kn">import</span> <span class="n">event</span><span class="p">,</span> <span class="n">create_engine</span>

<span class="k">def</span> <span class="nf">before_cursor_execute</span><span class="p">(</span><span class="n">conn</span><span class="p">,</span> <span class="n">cursor</span><span class="p">,</span> <span class="n">statement</span><span class="p">,</span> <span class="n">parameters</span><span class="p">,</span> <span class="n">context</span><span class="p">,</span>
                                                <span class="n">executemany</span><span class="p">):</span>
    <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Received statement: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">statement</span><span class="p">)</span>

<span class="n">engine</span> <span class="o">=</span> <span class="n">create_engine</span><span class="p">(</span><span class="s1">&apos;postgresql://scott:tiger@localhost/test&apos;</span><span class="p">)</span>
<span class="n">event</span><span class="o">.</span><span class="n">listen</span><span class="p">(</span><span class="n">engine</span><span class="p">,</span> <span class="s2">&quot;before_cursor_execute&quot;</span><span class="p">,</span> <span class="n">before_cursor_execute</span><span class="p">)</span></pre></div></div><p><span class="yiyi-st" id="yiyi-150">&#x6216;&#x4F7F;&#x7528;&#x7279;&#x5B9A;&#x7684;<a class="reference internal" href="connections.html#sqlalchemy.engine.Connection" title="sqlalchemy.engine.Connection"><code class="xref py py-class docutils literal"><span class="pre">Connection</span></code></a>&#xFF1A;</span></p><div class="highlight-python"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">engine</span><span class="o">.</span><span class="n">begin</span><span class="p">()</span> <span class="k">as</span> <span class="n">conn</span><span class="p">:</span>
    <span class="nd">@event.listens_for</span><span class="p">(</span><span class="n">conn</span><span class="p">,</span> <span class="s1">&apos;before_cursor_execute&apos;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">before_cursor_execute</span><span class="p">(</span><span class="n">conn</span><span class="p">,</span> <span class="n">cursor</span><span class="p">,</span> <span class="n">statement</span><span class="p">,</span> <span class="n">parameters</span><span class="p">,</span>
                                    <span class="n">context</span><span class="p">,</span> <span class="n">executemany</span><span class="p">):</span>
        <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Received statement: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">statement</span><span class="p">)</span></pre></div></div><p><span class="yiyi-st" id="yiyi-151">When the methods are called with a <cite>statement</cite> parameter, such as in <a class="reference internal" href="#sqlalchemy.events.ConnectionEvents.after_cursor_execute" title="sqlalchemy.events.ConnectionEvents.after_cursor_execute"><code class="xref py py-meth docutils literal"><span class="pre">after_cursor_execute()</span></code></a>, <a class="reference internal" href="#sqlalchemy.events.ConnectionEvents.before_cursor_execute" title="sqlalchemy.events.ConnectionEvents.before_cursor_execute"><code class="xref py py-meth docutils literal"><span class="pre">before_cursor_execute()</span></code></a> and <a class="reference internal" href="#sqlalchemy.events.ConnectionEvents.dbapi_error" title="sqlalchemy.events.ConnectionEvents.dbapi_error"><code class="xref py py-meth docutils literal"><span class="pre">dbapi_error()</span></code></a>, the statement is the exact SQL string that was prepared for transmission to the DBAPI <code class="docutils literal"><span class="pre">cursor</span></code> in the connection&#x2019;s <a class="reference internal" href="internals.html#sqlalchemy.engine.interfaces.Dialect" title="sqlalchemy.engine.interfaces.Dialect"><code class="xref py py-class docutils literal"><span class="pre">Dialect</span></code></a>.</span></p><p><span class="yiyi-st" id="yiyi-152"><a class="reference internal" href="#sqlalchemy.events.ConnectionEvents.before_execute" title="sqlalchemy.events.ConnectionEvents.before_execute"><code class="xref py py-meth docutils literal"><span class="pre">before_execute()</span></code></a>&#x548C;<a class="reference internal" href="#sqlalchemy.events.ConnectionEvents.before_cursor_execute" title="sqlalchemy.events.ConnectionEvents.before_cursor_execute"><code class="xref py py-meth docutils literal"><span class="pre">before_cursor_execute()</span></code></a>&#x4E8B;&#x4EF6;&#x4E5F;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;<code class="docutils literal"><span class="pre">retval=True</span></code>&#x6807;&#x5FD7;&#x5EFA;&#x7ACB;&#xFF0C;&#x5B83;&#x5141;&#x8BB8;&#x4FEE;&#x6539;&#x8BED;&#x53E5;&#x548C;&#x53C2;&#x6570;&#x4E3A;&#x88AB;&#x53D1;&#x9001;&#x5230;&#x6570;&#x636E;&#x5E93;&#x3002;</span><span class="yiyi-st" id="yiyi-153">The <a class="reference internal" href="#sqlalchemy.events.ConnectionEvents.before_cursor_execute" title="sqlalchemy.events.ConnectionEvents.before_cursor_execute"><code class="xref py py-meth docutils literal"><span class="pre">before_cursor_execute()</span></code></a> event is particularly useful here to add ad-hoc string transformations, such as comments, to all executions:</span></p><div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sqlalchemy.engine</span> <span class="kn">import</span> <span class="n">Engine</span>
<span class="kn">from</span> <span class="nn">sqlalchemy</span> <span class="kn">import</span> <span class="n">event</span>

<span class="nd">@event.listens_for</span><span class="p">(</span><span class="n">Engine</span><span class="p">,</span> <span class="s2">&quot;before_cursor_execute&quot;</span><span class="p">,</span> <span class="n">retval</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">comment_sql_calls</span><span class="p">(</span><span class="n">conn</span><span class="p">,</span> <span class="n">cursor</span><span class="p">,</span> <span class="n">statement</span><span class="p">,</span> <span class="n">parameters</span><span class="p">,</span>
                                    <span class="n">context</span><span class="p">,</span> <span class="n">executemany</span><span class="p">):</span>
    <span class="n">statement</span> <span class="o">=</span> <span class="n">statement</span> <span class="o">+</span> <span class="s2">&quot; -- some comment&quot;</span>
    <span class="k">return</span> <span class="n">statement</span><span class="p">,</span> <span class="n">parameters</span></pre></div></div><div class="admonition note"><p class="first admonition-title"><span class="yiyi-st" id="yiyi-154">&#x6CE8;&#x610F;</span></p><p class="last"><span class="yiyi-st" id="yiyi-155"><a class="reference internal" href="#sqlalchemy.events.ConnectionEvents" title="sqlalchemy.events.ConnectionEvents"><code class="xref py py-class docutils literal"><span class="pre">ConnectionEvents</span></code></a> can be established on any combination of <a class="reference internal" href="connections.html#sqlalchemy.engine.Engine" title="sqlalchemy.engine.Engine"><code class="xref py py-class docutils literal"><span class="pre">Engine</span></code></a>, <a class="reference internal" href="connections.html#sqlalchemy.engine.Connection" title="sqlalchemy.engine.Connection"><code class="xref py py-class docutils literal"><span class="pre">Connection</span></code></a>, as well as instances of each of those classes. </span><span class="yiyi-st" id="yiyi-156">&#x6240;&#x6709;&#x56DB;&#x4E2A;&#x8303;&#x56F4;&#x5185;&#x7684;&#x4E8B;&#x4EF6;&#x5C06;&#x9488;&#x5BF9;&#x7ED9;&#x5B9A;&#x7684;<a class="reference internal" href="connections.html#sqlalchemy.engine.Connection" title="sqlalchemy.engine.Connection"><code class="xref py py-class docutils literal"><span class="pre">Connection</span></code></a>&#x5B9E;&#x4F8B;&#x89E6;&#x53D1;&#x3002;</span><span class="yiyi-st" id="yiyi-157">&#x4F46;&#x662F;&#xFF0C;&#x51FA;&#x4E8E;&#x6027;&#x80FD;&#x65B9;&#x9762;&#x7684;&#x539F;&#x56E0;&#xFF0C;<a class="reference internal" href="connections.html#sqlalchemy.engine.Connection" title="sqlalchemy.engine.Connection"><code class="xref py py-class docutils literal"><span class="pre">Connection</span></code></a>&#x5BF9;&#x8C61;&#x5728;&#x5B9E;&#x4F8B;&#x5316;&#x65F6;&#x786E;&#x5B9A;&#x5176;&#x7236;<a class="reference internal" href="connections.html#sqlalchemy.engine.Engine" title="sqlalchemy.engine.Engine"><code class="xref py py-class docutils literal"><span class="pre">Engine</span></code></a>&#x662F;&#x5426;&#x5DF2;&#x5EFA;&#x7ACB;&#x4E8B;&#x4EF6;&#x4FA6;&#x542C;&#x5668;&#x3002;</span><span class="yiyi-st" id="yiyi-158">&#x4E8B;&#x4EF6;&#x76D1;&#x542C;&#x5668;&#x6DFB;&#x52A0;&#x5230;<a class="reference internal" href="connections.html#sqlalchemy.engine.Engine" title="sqlalchemy.engine.Engine"><code class="xref py py-class docutils literal"><span class="pre">Engine</span></code></a>&#x7C7B;&#x6216;&#x8005;<a class="reference internal" href="connections.html#sqlalchemy.engine.Engine" title="sqlalchemy.engine.Engine"><code class="xref py py-class docutils literal"><span class="pre">Engine</span></code></a> <em>&#x5B9E;&#x4F8B;&#x4E4B;&#x540E;</em>&#x5B9E;&#x4F8B;&#x5316;&#x4E00;&#x4E2A;&#x4F9D;&#x8D56;&#x7684;<a class="reference internal" href="connections.html#sqlalchemy.engine.Connection" title="sqlalchemy.engine.Connection"><code class="xref py py-class docutils literal"><span class="pre">Connection</span></code></a>&#x5B9E;&#x4F8B;&#x901A;&#x5E38;&#x5728;<a class="reference internal" href="connections.html#sqlalchemy.engine.Connection" title="sqlalchemy.engine.Connection"><code class="xref py py-class docutils literal"><span class="pre">Connection</span></code></a>&#x5B9E;&#x4F8B;&#x4E0A;&#x4E0D;&#x53EF;&#x7528;<em>not</em>&#x3002;</span><span class="yiyi-st" id="yiyi-159">&#x65B0;&#x6DFB;&#x52A0;&#x7684;&#x4FA6;&#x542C;&#x5668;&#x5C06;&#x5BF9;&#x5728;<a class="reference internal" href="connections.html#sqlalchemy.engine.Engine" title="sqlalchemy.engine.Engine"><code class="xref py py-class docutils literal"><span class="pre">Engine</span></code></a>&#x7C7B;&#x6216;&#x5B9E;&#x4F8B;&#x4E0A;&#x5EFA;&#x7ACB;&#x7684;&#x90A3;&#x4E9B;&#x4E8B;&#x4EF6;&#x4FA6;&#x542C;&#x5668;&#x4E4B;&#x540E;&#x521B;&#x5EFA;&#x7684;<a class="reference internal" href="connections.html#sqlalchemy.engine.Connection" title="sqlalchemy.engine.Connection"><code class="xref py py-class docutils literal"><span class="pre">Connection</span></code></a>&#x5B9E;&#x4F8B;&#x751F;&#x6548;&#x3002;</span></p></div><table class="docutils field-list" frame="void" rules="none"><tbody valign="top"><tr class="field-odd field"><th class="field-name"><span class="yiyi-st" id="yiyi-160">&#x53C2;&#x6570;&#xFF1A;</span></th><td class="field-body"><span class="yiyi-st" id="yiyi-161"><span class="target" id="sqlalchemy.events.ConnectionEvents.params.retval"></span><strong>retval=False</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.events.ConnectionEvents.params.retval">&#xB6;</a> &#x2013; Applies to the <a class="reference internal" href="#sqlalchemy.events.ConnectionEvents.before_execute" title="sqlalchemy.events.ConnectionEvents.before_execute"><code class="xref py py-meth docutils literal"><span class="pre">before_execute()</span></code></a> and <a class="reference internal" href="#sqlalchemy.events.ConnectionEvents.before_cursor_execute" title="sqlalchemy.events.ConnectionEvents.before_cursor_execute"><code class="xref py py-meth docutils literal"><span class="pre">before_cursor_execute()</span></code></a> events only. </span><span class="yiyi-st" id="yiyi-162">&#x5982;&#x679C;&#x4E3A;True&#xFF0C;&#x5219;&#x7528;&#x6237;&#x5B9A;&#x4E49;&#x7684;&#x4E8B;&#x4EF6;&#x51FD;&#x6570;&#x5FC5;&#x987B;&#x5177;&#x6709;&#x8FD4;&#x56DE;&#x503C;&#xFF0C;&#x8BE5;&#x503C;&#x662F;&#x7528;&#x4E8E;&#x66FF;&#x6362;&#x7ED9;&#x5B9A;&#x8BED;&#x53E5;&#x548C;&#x53C2;&#x6570;&#x7684;&#x53C2;&#x6570;&#x5143;&#x7EC4;&#x3002;</span><span class="yiyi-st" id="yiyi-163">&#x8BF7;&#x53C2;&#x9605;&#x8FD9;&#x4E9B;&#x65B9;&#x6CD5;&#x4EE5;&#x83B7;&#x53D6;&#x7279;&#x5B9A;&#x8FD4;&#x56DE;&#x53C2;&#x6570;&#x7684;&#x8BF4;&#x660E;&#x3002;</span></td></tr></tbody></table><div class="versionchanged"><p><span class="yiyi-st" id="yiyi-164"><span class="versionmodified">Changed in version 0.8: </span><a class="reference internal" href="#sqlalchemy.events.ConnectionEvents" title="sqlalchemy.events.ConnectionEvents"><code class="xref py py-class docutils literal"><span class="pre">ConnectionEvents</span></code></a> can now be associated with any <a class="reference internal" href="connections.html#sqlalchemy.engine.Connectable" title="sqlalchemy.engine.Connectable"><code class="xref py py-class docutils literal"><span class="pre">Connectable</span></code></a> including <a class="reference internal" href="connections.html#sqlalchemy.engine.Connection" title="sqlalchemy.engine.Connection"><code class="xref py py-class docutils literal"><span class="pre">Connection</span></code></a>, in addition to the existing support for <a class="reference internal" href="connections.html#sqlalchemy.engine.Engine" title="sqlalchemy.engine.Engine"><code class="xref py py-class docutils literal"><span class="pre">Engine</span></code></a>.</span></p></div><dl class="method"><dt id="sqlalchemy.events.ConnectionEvents.after_cursor_execute"><span class="yiyi-st" id="yiyi-165"><code class="descname">after_cursor_execute</code> <span class="sig-paren">&#xFF08;</span> <em>conn</em>&#xFF0C;<em>&#x6E38;&#x6807;</em>&#xFF0C;<em>&#x8BED;&#x53E5;</em>&#xFF0C;<em>&#x53C2;&#x6570; t5 &gt;&#xFF0C;<em>&#x4E0A;&#x4E0B;&#x6587;</em>&#xFF0C;<em>executemany</em> <span class="sig-paren">&#xFF09;</span> <a class="headerlink" href="#sqlalchemy.events.ConnectionEvents.after_cursor_execute" title="Permalink to this definition">&#xB6;</a></em></span></dt><dd><p><span class="yiyi-st" id="yiyi-166">&#x5728;&#x6267;&#x884C;&#x540E;&#x62E6;&#x622A;&#x4F4E;&#x7EA7;&#x6E38;&#x6807;execute()&#x4E8B;&#x4EF6;&#x3002;</span></p><div class="event-signatures container"><p><span class="yiyi-st" id="yiyi-167">&#x793A;&#x4F8B;&#x53C2;&#x6570;&#x8868;&#x5355;&#xFF1A;</span></p><div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sqlalchemy</span> <span class="kn">import</span> <span class="n">event</span>

<span class="c1"># standard decorator style</span>
<span class="nd">@event.listens_for</span><span class="p">(</span><span class="n">SomeEngine</span><span class="p">,</span> <span class="s1">&apos;after_cursor_execute&apos;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">receive_after_cursor_execute</span><span class="p">(</span><span class="n">conn</span><span class="p">,</span> <span class="n">cursor</span><span class="p">,</span> <span class="n">statement</span><span class="p">,</span> <span class="n">parameters</span><span class="p">,</span> <span class="n">context</span><span class="p">,</span> <span class="n">executemany</span><span class="p">):</span>
    <span class="s2">&quot;listen for the &apos;after_cursor_execute&apos; event&quot;</span>

    <span class="c1"># ... (event handling logic) ...</span>

<span class="c1"># named argument style (new in 0.9)</span>
<span class="nd">@event.listens_for</span><span class="p">(</span><span class="n">SomeEngine</span><span class="p">,</span> <span class="s1">&apos;after_cursor_execute&apos;</span><span class="p">,</span> <span class="n">named</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">receive_after_cursor_execute</span><span class="p">(</span><span class="o">**</span><span class="n">kw</span><span class="p">):</span>
    <span class="s2">&quot;listen for the &apos;after_cursor_execute&apos; event&quot;</span>
    <span class="n">conn</span> <span class="o">=</span> <span class="n">kw</span><span class="p">[</span><span class="s1">&apos;conn&apos;</span><span class="p">]</span>
    <span class="n">cursor</span> <span class="o">=</span> <span class="n">kw</span><span class="p">[</span><span class="s1">&apos;cursor&apos;</span><span class="p">]</span>

    <span class="c1"># ... (event handling logic) ...</span></pre></div></div></div><table class="docutils field-list" frame="void" rules="none"><tbody valign="top"><tr class="field-odd field"><th class="field-name"><span class="yiyi-st" id="yiyi-168">&#x53C2;&#x6570;&#xFF1A;</span></th><td class="field-body"><ul class="first last simple"><li><span class="yiyi-st" id="yiyi-169"><span class="target" id="sqlalchemy.events.ConnectionEvents.after_cursor_execute.params.conn"></span> <strong>conn</strong> <a class="paramlink headerlink reference internal" href="#sqlalchemy.events.ConnectionEvents.after_cursor_execute.params.conn">&#xB6;</a>  -  <a class="reference internal" href="connections.html#sqlalchemy.engine.Connection" title="sqlalchemy.engine.Connection"><code class="xref py py-class docutils literal"><span class="pre">Connection</span></code></a>&#x5BF9;&#x8C61;</span></li><li><span class="yiyi-st" id="yiyi-170"><span class="target" id="sqlalchemy.events.ConnectionEvents.after_cursor_execute.params.cursor"></span> <strong>&#x6E38;&#x6807;</strong> <a class="paramlink headerlink reference internal" href="#sqlalchemy.events.ConnectionEvents.after_cursor_execute.params.cursor">&#xB6;</a>  -  DBAPI&#x6E38;&#x6807;&#x5BF9;&#x8C61;&#x3002;</span><span class="yiyi-st" id="yiyi-171">&#x5982;&#x679C;&#x8BED;&#x53E5;&#x662F;SELECT&#xFF0C;&#x5C06;&#x4F1A;&#x4EA7;&#x751F;&#x6302;&#x8D77;&#x7684;&#x7ED3;&#x679C;&#xFF0C;&#x4F46;&#x662F;&#x8FD9;&#x4E9B;&#x4E0D;&#x5E94;&#x8BE5;&#x88AB;&#x4F7F;&#x7528;&#xFF0C;&#x56E0;&#x4E3A;&#x5B83;&#x4EEC;&#x5C06;&#x88AB;<a class="reference internal" href="connections.html#sqlalchemy.engine.ResultProxy" title="sqlalchemy.engine.ResultProxy"><code class="xref py py-class docutils literal"><span class="pre">ResultProxy</span></code></a>&#x9700;&#x8981;&#x3002;</span></li><li><span class="yiyi-st" id="yiyi-172"><span class="target" id="sqlalchemy.events.ConnectionEvents.after_cursor_execute.params.statement"></span><strong>statement</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.events.ConnectionEvents.after_cursor_execute.params.statement">&#xB6;</a> &#x2013; string SQL statement, as passed to the DBAPI</span></li><li><span class="yiyi-st" id="yiyi-173"><span class="target" id="sqlalchemy.events.ConnectionEvents.after_cursor_execute.params.parameters"></span><strong>parameters</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.events.ConnectionEvents.after_cursor_execute.params.parameters">&#xB6;</a> &#x2013; Dictionary, tuple, or list of parameters being passed to the <code class="docutils literal"><span class="pre">execute()</span></code> or <code class="docutils literal"><span class="pre">executemany()</span></code> method of the DBAPI <code class="docutils literal"><span class="pre">cursor</span></code>. </span><span class="yiyi-st" id="yiyi-174">&#x5728;&#x67D0;&#x4E9B;&#x60C5;&#x51B5;&#x4E0B;&#x53EF;&#x80FD;&#x662F;<code class="docutils literal"><span class="pre">None</span></code>&#x3002;</span></li><li><span class="yiyi-st" id="yiyi-175"><span class="target" id="sqlalchemy.events.ConnectionEvents.after_cursor_execute.params.context"></span><strong>context</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.events.ConnectionEvents.after_cursor_execute.params.context">&#xB6;</a> &#x2013; <a class="reference internal" href="internals.html#sqlalchemy.engine.interfaces.ExecutionContext" title="sqlalchemy.engine.interfaces.ExecutionContext"><code class="xref py py-class docutils literal"><span class="pre">ExecutionContext</span></code></a> object in use. </span><span class="yiyi-st" id="yiyi-176">&#x53EF;&#x80FD;&#x662F;<code class="docutils literal"><span class="pre">None</span></code>&#x3002;</span></li><li><span class="yiyi-st" id="yiyi-177"><span class="target" id="sqlalchemy.events.ConnectionEvents.after_cursor_execute.params.executemany"></span><strong>executemany</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.events.ConnectionEvents.after_cursor_execute.params.executemany">&#xB6;</a> &#x2013; boolean, if <code class="docutils literal"><span class="pre">True</span></code>, this is an <code class="docutils literal"><span class="pre">executemany()</span></code> call, if <code class="docutils literal"><span class="pre">False</span></code>, this is an <code class="docutils literal"><span class="pre">execute()</span></code> call.</span></li></ul></td></tr></tbody></table></dd></dl><dl class="method"><dt id="sqlalchemy.events.ConnectionEvents.after_execute"><span class="yiyi-st" id="yiyi-178"> <code class="descname">after_execute</code><span class="sig-paren">(</span><em>conn</em>, <em>clauseelement</em>, <em>multiparams</em>, <em>params</em>, <em>result</em><span class="sig-paren">)</span><a class="headerlink" href="#sqlalchemy.events.ConnectionEvents.after_execute" title="Permalink to this definition">&#xB6;</a></span></dt><dd><p><span class="yiyi-st" id="yiyi-179">&#x6267;&#x884C;&#x540E;&#x62E6;&#x622A;&#x9AD8;&#x7EA7;&#x522B;&#x7684;execute()&#x4E8B;&#x4EF6;&#x3002;</span></p><div class="event-signatures container"><p><span class="yiyi-st" id="yiyi-180">&#x793A;&#x4F8B;&#x53C2;&#x6570;&#x8868;&#x5355;&#xFF1A;</span></p><div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sqlalchemy</span> <span class="kn">import</span> <span class="n">event</span>

<span class="c1"># standard decorator style</span>
<span class="nd">@event.listens_for</span><span class="p">(</span><span class="n">SomeEngine</span><span class="p">,</span> <span class="s1">&apos;after_execute&apos;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">receive_after_execute</span><span class="p">(</span><span class="n">conn</span><span class="p">,</span> <span class="n">clauseelement</span><span class="p">,</span> <span class="n">multiparams</span><span class="p">,</span> <span class="n">params</span><span class="p">,</span> <span class="n">result</span><span class="p">):</span>
    <span class="s2">&quot;listen for the &apos;after_execute&apos; event&quot;</span>

    <span class="c1"># ... (event handling logic) ...</span>

<span class="c1"># named argument style (new in 0.9)</span>
<span class="nd">@event.listens_for</span><span class="p">(</span><span class="n">SomeEngine</span><span class="p">,</span> <span class="s1">&apos;after_execute&apos;</span><span class="p">,</span> <span class="n">named</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">receive_after_execute</span><span class="p">(</span><span class="o">**</span><span class="n">kw</span><span class="p">):</span>
    <span class="s2">&quot;listen for the &apos;after_execute&apos; event&quot;</span>
    <span class="n">conn</span> <span class="o">=</span> <span class="n">kw</span><span class="p">[</span><span class="s1">&apos;conn&apos;</span><span class="p">]</span>
    <span class="n">clauseelement</span> <span class="o">=</span> <span class="n">kw</span><span class="p">[</span><span class="s1">&apos;clauseelement&apos;</span><span class="p">]</span>

    <span class="c1"># ... (event handling logic) ...</span></pre></div></div></div><table class="docutils field-list" frame="void" rules="none"><tbody valign="top"><tr class="field-odd field"><th class="field-name"><span class="yiyi-st" id="yiyi-181">&#x53C2;&#x6570;&#xFF1A;</span></th><td class="field-body"><ul class="first last simple"><li><span class="yiyi-st" id="yiyi-182"><span class="target" id="sqlalchemy.events.ConnectionEvents.after_execute.params.conn"></span> <strong>conn</strong> <a class="paramlink headerlink reference internal" href="#sqlalchemy.events.ConnectionEvents.after_execute.params.conn">&#xB6;</a>  -  <a class="reference internal" href="connections.html#sqlalchemy.engine.Connection" title="sqlalchemy.engine.Connection"><code class="xref py py-class docutils literal"><span class="pre">Connection</span></code></a>&#x5BF9;&#x8C61;</span></li><li><span class="yiyi-st" id="yiyi-183"><span class="target" id="sqlalchemy.events.ConnectionEvents.after_execute.params.clauseelement"></span><strong>clauseelement</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.events.ConnectionEvents.after_execute.params.clauseelement">&#xB6;</a> &#x2013; SQL expression construct, <a class="reference internal" href="internals.html#sqlalchemy.engine.interfaces.Compiled" title="sqlalchemy.engine.interfaces.Compiled"><code class="xref py py-class docutils literal"><span class="pre">Compiled</span></code></a> instance, or string statement passed to <a class="reference internal" href="connections.html#sqlalchemy.engine.Connection.execute" title="sqlalchemy.engine.Connection.execute"><code class="xref py py-meth docutils literal"><span class="pre">Connection.execute()</span></code></a>.</span></li><li><span class="yiyi-st" id="yiyi-184"><span class="target" id="sqlalchemy.events.ConnectionEvents.after_execute.params.multiparams"></span> <strong>multiparams</strong> <a class="paramlink headerlink reference internal" href="#sqlalchemy.events.ConnectionEvents.after_execute.params.multiparams">&#xB6;</a>  - &#x591A;&#x4E2A;&#x53C2;&#x6570;&#x96C6;&#xFF0C;&#x4E00;&#x4E2A;&#x5B57;&#x5178;&#x5217;&#x8868;&#x3002;</span></li><li><span class="yiyi-st" id="yiyi-185"><span class="target" id="sqlalchemy.events.ConnectionEvents.after_execute.params.params"></span> <strong>params</strong> <a class="paramlink headerlink reference internal" href="#sqlalchemy.events.ConnectionEvents.after_execute.params.params">&#xB6;</a>  - &#x5355;&#x4E2A;&#x53C2;&#x6570;&#x96C6;&#xFF0C;&#x5355;&#x4E2A;&#x5B57;&#x5178;&#x3002;</span></li><li><span class="yiyi-st" id="yiyi-186"><span class="target" id="sqlalchemy.events.ConnectionEvents.after_execute.params.result"></span><strong>result</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.events.ConnectionEvents.after_execute.params.result">&#xB6;</a> &#x2013; <a class="reference internal" href="connections.html#sqlalchemy.engine.ResultProxy" title="sqlalchemy.engine.ResultProxy"><code class="xref py py-class docutils literal"><span class="pre">ResultProxy</span></code></a> generated by the execution.</span></li></ul></td></tr></tbody></table></dd></dl><dl class="method"><dt id="sqlalchemy.events.ConnectionEvents.before_cursor_execute"><span class="yiyi-st" id="yiyi-187"><code class="descname">before_cursor_execute</code> <span class="sig-paren">&#xFF08;</span> <em>conn</em>&#xFF0C;<em>&#x6E38;&#x6807;</em>&#xFF0C;<em>&#x8BED;&#x53E5;</em>&#xFF0C;<em>&#x53C2;&#x6570; t5 &gt;&#xFF0C;<em>&#x4E0A;&#x4E0B;&#x6587;</em>&#xFF0C;<em>executemany</em> <span class="sig-paren">&#xFF09;</span> <a class="headerlink" href="#sqlalchemy.events.ConnectionEvents.before_cursor_execute" title="Permalink to this definition">&#xB6;</a></em></span></dt><dd><p><span class="yiyi-st" id="yiyi-188">&#x5728;&#x6267;&#x884C;&#x524D;&#x62E6;&#x622A;&#x4F4E;&#x7EA7;&#x522B;&#x6E38;&#x6807;execute()&#x4E8B;&#x4EF6;&#xFF0C;&#x63A5;&#x6536;&#x8981;&#x9488;&#x5BF9;&#x6E38;&#x6807;&#x8C03;&#x7528;&#x7684;&#x5B57;&#x7B26;&#x4E32;SQL&#x8BED;&#x53E5;&#x548C;DBAPI&#x7279;&#x5B9A;&#x7684;&#x53C2;&#x6570;&#x5217;&#x8868;&#x3002;</span></p><div class="event-signatures container"><p><span class="yiyi-st" id="yiyi-189">&#x793A;&#x4F8B;&#x53C2;&#x6570;&#x8868;&#x5355;&#xFF1A;</span></p><div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sqlalchemy</span> <span class="kn">import</span> <span class="n">event</span>

<span class="c1"># standard decorator style</span>
<span class="nd">@event.listens_for</span><span class="p">(</span><span class="n">SomeEngine</span><span class="p">,</span> <span class="s1">&apos;before_cursor_execute&apos;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">receive_before_cursor_execute</span><span class="p">(</span><span class="n">conn</span><span class="p">,</span> <span class="n">cursor</span><span class="p">,</span> <span class="n">statement</span><span class="p">,</span> <span class="n">parameters</span><span class="p">,</span> <span class="n">context</span><span class="p">,</span> <span class="n">executemany</span><span class="p">):</span>
    <span class="s2">&quot;listen for the &apos;before_cursor_execute&apos; event&quot;</span>

    <span class="c1"># ... (event handling logic) ...</span>

<span class="c1"># named argument style (new in 0.9)</span>
<span class="nd">@event.listens_for</span><span class="p">(</span><span class="n">SomeEngine</span><span class="p">,</span> <span class="s1">&apos;before_cursor_execute&apos;</span><span class="p">,</span> <span class="n">named</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">receive_before_cursor_execute</span><span class="p">(</span><span class="o">**</span><span class="n">kw</span><span class="p">):</span>
    <span class="s2">&quot;listen for the &apos;before_cursor_execute&apos; event&quot;</span>
    <span class="n">conn</span> <span class="o">=</span> <span class="n">kw</span><span class="p">[</span><span class="s1">&apos;conn&apos;</span><span class="p">]</span>
    <span class="n">cursor</span> <span class="o">=</span> <span class="n">kw</span><span class="p">[</span><span class="s1">&apos;cursor&apos;</span><span class="p">]</span>

    <span class="c1"># ... (event handling logic) ...</span></pre></div></div></div><p><span class="yiyi-st" id="yiyi-190">&#x6B64;&#x4E8B;&#x4EF6;&#x5BF9;&#x4E8E;&#x65E5;&#x5FD7;&#x8BB0;&#x5F55;&#x4EE5;&#x53CA;&#x5BF9;SQL&#x5B57;&#x7B26;&#x4E32;&#x7684;&#x540E;&#x671F;&#x4FEE;&#x6539;&#x90FD;&#x662F;&#x4E0D;&#x9519;&#x7684;&#x9009;&#x62E9;&#x3002;</span><span class="yiyi-st" id="yiyi-191">&#x9664;&#x4E86;&#x90A3;&#x4E9B;&#x7279;&#x5B9A;&#x4E8E;&#x76EE;&#x6807;&#x540E;&#x7AEF;&#x7684;&#x53C2;&#x6570;&#x4E4B;&#x5916;&#xFF0C;&#x5B83;&#x4E0D;&#x592A;&#x7406;&#x60F3;&#x3002;</span></p><p><span class="yiyi-st" id="yiyi-192">&#x8BE5;&#x4E8B;&#x4EF6;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;<code class="docutils literal"><span class="pre">retval=True</span></code>&#x6807;&#x5FD7;&#x6765;&#x9009;&#x62E9;&#x6027;&#x5730;&#x5EFA;&#x7ACB;&#x3002;</span><span class="yiyi-st" id="yiyi-193">&#x5728;&#x8FD9;&#x79CD;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;<code class="docutils literal"><span class="pre">statement</span></code>&#x548C;<code class="docutils literal"><span class="pre">parameters</span></code>&#x53C2;&#x6570;&#x5E94;&#x4F5C;&#x4E3A;&#x4E8C;&#x5143;&#x7EC4;&#x8FD4;&#x56DE;&#xFF1A;</span></p><div class="highlight-python"><div class="highlight"><pre><span></span><span class="nd">@event.listens_for</span><span class="p">(</span><span class="n">Engine</span><span class="p">,</span> <span class="s2">&quot;before_cursor_execute&quot;</span><span class="p">,</span> <span class="n">retval</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">before_cursor_execute</span><span class="p">(</span><span class="n">conn</span><span class="p">,</span> <span class="n">cursor</span><span class="p">,</span> <span class="n">statement</span><span class="p">,</span>
                <span class="n">parameters</span><span class="p">,</span> <span class="n">context</span><span class="p">,</span> <span class="n">executemany</span><span class="p">):</span>
    <span class="c1"># do something with statement, parameters</span>
    <span class="k">return</span> <span class="n">statement</span><span class="p">,</span> <span class="n">parameters</span></pre></div></div><p><span class="yiyi-st" id="yiyi-194">&#x8BF7;&#x53C2;&#x9605;<a class="reference internal" href="#sqlalchemy.events.ConnectionEvents" title="sqlalchemy.events.ConnectionEvents"><code class="xref py py-class docutils literal"><span class="pre">ConnectionEvents</span></code></a>&#x4E2D;&#x7684;&#x793A;&#x4F8B;&#x3002;</span></p><table class="docutils field-list" frame="void" rules="none"><tbody valign="top"><tr class="field-odd field"><th class="field-name"><span class="yiyi-st" id="yiyi-195">&#x53C2;&#x6570;&#xFF1A;</span></th><td class="field-body"><ul class="first last simple"><li><span class="yiyi-st" id="yiyi-196"><span class="target" id="sqlalchemy.events.ConnectionEvents.before_cursor_execute.params.conn"></span> <strong>conn</strong> <a class="paramlink headerlink reference internal" href="#sqlalchemy.events.ConnectionEvents.before_cursor_execute.params.conn">&#xB6;</a>  -  <a class="reference internal" href="connections.html#sqlalchemy.engine.Connection" title="sqlalchemy.engine.Connection"><code class="xref py py-class docutils literal"><span class="pre">Connection</span></code></a>&#x5BF9;&#x8C61;</span></li><li><span class="yiyi-st" id="yiyi-197"><span class="target" id="sqlalchemy.events.ConnectionEvents.before_cursor_execute.params.cursor"></span> <strong>&#x6E38;&#x6807;</strong> <a class="paramlink headerlink reference internal" href="#sqlalchemy.events.ConnectionEvents.before_cursor_execute.params.cursor">&#xB6;</a>  -  DBAPI&#x6E38;&#x6807;&#x5BF9;&#x8C61;</span></li><li><span class="yiyi-st" id="yiyi-198"><span class="target" id="sqlalchemy.events.ConnectionEvents.before_cursor_execute.params.statement"></span> <strong>&#x8BED;&#x53E5;</strong> <a class="paramlink headerlink reference internal" href="#sqlalchemy.events.ConnectionEvents.before_cursor_execute.params.statement">&#xB6;</a>  - &#x5C06;&#x5B57;&#x7B26;&#x4E32;SQL&#x8BED;&#x53E5;&#x4F20;&#x9012;&#x7ED9;DBAPI</span></li><li><span class="yiyi-st" id="yiyi-199"><span class="target" id="sqlalchemy.events.ConnectionEvents.before_cursor_execute.params.parameters"></span><strong>parameters</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.events.ConnectionEvents.before_cursor_execute.params.parameters">&#xB6;</a> &#x2013; Dictionary, tuple, or list of parameters being passed to the <code class="docutils literal"><span class="pre">execute()</span></code> or <code class="docutils literal"><span class="pre">executemany()</span></code> method of the DBAPI <code class="docutils literal"><span class="pre">cursor</span></code>. </span><span class="yiyi-st" id="yiyi-200">&#x5728;&#x67D0;&#x4E9B;&#x60C5;&#x51B5;&#x4E0B;&#x53EF;&#x80FD;&#x662F;<code class="docutils literal"><span class="pre">None</span></code>&#x3002;</span></li><li><span class="yiyi-st" id="yiyi-201"><span class="target" id="sqlalchemy.events.ConnectionEvents.before_cursor_execute.params.context"></span><strong>context</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.events.ConnectionEvents.before_cursor_execute.params.context">&#xB6;</a> &#x2013; <a class="reference internal" href="internals.html#sqlalchemy.engine.interfaces.ExecutionContext" title="sqlalchemy.engine.interfaces.ExecutionContext"><code class="xref py py-class docutils literal"><span class="pre">ExecutionContext</span></code></a> object in use. </span><span class="yiyi-st" id="yiyi-202">&#x53EF;&#x80FD;&#x662F;<code class="docutils literal"><span class="pre">None</span></code>&#x3002;</span></li><li><span class="yiyi-st" id="yiyi-203"><span class="target" id="sqlalchemy.events.ConnectionEvents.before_cursor_execute.params.executemany"></span><strong>executemany</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.events.ConnectionEvents.before_cursor_execute.params.executemany">&#xB6;</a> &#x2013; boolean, if <code class="docutils literal"><span class="pre">True</span></code>, this is an <code class="docutils literal"><span class="pre">executemany()</span></code> call, if <code class="docutils literal"><span class="pre">False</span></code>, this is an <code class="docutils literal"><span class="pre">execute()</span></code> call.</span></li></ul></td></tr></tbody></table><p><span class="yiyi-st" id="yiyi-204">&#x4E5F;&#x53EF;&#x4EE5;&#x770B;&#x770B;&#xFF1A;</span></p><p><span class="yiyi-st" id="yiyi-205"><a class="reference internal" href="#sqlalchemy.events.ConnectionEvents.before_execute" title="sqlalchemy.events.ConnectionEvents.before_execute"><code class="xref py py-meth docutils literal"><span class="pre">before_execute()</span></code></a></span></p><p><span class="yiyi-st" id="yiyi-206"><a class="reference internal" href="#sqlalchemy.events.ConnectionEvents.after_cursor_execute" title="sqlalchemy.events.ConnectionEvents.after_cursor_execute"><code class="xref py py-meth docutils literal"><span class="pre">after_cursor_execute()</span></code></a></span></p></dd></dl><dl class="method"><dt id="sqlalchemy.events.ConnectionEvents.before_execute"><span class="yiyi-st" id="yiyi-207"><code class="descname">before_execute</code> <span class="sig-paren">&#xFF08;</span> <em>conn</em>&#xFF0C;<em>clauseelement</em>&#xFF0C;<em>multiparams</em>&#xFF0C;<em>params  t5 &gt; <span class="sig-paren">&#xFF09; T6&gt; <a class="headerlink" href="#sqlalchemy.events.ConnectionEvents.before_execute" title="Permalink to this definition">&#xB6; T7&gt;</a></span></em></span></dt><dd><p><span class="yiyi-st" id="yiyi-208">&#x62E6;&#x622A;&#x9AD8;&#x7EA7;&#x522B;&#x7684;execute()&#x4E8B;&#x4EF6;&#xFF0C;&#x5728;&#x6E32;&#x67D3;&#x5230;SQL&#x4E4B;&#x524D;&#x63A5;&#x6536;&#x672A;&#x7F16;&#x8BD1;&#x7684;SQL&#x6784;&#x9020;&#x548C;&#x5176;&#x4ED6;&#x5BF9;&#x8C61;&#x3002;</span></p><div class="event-signatures container"><p><span class="yiyi-st" id="yiyi-209">&#x793A;&#x4F8B;&#x53C2;&#x6570;&#x8868;&#x5355;&#xFF1A;</span></p><div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sqlalchemy</span> <span class="kn">import</span> <span class="n">event</span>

<span class="c1"># standard decorator style</span>
<span class="nd">@event.listens_for</span><span class="p">(</span><span class="n">SomeEngine</span><span class="p">,</span> <span class="s1">&apos;before_execute&apos;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">receive_before_execute</span><span class="p">(</span><span class="n">conn</span><span class="p">,</span> <span class="n">clauseelement</span><span class="p">,</span> <span class="n">multiparams</span><span class="p">,</span> <span class="n">params</span><span class="p">):</span>
    <span class="s2">&quot;listen for the &apos;before_execute&apos; event&quot;</span>

    <span class="c1"># ... (event handling logic) ...</span>

<span class="c1"># named argument style (new in 0.9)</span>
<span class="nd">@event.listens_for</span><span class="p">(</span><span class="n">SomeEngine</span><span class="p">,</span> <span class="s1">&apos;before_execute&apos;</span><span class="p">,</span> <span class="n">named</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">receive_before_execute</span><span class="p">(</span><span class="o">**</span><span class="n">kw</span><span class="p">):</span>
    <span class="s2">&quot;listen for the &apos;before_execute&apos; event&quot;</span>
    <span class="n">conn</span> <span class="o">=</span> <span class="n">kw</span><span class="p">[</span><span class="s1">&apos;conn&apos;</span><span class="p">]</span>
    <span class="n">clauseelement</span> <span class="o">=</span> <span class="n">kw</span><span class="p">[</span><span class="s1">&apos;clauseelement&apos;</span><span class="p">]</span>

    <span class="c1"># ... (event handling logic) ...</span></pre></div></div></div><p><span class="yiyi-st" id="yiyi-210">&#x6B64;&#x4E8B;&#x4EF6;&#x9002;&#x7528;&#x4E8E;&#x8C03;&#x8BD5;SQL&#x7F16;&#x8BD1;&#x95EE;&#x9898;&#x4EE5;&#x53CA;&#x5BF9;&#x53D1;&#x9001;&#x5230;&#x6570;&#x636E;&#x5E93;&#x7684;&#x53C2;&#x6570;&#x7684;&#x65E9;&#x671F;&#x64CD;&#x4F5C;&#xFF0C;&#x56E0;&#x4E3A;&#x53C2;&#x6570;&#x5217;&#x8868;&#x5728;&#x8FD9;&#x91CC;&#x5C06;&#x91C7;&#x7528;&#x4E00;&#x81F4;&#x7684;&#x683C;&#x5F0F;&#x3002;</span></p><p><span class="yiyi-st" id="yiyi-211">&#x8BE5;&#x4E8B;&#x4EF6;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;<code class="docutils literal"><span class="pre">retval=True</span></code>&#x6807;&#x5FD7;&#x6765;&#x9009;&#x62E9;&#x6027;&#x5730;&#x5EFA;&#x7ACB;&#x3002;</span><span class="yiyi-st" id="yiyi-212">&#x5728;&#x8FD9;&#x79CD;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;&#x5E94;&#x8BE5;&#x5C06;<code class="docutils literal"><span class="pre">clauseelement</span></code>&#xFF0C;<code class="docutils literal"><span class="pre">multiparams</span></code>&#x548C;<code class="docutils literal"><span class="pre">params</span></code>&#x53C2;&#x6570;&#x4F5C;&#x4E3A;&#x4E09;&#x5143;&#x7EC4;&#x8FD4;&#x56DE;&#xFF1A;</span></p><div class="highlight-python"><div class="highlight"><pre><span></span><span class="nd">@event.listens_for</span><span class="p">(</span><span class="n">Engine</span><span class="p">,</span> <span class="s2">&quot;before_execute&quot;</span><span class="p">,</span> <span class="n">retval</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">before_execute</span><span class="p">(</span><span class="n">conn</span><span class="p">,</span> <span class="n">conn</span><span class="p">,</span> <span class="n">clauseelement</span><span class="p">,</span> <span class="n">multiparams</span><span class="p">,</span> <span class="n">params</span><span class="p">):</span>
    <span class="c1"># do something with clauseelement, multiparams, params</span>
    <span class="k">return</span> <span class="n">clauseelement</span><span class="p">,</span> <span class="n">multiparams</span><span class="p">,</span> <span class="n">params</span></pre></div></div><table class="docutils field-list" frame="void" rules="none"><tbody valign="top"><tr class="field-odd field"><th class="field-name"><span class="yiyi-st" id="yiyi-213">&#x53C2;&#x6570;&#xFF1A;</span></th><td class="field-body"><ul class="first last simple"><li><span class="yiyi-st" id="yiyi-214"><span class="target" id="sqlalchemy.events.ConnectionEvents.before_execute.params.conn"></span> <strong>conn</strong> <a class="paramlink headerlink reference internal" href="#sqlalchemy.events.ConnectionEvents.before_execute.params.conn">&#xB6;</a>  -  <a class="reference internal" href="connections.html#sqlalchemy.engine.Connection" title="sqlalchemy.engine.Connection"><code class="xref py py-class docutils literal"><span class="pre">Connection</span></code></a>&#x5BF9;&#x8C61;</span></li><li><span class="yiyi-st" id="yiyi-215"><span class="target" id="sqlalchemy.events.ConnectionEvents.before_execute.params.clauseelement"></span><strong>clauseelement</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.events.ConnectionEvents.before_execute.params.clauseelement">&#xB6;</a> &#x2013; SQL expression construct, <a class="reference internal" href="internals.html#sqlalchemy.engine.interfaces.Compiled" title="sqlalchemy.engine.interfaces.Compiled"><code class="xref py py-class docutils literal"><span class="pre">Compiled</span></code></a> instance, or string statement passed to <a class="reference internal" href="connections.html#sqlalchemy.engine.Connection.execute" title="sqlalchemy.engine.Connection.execute"><code class="xref py py-meth docutils literal"><span class="pre">Connection.execute()</span></code></a>.</span></li><li><span class="yiyi-st" id="yiyi-216"><span class="target" id="sqlalchemy.events.ConnectionEvents.before_execute.params.multiparams"></span> <strong>multiparams</strong> <a class="paramlink headerlink reference internal" href="#sqlalchemy.events.ConnectionEvents.before_execute.params.multiparams">&#xB6;</a>  - &#x591A;&#x4E2A;&#x53C2;&#x6570;&#x96C6;&#xFF0C;&#x4E00;&#x4E2A;&#x5B57;&#x5178;&#x5217;&#x8868;&#x3002;</span></li><li><span class="yiyi-st" id="yiyi-217"><span class="target" id="sqlalchemy.events.ConnectionEvents.before_execute.params.params"></span> <strong>params</strong> <a class="paramlink headerlink reference internal" href="#sqlalchemy.events.ConnectionEvents.before_execute.params.params">&#xB6;</a>  - &#x5355;&#x4E2A;&#x53C2;&#x6570;&#x96C6;&#xFF0C;&#x5355;&#x4E2A;&#x5B57;&#x5178;&#x3002;</span></li></ul></td></tr></tbody></table><p><span class="yiyi-st" id="yiyi-218">&#x4E5F;&#x53EF;&#x4EE5;&#x770B;&#x770B;&#xFF1A;</span></p><p><span class="yiyi-st" id="yiyi-219"><a class="reference internal" href="#sqlalchemy.events.ConnectionEvents.before_cursor_execute" title="sqlalchemy.events.ConnectionEvents.before_cursor_execute"><code class="xref py py-meth docutils literal"><span class="pre">before_cursor_execute()</span></code></a></span></p></dd></dl><dl class="method"><dt id="sqlalchemy.events.ConnectionEvents.begin"><span class="yiyi-st" id="yiyi-220"><code class="descname">&#x5F00;&#x59CB; T0&gt; <span class="sig-paren">&#xFF08; T1&gt; <em>&#x5EB7;&#x6069; T2&gt; <span class="sig-paren">&#xFF09; T3&gt; <a class="headerlink" href="#sqlalchemy.events.ConnectionEvents.begin" title="Permalink to this definition">&#xB6; T4&gt;</a></span></em></span></code></span></dt><dd><p><span class="yiyi-st" id="yiyi-221">&#x62E6;&#x622A;begin()&#x4E8B;&#x4EF6;&#x3002;</span></p><div class="event-signatures container"><p><span class="yiyi-st" id="yiyi-222">&#x793A;&#x4F8B;&#x53C2;&#x6570;&#x8868;&#x5355;&#xFF1A;</span></p><div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sqlalchemy</span> <span class="kn">import</span> <span class="n">event</span>

<span class="c1"># standard decorator style</span>
<span class="nd">@event.listens_for</span><span class="p">(</span><span class="n">SomeEngine</span><span class="p">,</span> <span class="s1">&apos;begin&apos;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">receive_begin</span><span class="p">(</span><span class="n">conn</span><span class="p">):</span>
    <span class="s2">&quot;listen for the &apos;begin&apos; event&quot;</span>

    <span class="c1"># ... (event handling logic) ...</span></pre></div></div></div><table class="docutils field-list" frame="void" rules="none"><tbody valign="top"><tr class="field-odd field"><th class="field-name"><span class="yiyi-st" id="yiyi-223">&#x53C2;&#x6570;&#xFF1A;</span></th><td class="field-body"><span class="yiyi-st" id="yiyi-224"><span class="target" id="sqlalchemy.events.ConnectionEvents.begin.params.conn"></span> <strong>conn</strong> <a class="paramlink headerlink reference internal" href="#sqlalchemy.events.ConnectionEvents.begin.params.conn">&#xB6;</a>  -  <a class="reference internal" href="connections.html#sqlalchemy.engine.Connection" title="sqlalchemy.engine.Connection"><code class="xref py py-class docutils literal"><span class="pre">Connection</span></code></a>&#x5BF9;&#x8C61;</span></td></tr></tbody></table></dd></dl><dl class="method"><dt id="sqlalchemy.events.ConnectionEvents.begin_twophase"><span class="yiyi-st" id="yiyi-225"><code class="descname">begin_twophase</code> <span class="sig-paren">&#xFF08;</span> <em>conn</em>&#xFF0C;<em>xid</em> <span class="sig-paren">&#xFF09;</span> <a class="headerlink" href="#sqlalchemy.events.ConnectionEvents.begin_twophase" title="Permalink to this definition"></a></span></dt><dd><p><span class="yiyi-st" id="yiyi-226">&#x62E6;&#x622A;begin_twophase()&#x4E8B;&#x4EF6;&#x3002;</span></p><div class="event-signatures container"><p><span class="yiyi-st" id="yiyi-227">&#x793A;&#x4F8B;&#x53C2;&#x6570;&#x8868;&#x5355;&#xFF1A;</span></p><div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sqlalchemy</span> <span class="kn">import</span> <span class="n">event</span>

<span class="c1"># standard decorator style</span>
<span class="nd">@event.listens_for</span><span class="p">(</span><span class="n">SomeEngine</span><span class="p">,</span> <span class="s1">&apos;begin_twophase&apos;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">receive_begin_twophase</span><span class="p">(</span><span class="n">conn</span><span class="p">,</span> <span class="n">xid</span><span class="p">):</span>
    <span class="s2">&quot;listen for the &apos;begin_twophase&apos; event&quot;</span>

    <span class="c1"># ... (event handling logic) ...</span></pre></div></div></div><table class="docutils field-list" frame="void" rules="none"><tbody valign="top"><tr class="field-odd field"><th class="field-name"><span class="yiyi-st" id="yiyi-228">&#x53C2;&#x6570;&#xFF1A;</span></th><td class="field-body"><ul class="first last simple"><li><span class="yiyi-st" id="yiyi-229"><span class="target" id="sqlalchemy.events.ConnectionEvents.begin_twophase.params.conn"></span> <strong>conn</strong> <a class="paramlink headerlink reference internal" href="#sqlalchemy.events.ConnectionEvents.begin_twophase.params.conn">&#xB6;</a>  -  <a class="reference internal" href="connections.html#sqlalchemy.engine.Connection" title="sqlalchemy.engine.Connection"><code class="xref py py-class docutils literal"><span class="pre">Connection</span></code></a>&#x5BF9;&#x8C61;</span></li><li><span class="yiyi-st" id="yiyi-230"><span class="target" id="sqlalchemy.events.ConnectionEvents.begin_twophase.params.xid"></span> <strong>xid</strong> <a class="paramlink headerlink reference internal" href="#sqlalchemy.events.ConnectionEvents.begin_twophase.params.xid">&#xB6;</a>  - &#x4E24;&#x9636;&#x6BB5;XID&#x6807;&#x8BC6;&#x7B26;</span></li></ul></td></tr></tbody></table></dd></dl><dl class="method"><dt id="sqlalchemy.events.ConnectionEvents.commit"><span class="yiyi-st" id="yiyi-231"><code class="descname">&#x63D0;&#x4EA4; T0&gt; <span class="sig-paren">&#xFF08; T1&gt; <em>&#x5EB7;&#x6069; T2&gt; <span class="sig-paren">&#xFF09; T3&gt; <a class="headerlink" href="#sqlalchemy.events.ConnectionEvents.commit" title="Permalink to this definition">&#xB6; T4&gt;</a></span></em></span></code></span></dt><dd><p><span class="yiyi-st" id="yiyi-232">&#x62E6;&#x622A;commit()&#x4E8B;&#x4EF6;&#xFF0C;&#x7531;<a class="reference internal" href="connections.html#sqlalchemy.engine.Transaction" title="sqlalchemy.engine.Transaction"><code class="xref py py-class docutils literal"><span class="pre">Transaction</span></code></a>&#x542F;&#x52A8;&#x3002;</span></p><div class="event-signatures container"><p><span class="yiyi-st" id="yiyi-233">&#x793A;&#x4F8B;&#x53C2;&#x6570;&#x8868;&#x5355;&#xFF1A;</span></p><div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sqlalchemy</span> <span class="kn">import</span> <span class="n">event</span>

<span class="c1"># standard decorator style</span>
<span class="nd">@event.listens_for</span><span class="p">(</span><span class="n">SomeEngine</span><span class="p">,</span> <span class="s1">&apos;commit&apos;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">receive_commit</span><span class="p">(</span><span class="n">conn</span><span class="p">):</span>
    <span class="s2">&quot;listen for the &apos;commit&apos; event&quot;</span>

    <span class="c1"># ... (event handling logic) ...</span></pre></div></div></div><p><span class="yiyi-st" id="yiyi-234">&#x8BF7;&#x6CE8;&#x610F;&#xFF0C;&#x5982;&#x679C;<code class="docutils literal"><span class="pre">reset_on_return</span></code>&#x6807;&#x5FD7;&#x8BBE;&#x7F6E;&#x4E3A;<code class="docutils literal"><span class="pre">&apos;commit&apos;</span></code>&#x503C;&#xFF0C;&#x5219;<a class="reference internal" href="pooling.html#sqlalchemy.pool.Pool" title="sqlalchemy.pool.Pool"><code class="xref py py-class docutils literal"><span class="pre">Pool</span></code></a>&#x4E5F;&#x53EF;&#x4EE5;&#x5728;&#x7B7E;&#x5165;&#x65F6;&#x81EA;&#x52A8;&#x63D0;&#x4EA4;DBAPI&#x8FDE;&#x63A5;&#x3002; &#x3002;</span><span class="yiyi-st" id="yiyi-235">&#x8981;&#x62E6;&#x622A;&#x6B64;&#x63D0;&#x4EA4;&#xFF0C;&#x8BF7;&#x4F7F;&#x7528;<a class="reference internal" href="#sqlalchemy.events.PoolEvents.reset" title="sqlalchemy.events.PoolEvents.reset"><code class="xref py py-meth docutils literal"><span class="pre">PoolEvents.reset()</span></code></a>&#x6302;&#x94A9;&#x3002;</span></p><table class="docutils field-list" frame="void" rules="none"><tbody valign="top"><tr class="field-odd field"><th class="field-name"><span class="yiyi-st" id="yiyi-236">&#x53C2;&#x6570;&#xFF1A;</span></th><td class="field-body"><span class="yiyi-st" id="yiyi-237"><span class="target" id="sqlalchemy.events.ConnectionEvents.commit.params.conn"></span> <strong>conn</strong> <a class="paramlink headerlink reference internal" href="#sqlalchemy.events.ConnectionEvents.commit.params.conn">&#xB6;</a>  -  <a class="reference internal" href="connections.html#sqlalchemy.engine.Connection" title="sqlalchemy.engine.Connection"><code class="xref py py-class docutils literal"><span class="pre">Connection</span></code></a>&#x5BF9;&#x8C61;</span></td></tr></tbody></table></dd></dl><dl class="method"><dt id="sqlalchemy.events.ConnectionEvents.commit_twophase"><span class="yiyi-st" id="yiyi-238"> <code class="descname">commit_twophase</code><span class="sig-paren">(</span><em>conn</em>, <em>xid</em>, <em>is_prepared</em><span class="sig-paren">)</span><a class="headerlink" href="#sqlalchemy.events.ConnectionEvents.commit_twophase" title="Permalink to this definition">&#xB6;</a></span></dt><dd><p><span class="yiyi-st" id="yiyi-239">&#x62E6;&#x622A;commit_twophase()&#x4E8B;&#x4EF6;&#x3002;</span></p><div class="event-signatures container"><p><span class="yiyi-st" id="yiyi-240">&#x793A;&#x4F8B;&#x53C2;&#x6570;&#x8868;&#x5355;&#xFF1A;</span></p><div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sqlalchemy</span> <span class="kn">import</span> <span class="n">event</span>

<span class="c1"># standard decorator style</span>
<span class="nd">@event.listens_for</span><span class="p">(</span><span class="n">SomeEngine</span><span class="p">,</span> <span class="s1">&apos;commit_twophase&apos;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">receive_commit_twophase</span><span class="p">(</span><span class="n">conn</span><span class="p">,</span> <span class="n">xid</span><span class="p">,</span> <span class="n">is_prepared</span><span class="p">):</span>
    <span class="s2">&quot;listen for the &apos;commit_twophase&apos; event&quot;</span>

    <span class="c1"># ... (event handling logic) ...</span></pre></div></div></div><table class="docutils field-list" frame="void" rules="none"><tbody valign="top"><tr class="field-odd field"><th class="field-name"><span class="yiyi-st" id="yiyi-241">&#x53C2;&#x6570;&#xFF1A;</span></th><td class="field-body"><ul class="first last simple"><li><span class="yiyi-st" id="yiyi-242"><span class="target" id="sqlalchemy.events.ConnectionEvents.commit_twophase.params.conn"></span> <strong>conn</strong> <a class="paramlink headerlink reference internal" href="#sqlalchemy.events.ConnectionEvents.commit_twophase.params.conn">&#xB6;</a>  -  <a class="reference internal" href="connections.html#sqlalchemy.engine.Connection" title="sqlalchemy.engine.Connection"><code class="xref py py-class docutils literal"><span class="pre">Connection</span></code></a>&#x5BF9;&#x8C61;</span></li><li><span class="yiyi-st" id="yiyi-243"><span class="target" id="sqlalchemy.events.ConnectionEvents.commit_twophase.params.xid"></span> <strong>xid</strong> <a class="paramlink headerlink reference internal" href="#sqlalchemy.events.ConnectionEvents.commit_twophase.params.xid">&#xB6;</a>  - &#x4E24;&#x9636;&#x6BB5;XID&#x6807;&#x8BC6;&#x7B26;</span></li><li><span class="yiyi-st" id="yiyi-244"><span class="target" id="sqlalchemy.events.ConnectionEvents.commit_twophase.params.is_prepared"></span><strong>is_prepared</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.events.ConnectionEvents.commit_twophase.params.is_prepared">&#xB6;</a> &#x2013; boolean, indicates if <a class="reference internal" href="connections.html#sqlalchemy.engine.TwoPhaseTransaction.prepare" title="sqlalchemy.engine.TwoPhaseTransaction.prepare"><code class="xref py py-meth docutils literal"><span class="pre">TwoPhaseTransaction.prepare()</span></code></a> was called.</span></li></ul></td></tr></tbody></table></dd></dl><dl class="method"><dt id="sqlalchemy.events.ConnectionEvents.dbapi_error"><span class="yiyi-st" id="yiyi-245"><code class="descname">dbapi_error</code> <span class="sig-paren">&#xFF08;</span> <em>conn</em>&#xFF0C;<em>&#x6E38;&#x6807;</em>&#xFF0C;<em>&#x8BED;&#x53E5;</em>&#xFF0C;<em>&#x53C2;&#x6570; t5 &gt;&#xFF0C;<em>&#x4E0A;&#x4E0B;&#x6587;</em>&#xFF0C;<em>&#x5F02;&#x5E38;</em> <span class="sig-paren">&#xFF09;</span> <a class="headerlink" href="#sqlalchemy.events.ConnectionEvents.dbapi_error" title="Permalink to this definition">&#xB6;</a></em></span></dt><dd><p><span class="yiyi-st" id="yiyi-246">&#x62E6;&#x622A;&#x539F;&#x59CB;DBAPI&#x9519;&#x8BEF;&#x3002;</span></p><div class="event-signatures container"><p><span class="yiyi-st" id="yiyi-247">&#x793A;&#x4F8B;&#x53C2;&#x6570;&#x8868;&#x5355;&#xFF1A;</span></p><div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sqlalchemy</span> <span class="kn">import</span> <span class="n">event</span>

<span class="c1"># standard decorator style</span>
<span class="nd">@event.listens_for</span><span class="p">(</span><span class="n">SomeEngine</span><span class="p">,</span> <span class="s1">&apos;dbapi_error&apos;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">receive_dbapi_error</span><span class="p">(</span><span class="n">conn</span><span class="p">,</span> <span class="n">cursor</span><span class="p">,</span> <span class="n">statement</span><span class="p">,</span> <span class="n">parameters</span><span class="p">,</span> <span class="n">context</span><span class="p">,</span> <span class="n">exception</span><span class="p">):</span>
    <span class="s2">&quot;listen for the &apos;dbapi_error&apos; event&quot;</span>

    <span class="c1"># ... (event handling logic) ...</span>

<span class="c1"># named argument style (new in 0.9)</span>
<span class="nd">@event.listens_for</span><span class="p">(</span><span class="n">SomeEngine</span><span class="p">,</span> <span class="s1">&apos;dbapi_error&apos;</span><span class="p">,</span> <span class="n">named</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">receive_dbapi_error</span><span class="p">(</span><span class="o">**</span><span class="n">kw</span><span class="p">):</span>
    <span class="s2">&quot;listen for the &apos;dbapi_error&apos; event&quot;</span>
    <span class="n">conn</span> <span class="o">=</span> <span class="n">kw</span><span class="p">[</span><span class="s1">&apos;conn&apos;</span><span class="p">]</span>
    <span class="n">cursor</span> <span class="o">=</span> <span class="n">kw</span><span class="p">[</span><span class="s1">&apos;cursor&apos;</span><span class="p">]</span>

    <span class="c1"># ... (event handling logic) ...</span></pre></div></div></div><p><span class="yiyi-st" id="yiyi-248">This event is called with the DBAPI exception instance received from the DBAPI itself, <em>before</em> SQLAlchemy wraps the exception with it&#x2019;s own exception wrappers, and before any other operations are performed on the DBAPI cursor; the existing transaction remains in effect as well as any state on the cursor.</span></p><p><span class="yiyi-st" id="yiyi-249">&#x8FD9;&#x91CC;&#x7684;&#x7528;&#x4F8B;&#x662F;&#x5C06;&#x4F4E;&#x7EA7;&#x5F02;&#x5E38;&#x5904;&#x7406;&#x6CE8;&#x5165;&#x5230;<a class="reference internal" href="connections.html#sqlalchemy.engine.Engine" title="sqlalchemy.engine.Engine"><code class="xref py py-class docutils literal"><span class="pre">Engine</span></code></a>&#x4E2D;&#xFF0C;&#x901A;&#x5E38;&#x7528;&#x4E8E;&#x8BB0;&#x5F55;&#x548C;&#x8C03;&#x8BD5;&#x76EE;&#x7684;&#x3002;</span></p><div class="admonition warning"><p class="first admonition-title"><span class="yiyi-st" id="yiyi-250">&#x8B66;&#x544A;</span></p><p class="last"><span class="yiyi-st" id="yiyi-251">&#x4EE3;&#x7801;&#x5E94;&#x8BE5;<strong>&#x4E0D;</strong>&#x4FEE;&#x6539;&#x4EFB;&#x4F55;&#x72B6;&#x6001;&#x6216;&#x629B;&#x51FA;&#x4EFB;&#x4F55;&#x5F02;&#x5E38;&#xFF0C;&#x56E0;&#x4E3A;&#x8FD9;&#x4F1A;&#x5E72;&#x6270;SQLAlchemy&#x7684;&#x6E05;&#x7406;&#x548C;&#x9519;&#x8BEF;&#x5904;&#x7406;&#x4F8B;&#x7A0B;&#x3002;</span><span class="yiyi-st" id="yiyi-252">&#x5BF9;&#x4E8E;&#x5F02;&#x5E38;&#x4FEE;&#x6539;&#xFF0C;&#x8BF7;&#x53C2;&#x9605;&#x65B0;&#x7684;<a class="reference internal" href="#sqlalchemy.events.ConnectionEvents.handle_error" title="sqlalchemy.events.ConnectionEvents.handle_error"><code class="xref py py-meth docutils literal"><span class="pre">ConnectionEvents.handle_error()</span></code></a>&#x4E8B;&#x4EF6;&#x3002;</span></p></div><p><span class="yiyi-st" id="yiyi-253">&#x5728;&#x8BE5;&#x94A9;&#x5B50;&#x4E4B;&#x540E;&#xFF0C;SQLAlchemy&#x53EF;&#x4EE5;&#x5C1D;&#x8BD5;&#x5BF9;&#x8FDE;&#x63A5;/&#x6E38;&#x6807;&#x6267;&#x884C;&#x4EFB;&#x610F;&#x6570;&#x91CF;&#x7684;&#x64CD;&#x4F5C;&#xFF0C;&#x5305;&#x62EC;&#x5173;&#x95ED;&#x6E38;&#x6807;&#xFF0C;&#x5728;&#x65E0;&#x8FDE;&#x63A5;&#x6267;&#x884C;&#x7684;&#x60C5;&#x51B5;&#x4E0B;&#x56DE;&#x6EDA;&#x4E8B;&#x52A1;&#xFF0C;&#x4EE5;&#x53CA;&#x5728;&#x68C0;&#x6D4B;&#x5230;&#x201C;&#x65AD;&#x5F00;&#x8FDE;&#x63A5;&#x201D;&#x7684;&#x60C5;&#x51B5;&#x4E0B;&#x5904;&#x7F6E;&#x6574;&#x4E2A;&#x8FDE;&#x63A5;&#x6C60;&#x3002;</span><span class="yiyi-st" id="yiyi-254">&#x7136;&#x540E;&#x5C06;&#x8BE5;&#x5F02;&#x5E38;&#x5305;&#x88C5;&#x5728;SQLAlchemy DBAPI&#x5F02;&#x5E38;&#x5305;&#x88C5;&#x5668;&#x4E2D;&#x5E76;&#x91CD;&#x65B0;&#x5F15;&#x53D1;&#x3002;</span></p><table class="docutils field-list" frame="void" rules="none"><tbody valign="top"><tr class="field-odd field"><th class="field-name"><span class="yiyi-st" id="yiyi-255">&#x53C2;&#x6570;&#xFF1A;</span></th><td class="field-body"><ul class="first last simple"><li><span class="yiyi-st" id="yiyi-256"><span class="target" id="sqlalchemy.events.ConnectionEvents.dbapi_error.params.conn"></span> <strong>conn</strong> <a class="paramlink headerlink reference internal" href="#sqlalchemy.events.ConnectionEvents.dbapi_error.params.conn">&#xB6;</a>  -  <a class="reference internal" href="connections.html#sqlalchemy.engine.Connection" title="sqlalchemy.engine.Connection"><code class="xref py py-class docutils literal"><span class="pre">Connection</span></code></a>&#x5BF9;&#x8C61;</span></li><li><span class="yiyi-st" id="yiyi-257"><span class="target" id="sqlalchemy.events.ConnectionEvents.dbapi_error.params.cursor"></span> <strong>&#x6E38;&#x6807;</strong> <a class="paramlink headerlink reference internal" href="#sqlalchemy.events.ConnectionEvents.dbapi_error.params.cursor">&#xB6;</a>  -  DBAPI&#x6E38;&#x6807;&#x5BF9;&#x8C61;</span></li><li><span class="yiyi-st" id="yiyi-258"><span class="target" id="sqlalchemy.events.ConnectionEvents.dbapi_error.params.statement"></span><strong>statement</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.events.ConnectionEvents.dbapi_error.params.statement">&#xB6;</a> &#x2013; string SQL statement, as passed to the DBAPI</span></li><li><span class="yiyi-st" id="yiyi-259"><span class="target" id="sqlalchemy.events.ConnectionEvents.dbapi_error.params.parameters"></span><strong>parameters</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.events.ConnectionEvents.dbapi_error.params.parameters">&#xB6;</a> &#x2013; Dictionary, tuple, or list of parameters being passed to the <code class="docutils literal"><span class="pre">execute()</span></code> or <code class="docutils literal"><span class="pre">executemany()</span></code> method of the DBAPI <code class="docutils literal"><span class="pre">cursor</span></code>. </span><span class="yiyi-st" id="yiyi-260">&#x5728;&#x67D0;&#x4E9B;&#x60C5;&#x51B5;&#x4E0B;&#x53EF;&#x80FD;&#x662F;<code class="docutils literal"><span class="pre">None</span></code>&#x3002;</span></li><li><span class="yiyi-st" id="yiyi-261"><span class="target" id="sqlalchemy.events.ConnectionEvents.dbapi_error.params.context"></span><strong>context</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.events.ConnectionEvents.dbapi_error.params.context">&#xB6;</a> &#x2013; <a class="reference internal" href="internals.html#sqlalchemy.engine.interfaces.ExecutionContext" title="sqlalchemy.engine.interfaces.ExecutionContext"><code class="xref py py-class docutils literal"><span class="pre">ExecutionContext</span></code></a> object in use. </span><span class="yiyi-st" id="yiyi-262">&#x53EF;&#x80FD;&#x662F;<code class="docutils literal"><span class="pre">None</span></code>&#x3002;</span></li><li><span class="yiyi-st" id="yiyi-263"><span class="target" id="sqlalchemy.events.ConnectionEvents.dbapi_error.params.exception"></span><strong>exception</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.events.ConnectionEvents.dbapi_error.params.exception">&#xB6;</a> &#x2013; The <strong>unwrapped</strong> exception emitted directly from the DBAPI. </span><span class="yiyi-st" id="yiyi-264">&#x6B64;&#x5904;&#x7684;&#x7C7B;&#x7279;&#x5B9A;&#x4E8E;&#x6B63;&#x5728;&#x4F7F;&#x7528;&#x7684;DBAPI&#x6A21;&#x5757;&#x3002;</span></li></ul></td></tr></tbody></table><div class="deprecated"><p><span class="yiyi-st" id="yiyi-265"><span class="versionmodified">&#x4ECE;&#x7248;&#x672C;0.9.7&#x5F00;&#x59CB;&#x5F03;&#x7528;&#xFF1A;</span>  - &#x7531;<a class="reference internal" href="#sqlalchemy.events.ConnectionEvents.handle_error" title="sqlalchemy.events.ConnectionEvents.handle_error"><code class="xref py py-meth docutils literal"><span class="pre">ConnectionEvents.handle_error()</span></code></a></span></p></div></dd></dl><dl class="method"><dt id="sqlalchemy.events.ConnectionEvents.engine_connect"><span class="yiyi-st" id="yiyi-266"><code class="descname"> engine_connect  T0&gt; <span class="sig-paren">&#xFF08; T1&gt; <em>&#x5EB7;&#x6069; T2&gt;&#xFF0C;<em>&#x5206;&#x652F; T3&gt; <span class="sig-paren">&#xFF09; T4&gt; <a class="headerlink" href="#sqlalchemy.events.ConnectionEvents.engine_connect" title="Permalink to this definition">&#xB6; T5&gt;</a></span></em></em></span></code></span></dt><dd><p><span class="yiyi-st" id="yiyi-267">&#x62E6;&#x622A;&#x521B;&#x5EFA;&#x65B0;&#x7684;<a class="reference internal" href="connections.html#sqlalchemy.engine.Connection" title="sqlalchemy.engine.Connection"><code class="xref py py-class docutils literal"><span class="pre">Connection</span></code></a>&#x3002;</span></p><div class="event-signatures container"><p><span class="yiyi-st" id="yiyi-268">&#x793A;&#x4F8B;&#x53C2;&#x6570;&#x8868;&#x5355;&#xFF1A;</span></p><div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sqlalchemy</span> <span class="kn">import</span> <span class="n">event</span>

<span class="c1"># standard decorator style</span>
<span class="nd">@event.listens_for</span><span class="p">(</span><span class="n">SomeEngine</span><span class="p">,</span> <span class="s1">&apos;engine_connect&apos;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">receive_engine_connect</span><span class="p">(</span><span class="n">conn</span><span class="p">,</span> <span class="n">branch</span><span class="p">):</span>
    <span class="s2">&quot;listen for the &apos;engine_connect&apos; event&quot;</span>

    <span class="c1"># ... (event handling logic) ...</span></pre></div></div></div><p><span class="yiyi-st" id="yiyi-269">&#x8FD9;&#x4E2A;&#x4E8B;&#x4EF6;&#x901A;&#x5E38;&#x88AB;&#x79F0;&#x4E3A;&#x8C03;&#x7528;<a class="reference internal" href="connections.html#sqlalchemy.engine.Engine.connect" title="sqlalchemy.engine.Engine.connect"><code class="xref py py-meth docutils literal"><span class="pre">Engine.connect()</span></code></a>&#x65B9;&#x6CD5;&#x7684;&#x76F4;&#x63A5;&#x7ED3;&#x679C;&#x3002;</span></p><p><span class="yiyi-st" id="yiyi-270">&#x5B83;&#x4E0D;&#x540C;&#x4E8E;<a class="reference internal" href="#sqlalchemy.events.PoolEvents.connect" title="sqlalchemy.events.PoolEvents.connect"><code class="xref py py-meth docutils literal"><span class="pre">PoolEvents.connect()</span></code></a>&#x65B9;&#x6CD5;&#xFF0C;&#x5B83;&#x6307;&#x5411;DBAPI&#x7EA7;&#x522B;&#x7684;&#x6570;&#x636E;&#x5E93;&#x7684;&#x5B9E;&#x9645;&#x8FDE;&#x63A5;&#xFF1B; DBAPI&#x8FDE;&#x63A5;&#x53EF;&#x80FD;&#x4F1A;&#x88AB;&#x96C6;&#x4E2D;&#x5E76;&#x91CD;&#x7528;&#x4E8E;&#x8BB8;&#x591A;&#x64CD;&#x4F5C;&#x3002;</span><span class="yiyi-st" id="yiyi-271">&#x76F8;&#x53CD;&#xFF0C;&#x6B64;&#x4E8B;&#x4EF6;&#x4EC5;&#x6D89;&#x53CA;&#x56F4;&#x7ED5;&#x6B64;&#x7C7B;DBAPI&#x8FDE;&#x63A5;&#x751F;&#x6210;&#x8F83;&#x9AD8;&#x7EA7;&#x522B;&#x7684;<a class="reference internal" href="connections.html#sqlalchemy.engine.Connection" title="sqlalchemy.engine.Connection"><code class="xref py py-class docutils literal"><span class="pre">Connection</span></code></a>&#x5305;&#x88C5;&#x3002;</span></p><p><span class="yiyi-st" id="yiyi-272">It also differs from the <a class="reference internal" href="#sqlalchemy.events.PoolEvents.checkout" title="sqlalchemy.events.PoolEvents.checkout"><code class="xref py py-meth docutils literal"><span class="pre">PoolEvents.checkout()</span></code></a> event in that it is specific to the <a class="reference internal" href="connections.html#sqlalchemy.engine.Connection" title="sqlalchemy.engine.Connection"><code class="xref py py-class docutils literal"><span class="pre">Connection</span></code></a> object, not the DBAPI connection that <a class="reference internal" href="#sqlalchemy.events.PoolEvents.checkout" title="sqlalchemy.events.PoolEvents.checkout"><code class="xref py py-meth docutils literal"><span class="pre">PoolEvents.checkout()</span></code></a> deals with, although this DBAPI connection is available here via the <a class="reference internal" href="connections.html#sqlalchemy.engine.Connection.connection" title="sqlalchemy.engine.Connection.connection"><code class="xref py py-attr docutils literal"><span class="pre">Connection.connection</span></code></a> attribute. </span><span class="yiyi-st" id="yiyi-273">&#x4F46;&#x662F;&#x8BF7;&#x6CE8;&#x610F;&#xFF0C;&#x5982;&#x679C;<a class="reference internal" href="connections.html#sqlalchemy.engine.Connection" title="sqlalchemy.engine.Connection"><code class="xref py py-class docutils literal"><span class="pre">Connection</span></code></a>&#x5BF9;&#x8C61;&#x5931;&#x6548;&#xFF0C;&#x90A3;&#x4E48;&#x5728;&#x5355;&#x4E2A;<a class="reference internal" href="connections.html#sqlalchemy.engine.Connection" title="sqlalchemy.engine.Connection"><code class="xref py py-class docutils literal"><span class="pre">Connection</span></code></a>&#x5BF9;&#x8C61;&#x7684;&#x751F;&#x547D;&#x5468;&#x671F;&#x5185;&#x5B9E;&#x9645;&#x4E0A;&#x53EF;&#x80FD;&#x5B58;&#x5728;&#x591A;&#x4E2A;<a class="reference internal" href="#sqlalchemy.events.PoolEvents.checkout" title="sqlalchemy.events.PoolEvents.checkout"><code class="xref py py-meth docutils literal"><span class="pre">PoolEvents.checkout()</span></code></a>&#x91CD;&#x65B0;&#x5EFA;&#x7ACB;&#x3002;</span><span class="yiyi-st" id="yiyi-274">&#x5728;&#x751F;&#x6210;<a class="reference internal" href="connections.html#sqlalchemy.engine.Connection" title="sqlalchemy.engine.Connection"><code class="xref py py-class docutils literal"><span class="pre">Connection</span></code></a>&#x7684;&#x201C;&#x5206;&#x652F;&#x201D;&#x7684;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;&#x4E5F;&#x53EF;&#x4EE5;&#x4E3A;&#x540C;&#x4E00;&#x4E2A;&#x5DF2;&#x7ECF;&#x68C0;&#x51FA;&#x7684;DBAPI&#x8FDE;&#x63A5;&#x751F;&#x6210;&#x591A;&#x4E2A;<a class="reference internal" href="connections.html#sqlalchemy.engine.Connection" title="sqlalchemy.engine.Connection"><code class="xref py py-class docutils literal"><span class="pre">Connection</span></code></a>&#x5BF9;&#x8C61;&#x3002;</span></p><table class="docutils field-list" frame="void" rules="none"><tbody valign="top"><tr class="field-odd field"><th class="field-name"><span class="yiyi-st" id="yiyi-275">&#x53C2;&#x6570;&#xFF1A;</span></th><td class="field-body"><ul class="first last simple"><li><span class="yiyi-st" id="yiyi-276"><span class="target" id="sqlalchemy.events.ConnectionEvents.engine_connect.params.conn"></span> <strong>conn</strong> <a class="paramlink headerlink reference internal" href="#sqlalchemy.events.ConnectionEvents.engine_connect.params.conn">&#xB6;</a>  -  <a class="reference internal" href="connections.html#sqlalchemy.engine.Connection" title="sqlalchemy.engine.Connection"><code class="xref py py-class docutils literal"><span class="pre">Connection</span></code></a>&#x5BF9;&#x8C61;&#x3002;</span></li><li><span class="yiyi-st" id="yiyi-277"><span class="target" id="sqlalchemy.events.ConnectionEvents.engine_connect.params.branch"></span><strong>branch</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.events.ConnectionEvents.engine_connect.params.branch">&#xB6;</a> &#x2013; if True, this is a &#x201C;branch&#x201D; of an existing <a class="reference internal" href="connections.html#sqlalchemy.engine.Connection" title="sqlalchemy.engine.Connection"><code class="xref py py-class docutils literal"><span class="pre">Connection</span></code></a>. </span><span class="yiyi-st" id="yiyi-278">&#x5728;&#x6267;&#x884C;&#x8BED;&#x53E5;&#x7684;&#x8FC7;&#x7A0B;&#x4E2D;&#x4F1A;&#x751F;&#x6210;&#x4E00;&#x4E2A;&#x5206;&#x652F;&#x4EE5;&#x8C03;&#x7528;&#x8865;&#x5145;&#x8BED;&#x53E5;&#xFF0C;&#x901A;&#x5E38;&#x4E3A;&#x4E86;INSERT&#x8BED;&#x53E5;&#x7684;&#x76EE;&#x7684;&#x9884;&#x5148;&#x6267;&#x884C;&#x4E00;&#x4E2A;&#x9ED8;&#x8BA4;&#x503C;&#x7684;SELECT&#x3002;</span></li></ul></td></tr></tbody></table><div class="versionadded"><p><span class="yiyi-st" id="yiyi-279"><span class="versionmodified">&#x7248;&#x672C;0.9.0&#x4E2D;&#x7684;&#x65B0;&#x529F;&#x80FD;</span></span></p></div><div class="admonition seealso"><p class="first admonition-title"><span class="yiyi-st" id="yiyi-280">&#x4E5F;&#x53EF;&#x4EE5;&#x770B;&#x770B;</span></p><p><span class="yiyi-st" id="yiyi-281"><a class="reference internal" href="pooling.html#pool-disconnects-pessimistic"><span>Disconnect Handling - Pessimistic</span></a>  - &#x8BF4;&#x660E;&#x5982;&#x4F55;&#x4F7F;&#x7528;<a class="reference internal" href="#sqlalchemy.events.ConnectionEvents.engine_connect" title="sqlalchemy.events.ConnectionEvents.engine_connect"><code class="xref py py-meth docutils literal"><span class="pre">ConnectionEvents.engine_connect()</span></code></a>&#x900F;&#x660E;&#x5730;&#x786E;&#x4FDD;&#x6C60;&#x8FDE;&#x63A5;&#x8FDE;&#x63A5;&#x5230;&#x6570;&#x636E;&#x5E93;&#x3002;</span></p><p><span class="yiyi-st" id="yiyi-282"><a class="reference internal" href="#sqlalchemy.events.PoolEvents.checkout" title="sqlalchemy.events.PoolEvents.checkout"><code class="xref py py-meth docutils literal"><span class="pre">PoolEvents.checkout()</span></code></a>&#x5355;&#x4E2A;DBAPI&#x8FDE;&#x63A5;&#x7684;&#x4F4E;&#x7EA7;&#x6C60;&#x68C0;&#x51FA;&#x4E8B;&#x4EF6;</span></p><p class="last"><span class="yiyi-st" id="yiyi-283"><a class="reference internal" href="#sqlalchemy.events.ConnectionEvents.set_connection_execution_options" title="sqlalchemy.events.ConnectionEvents.set_connection_execution_options"><code class="xref py py-meth docutils literal"><span class="pre">ConnectionEvents.set_connection_execution_options()</span></code></a> - a copy of a <a class="reference internal" href="connections.html#sqlalchemy.engine.Connection" title="sqlalchemy.engine.Connection"><code class="xref py py-class docutils literal"><span class="pre">Connection</span></code></a> is also made when the <a class="reference internal" href="connections.html#sqlalchemy.engine.Connection.execution_options" title="sqlalchemy.engine.Connection.execution_options"><code class="xref py py-meth docutils literal"><span class="pre">Connection.execution_options()</span></code></a> method is called.</span></p></div></dd></dl><dl class="method"><dt id="sqlalchemy.events.ConnectionEvents.engine_disposed"><span class="yiyi-st" id="yiyi-284"><code class="descname"> engine_disposed  T0&gt; <span class="sig-paren">&#xFF08; T1&gt; <em>&#x53D1;&#x52A8;&#x673A; T2&gt; <span class="sig-paren">&#xFF09; T3&gt; <a class="headerlink" href="#sqlalchemy.events.ConnectionEvents.engine_disposed" title="Permalink to this definition">&#xB6; T4&gt;</a></span></em></span></code></span></dt><dd><p><span class="yiyi-st" id="yiyi-285">&#x5728;&#x8C03;&#x7528;<a class="reference internal" href="connections.html#sqlalchemy.engine.Engine.dispose" title="sqlalchemy.engine.Engine.dispose"><code class="xref py py-meth docutils literal"><span class="pre">Engine.dispose()</span></code></a>&#x65B9;&#x6CD5;&#x65F6;&#x62E6;&#x622A;&#x3002;</span></p><div class="event-signatures container"><p><span class="yiyi-st" id="yiyi-286">&#x793A;&#x4F8B;&#x53C2;&#x6570;&#x8868;&#x5355;&#xFF1A;</span></p><div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sqlalchemy</span> <span class="kn">import</span> <span class="n">event</span>

<span class="c1"># standard decorator style</span>
<span class="nd">@event.listens_for</span><span class="p">(</span><span class="n">SomeEngine</span><span class="p">,</span> <span class="s1">&apos;engine_disposed&apos;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">receive_engine_disposed</span><span class="p">(</span><span class="n">engine</span><span class="p">):</span>
    <span class="s2">&quot;listen for the &apos;engine_disposed&apos; event&quot;</span>

    <span class="c1"># ... (event handling logic) ...</span></pre></div></div></div><p><span class="yiyi-st" id="yiyi-287"><a class="reference internal" href="connections.html#sqlalchemy.engine.Engine.dispose" title="sqlalchemy.engine.Engine.dispose"><code class="xref py py-meth docutils literal"><span class="pre">Engine.dispose()</span></code></a>&#x65B9;&#x6CD5;&#x6307;&#x793A;&#x5F15;&#x64CE;&#x201C;&#x5904;&#x7F6E;&#x201D;&#x5176;&#x8FDE;&#x63A5;&#x6C60;&#xFF08;&#x4F8B;&#x5982;&#xFF0C;</span><span class="yiyi-st" id="yiyi-288"><a class="reference internal" href="pooling.html#sqlalchemy.pool.Pool" title="sqlalchemy.pool.Pool"><code class="xref py py-class docutils literal"><span class="pre">Pool</span></code></a>&#xFF09;&#xFF0C;&#x5E76;&#x7528;&#x65B0;&#x7684;&#x66FF;&#x6362;&#x5B83;&#x3002;</span><span class="yiyi-st" id="yiyi-289">&#x5904;&#x7406;&#x65E7;&#x6C60;&#x4F1A;&#x5BFC;&#x81F4;&#x73B0;&#x6709;&#x7684;&#x68C0;&#x5165;&#x8FDE;&#x63A5;&#x5173;&#x95ED;&#x3002;</span><span class="yiyi-st" id="yiyi-290">&#x65B0;&#x6C60;&#x5728;&#x9996;&#x6B21;&#x4F7F;&#x7528;&#x4E4B;&#x524D;&#x4E0D;&#x4F1A;&#x5EFA;&#x7ACB;&#x4EFB;&#x4F55;&#x65B0;&#x8FDE;&#x63A5;&#x3002;</span></p><p><span class="yiyi-st" id="yiyi-291">&#x6B64;&#x4E8B;&#x4EF6;&#x53EF;&#x7528;&#x4E8E;&#x6307;&#x793A;&#x4E0E;<a class="reference internal" href="connections.html#sqlalchemy.engine.Engine" title="sqlalchemy.engine.Engine"><code class="xref py py-class docutils literal"><span class="pre">Engine</span></code></a>&#x76F8;&#x5173;&#x7684;&#x8D44;&#x6E90;&#x4E5F;&#x5E94;&#x8BE5;&#x6E05;&#x7406;&#x5E72;&#x51C0;&#xFF0C;&#x540C;&#x65F6;&#x8BF7;&#x8BB0;&#x4F4F;<a class="reference internal" href="connections.html#sqlalchemy.engine.Engine" title="sqlalchemy.engine.Engine"><code class="xref py py-class docutils literal"><span class="pre">Engine</span></code></a>&#x4ECD;&#x53EF;&#x7528;&#x4E8E;&#x65B0;&#x8BF7;&#x6C42;&#xFF0C;&#x5728;&#x8FD9;&#x79CD;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;&#x91CD;&#x65B0;&#x83B7;&#x53D6;&#x8FDE;&#x63A5;&#x8D44;&#x6E90;&#x3002;</span></p><div class="versionadded"><p><span class="yiyi-st" id="yiyi-292"><span class="versionmodified">&#x7248;&#x672C;1.0.5&#x4E2D;&#x7684;&#x65B0;&#x529F;&#x80FD;</span></span></p></div></dd></dl><dl class="method"><dt id="sqlalchemy.events.ConnectionEvents.handle_error"><span class="yiyi-st" id="yiyi-293"><code class="descname">&#x4E86;handle_error  T0&gt; <span class="sig-paren">&#xFF08; T1&gt; <em> exception_context  T2&gt; <span class="sig-paren">&#xFF09; T3&gt; <a class="headerlink" href="#sqlalchemy.events.ConnectionEvents.handle_error" title="Permalink to this definition">&#xB6; T4&gt;</a></span></em></span></code></span></dt><dd><p><span class="yiyi-st" id="yiyi-294">&#x62E6;&#x622A;&#x7531;<a class="reference internal" href="connections.html#sqlalchemy.engine.Connection" title="sqlalchemy.engine.Connection"><code class="xref py py-class docutils literal"><span class="pre">Connection</span></code></a>&#x5904;&#x7406;&#x7684;&#x6240;&#x6709;&#x5F02;&#x5E38;&#x3002;</span></p><div class="event-signatures container"><p><span class="yiyi-st" id="yiyi-295">&#x793A;&#x4F8B;&#x53C2;&#x6570;&#x8868;&#x5355;&#xFF1A;</span></p><div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sqlalchemy</span> <span class="kn">import</span> <span class="n">event</span>

<span class="c1"># standard decorator style</span>
<span class="nd">@event.listens_for</span><span class="p">(</span><span class="n">SomeEngine</span><span class="p">,</span> <span class="s1">&apos;handle_error&apos;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">receive_handle_error</span><span class="p">(</span><span class="n">exception_context</span><span class="p">):</span>
    <span class="s2">&quot;listen for the &apos;handle_error&apos; event&quot;</span>

    <span class="c1"># ... (event handling logic) ...</span></pre></div></div></div><p><span class="yiyi-st" id="yiyi-296">&#x8FD9;&#x5305;&#x62EC;DBAPI&#x4EE5;&#x53CA;SQLAlchemy&#x7684;&#x8BED;&#x53E5;&#x8C03;&#x7528;&#x8FC7;&#x7A0B;&#x4E2D;&#x53D1;&#x51FA;&#x7684;&#x6240;&#x6709;&#x5F02;&#x5E38;&#xFF0C;&#x5305;&#x62EC;&#x7F16;&#x7801;&#x9519;&#x8BEF;&#x548C;&#x5176;&#x4ED6;&#x8BED;&#x53E5;&#x9A8C;&#x8BC1;&#x9519;&#x8BEF;&#x3002;</span><span class="yiyi-st" id="yiyi-297">&#x4E8B;&#x4EF6;&#x88AB;&#x8C03;&#x7528;&#x7684;&#x5176;&#x4ED6;&#x533A;&#x57DF;&#x5305;&#x62EC;&#x4E8B;&#x52A1;&#x5F00;&#x59CB;&#x548C;&#x7ED3;&#x675F;&#xFF0C;&#x7ED3;&#x679C;&#x884C;&#x8BFB;&#x53D6;&#xFF0C;&#x5149;&#x6807;&#x521B;&#x5EFA;&#x3002;</span></p><p><span class="yiyi-st" id="yiyi-298">&#x8BF7;&#x6CE8;&#x610F;&#xFF0C;<a class="reference internal" href="#sqlalchemy.events.ConnectionEvents.handle_error" title="sqlalchemy.events.ConnectionEvents.handle_error"><code class="xref py py-meth docutils literal"><span class="pre">handle_error()</span></code></a>&#x53EF;&#x4EE5;&#x968F;&#x65F6;<em>&#x652F;&#x6301;&#x65B0;&#x7C7B;&#x578B;&#x7684;&#x5F02;&#x5E38;&#x548C;&#x65B0;&#x7684;&#x8C03;&#x7528;&#x65B9;&#x6848;</em>&#x3002;</span><span class="yiyi-st" id="yiyi-299">&#x4F7F;&#x7528;&#x6B64;&#x4E8B;&#x4EF6;&#x7684;&#x4EE3;&#x7801;&#x5FC5;&#x987B;&#x671F;&#x671B;&#x5728;&#x6B21;&#x8981;&#x7248;&#x672C;&#x4E2D;&#x5B58;&#x5728;&#x65B0;&#x7684;&#x8C03;&#x7528;&#x6A21;&#x5F0F;&#x3002;</span></p><p><span class="yiyi-st" id="yiyi-300">To support the wide variety of members that correspond to an exception, as well as to allow extensibility of the event without backwards incompatibility, the sole argument received is an instance of <a class="reference internal" href="connections.html#sqlalchemy.engine.ExceptionContext" title="sqlalchemy.engine.ExceptionContext"><code class="xref py py-class docutils literal"><span class="pre">ExceptionContext</span></code></a>. </span><span class="yiyi-st" id="yiyi-301">&#x8BE5;&#x5BF9;&#x8C61;&#x5305;&#x542B;&#x8868;&#x793A;&#x6709;&#x5173;&#x5F02;&#x5E38;&#x8BE6;&#x7EC6;&#x4FE1;&#x606F;&#x7684;&#x6570;&#x636E;&#x6210;&#x5458;&#x3002;</span></p><p><span class="yiyi-st" id="yiyi-302">&#x8FD9;&#x4E2A;&#x94A9;&#x5B50;&#x652F;&#x6301;&#x7684;&#x7528;&#x4F8B;&#x5305;&#x62EC;&#xFF1A;</span></p><ul class="simple"><li><span class="yiyi-st" id="yiyi-303">&#x7528;&#x4E8E;&#x8BB0;&#x5F55;&#x548C;&#x8C03;&#x8BD5;&#x76EE;&#x7684;&#x7684;&#x53EA;&#x8BFB;&#xFF0C;&#x4F4E;&#x7EA7;&#x5F02;&#x5E38;&#x5904;&#x7406;</span></li><li><span class="yiyi-st" id="yiyi-304">&#x5F02;&#x5E38;&#x91CD;&#x5199;</span></li></ul><p><span class="yiyi-st" id="yiyi-305">&#x6302;&#x94A9;&#x88AB;&#x8C03;&#x7528;&#xFF0C;&#x800C;&#x5931;&#x8D25;&#x64CD;&#x4F5C;&#x7684;&#x5149;&#x6807;&#xFF08;&#x5982;&#x679C;&#x6709;&#x7684;&#x8BDD;&#xFF09;&#x4ECD;&#x7136;&#x6253;&#x5F00;&#x5E76;&#x53EF;&#x8BBF;&#x95EE;&#x3002;</span><span class="yiyi-st" id="yiyi-306">&#x53EF;&#x4EE5;&#x5728;&#x8BE5;&#x6E38;&#x6807;&#x4E0A;&#x8C03;&#x7528;&#x7279;&#x6B8A;&#x7684;&#x6E05;&#x7406;&#x64CD;&#x4F5C;&#xFF1B;&#x5728;&#x6B64;&#x94A9;&#x5B50;&#x88AB;&#x8C03;&#x7528;&#x540E;&#xFF0C;SQLAlchemy&#x5C06;&#x5C1D;&#x8BD5;&#x5173;&#x95ED;&#x8FD9;&#x4E2A;&#x6E38;&#x6807;&#x3002;</span><span class="yiyi-st" id="yiyi-307">&#x5982;&#x679C;&#x8FDE;&#x63A5;&#x5904;&#x4E8E;&#x201C;&#x81EA;&#x52A8;&#x63D0;&#x4EA4;&#x201D;&#x6A21;&#x5F0F;&#xFF0C;&#x5219;&#x8BE5;&#x4E8B;&#x52A1;&#x5728;&#x8BE5;&#x94A9;&#x5B50;&#x7684;&#x8303;&#x56F4;&#x5185;&#x4E5F;&#x4FDD;&#x6301;&#x6253;&#x5F00;&#x72B6;&#x6001;&#xFF1B;&#x6BCF;&#x4E2A;&#x8BED;&#x53E5;&#x4E8B;&#x52A1;&#x7684;&#x56DE;&#x6EDA;&#x4E5F;&#x4F1A;&#x5728;&#x94A9;&#x5B50;&#x88AB;&#x8C03;&#x7528;&#x540E;&#x53D1;&#x751F;&#x3002;</span></p><p><span class="yiyi-st" id="yiyi-308">&#x7528;&#x6237;&#x5B9A;&#x4E49;&#x7684;&#x4E8B;&#x4EF6;&#x5904;&#x7406;&#x7A0B;&#x5E8F;&#x6709;&#x4E24;&#x4E2A;&#x7528;&#x4E8E;&#x5C06;SQLAlchemy&#x6784;&#x9020;&#x7684;&#x5F02;&#x5E38;&#x66FF;&#x6362;&#x4E3A;&#x7528;&#x6237;&#x5B9A;&#x4E49;&#x7684;&#x5F02;&#x5E38;&#x7684;&#x9009;&#x9879;&#x3002;</span><span class="yiyi-st" id="yiyi-309">&#x5B83;&#x53EF;&#x4EE5;&#x76F4;&#x63A5;&#x5F15;&#x53D1;&#x8FD9;&#x4E2A;&#x65B0;&#x7684;&#x5F02;&#x5E38;&#xFF0C;&#x5728;&#x8FD9;&#x79CD;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;&#x6240;&#x6709;&#x8FDB;&#x4E00;&#x6B65;&#x7684;&#x4E8B;&#x4EF6;&#x4FA6;&#x542C;&#x5668;&#x90FD;&#x4F1A;&#x88AB;&#x7ED5;&#x8FC7;&#xFF0C;&#x5E76;&#x5728;&#x53D1;&#x751F;&#x9002;&#x5F53;&#x7684;&#x6E05;&#x7406;&#x540E;&#x5F15;&#x53D1;&#x5F02;&#x5E38;&#xFF1A;</span></p><div class="highlight-python"><div class="highlight"><pre><span></span><span class="nd">@event.listens_for</span><span class="p">(</span><span class="n">Engine</span><span class="p">,</span> <span class="s2">&quot;handle_error&quot;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">handle_exception</span><span class="p">(</span><span class="n">context</span><span class="p">):</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">context</span><span class="o">.</span><span class="n">original_exception</span><span class="p">,</span>
        <span class="n">psycopg2</span><span class="o">.</span><span class="n">OperationalError</span><span class="p">)</span> <span class="ow">and</span> \
        <span class="s2">&quot;failed&quot;</span> <span class="ow">in</span> <span class="nb">str</span><span class="p">(</span><span class="n">context</span><span class="o">.</span><span class="n">original_exception</span><span class="p">):</span>
        <span class="k">raise</span> <span class="n">MySpecialException</span><span class="p">(</span><span class="s2">&quot;failed operation&quot;</span><span class="p">)</span></pre></div></div><div class="admonition warning"><p class="first admonition-title"><span class="yiyi-st" id="yiyi-310">&#x8B66;&#x544A;</span></p><p class="last"><span class="yiyi-st" id="yiyi-311">Because the <a class="reference internal" href="#sqlalchemy.events.ConnectionEvents.handle_error" title="sqlalchemy.events.ConnectionEvents.handle_error"><code class="xref py py-meth docutils literal"><span class="pre">ConnectionEvents.handle_error()</span></code></a> event specifically provides for exceptions to be re-thrown as the ultimate exception raised by the failed statement, <strong>stack traces will be misleading</strong> if the user-defined event handler itself fails and throws an unexpected exception; the stack trace may not illustrate the actual code line that failed! </span><span class="yiyi-st" id="yiyi-312">&#x5EFA;&#x8BAE;&#x5728;&#x6B64;&#x4ED4;&#x7EC6;&#x7F16;&#x7801;&#xFF0C;&#x5E76;&#x5728;&#x53D1;&#x751F;&#x610F;&#x5916;&#x5F02;&#x5E38;&#x65F6;&#x4F7F;&#x7528;&#x65E5;&#x5FD7;&#x8BB0;&#x5F55;&#x548C;/&#x6216;&#x5185;&#x8054;&#x8C03;&#x8BD5;&#x3002;</span></p></div><p><span class="yiyi-st" id="yiyi-313">&#x6216;&#x8005;&#xFF0C;&#x901A;&#x8FC7;&#x4F7F;&#x7528;<code class="docutils literal"><span class="pre">retval=True</span></code>&#x4FEE;&#x9970;&#x7B26;&#x914D;&#x7F6E;&#x5904;&#x7406;&#x7A0B;&#x5E8F;&#x5E76;&#x4ECE;&#x51FD;&#x6570;&#x8FD4;&#x56DE;&#x65B0;&#x7684;&#x5F02;&#x5E38;&#x5B9E;&#x4F8B;&#xFF0C;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;&#x201C;&#x94FE;&#x5F0F;&#x201D;&#x4E8B;&#x4EF6;&#x5904;&#x7406;&#x98CE;&#x683C;&#x3002;</span><span class="yiyi-st" id="yiyi-314">&#x5728;&#x8FD9;&#x79CD;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;&#x4E8B;&#x4EF6;&#x5904;&#x7406;&#x5C06;&#x7EE7;&#x7EED;&#x5230;&#x4E0B;&#x4E00;&#x4E2A;&#x5904;&#x7406;&#x7A0B;&#x5E8F;&#x3002;</span><span class="yiyi-st" id="yiyi-315">&#x201C;&#x94FE;&#x63A5;&#x201D;&#x5F02;&#x5E38;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;<a class="reference internal" href="connections.html#sqlalchemy.engine.ExceptionContext.chained_exception" title="sqlalchemy.engine.ExceptionContext.chained_exception"><code class="xref py py-attr docutils literal"><span class="pre">ExceptionContext.chained_exception</span></code></a>&#xFF1A;</span></p><div class="highlight-python"><div class="highlight"><pre><span></span><span class="nd">@event.listens_for</span><span class="p">(</span><span class="n">Engine</span><span class="p">,</span> <span class="s2">&quot;handle_error&quot;</span><span class="p">,</span> <span class="n">retval</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">handle_exception</span><span class="p">(</span><span class="n">context</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">context</span><span class="o">.</span><span class="n">chained_exception</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span> <span class="ow">and</span> \
        <span class="s2">&quot;special&quot;</span> <span class="ow">in</span> <span class="n">context</span><span class="o">.</span><span class="n">chained_exception</span><span class="o">.</span><span class="n">message</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">MySpecialException</span><span class="p">(</span><span class="s2">&quot;failed&quot;</span><span class="p">,</span>
            <span class="n">cause</span><span class="o">=</span><span class="n">context</span><span class="o">.</span><span class="n">chained_exception</span><span class="p">)</span></pre></div></div><p><span class="yiyi-st" id="yiyi-316">&#x8FD4;&#x56DE;<code class="docutils literal"><span class="pre">None</span></code>&#x7684;&#x5904;&#x7406;&#x7A0B;&#x5E8F;&#x53EF;&#x80FD;&#x4FDD;&#x7559;&#x5728;&#x6B64;&#x94FE;&#x4E2D;&#xFF1B;&#x6700;&#x540E;&#x4E00;&#x4E2A;non <code class="docutils literal"><span class="pre">None</span></code>&#x8FD4;&#x56DE;&#x503C;&#x662F;&#x7EE7;&#x7EED;&#x4F20;&#x9012;&#x7ED9;&#x4E0B;&#x4E00;&#x4E2A;&#x5904;&#x7406;&#x7A0B;&#x5E8F;&#x7684;&#x90A3;&#x4E2A;&#x3002;</span></p><p><span class="yiyi-st" id="yiyi-317">&#x5F53;&#x5F15;&#x53D1;&#x6216;&#x8FD4;&#x56DE;&#x81EA;&#x5B9A;&#x4E49;&#x5F02;&#x5E38;&#x65F6;&#xFF0C;SQLAlchemy&#x4F1A;&#x6309;&#x539F;&#x6837;&#x5F15;&#x53D1;&#x6B64;&#x65B0;&#x5F02;&#x5E38;&#xFF0C;&#x4F46;&#x4E0D;&#x4F1A;&#x7531;&#x4EFB;&#x4F55;SQLAlchemy&#x5BF9;&#x8C61;&#x5305;&#x88C5;&#x3002;</span><span class="yiyi-st" id="yiyi-318">&#x5982;&#x679C;&#x8BE5;&#x5F02;&#x5E38;&#x4E0D;&#x662F;<a class="reference internal" href="exceptions.html#sqlalchemy.exc.StatementError" title="sqlalchemy.exc.StatementError"><code class="xref py py-class docutils literal"><span class="pre">sqlalchemy.exc.StatementError</span></code></a>&#x7684;&#x5B50;&#x7C7B;&#xFF0C;&#x5219;&#x67D0;&#x4E9B;&#x529F;&#x80FD;&#x53EF;&#x80FD;&#x4E0D;&#x53EF;&#x7528;&#xFF1B;&#x76EE;&#x524D;&#x8FD9;&#x5305;&#x62EC;ORM&#x7684;&#x529F;&#x80FD;&#xFF0C;&#x5373;&#x5728;autoflush&#x8FDB;&#x7A0B;&#x4E2D;&#x6DFB;&#x52A0;&#x5173;&#x4E8E;&#x201C;autoflush&#x201D;&#x7684;&#x5F02;&#x5E38;&#x63D0;&#x793A;&#x3002;</span></p><table class="docutils field-list" frame="void" rules="none"><tbody valign="top"><tr class="field-odd field"><th class="field-name"><span class="yiyi-st" id="yiyi-319">&#x53C2;&#x6570;&#xFF1A;</span></th><td class="field-body"><span class="yiyi-st" id="yiyi-320"><span class="target" id="sqlalchemy.events.ConnectionEvents.handle_error.params.context"></span><strong>context</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.events.ConnectionEvents.handle_error.params.context">&#xB6;</a> &#x2013; an <a class="reference internal" href="connections.html#sqlalchemy.engine.ExceptionContext" title="sqlalchemy.engine.ExceptionContext"><code class="xref py py-class docutils literal"><span class="pre">ExceptionContext</span></code></a> object. </span><span class="yiyi-st" id="yiyi-321">&#x6709;&#x5173;&#x6240;&#x6709;&#x53EF;&#x7528;&#x6210;&#x5458;&#x7684;&#x8BE6;&#x60C5;&#xFF0C;&#x8BF7;&#x53C2;&#x9605;&#x6B64;&#x8BFE;&#x7A0B;&#x3002;</span></td></tr></tbody></table><div class="versionadded"><p><span class="yiyi-st" id="yiyi-322"><span class="versionmodified">&#x7248;&#x672C;0.9.7&#x65B0;&#x589E;&#xFF1A;</span>&#x6DFB;&#x52A0;&#x4E86;<a class="reference internal" href="#sqlalchemy.events.ConnectionEvents.handle_error" title="sqlalchemy.events.ConnectionEvents.handle_error"><code class="xref py py-meth docutils literal"><span class="pre">ConnectionEvents.handle_error()</span></code></a>&#x94A9;&#x5B50;&#x3002;</span></p></div><div class="versionchanged"><p><span class="yiyi-st" id="yiyi-323"><span class="versionmodified">Changed in version 1.0.0: </span>The <a class="reference internal" href="#sqlalchemy.events.ConnectionEvents.handle_error" title="sqlalchemy.events.ConnectionEvents.handle_error"><code class="xref py py-meth docutils literal"><span class="pre">handle_error()</span></code></a> event is now invoked when an <a class="reference internal" href="connections.html#sqlalchemy.engine.Engine" title="sqlalchemy.engine.Engine"><code class="xref py py-class docutils literal"><span class="pre">Engine</span></code></a> fails during the initial call to <a class="reference internal" href="connections.html#sqlalchemy.engine.Engine.connect" title="sqlalchemy.engine.Engine.connect"><code class="xref py py-meth docutils literal"><span class="pre">Engine.connect()</span></code></a>, as well as when a <a class="reference internal" href="connections.html#sqlalchemy.engine.Connection" title="sqlalchemy.engine.Connection"><code class="xref py py-class docutils literal"><span class="pre">Connection</span></code></a> object encounters an error during a reconnect operation.</span></p></div><div class="versionchanged"><p><span class="yiyi-st" id="yiyi-324"><span class="versionmodified">&#x7248;&#x672C;1.0.0&#x66F4;&#x6539;&#xFF1A;</span>&#x5F53;&#x65B9;&#x8A00;&#x4F7F;&#x7528;<code class="docutils literal"><span class="pre">skip_user_error_events</span></code>&#x6267;&#x884C;&#x9009;&#x9879;&#x65F6;&#xFF0C;<a class="reference internal" href="#sqlalchemy.events.ConnectionEvents.handle_error" title="sqlalchemy.events.ConnectionEvents.handle_error"><code class="xref py py-meth docutils literal"><span class="pre">handle_error()</span></code></a>&#x4E8B;&#x4EF6;&#x4E0D;&#x4F1A;&#x88AB;&#x89E6;&#x53D1;&#x3002;</span><span class="yiyi-st" id="yiyi-325">&#x8FD9;&#x88AB;&#x7528;&#x4E8E;&#x6253;&#x7B97;&#x5728;&#x7279;&#x5B9A;&#x64CD;&#x4F5C;&#x4E2D;&#x6355;&#x83B7;SQLAlchemy&#x7279;&#x5B9A;&#x5F02;&#x5E38;&#x7684;&#x65B9;&#x8A00;&#xFF0C;&#x4F8B;&#x5982;&#x5F53;MySQL&#x65B9;&#x8A00;&#x68C0;&#x6D4B;&#x5230;<code class="docutils literal"><span class="pre">has_table()</span></code>&#x65B9;&#x8A00;&#x65B9;&#x6CD5;&#x4E2D;&#x4E0D;&#x5B58;&#x5728;&#x7684;&#x8868;&#x65F6;&#x3002;</span><span class="yiyi-st" id="yiyi-326">&#x5728;1.0.0&#x4E4B;&#x524D;&#xFF0C;&#x5B9E;&#x73B0;<a class="reference internal" href="#sqlalchemy.events.ConnectionEvents.handle_error" title="sqlalchemy.events.ConnectionEvents.handle_error"><code class="xref py py-meth docutils literal"><span class="pre">handle_error()</span></code></a>&#x7684;&#x4EE3;&#x7801;&#x9700;&#x8981;&#x786E;&#x4FDD;&#x5728;&#x8FD9;&#x4E9B;&#x573A;&#x666F;&#x4E2D;&#x629B;&#x51FA;&#x7684;&#x5F02;&#x5E38;&#x4E0D;&#x52A0;&#x4FEE;&#x6539;&#x5730;&#x91CD;&#x65B0;&#x5F15;&#x53D1;&#x3002;</span></p></div></dd></dl><dl class="method"><dt id="sqlalchemy.events.ConnectionEvents.prepare_twophase"><span class="yiyi-st" id="yiyi-327"><code class="descname">prepare_twophase</code> <span class="sig-paren">&#xFF08;</span> <em>conn</em>&#xFF0C;<em>xid</em> <span class="sig-paren">&#xFF09;</span> <a class="headerlink" href="#sqlalchemy.events.ConnectionEvents.prepare_twophase" title="Permalink to this definition"></a></span></dt><dd><p><span class="yiyi-st" id="yiyi-328">&#x62E6;&#x622A;prepare_twophase()&#x4E8B;&#x4EF6;&#x3002;</span></p><div class="event-signatures container"><p><span class="yiyi-st" id="yiyi-329">&#x793A;&#x4F8B;&#x53C2;&#x6570;&#x8868;&#x5355;&#xFF1A;</span></p><div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sqlalchemy</span> <span class="kn">import</span> <span class="n">event</span>

<span class="c1"># standard decorator style</span>
<span class="nd">@event.listens_for</span><span class="p">(</span><span class="n">SomeEngine</span><span class="p">,</span> <span class="s1">&apos;prepare_twophase&apos;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">receive_prepare_twophase</span><span class="p">(</span><span class="n">conn</span><span class="p">,</span> <span class="n">xid</span><span class="p">):</span>
    <span class="s2">&quot;listen for the &apos;prepare_twophase&apos; event&quot;</span>

    <span class="c1"># ... (event handling logic) ...</span></pre></div></div></div><table class="docutils field-list" frame="void" rules="none"><tbody valign="top"><tr class="field-odd field"><th class="field-name"><span class="yiyi-st" id="yiyi-330">&#x53C2;&#x6570;&#xFF1A;</span></th><td class="field-body"><ul class="first last simple"><li><span class="yiyi-st" id="yiyi-331"><span class="target" id="sqlalchemy.events.ConnectionEvents.prepare_twophase.params.conn"></span> <strong>conn</strong> <a class="paramlink headerlink reference internal" href="#sqlalchemy.events.ConnectionEvents.prepare_twophase.params.conn">&#xB6;</a>  -  <a class="reference internal" href="connections.html#sqlalchemy.engine.Connection" title="sqlalchemy.engine.Connection"><code class="xref py py-class docutils literal"><span class="pre">Connection</span></code></a>&#x5BF9;&#x8C61;</span></li><li><span class="yiyi-st" id="yiyi-332"><span class="target" id="sqlalchemy.events.ConnectionEvents.prepare_twophase.params.xid"></span> <strong>xid</strong> <a class="paramlink headerlink reference internal" href="#sqlalchemy.events.ConnectionEvents.prepare_twophase.params.xid">&#xB6;</a>  - &#x4E24;&#x9636;&#x6BB5;XID&#x6807;&#x8BC6;&#x7B26;</span></li></ul></td></tr></tbody></table></dd></dl><dl class="method"><dt id="sqlalchemy.events.ConnectionEvents.release_savepoint"><span class="yiyi-st" id="yiyi-333"> <code class="descname">release_savepoint</code><span class="sig-paren">(</span><em>conn</em>, <em>name</em>, <em>context</em><span class="sig-paren">)</span><a class="headerlink" href="#sqlalchemy.events.ConnectionEvents.release_savepoint" title="Permalink to this definition">&#xB6;</a></span></dt><dd><p><span class="yiyi-st" id="yiyi-334">&#x62E6;&#x622A;release_savepoint()&#x4E8B;&#x4EF6;&#x3002;</span></p><div class="event-signatures container"><p><span class="yiyi-st" id="yiyi-335">&#x793A;&#x4F8B;&#x53C2;&#x6570;&#x8868;&#x5355;&#xFF1A;</span></p><div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sqlalchemy</span> <span class="kn">import</span> <span class="n">event</span>

<span class="c1"># standard decorator style</span>
<span class="nd">@event.listens_for</span><span class="p">(</span><span class="n">SomeEngine</span><span class="p">,</span> <span class="s1">&apos;release_savepoint&apos;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">receive_release_savepoint</span><span class="p">(</span><span class="n">conn</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">context</span><span class="p">):</span>
    <span class="s2">&quot;listen for the &apos;release_savepoint&apos; event&quot;</span>

    <span class="c1"># ... (event handling logic) ...</span></pre></div></div></div><table class="docutils field-list" frame="void" rules="none"><tbody valign="top"><tr class="field-odd field"><th class="field-name"><span class="yiyi-st" id="yiyi-336">&#x53C2;&#x6570;&#xFF1A;</span></th><td class="field-body"><ul class="first last simple"><li><span class="yiyi-st" id="yiyi-337"><span class="target" id="sqlalchemy.events.ConnectionEvents.release_savepoint.params.conn"></span> <strong>conn</strong> <a class="paramlink headerlink reference internal" href="#sqlalchemy.events.ConnectionEvents.release_savepoint.params.conn">&#xB6;</a>  -  <a class="reference internal" href="connections.html#sqlalchemy.engine.Connection" title="sqlalchemy.engine.Connection"><code class="xref py py-class docutils literal"><span class="pre">Connection</span></code></a>&#x5BF9;&#x8C61;</span></li><li><span class="yiyi-st" id="yiyi-338"><span class="target" id="sqlalchemy.events.ConnectionEvents.release_savepoint.params.name"></span><strong>name</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.events.ConnectionEvents.release_savepoint.params.name">&#xB6;</a> &#x2013; specified name used for the savepoint.</span></li><li><span class="yiyi-st" id="yiyi-339"><span class="target" id="sqlalchemy.events.ConnectionEvents.release_savepoint.params.context"></span> <strong>&#x4E0A;&#x4E0B;&#x6587;</strong> <a class="paramlink headerlink reference internal" href="#sqlalchemy.events.ConnectionEvents.release_savepoint.params.context">&#xB6;</a>  -  <a class="reference internal" href="internals.html#sqlalchemy.engine.interfaces.ExecutionContext" title="sqlalchemy.engine.interfaces.ExecutionContext"><code class="xref py py-class docutils literal"><span class="pre">ExecutionContext</span></code></a>&#x6B63;&#x5728;&#x4F7F;&#x7528;&#x4E2D;&#x3002;</span><span class="yiyi-st" id="yiyi-340">&#x53EF;&#x80FD;&#x662F;<code class="docutils literal"><span class="pre">None</span></code>&#x3002;</span></li></ul></td></tr></tbody></table></dd></dl><dl class="method"><dt id="sqlalchemy.events.ConnectionEvents.rollback"><span class="yiyi-st" id="yiyi-341"><code class="descname">&#x56DE;&#x6EDA; T0&gt; <span class="sig-paren">&#xFF08; T1&gt; <em>&#x5EB7;&#x6069; T2&gt; <span class="sig-paren">&#xFF09; T3&gt; <a class="headerlink" href="#sqlalchemy.events.ConnectionEvents.rollback" title="Permalink to this definition">&#xB6; T4&gt;</a></span></em></span></code></span></dt><dd><p><span class="yiyi-st" id="yiyi-342">&#x62E6;&#x622A;&#x56DE;&#x6EDA;()&#x4E8B;&#x4EF6;&#xFF0C;&#x7531;<a class="reference internal" href="connections.html#sqlalchemy.engine.Transaction" title="sqlalchemy.engine.Transaction"><code class="xref py py-class docutils literal"><span class="pre">Transaction</span></code></a>&#x542F;&#x52A8;&#x3002;</span></p><div class="event-signatures container"><p><span class="yiyi-st" id="yiyi-343">&#x793A;&#x4F8B;&#x53C2;&#x6570;&#x8868;&#x5355;&#xFF1A;</span></p><div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sqlalchemy</span> <span class="kn">import</span> <span class="n">event</span>

<span class="c1"># standard decorator style</span>
<span class="nd">@event.listens_for</span><span class="p">(</span><span class="n">SomeEngine</span><span class="p">,</span> <span class="s1">&apos;rollback&apos;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">receive_rollback</span><span class="p">(</span><span class="n">conn</span><span class="p">):</span>
    <span class="s2">&quot;listen for the &apos;rollback&apos; event&quot;</span>

    <span class="c1"># ... (event handling logic) ...</span></pre></div></div></div><p><span class="yiyi-st" id="yiyi-344">Note that the <a class="reference internal" href="pooling.html#sqlalchemy.pool.Pool" title="sqlalchemy.pool.Pool"><code class="xref py py-class docutils literal"><span class="pre">Pool</span></code></a> also &#x201C;auto-rolls back&#x201D; a DBAPI connection upon checkin, if the <code class="docutils literal"><span class="pre">reset_on_return</span></code> flag is set to its default value of <code class="docutils literal"><span class="pre">&apos;rollback&apos;</span></code>. </span><span class="yiyi-st" id="yiyi-345">&#x8981;&#x62E6;&#x622A;&#x6B64;&#x56DE;&#x6EDA;&#xFF0C;&#x8BF7;&#x4F7F;&#x7528;<a class="reference internal" href="#sqlalchemy.events.PoolEvents.reset" title="sqlalchemy.events.PoolEvents.reset"><code class="xref py py-meth docutils literal"><span class="pre">PoolEvents.reset()</span></code></a>&#x6302;&#x94A9;&#x3002;</span></p><table class="docutils field-list" frame="void" rules="none"><tbody valign="top"><tr class="field-odd field"><th class="field-name"><span class="yiyi-st" id="yiyi-346">&#x53C2;&#x6570;&#xFF1A;</span></th><td class="field-body"><span class="yiyi-st" id="yiyi-347"><span class="target" id="sqlalchemy.events.ConnectionEvents.rollback.params.conn"></span> <strong>conn</strong> <a class="paramlink headerlink reference internal" href="#sqlalchemy.events.ConnectionEvents.rollback.params.conn">&#xB6;</a>  -  <a class="reference internal" href="connections.html#sqlalchemy.engine.Connection" title="sqlalchemy.engine.Connection"><code class="xref py py-class docutils literal"><span class="pre">Connection</span></code></a>&#x5BF9;&#x8C61;</span></td></tr></tbody></table><div class="admonition seealso"><p class="first admonition-title"><span class="yiyi-st" id="yiyi-348">&#x4E5F;&#x53EF;&#x4EE5;&#x770B;&#x770B;</span></p><p class="last"><span class="yiyi-st" id="yiyi-349"><a class="reference internal" href="#sqlalchemy.events.PoolEvents.reset" title="sqlalchemy.events.PoolEvents.reset"><code class="xref py py-meth docutils literal"><span class="pre">PoolEvents.reset()</span></code></a></span></p></div></dd></dl><dl class="method"><dt id="sqlalchemy.events.ConnectionEvents.rollback_savepoint"><span class="yiyi-st" id="yiyi-350"> <code class="descname">rollback_savepoint</code><span class="sig-paren">(</span><em>conn</em>, <em>name</em>, <em>context</em><span class="sig-paren">)</span><a class="headerlink" href="#sqlalchemy.events.ConnectionEvents.rollback_savepoint" title="Permalink to this definition">&#xB6;</a></span></dt><dd><p><span class="yiyi-st" id="yiyi-351">&#x62E6;&#x622A;rollback_savepoint()&#x4E8B;&#x4EF6;&#x3002;</span></p><div class="event-signatures container"><p><span class="yiyi-st" id="yiyi-352">&#x793A;&#x4F8B;&#x53C2;&#x6570;&#x8868;&#x5355;&#xFF1A;</span></p><div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sqlalchemy</span> <span class="kn">import</span> <span class="n">event</span>

<span class="c1"># standard decorator style</span>
<span class="nd">@event.listens_for</span><span class="p">(</span><span class="n">SomeEngine</span><span class="p">,</span> <span class="s1">&apos;rollback_savepoint&apos;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">receive_rollback_savepoint</span><span class="p">(</span><span class="n">conn</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">context</span><span class="p">):</span>
    <span class="s2">&quot;listen for the &apos;rollback_savepoint&apos; event&quot;</span>

    <span class="c1"># ... (event handling logic) ...</span></pre></div></div></div><table class="docutils field-list" frame="void" rules="none"><tbody valign="top"><tr class="field-odd field"><th class="field-name"><span class="yiyi-st" id="yiyi-353">&#x53C2;&#x6570;&#xFF1A;</span></th><td class="field-body"><ul class="first last simple"><li><span class="yiyi-st" id="yiyi-354"><span class="target" id="sqlalchemy.events.ConnectionEvents.rollback_savepoint.params.conn"></span><strong>conn</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.events.ConnectionEvents.rollback_savepoint.params.conn">&#xB6;</a> &#x2013; <a class="reference internal" href="connections.html#sqlalchemy.engine.Connection" title="sqlalchemy.engine.Connection"><code class="xref py py-class docutils literal"><span class="pre">Connection</span></code></a> object</span></li><li><span class="yiyi-st" id="yiyi-355"><span class="target" id="sqlalchemy.events.ConnectionEvents.rollback_savepoint.params.name"></span><strong>name</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.events.ConnectionEvents.rollback_savepoint.params.name">&#xB6;</a> &#x2013; specified name used for the savepoint.</span></li><li><span class="yiyi-st" id="yiyi-356"><span class="target" id="sqlalchemy.events.ConnectionEvents.rollback_savepoint.params.context"></span> <strong>&#x4E0A;&#x4E0B;&#x6587;</strong> <a class="paramlink headerlink reference internal" href="#sqlalchemy.events.ConnectionEvents.rollback_savepoint.params.context">&#xB6;</a>  -  <a class="reference internal" href="internals.html#sqlalchemy.engine.interfaces.ExecutionContext" title="sqlalchemy.engine.interfaces.ExecutionContext"><code class="xref py py-class docutils literal"><span class="pre">ExecutionContext</span></code></a>&#x6B63;&#x5728;&#x4F7F;&#x7528;&#x4E2D;&#x3002;</span><span class="yiyi-st" id="yiyi-357">&#x53EF;&#x80FD;&#x662F;<code class="docutils literal"><span class="pre">None</span></code>&#x3002;</span></li></ul></td></tr></tbody></table></dd></dl><dl class="method"><dt id="sqlalchemy.events.ConnectionEvents.rollback_twophase"><span class="yiyi-st" id="yiyi-358"> <code class="descname">rollback_twophase</code><span class="sig-paren">(</span><em>conn</em>, <em>xid</em>, <em>is_prepared</em><span class="sig-paren">)</span><a class="headerlink" href="#sqlalchemy.events.ConnectionEvents.rollback_twophase" title="Permalink to this definition">&#xB6;</a></span></dt><dd><p><span class="yiyi-st" id="yiyi-359">&#x62E6;&#x622A;rollback_twophase()&#x4E8B;&#x4EF6;&#x3002;</span></p><div class="event-signatures container"><p><span class="yiyi-st" id="yiyi-360">&#x793A;&#x4F8B;&#x53C2;&#x6570;&#x8868;&#x5355;&#xFF1A;</span></p><div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sqlalchemy</span> <span class="kn">import</span> <span class="n">event</span>

<span class="c1"># standard decorator style</span>
<span class="nd">@event.listens_for</span><span class="p">(</span><span class="n">SomeEngine</span><span class="p">,</span> <span class="s1">&apos;rollback_twophase&apos;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">receive_rollback_twophase</span><span class="p">(</span><span class="n">conn</span><span class="p">,</span> <span class="n">xid</span><span class="p">,</span> <span class="n">is_prepared</span><span class="p">):</span>
    <span class="s2">&quot;listen for the &apos;rollback_twophase&apos; event&quot;</span>

    <span class="c1"># ... (event handling logic) ...</span></pre></div></div></div><table class="docutils field-list" frame="void" rules="none"><tbody valign="top"><tr class="field-odd field"><th class="field-name"><span class="yiyi-st" id="yiyi-361">&#x53C2;&#x6570;&#xFF1A;</span></th><td class="field-body"><ul class="first last simple"><li><span class="yiyi-st" id="yiyi-362"><span class="target" id="sqlalchemy.events.ConnectionEvents.rollback_twophase.params.conn"></span> <strong>conn</strong> <a class="paramlink headerlink reference internal" href="#sqlalchemy.events.ConnectionEvents.rollback_twophase.params.conn">&#xB6;</a>  -  <a class="reference internal" href="connections.html#sqlalchemy.engine.Connection" title="sqlalchemy.engine.Connection"><code class="xref py py-class docutils literal"><span class="pre">Connection</span></code></a>&#x5BF9;&#x8C61;</span></li><li><span class="yiyi-st" id="yiyi-363"><span class="target" id="sqlalchemy.events.ConnectionEvents.rollback_twophase.params.xid"></span> <strong>xid</strong> <a class="paramlink headerlink reference internal" href="#sqlalchemy.events.ConnectionEvents.rollback_twophase.params.xid">&#xB6;</a>  - &#x4E24;&#x9636;&#x6BB5;XID&#x6807;&#x8BC6;&#x7B26;</span></li><li><span class="yiyi-st" id="yiyi-364"><span class="target" id="sqlalchemy.events.ConnectionEvents.rollback_twophase.params.is_prepared"></span><strong>is_prepared</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.events.ConnectionEvents.rollback_twophase.params.is_prepared">&#xB6;</a> &#x2013; boolean, indicates if <a class="reference internal" href="connections.html#sqlalchemy.engine.TwoPhaseTransaction.prepare" title="sqlalchemy.engine.TwoPhaseTransaction.prepare"><code class="xref py py-meth docutils literal"><span class="pre">TwoPhaseTransaction.prepare()</span></code></a> was called.</span></li></ul></td></tr></tbody></table></dd></dl><dl class="method"><dt id="sqlalchemy.events.ConnectionEvents.savepoint"><span class="yiyi-st" id="yiyi-365"> <code class="descname">savepoint</code><span class="sig-paren">(</span><em>conn</em>, <em>name</em><span class="sig-paren">)</span><a class="headerlink" href="#sqlalchemy.events.ConnectionEvents.savepoint" title="Permalink to this definition">&#xB6;</a></span></dt><dd><p><span class="yiyi-st" id="yiyi-366">&#x622A;&#x53D6;&#x4FDD;&#x5B58;&#x70B9;()&#x4E8B;&#x4EF6;&#x3002;</span></p><div class="event-signatures container"><p><span class="yiyi-st" id="yiyi-367">&#x793A;&#x4F8B;&#x53C2;&#x6570;&#x8868;&#x5355;&#xFF1A;</span></p><div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sqlalchemy</span> <span class="kn">import</span> <span class="n">event</span>

<span class="c1"># standard decorator style</span>
<span class="nd">@event.listens_for</span><span class="p">(</span><span class="n">SomeEngine</span><span class="p">,</span> <span class="s1">&apos;savepoint&apos;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">receive_savepoint</span><span class="p">(</span><span class="n">conn</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
    <span class="s2">&quot;listen for the &apos;savepoint&apos; event&quot;</span>

    <span class="c1"># ... (event handling logic) ...</span></pre></div></div></div><table class="docutils field-list" frame="void" rules="none"><tbody valign="top"><tr class="field-odd field"><th class="field-name"><span class="yiyi-st" id="yiyi-368">&#x53C2;&#x6570;&#xFF1A;</span></th><td class="field-body"><ul class="first last simple"><li><span class="yiyi-st" id="yiyi-369"><span class="target" id="sqlalchemy.events.ConnectionEvents.savepoint.params.conn"></span> <strong>conn</strong> <a class="paramlink headerlink reference internal" href="#sqlalchemy.events.ConnectionEvents.savepoint.params.conn">&#xB6;</a>  -  <a class="reference internal" href="connections.html#sqlalchemy.engine.Connection" title="sqlalchemy.engine.Connection"><code class="xref py py-class docutils literal"><span class="pre">Connection</span></code></a>&#x5BF9;&#x8C61;</span></li><li><span class="yiyi-st" id="yiyi-370"><span class="target" id="sqlalchemy.events.ConnectionEvents.savepoint.params.name"></span><strong>name</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.events.ConnectionEvents.savepoint.params.name">&#xB6;</a> &#x2013; specified name used for the savepoint.</span></li></ul></td></tr></tbody></table></dd></dl><dl class="method"><dt id="sqlalchemy.events.ConnectionEvents.set_connection_execution_options"><span class="yiyi-st" id="yiyi-371"><code class="descname">set_connection_execution_options</code> <span class="sig-paren">&#xFF08;</span> <em>conn</em>&#xFF0C;<em>opts</em> <span class="sig-paren">&#xFF09;</span> <a class="headerlink" href="#sqlalchemy.events.ConnectionEvents.set_connection_execution_options" title="Permalink to this definition"></a></span></dt><dd><p><span class="yiyi-st" id="yiyi-372">&#x5728;&#x8C03;&#x7528;<a class="reference internal" href="connections.html#sqlalchemy.engine.Connection.execution_options" title="sqlalchemy.engine.Connection.execution_options"><code class="xref py py-meth docutils literal"><span class="pre">Connection.execution_options()</span></code></a>&#x65B9;&#x6CD5;&#x65F6;&#x62E6;&#x622A;&#x3002;</span></p><div class="event-signatures container"><p><span class="yiyi-st" id="yiyi-373">&#x793A;&#x4F8B;&#x53C2;&#x6570;&#x8868;&#x5355;&#xFF1A;</span></p><div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sqlalchemy</span> <span class="kn">import</span> <span class="n">event</span>

<span class="c1"># standard decorator style</span>
<span class="nd">@event.listens_for</span><span class="p">(</span><span class="n">SomeEngine</span><span class="p">,</span> <span class="s1">&apos;set_connection_execution_options&apos;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">receive_set_connection_execution_options</span><span class="p">(</span><span class="n">conn</span><span class="p">,</span> <span class="n">opts</span><span class="p">):</span>
    <span class="s2">&quot;listen for the &apos;set_connection_execution_options&apos; event&quot;</span>

    <span class="c1"># ... (event handling logic) ...</span></pre></div></div></div><p><span class="yiyi-st" id="yiyi-374">&#x5728;&#x65B0;&#x7684;<a class="reference internal" href="connections.html#sqlalchemy.engine.Connection" title="sqlalchemy.engine.Connection"><code class="xref py py-class docutils literal"><span class="pre">Connection</span></code></a>&#x751F;&#x6210;&#x540E;&#xFF0C;&#x4F7F;&#x7528;&#x65B0;&#x66F4;&#x65B0;&#x7684;&#x6267;&#x884C;&#x9009;&#x9879;&#x96C6;&#x5408;&#xFF0C;&#x4F46;&#x5728;<a class="reference internal" href="internals.html#sqlalchemy.engine.interfaces.Dialect" title="sqlalchemy.engine.interfaces.Dialect"><code class="xref py py-class docutils literal"><span class="pre">Dialect</span></code></a>&#x5BF9;&#x8FD9;&#x4E9B;&#x65B0;&#x9009;&#x9879;&#x6267;&#x884C;&#x64CD;&#x4F5C;&#x4E4B;&#x524D;&#x8C03;&#x7528;&#x6B64;&#x65B9;&#x6CD5;&#x3002;</span></p><p><span class="yiyi-st" id="yiyi-375">&#x6CE8;&#x610F;&#xFF0C;&#x5F53;&#x4E00;&#x4E2A;&#x65B0;&#x7684;<a class="reference internal" href="connections.html#sqlalchemy.engine.Connection" title="sqlalchemy.engine.Connection"><code class="xref py py-class docutils literal"><span class="pre">Connection</span></code></a>&#x4EA7;&#x751F;&#x4E86;&#x7EE7;&#x627F;&#x5176;&#x7236;&#x8282;&#x70B9;<a class="reference internal" href="connections.html#sqlalchemy.engine.Engine" title="sqlalchemy.engine.Engine"><code class="xref py py-class docutils literal"><span class="pre">Engine</span></code></a>&#x7684;&#x6267;&#x884C;&#x9009;&#x9879;&#x65F6;&#xFF0C;&#x8FD9;&#x4E2A;&#x65B9;&#x6CD5;&#x4E0D;&#x4F1A;&#x88AB;&#x8C03;&#x7528;&#x3002;&#x8981;&#x62E6;&#x622A;&#x6B64;&#x60C5;&#x51B5;&#xFF0C;&#x8BF7;&#x4F7F;&#x7528;<a class="reference internal" href="#sqlalchemy.events.ConnectionEvents.engine_connect" title="sqlalchemy.events.ConnectionEvents.engine_connect"><code class="xref py py-meth docutils literal"><span class="pre">ConnectionEvents.engine_connect()</span></code></a>&#x4E8B;&#x4EF6;&#x3002;</span></p><table class="docutils field-list" frame="void" rules="none"><tbody valign="top"><tr class="field-odd field"><th class="field-name"><span class="yiyi-st" id="yiyi-376">&#x53C2;&#x6570;&#xFF1A;</span></th><td class="field-body"><ul class="first last simple"><li><span class="yiyi-st" id="yiyi-377"><span class="target" id="sqlalchemy.events.ConnectionEvents.set_connection_execution_options.params.conn"></span><strong>conn</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.events.ConnectionEvents.set_connection_execution_options.params.conn">&#xB6;</a> &#x2013; The newly copied <a class="reference internal" href="connections.html#sqlalchemy.engine.Connection" title="sqlalchemy.engine.Connection"><code class="xref py py-class docutils literal"><span class="pre">Connection</span></code></a> object</span></li><li><span class="yiyi-st" id="yiyi-378"><span class="target" id="sqlalchemy.events.ConnectionEvents.set_connection_execution_options.params.opts"></span><strong>opts</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.events.ConnectionEvents.set_connection_execution_options.params.opts">&#xB6;</a> &#x2013; dictionary of options that were passed to the <a class="reference internal" href="connections.html#sqlalchemy.engine.Connection.execution_options" title="sqlalchemy.engine.Connection.execution_options"><code class="xref py py-meth docutils literal"><span class="pre">Connection.execution_options()</span></code></a> method.</span></li></ul></td></tr></tbody></table><div class="versionadded"><p><span class="yiyi-st" id="yiyi-379"><span class="versionmodified">&#x7248;&#x672C;0.9.0&#x4E2D;&#x7684;&#x65B0;&#x529F;&#x80FD;</span></span></p></div><div class="admonition seealso"><p class="first admonition-title"><span class="yiyi-st" id="yiyi-380">&#x4E5F;&#x53EF;&#x4EE5;&#x770B;&#x770B;</span></p><p class="last"><span class="yiyi-st" id="yiyi-381"><a class="reference internal" href="#sqlalchemy.events.ConnectionEvents.set_engine_execution_options" title="sqlalchemy.events.ConnectionEvents.set_engine_execution_options"><code class="xref py py-meth docutils literal"><span class="pre">ConnectionEvents.set_engine_execution_options()</span></code></a>  - &#x8C03;&#x7528;<a class="reference internal" href="connections.html#sqlalchemy.engine.Engine.execution_options" title="sqlalchemy.engine.Engine.execution_options"><code class="xref py py-meth docutils literal"><span class="pre">Engine.execution_options()</span></code></a>&#x65F6;&#x8C03;&#x7528;&#x7684;&#x4E8B;&#x4EF6;&#x3002;</span></p></div></dd></dl><dl class="method"><dt id="sqlalchemy.events.ConnectionEvents.set_engine_execution_options"><span class="yiyi-st" id="yiyi-382"><code class="descname">set_engine_execution_options</code> <span class="sig-paren">&#xFF08;</span> <em>engine</em>&#xFF0C;<em>opts</em> <span class="sig-paren">&#xFF09;</span> <a class="headerlink" href="#sqlalchemy.events.ConnectionEvents.set_engine_execution_options" title="Permalink to this definition"></a></span></dt><dd><p><span class="yiyi-st" id="yiyi-383">&#x5728;&#x8C03;&#x7528;<a class="reference internal" href="connections.html#sqlalchemy.engine.Engine.execution_options" title="sqlalchemy.engine.Engine.execution_options"><code class="xref py py-meth docutils literal"><span class="pre">Engine.execution_options()</span></code></a>&#x65B9;&#x6CD5;&#x65F6;&#x62E6;&#x622A;&#x3002;</span></p><div class="event-signatures container"><p><span class="yiyi-st" id="yiyi-384">&#x793A;&#x4F8B;&#x53C2;&#x6570;&#x8868;&#x5355;&#xFF1A;</span></p><div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sqlalchemy</span> <span class="kn">import</span> <span class="n">event</span>

<span class="c1"># standard decorator style</span>
<span class="nd">@event.listens_for</span><span class="p">(</span><span class="n">SomeEngine</span><span class="p">,</span> <span class="s1">&apos;set_engine_execution_options&apos;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">receive_set_engine_execution_options</span><span class="p">(</span><span class="n">engine</span><span class="p">,</span> <span class="n">opts</span><span class="p">):</span>
    <span class="s2">&quot;listen for the &apos;set_engine_execution_options&apos; event&quot;</span>

    <span class="c1"># ... (event handling logic) ...</span></pre></div></div></div><p><span class="yiyi-st" id="yiyi-385"><a class="reference internal" href="connections.html#sqlalchemy.engine.Engine.execution_options" title="sqlalchemy.engine.Engine.execution_options"><code class="xref py py-meth docutils literal"><span class="pre">Engine.execution_options()</span></code></a>&#x65B9;&#x6CD5;&#x4EA7;&#x751F;&#x5B58;&#x50A8;&#x65B0;&#x9009;&#x9879;&#x7684;<a class="reference internal" href="connections.html#sqlalchemy.engine.Engine" title="sqlalchemy.engine.Engine"><code class="xref py py-class docutils literal"><span class="pre">Engine</span></code></a>&#x7684;&#x6D45;&#x8868;&#x526F;&#x672C;&#x3002;</span><span class="yiyi-st" id="yiyi-386">&#x65B0;&#x7684;<a class="reference internal" href="connections.html#sqlalchemy.engine.Engine" title="sqlalchemy.engine.Engine"><code class="xref py py-class docutils literal"><span class="pre">Engine</span></code></a>&#x5728;&#x8FD9;&#x91CC;&#x4F20;&#x9012;&#x3002;</span><span class="yiyi-st" id="yiyi-387">&#x6B64;&#x65B9;&#x6CD5;&#x7684;&#x4E00;&#x4E2A;&#x7279;&#x6B8A;&#x5E94;&#x7528;&#x662F;&#x5411;&#x7ED9;&#x5B9A;&#x7684;<a class="reference internal" href="connections.html#sqlalchemy.engine.Engine" title="sqlalchemy.engine.Engine"><code class="xref py py-class docutils literal"><span class="pre">Engine</span></code></a>&#x6DFB;&#x52A0;&#x4E00;&#x4E2A;<a class="reference internal" href="#sqlalchemy.events.ConnectionEvents.engine_connect" title="sqlalchemy.events.ConnectionEvents.engine_connect"><code class="xref py py-meth docutils literal"><span class="pre">ConnectionEvents.engine_connect()</span></code></a>&#x4E8B;&#x4EF6;&#x5904;&#x7406;&#x7A0B;&#x5E8F;&#xFF0C;&#x5B83;&#x5C06;&#x6267;&#x884C;&#x4E00;&#x4E9B;per- <a class="reference internal" href="connections.html#sqlalchemy.engine.Connection" title="sqlalchemy.engine.Connection"><code class="xref py py-class docutils literal"><span class="pre">Connection</span></code></a>&#x4EFB;&#x52A1;&#x7279;&#x5B9A;&#x4E8E;&#x8FD9;&#x4E9B;&#x6267;&#x884C;&#x9009;&#x9879;&#x3002;</span></p><table class="docutils field-list" frame="void" rules="none"><tbody valign="top"><tr class="field-odd field"><th class="field-name"><span class="yiyi-st" id="yiyi-388">&#x53C2;&#x6570;&#xFF1A;</span></th><td class="field-body"><ul class="first last simple"><li><span class="yiyi-st" id="yiyi-389"><span class="target" id="sqlalchemy.events.ConnectionEvents.set_engine_execution_options.params.conn"></span> <strong>conn</strong> <a class="paramlink headerlink reference internal" href="#sqlalchemy.events.ConnectionEvents.set_engine_execution_options.params.conn">&#xB6;</a>  - &#x65B0;&#x590D;&#x5236;&#x7684;<a class="reference internal" href="connections.html#sqlalchemy.engine.Engine" title="sqlalchemy.engine.Engine"><code class="xref py py-class docutils literal"><span class="pre">Engine</span></code></a>&#x5BF9;&#x8C61;</span></li><li><span class="yiyi-st" id="yiyi-390"><span class="target" id="sqlalchemy.events.ConnectionEvents.set_engine_execution_options.params.opts"></span><strong>opts</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.events.ConnectionEvents.set_engine_execution_options.params.opts">&#xB6;</a> &#x2013; dictionary of options that were passed to the <a class="reference internal" href="connections.html#sqlalchemy.engine.Connection.execution_options" title="sqlalchemy.engine.Connection.execution_options"><code class="xref py py-meth docutils literal"><span class="pre">Connection.execution_options()</span></code></a> method.</span></li></ul></td></tr></tbody></table><div class="versionadded"><p><span class="yiyi-st" id="yiyi-391"><span class="versionmodified">&#x7248;&#x672C;0.9.0&#x4E2D;&#x7684;&#x65B0;&#x529F;&#x80FD;</span></span></p></div><div class="admonition seealso"><p class="first admonition-title"><span class="yiyi-st" id="yiyi-392">&#x4E5F;&#x53EF;&#x4EE5;&#x770B;&#x770B;</span></p><p class="last"><span class="yiyi-st" id="yiyi-393"><a class="reference internal" href="#sqlalchemy.events.ConnectionEvents.set_connection_execution_options" title="sqlalchemy.events.ConnectionEvents.set_connection_execution_options"><code class="xref py py-meth docutils literal"><span class="pre">ConnectionEvents.set_connection_execution_options()</span></code></a>  - &#x8C03;&#x7528;<a class="reference internal" href="connections.html#sqlalchemy.engine.Connection.execution_options" title="sqlalchemy.engine.Connection.execution_options"><code class="xref py py-meth docutils literal"><span class="pre">Connection.execution_options()</span></code></a>&#x65F6;&#x8C03;&#x7528;&#x7684;&#x4E8B;&#x4EF6;&#x3002;</span></p></div></dd></dl></dd></dl><dl class="class"><dt id="sqlalchemy.events.DialectEvents"><span class="yiyi-st" id="yiyi-394"><em class="property">class</em> <code class="descclassname">sqlalchemy.events&#x3002;</code> <code class="descname">DialectEvents</code> <a class="headerlink" href="#sqlalchemy.events.DialectEvents" title="Permalink to this definition">&#xB6;</a></span></dt><dd><p><span class="yiyi-st" id="yiyi-395">&#x57FA;&#x7840;&#xFF1A;<a class="reference internal" href="#sqlalchemy.event.base.Events" title="sqlalchemy.event.base.Events"><code class="xref py py-class docutils literal"><span class="pre">sqlalchemy.event.base.Events</span></code></a></span></p><p><span class="yiyi-st" id="yiyi-396">&#x4E8B;&#x4EF6;&#x63A5;&#x53E3;&#x7528;&#x4E8E;&#x6267;&#x884C;&#x66FF;&#x6362;&#x529F;&#x80FD;&#x3002;</span></p><p><span class="yiyi-st" id="yiyi-397">&#x8FD9;&#x4E9B;&#x4E8B;&#x4EF6;&#x5141;&#x8BB8;&#x76F4;&#x63A5;&#x68C0;&#x6D4B;&#x548C;&#x66FF;&#x6362;&#x4E0E;DBAPI&#x4EA4;&#x4E92;&#x7684;&#x5173;&#x952E;&#x65B9;&#x8A00;&#x529F;&#x80FD;&#x3002;</span></p><div class="admonition note"><p class="first admonition-title"><span class="yiyi-st" id="yiyi-398">&#x6CE8;&#x610F;</span></p><p class="last"><span class="yiyi-st" id="yiyi-399"><a class="reference internal" href="#sqlalchemy.events.DialectEvents" title="sqlalchemy.events.DialectEvents"><code class="xref py py-class docutils literal"><span class="pre">DialectEvents</span></code></a> hooks should be considered <strong>semi-public</strong> and experimental. </span><span class="yiyi-st" id="yiyi-400">&#x8FD9;&#x4E9B;&#x94A9;&#x5B50;&#x5E76;&#x4E0D;&#x662F;&#x4E00;&#x822C;&#x7528;&#x9014;&#xFF0C;&#x53EA;&#x9002;&#x7528;&#x4E8E;&#x90A3;&#x4E9B;&#x9700;&#x8981;&#x5C06;DBAPI&#x673A;&#x5236;&#x590D;&#x6742;&#x7684;&#x91CD;&#x65B0;&#x58F0;&#x660E;&#x6CE8;&#x5165;&#x73B0;&#x6709;&#x65B9;&#x8A00;&#x7684;&#x60C5;&#x51B5;&#x3002;</span><span class="yiyi-st" id="yiyi-401">&#x5BF9;&#x4E8E;&#x901A;&#x7528;&#x8BED;&#x53E5;&#x62E6;&#x622A;&#x4E8B;&#x4EF6;&#xFF0C;&#x8BF7;&#x4F7F;&#x7528;<a class="reference internal" href="#sqlalchemy.events.ConnectionEvents" title="sqlalchemy.events.ConnectionEvents"><code class="xref py py-class docutils literal"><span class="pre">ConnectionEvents</span></code></a>&#x63A5;&#x53E3;&#x3002;</span></p></div><div class="admonition seealso"><p class="first admonition-title"><span class="yiyi-st" id="yiyi-402">&#x4E5F;&#x53EF;&#x4EE5;&#x770B;&#x770B;</span></p><p><span class="yiyi-st" id="yiyi-403"><a class="reference internal" href="#sqlalchemy.events.ConnectionEvents.before_cursor_execute" title="sqlalchemy.events.ConnectionEvents.before_cursor_execute"><code class="xref py py-meth docutils literal"><span class="pre">ConnectionEvents.before_cursor_execute()</span></code></a></span></p><p><span class="yiyi-st" id="yiyi-404"><a class="reference internal" href="#sqlalchemy.events.ConnectionEvents.before_execute" title="sqlalchemy.events.ConnectionEvents.before_execute"><code class="xref py py-meth docutils literal"><span class="pre">ConnectionEvents.before_execute()</span></code></a></span></p><p><span class="yiyi-st" id="yiyi-405"><a class="reference internal" href="#sqlalchemy.events.ConnectionEvents.after_cursor_execute" title="sqlalchemy.events.ConnectionEvents.after_cursor_execute"><code class="xref py py-meth docutils literal"><span class="pre">ConnectionEvents.after_cursor_execute()</span></code></a></span></p><p class="last"><span class="yiyi-st" id="yiyi-406"><a class="reference internal" href="#sqlalchemy.events.ConnectionEvents.after_execute" title="sqlalchemy.events.ConnectionEvents.after_execute"><code class="xref py py-meth docutils literal"><span class="pre">ConnectionEvents.after_execute()</span></code></a></span></p></div><div class="versionadded"><p><span class="yiyi-st" id="yiyi-407"><span class="versionmodified">&#x7248;&#x672C;0.9.4&#x4E2D;&#x7684;&#x65B0;&#x529F;&#x80FD;</span></span></p></div><dl class="method"><dt id="sqlalchemy.events.DialectEvents.do_connect"><span class="yiyi-st" id="yiyi-408"><code class="descname">do_connect</code> <span class="sig-paren">&#xFF08;</span> <em>dialect</em>&#xFF0C;<em>conn_rec</em>&#xFF0C;<em>cargs</em>&#xFF0C;<em>cparams  t5 &gt; <span class="sig-paren">&#xFF09; T6&gt; <a class="headerlink" href="#sqlalchemy.events.DialectEvents.do_connect" title="Permalink to this definition">&#xB6; T7&gt;</a></span></em></span></dt><dd><p><span class="yiyi-st" id="yiyi-409">&#x5728;&#x5EFA;&#x7ACB;&#x8FDE;&#x63A5;&#x4E4B;&#x524D;&#x63A5;&#x6536;&#x8FDE;&#x63A5;&#x53C2;&#x6570;&#x3002;</span></p><div class="event-signatures container"><p><span class="yiyi-st" id="yiyi-410">&#x793A;&#x4F8B;&#x53C2;&#x6570;&#x8868;&#x5355;&#xFF1A;</span></p><div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sqlalchemy</span> <span class="kn">import</span> <span class="n">event</span>

<span class="c1"># standard decorator style</span>
<span class="nd">@event.listens_for</span><span class="p">(</span><span class="n">SomeEngine</span><span class="p">,</span> <span class="s1">&apos;do_connect&apos;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">receive_do_connect</span><span class="p">(</span><span class="n">dialect</span><span class="p">,</span> <span class="n">conn_rec</span><span class="p">,</span> <span class="n">cargs</span><span class="p">,</span> <span class="n">cparams</span><span class="p">):</span>
    <span class="s2">&quot;listen for the &apos;do_connect&apos; event&quot;</span>

    <span class="c1"># ... (event handling logic) ...</span>

<span class="c1"># named argument style (new in 0.9)</span>
<span class="nd">@event.listens_for</span><span class="p">(</span><span class="n">SomeEngine</span><span class="p">,</span> <span class="s1">&apos;do_connect&apos;</span><span class="p">,</span> <span class="n">named</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">receive_do_connect</span><span class="p">(</span><span class="o">**</span><span class="n">kw</span><span class="p">):</span>
    <span class="s2">&quot;listen for the &apos;do_connect&apos; event&quot;</span>
    <span class="n">dialect</span> <span class="o">=</span> <span class="n">kw</span><span class="p">[</span><span class="s1">&apos;dialect&apos;</span><span class="p">]</span>
    <span class="n">conn_rec</span> <span class="o">=</span> <span class="n">kw</span><span class="p">[</span><span class="s1">&apos;conn_rec&apos;</span><span class="p">]</span>

    <span class="c1"># ... (event handling logic) ...</span></pre></div></div></div><p><span class="yiyi-st" id="yiyi-411">&#x8FD4;&#x56DE;&#x4E00;&#x4E2A;DBAPI&#x8FDE;&#x63A5;&#x4EE5;&#x963B;&#x6B62;&#x8FDB;&#x4E00;&#x6B65;&#x8C03;&#x7528;&#x4E8B;&#x4EF6;&#xFF1B;&#x8FD4;&#x56DE;&#x7684;&#x8FDE;&#x63A5;&#x5C06;&#x88AB;&#x4F7F;&#x7528;&#x3002;</span></p><p><span class="yiyi-st" id="yiyi-412">&#x6216;&#x8005;&#xFF0C;&#x8BE5;&#x4E8B;&#x4EF6;&#x53EF;&#x4EE5;&#x64CD;&#x7EB5;&#x8D27;&#x7269;&#x548C;/&#x6216;cparams&#x96C6;&#x5408;&#xFF1B; cargs&#x5C06;&#x59CB;&#x7EC8;&#x662F;&#x4E00;&#x4E2A;Python&#x5217;&#x8868;&#xFF0C;&#x53EF;&#x4EE5;&#x5728;&#x539F;&#x5730;&#x8FDB;&#x884C;&#x53D8;&#x5F02;&#xFF0C;&#x5E76;&#x4E14;&#x53EF;&#x4EE5;&#x7F16;&#x5199;&#x4E00;&#x4E2A;Python&#x5B57;&#x5178;&#x3002;</span><span class="yiyi-st" id="yiyi-413">&#x8FD4;&#x56DE;None&#x4EE5;&#x5141;&#x8BB8;&#x63A7;&#x5236;&#x4F20;&#x9012;&#x7ED9;&#x4E0B;&#x4E00;&#x4E2A;&#x4E8B;&#x4EF6;&#x5904;&#x7406;&#x7A0B;&#x5E8F;&#xFF0C;&#x5E76;&#x6700;&#x7EC8;&#x5141;&#x8BB8;&#x65B9;&#x8A00;&#x6B63;&#x5E38;&#x8FDE;&#x63A5;&#xFF0C;&#x7ED9;&#x5B9A;&#x66F4;&#x65B0;&#x7684;&#x53C2;&#x6570;&#x3002;</span></p><div class="versionadded"><p><span class="yiyi-st" id="yiyi-414"><span class="versionmodified">&#x7248;&#x672C;1.0.3&#x4E2D;&#x7684;&#x65B0;&#x529F;&#x80FD;</span></span></p></div></dd></dl><dl class="method"><dt id="sqlalchemy.events.DialectEvents.do_execute"><span class="yiyi-st" id="yiyi-415"> <code class="descname">do_execute</code><span class="sig-paren">(</span><em>cursor</em>, <em>statement</em>, <em>parameters</em>, <em>context</em><span class="sig-paren">)</span><a class="headerlink" href="#sqlalchemy.events.DialectEvents.do_execute" title="Permalink to this definition">&#xB6;</a></span></dt><dd><p><span class="yiyi-st" id="yiyi-416">&#x63A5;&#x6536;&#x4E00;&#x4E2A;&#x6E38;&#x6807;&#x4EE5;&#x8C03;&#x7528;execute()&#x3002;</span></p><div class="event-signatures container"><p><span class="yiyi-st" id="yiyi-417">&#x793A;&#x4F8B;&#x53C2;&#x6570;&#x8868;&#x5355;&#xFF1A;</span></p><div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sqlalchemy</span> <span class="kn">import</span> <span class="n">event</span>

<span class="c1"># standard decorator style</span>
<span class="nd">@event.listens_for</span><span class="p">(</span><span class="n">SomeEngine</span><span class="p">,</span> <span class="s1">&apos;do_execute&apos;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">receive_do_execute</span><span class="p">(</span><span class="n">cursor</span><span class="p">,</span> <span class="n">statement</span><span class="p">,</span> <span class="n">parameters</span><span class="p">,</span> <span class="n">context</span><span class="p">):</span>
    <span class="s2">&quot;listen for the &apos;do_execute&apos; event&quot;</span>

    <span class="c1"># ... (event handling logic) ...</span>

<span class="c1"># named argument style (new in 0.9)</span>
<span class="nd">@event.listens_for</span><span class="p">(</span><span class="n">SomeEngine</span><span class="p">,</span> <span class="s1">&apos;do_execute&apos;</span><span class="p">,</span> <span class="n">named</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">receive_do_execute</span><span class="p">(</span><span class="o">**</span><span class="n">kw</span><span class="p">):</span>
    <span class="s2">&quot;listen for the &apos;do_execute&apos; event&quot;</span>
    <span class="n">cursor</span> <span class="o">=</span> <span class="n">kw</span><span class="p">[</span><span class="s1">&apos;cursor&apos;</span><span class="p">]</span>
    <span class="n">statement</span> <span class="o">=</span> <span class="n">kw</span><span class="p">[</span><span class="s1">&apos;statement&apos;</span><span class="p">]</span>

    <span class="c1"># ... (event handling logic) ...</span></pre></div></div></div><p><span class="yiyi-st" id="yiyi-418">&#x8FD4;&#x56DE;&#x503C;True&#x4EE5;&#x6682;&#x505C;&#x8C03;&#x7528;&#x7684;&#x66F4;&#x591A;&#x4E8B;&#x4EF6;&#xFF0C;&#x5E76;&#x6307;&#x793A;&#x6E38;&#x6807;&#x6267;&#x884C;&#x5DF2;&#x7ECF;&#x53D1;&#x751F;&#x5728;&#x4E8B;&#x4EF6;&#x5904;&#x7406;&#x7A0B;&#x5E8F;&#x4E2D;&#x3002;</span></p></dd></dl><dl class="method"><dt id="sqlalchemy.events.DialectEvents.do_execute_no_params"><span class="yiyi-st" id="yiyi-419"><code class="descname">do_execute_no_params</code> <span class="sig-paren">&#xFF08;</span> <em>&#x6E38;&#x6807;</em>&#xFF0C;<em>&#x8BED;&#x53E5;</em>&#xFF0C;<em>&#x4E0A;&#x4E0B;&#x6587;</em> <span class="sig-paren">&#xFF09;</span> <a class="headerlink" href="#sqlalchemy.events.DialectEvents.do_execute_no_params" title="Permalink to this definition">&#xB6; T6&gt;</a></span></dt><dd><p><span class="yiyi-st" id="yiyi-420">&#x63A5;&#x6536;&#x4E00;&#x4E2A;&#x6CA1;&#x6709;&#x8C03;&#x7528;&#x53C2;&#x6570;&#x7684;&#x6E38;&#x6807;&#x6765;&#x6267;&#x884C;execute()&#x3002;</span></p><div class="event-signatures container"><p><span class="yiyi-st" id="yiyi-421">&#x793A;&#x4F8B;&#x53C2;&#x6570;&#x8868;&#x5355;&#xFF1A;</span></p><div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sqlalchemy</span> <span class="kn">import</span> <span class="n">event</span>

<span class="c1"># standard decorator style</span>
<span class="nd">@event.listens_for</span><span class="p">(</span><span class="n">SomeEngine</span><span class="p">,</span> <span class="s1">&apos;do_execute_no_params&apos;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">receive_do_execute_no_params</span><span class="p">(</span><span class="n">cursor</span><span class="p">,</span> <span class="n">statement</span><span class="p">,</span> <span class="n">context</span><span class="p">):</span>
    <span class="s2">&quot;listen for the &apos;do_execute_no_params&apos; event&quot;</span>

    <span class="c1"># ... (event handling logic) ...</span></pre></div></div></div><p><span class="yiyi-st" id="yiyi-422">&#x8FD4;&#x56DE;&#x503C;True&#x4EE5;&#x6682;&#x505C;&#x8C03;&#x7528;&#x7684;&#x66F4;&#x591A;&#x4E8B;&#x4EF6;&#xFF0C;&#x5E76;&#x6307;&#x793A;&#x6E38;&#x6807;&#x6267;&#x884C;&#x5DF2;&#x7ECF;&#x53D1;&#x751F;&#x5728;&#x4E8B;&#x4EF6;&#x5904;&#x7406;&#x7A0B;&#x5E8F;&#x4E2D;&#x3002;</span></p></dd></dl><dl class="method"><dt id="sqlalchemy.events.DialectEvents.do_executemany"><span class="yiyi-st" id="yiyi-423"> <code class="descname">do_executemany</code><span class="sig-paren">(</span><em>cursor</em>, <em>statement</em>, <em>parameters</em>, <em>context</em><span class="sig-paren">)</span><a class="headerlink" href="#sqlalchemy.events.DialectEvents.do_executemany" title="Permalink to this definition">&#xB6;</a></span></dt><dd><p><span class="yiyi-st" id="yiyi-424">&#x63A5;&#x6536;&#x4E00;&#x4E2A;&#x6E38;&#x6807;&#x6765;&#x8C03;&#x7528;executemany()&#x3002;</span></p><div class="event-signatures container"><p><span class="yiyi-st" id="yiyi-425">&#x793A;&#x4F8B;&#x53C2;&#x6570;&#x8868;&#x5355;&#xFF1A;</span></p><div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sqlalchemy</span> <span class="kn">import</span> <span class="n">event</span>

<span class="c1"># standard decorator style</span>
<span class="nd">@event.listens_for</span><span class="p">(</span><span class="n">SomeEngine</span><span class="p">,</span> <span class="s1">&apos;do_executemany&apos;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">receive_do_executemany</span><span class="p">(</span><span class="n">cursor</span><span class="p">,</span> <span class="n">statement</span><span class="p">,</span> <span class="n">parameters</span><span class="p">,</span> <span class="n">context</span><span class="p">):</span>
    <span class="s2">&quot;listen for the &apos;do_executemany&apos; event&quot;</span>

    <span class="c1"># ... (event handling logic) ...</span>

<span class="c1"># named argument style (new in 0.9)</span>
<span class="nd">@event.listens_for</span><span class="p">(</span><span class="n">SomeEngine</span><span class="p">,</span> <span class="s1">&apos;do_executemany&apos;</span><span class="p">,</span> <span class="n">named</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">receive_do_executemany</span><span class="p">(</span><span class="o">**</span><span class="n">kw</span><span class="p">):</span>
    <span class="s2">&quot;listen for the &apos;do_executemany&apos; event&quot;</span>
    <span class="n">cursor</span> <span class="o">=</span> <span class="n">kw</span><span class="p">[</span><span class="s1">&apos;cursor&apos;</span><span class="p">]</span>
    <span class="n">statement</span> <span class="o">=</span> <span class="n">kw</span><span class="p">[</span><span class="s1">&apos;statement&apos;</span><span class="p">]</span>

    <span class="c1"># ... (event handling logic) ...</span></pre></div></div></div><p><span class="yiyi-st" id="yiyi-426">&#x8FD4;&#x56DE;&#x503C;True&#x4EE5;&#x6682;&#x505C;&#x8C03;&#x7528;&#x7684;&#x66F4;&#x591A;&#x4E8B;&#x4EF6;&#xFF0C;&#x5E76;&#x6307;&#x793A;&#x6E38;&#x6807;&#x6267;&#x884C;&#x5DF2;&#x7ECF;&#x53D1;&#x751F;&#x5728;&#x4E8B;&#x4EF6;&#x5904;&#x7406;&#x7A0B;&#x5E8F;&#x4E2D;&#x3002;</span></p></dd></dl></dd></dl></div><div class="section" id="schema-events"><h2><span class="yiyi-st" id="yiyi-427">&#x6A21;&#x5F0F;&#x4E8B;&#x4EF6;<a class="headerlink" href="#schema-events" title="Permalink to this headline">&#xB6;</a></span></h2><dl class="class"><dt id="sqlalchemy.events.DDLEvents"><span class="yiyi-st" id="yiyi-428"><em class="property">class</em> <code class="descclassname">sqlalchemy.events&#x3002;</code> <code class="descname">DDLEvents</code> <a class="headerlink" href="#sqlalchemy.events.DDLEvents" title="Permalink to this definition">&#xB6;</a></span></dt><dd><p><span class="yiyi-st" id="yiyi-429">&#x57FA;&#x7840;&#xFF1A;<a class="reference internal" href="#sqlalchemy.event.base.Events" title="sqlalchemy.event.base.Events"><code class="xref py py-class docutils literal"><span class="pre">sqlalchemy.event.base.Events</span></code></a></span></p><p><span class="yiyi-st" id="yiyi-430">Define event listeners for schema objects, that is, <a class="reference internal" href="metadata.html#sqlalchemy.schema.SchemaItem" title="sqlalchemy.schema.SchemaItem"><code class="xref py py-class docutils literal"><span class="pre">SchemaItem</span></code></a> and other <a class="reference internal" href="#sqlalchemy.events.SchemaEventTarget" title="sqlalchemy.events.SchemaEventTarget"><code class="xref py py-class docutils literal"><span class="pre">SchemaEventTarget</span></code></a> subclasses, including <a class="reference internal" href="metadata.html#sqlalchemy.schema.MetaData" title="sqlalchemy.schema.MetaData"><code class="xref py py-class docutils literal"><span class="pre">MetaData</span></code></a>, <a class="reference internal" href="metadata.html#sqlalchemy.schema.Table" title="sqlalchemy.schema.Table"><code class="xref py py-class docutils literal"><span class="pre">Table</span></code></a>, <a class="reference internal" href="metadata.html#sqlalchemy.schema.Column" title="sqlalchemy.schema.Column"><code class="xref py py-class docutils literal"><span class="pre">Column</span></code></a>.</span></p><p><span class="yiyi-st" id="yiyi-431"><a class="reference internal" href="metadata.html#sqlalchemy.schema.MetaData" title="sqlalchemy.schema.MetaData"><code class="xref py py-class docutils literal"><span class="pre">MetaData</span></code></a> and <a class="reference internal" href="metadata.html#sqlalchemy.schema.Table" title="sqlalchemy.schema.Table"><code class="xref py py-class docutils literal"><span class="pre">Table</span></code></a> support events specifically regarding when CREATE and DROP DDL is emitted to the database.</span></p><p><span class="yiyi-st" id="yiyi-432">Attachment events are also provided to customize behavior whenever a child schema element is associated with a parent, such as, when a <a class="reference internal" href="metadata.html#sqlalchemy.schema.Column" title="sqlalchemy.schema.Column"><code class="xref py py-class docutils literal"><span class="pre">Column</span></code></a> is associated with its <a class="reference internal" href="metadata.html#sqlalchemy.schema.Table" title="sqlalchemy.schema.Table"><code class="xref py py-class docutils literal"><span class="pre">Table</span></code></a>, when a <a class="reference internal" href="constraints.html#sqlalchemy.schema.ForeignKeyConstraint" title="sqlalchemy.schema.ForeignKeyConstraint"><code class="xref py py-class docutils literal"><span class="pre">ForeignKeyConstraint</span></code></a> is associated with a <a class="reference internal" href="metadata.html#sqlalchemy.schema.Table" title="sqlalchemy.schema.Table"><code class="xref py py-class docutils literal"><span class="pre">Table</span></code></a>, etc.</span></p><p><span class="yiyi-st" id="yiyi-433">&#x4F7F;&#x7528;<code class="docutils literal"><span class="pre">after_create</span></code>&#x4E8B;&#x4EF6;&#x7684;&#x793A;&#x4F8B;&#xFF1A;</span></p><div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sqlalchemy</span> <span class="kn">import</span> <span class="n">event</span>
<span class="kn">from</span> <span class="nn">sqlalchemy</span> <span class="kn">import</span> <span class="n">Table</span><span class="p">,</span> <span class="n">Column</span><span class="p">,</span> <span class="n">Metadata</span><span class="p">,</span> <span class="n">Integer</span>

<span class="n">m</span> <span class="o">=</span> <span class="n">MetaData</span><span class="p">()</span>
<span class="n">some_table</span> <span class="o">=</span> <span class="n">Table</span><span class="p">(</span><span class="s1">&apos;some_table&apos;</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">Column</span><span class="p">(</span><span class="s1">&apos;data&apos;</span><span class="p">,</span> <span class="n">Integer</span><span class="p">))</span>

<span class="k">def</span> <span class="nf">after_create</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="n">connection</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">):</span>
    <span class="n">connection</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;ALTER TABLE </span><span class="si">%s</span><span class="s2"> SET name=foo_</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span>
                            <span class="p">(</span><span class="n">target</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">target</span><span class="o">.</span><span class="n">name</span><span class="p">))</span>

<span class="n">event</span><span class="o">.</span><span class="n">listen</span><span class="p">(</span><span class="n">some_table</span><span class="p">,</span> <span class="s2">&quot;after_create&quot;</span><span class="p">,</span> <span class="n">after_create</span><span class="p">)</span></pre></div></div><p><span class="yiyi-st" id="yiyi-434">DDL&#x4E8B;&#x4EF6;&#x4E0E;DDL&#x5B50;&#x53E5;&#x6784;&#x9020;&#x7684;<a class="reference internal" href="ddl.html#sqlalchemy.schema.DDL" title="sqlalchemy.schema.DDL"><code class="xref py py-class docutils literal"><span class="pre">DDL</span></code></a>&#x7C7B;&#x548C;<a class="reference internal" href="ddl.html#sqlalchemy.schema.DDLElement" title="sqlalchemy.schema.DDLElement"><code class="xref py py-class docutils literal"><span class="pre">DDLElement</span></code></a>&#x5C42;&#x6B21;&#x7ED3;&#x6784;&#x7D27;&#x5BC6;&#x96C6;&#x6210;&#xFF0C;&#x8FD9;&#x4E9B;&#x6784;&#x9020;&#x672C;&#x8EAB;&#x9002;&#x5408;&#x4F5C;&#x4E3A;&#x4FA6;&#x542C;&#x5668;&#x53EF;&#x8C03;&#x7528;&#x5143;&#x7D20;&#xFF1A;</span></p><div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sqlalchemy</span> <span class="kn">import</span> <span class="n">DDL</span>
<span class="n">event</span><span class="o">.</span><span class="n">listen</span><span class="p">(</span>
    <span class="n">some_table</span><span class="p">,</span>
    <span class="s2">&quot;after_create&quot;</span><span class="p">,</span>
    <span class="n">DDL</span><span class="p">(</span><span class="s2">&quot;ALTER TABLE </span><span class="si">%(table)s</span><span class="s2"> SET name=foo_</span><span class="si">%(table)s</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="p">)</span></pre></div></div><p><span class="yiyi-st" id="yiyi-435">&#x8FD9;&#x91CC;&#x7684;&#x65B9;&#x6CD5;&#x5B9A;&#x4E49;&#x4E86;&#x4E8B;&#x4EF6;&#x7684;&#x540D;&#x79F0;&#x4EE5;&#x53CA;&#x4F20;&#x9012;&#x7ED9;&#x4FA6;&#x542C;&#x5668;&#x51FD;&#x6570;&#x7684;&#x6210;&#x5458;&#x7684;&#x540D;&#x79F0;&#x3002;</span></p><p><span class="yiyi-st" id="yiyi-436">&#x4E5F;&#x53EF;&#x4EE5;&#x770B;&#x770B;&#xFF1A;</span></p><blockquote><div><p><span class="yiyi-st" id="yiyi-437"><a class="reference internal" href="event.html"><span>Events</span></a></span></p><p><span class="yiyi-st" id="yiyi-438"><a class="reference internal" href="ddl.html#sqlalchemy.schema.DDLElement" title="sqlalchemy.schema.DDLElement"><code class="xref py py-class docutils literal"><span class="pre">DDLElement</span></code></a></span></p><p><span class="yiyi-st" id="yiyi-439"><a class="reference internal" href="ddl.html#sqlalchemy.schema.DDL" title="sqlalchemy.schema.DDL"><code class="xref py py-class docutils literal"><span class="pre">DDL</span></code></a></span></p><p><span class="yiyi-st" id="yiyi-440"><a class="reference internal" href="ddl.html#schema-ddl-sequences"><span>Controlling DDL Sequences</span></a></span></p></div></blockquote><dl class="method"><dt id="sqlalchemy.events.DDLEvents.after_create"><span class="yiyi-st" id="yiyi-441"><code class="descname">after_create</code> <span class="sig-paren">&#xFF08;</span> <em>target</em>&#xFF0C;<em>connection</em>&#xFF0C;<em>** kw</em> <span class="sig-paren">T5&gt; <a class="headerlink" href="#sqlalchemy.events.DDLEvents.after_create" title="Permalink to this definition">&#xB6; T6&gt;</a></span></span></dt><dd><p><span class="yiyi-st" id="yiyi-442">&#x5728;&#x53D1;&#x51FA;CREATE&#x8BED;&#x53E5;&#x540E;&#x8C03;&#x7528;&#x3002;</span></p><div class="event-signatures container"><p><span class="yiyi-st" id="yiyi-443">&#x793A;&#x4F8B;&#x53C2;&#x6570;&#x8868;&#x5355;&#xFF1A;</span></p><div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sqlalchemy</span> <span class="kn">import</span> <span class="n">event</span>

<span class="c1"># standard decorator style</span>
<span class="nd">@event.listens_for</span><span class="p">(</span><span class="n">SomeSchemaClassOrObject</span><span class="p">,</span> <span class="s1">&apos;after_create&apos;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">receive_after_create</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="n">connection</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">):</span>
    <span class="s2">&quot;listen for the &apos;after_create&apos; event&quot;</span>

    <span class="c1"># ... (event handling logic) ...</span></pre></div></div></div><table class="docutils field-list" frame="void" rules="none"><tbody valign="top"><tr class="field-odd field"><th class="field-name"><span class="yiyi-st" id="yiyi-444">&#x53C2;&#x6570;&#xFF1A;</span></th><td class="field-body"><ul class="first last simple"><li><span class="yiyi-st" id="yiyi-445"><span class="target" id="sqlalchemy.events.DDLEvents.after_create.params.target"></span><strong>target</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.events.DDLEvents.after_create.params.target">&#xB6;</a> &#x2013; the <a class="reference internal" href="metadata.html#sqlalchemy.schema.MetaData" title="sqlalchemy.schema.MetaData"><code class="xref py py-class docutils literal"><span class="pre">MetaData</span></code></a> or <a class="reference internal" href="metadata.html#sqlalchemy.schema.Table" title="sqlalchemy.schema.Table"><code class="xref py py-class docutils literal"><span class="pre">Table</span></code></a> object which is the target of the event.</span></li><li><span class="yiyi-st" id="yiyi-446"><span class="target" id="sqlalchemy.events.DDLEvents.after_create.params.connection"></span><strong>connection</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.events.DDLEvents.after_create.params.connection">&#xB6;</a> &#x2013; the <a class="reference internal" href="connections.html#sqlalchemy.engine.Connection" title="sqlalchemy.engine.Connection"><code class="xref py py-class docutils literal"><span class="pre">Connection</span></code></a> where the CREATE statement or statements have been emitted.</span></li><li><span class="yiyi-st" id="yiyi-447"><span class="target" id="sqlalchemy.events.DDLEvents.after_create.params.**kw"></span> <strong>** kw</strong> <a class="paramlink headerlink reference internal" href="#sqlalchemy.events.DDLEvents.after_create.params.**kw">&#xB6;</a>  - &#x4E0E;&#x4E8B;&#x4EF6;&#x76F8;&#x5173;&#x7684;&#x9644;&#x52A0;&#x5173;&#x952E;&#x5B57;&#x53C2;&#x6570;&#x3002;</span><span class="yiyi-st" id="yiyi-448">&#x8BE5;&#x5B57;&#x5178;&#x7684;&#x5185;&#x5BB9;&#x53EF;&#x80FD;&#x56E0;&#x53D1;&#x884C;&#x7248;&#x800C;&#x5F02;&#xFF0C;&#x5E76;&#x4E14;&#x5305;&#x62EC;&#x4E3A;&#x5143;&#x6570;&#x636E;&#x7EA7;&#x4E8B;&#x4EF6;&#x751F;&#x6210;&#x7684;&#x8868;&#x7684;&#x5217;&#x8868;&#xFF0C;checkfirst&#x6807;&#x5FD7;&#x4EE5;&#x53CA;&#x5185;&#x90E8;&#x4E8B;&#x4EF6;&#x4F7F;&#x7528;&#x7684;&#x5176;&#x4ED6;&#x5143;&#x7D20;&#x3002;</span></li></ul></td></tr></tbody></table></dd></dl><dl class="method"><dt id="sqlalchemy.events.DDLEvents.after_drop"><span class="yiyi-st" id="yiyi-449"> <code class="descname">after_drop</code><span class="sig-paren">(</span><em>target</em>, <em>connection</em>, <em>**kw</em><span class="sig-paren">)</span><a class="headerlink" href="#sqlalchemy.events.DDLEvents.after_drop" title="Permalink to this definition">&#xB6;</a></span></dt><dd><p><span class="yiyi-st" id="yiyi-450">&#x5728;DROP&#x8BED;&#x53E5;&#x53D1;&#x51FA;&#x540E;&#x8C03;&#x7528;&#x3002;</span></p><div class="event-signatures container"><p><span class="yiyi-st" id="yiyi-451">&#x793A;&#x4F8B;&#x53C2;&#x6570;&#x8868;&#x5355;&#xFF1A;</span></p><div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sqlalchemy</span> <span class="kn">import</span> <span class="n">event</span>

<span class="c1"># standard decorator style</span>
<span class="nd">@event.listens_for</span><span class="p">(</span><span class="n">SomeSchemaClassOrObject</span><span class="p">,</span> <span class="s1">&apos;after_drop&apos;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">receive_after_drop</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="n">connection</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">):</span>
    <span class="s2">&quot;listen for the &apos;after_drop&apos; event&quot;</span>

    <span class="c1"># ... (event handling logic) ...</span></pre></div></div></div><table class="docutils field-list" frame="void" rules="none"><tbody valign="top"><tr class="field-odd field"><th class="field-name"><span class="yiyi-st" id="yiyi-452">&#x53C2;&#x6570;&#xFF1A;</span></th><td class="field-body"><ul class="first last simple"><li><span class="yiyi-st" id="yiyi-453"><span class="target" id="sqlalchemy.events.DDLEvents.after_drop.params.target"></span><strong>target</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.events.DDLEvents.after_drop.params.target">&#xB6;</a> &#x2013; the <a class="reference internal" href="metadata.html#sqlalchemy.schema.MetaData" title="sqlalchemy.schema.MetaData"><code class="xref py py-class docutils literal"><span class="pre">MetaData</span></code></a> or <a class="reference internal" href="metadata.html#sqlalchemy.schema.Table" title="sqlalchemy.schema.Table"><code class="xref py py-class docutils literal"><span class="pre">Table</span></code></a> object which is the target of the event.</span></li><li><span class="yiyi-st" id="yiyi-454"><span class="target" id="sqlalchemy.events.DDLEvents.after_drop.params.connection"></span><strong>connection</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.events.DDLEvents.after_drop.params.connection">&#xB6;</a> &#x2013; the <a class="reference internal" href="connections.html#sqlalchemy.engine.Connection" title="sqlalchemy.engine.Connection"><code class="xref py py-class docutils literal"><span class="pre">Connection</span></code></a> where the DROP statement or statements have been emitted.</span></li><li><span class="yiyi-st" id="yiyi-455"><span class="target" id="sqlalchemy.events.DDLEvents.after_drop.params.**kw"></span> <strong>** kw</strong> <a class="paramlink headerlink reference internal" href="#sqlalchemy.events.DDLEvents.after_drop.params.**kw">&#xB6;</a>  - &#x4E0E;&#x4E8B;&#x4EF6;&#x76F8;&#x5173;&#x7684;&#x9644;&#x52A0;&#x5173;&#x952E;&#x5B57;&#x53C2;&#x6570;&#x3002;</span><span class="yiyi-st" id="yiyi-456">&#x8BE5;&#x5B57;&#x5178;&#x7684;&#x5185;&#x5BB9;&#x53EF;&#x80FD;&#x56E0;&#x53D1;&#x884C;&#x7248;&#x800C;&#x5F02;&#xFF0C;&#x5E76;&#x4E14;&#x5305;&#x62EC;&#x4E3A;&#x5143;&#x6570;&#x636E;&#x7EA7;&#x4E8B;&#x4EF6;&#x751F;&#x6210;&#x7684;&#x8868;&#x7684;&#x5217;&#x8868;&#xFF0C;checkfirst&#x6807;&#x5FD7;&#x4EE5;&#x53CA;&#x5185;&#x90E8;&#x4E8B;&#x4EF6;&#x4F7F;&#x7528;&#x7684;&#x5176;&#x4ED6;&#x5143;&#x7D20;&#x3002;</span></li></ul></td></tr></tbody></table></dd></dl><dl class="method"><dt id="sqlalchemy.events.DDLEvents.after_parent_attach"><span class="yiyi-st" id="yiyi-457"> <code class="descname">after_parent_attach</code><span class="sig-paren">(</span><em>target</em>, <em>parent</em><span class="sig-paren">)</span><a class="headerlink" href="#sqlalchemy.events.DDLEvents.after_parent_attach" title="Permalink to this definition">&#xB6;</a></span></dt><dd><p><span class="yiyi-st" id="yiyi-458">&#x5728;<a class="reference internal" href="metadata.html#sqlalchemy.schema.SchemaItem" title="sqlalchemy.schema.SchemaItem"><code class="xref py py-class docutils literal"><span class="pre">SchemaItem</span></code></a>&#x4E0E;&#x7236;<a class="reference internal" href="metadata.html#sqlalchemy.schema.SchemaItem" title="sqlalchemy.schema.SchemaItem"><code class="xref py py-class docutils literal"><span class="pre">SchemaItem</span></code></a>&#x5173;&#x8054;&#x540E;&#x8C03;&#x7528;&#x3002;</span></p><div class="event-signatures container"><p><span class="yiyi-st" id="yiyi-459">&#x793A;&#x4F8B;&#x53C2;&#x6570;&#x8868;&#x5355;&#xFF1A;</span></p><div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sqlalchemy</span> <span class="kn">import</span> <span class="n">event</span>

<span class="c1"># standard decorator style</span>
<span class="nd">@event.listens_for</span><span class="p">(</span><span class="n">SomeSchemaClassOrObject</span><span class="p">,</span> <span class="s1">&apos;after_parent_attach&apos;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">receive_after_parent_attach</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="n">parent</span><span class="p">):</span>
    <span class="s2">&quot;listen for the &apos;after_parent_attach&apos; event&quot;</span>

    <span class="c1"># ... (event handling logic) ...</span></pre></div></div></div><table class="docutils field-list" frame="void" rules="none"><tbody valign="top"><tr class="field-odd field"><th class="field-name"><span class="yiyi-st" id="yiyi-460">&#x53C2;&#x6570;&#xFF1A;</span></th><td class="field-body"><ul class="first last simple"><li><span class="yiyi-st" id="yiyi-461"><span class="target" id="sqlalchemy.events.DDLEvents.after_parent_attach.params.target"></span> <strong>&#x76EE;&#x6807;</strong> <a class="paramlink headerlink reference internal" href="#sqlalchemy.events.DDLEvents.after_parent_attach.params.target">&#xB6;</a>  - &#x76EE;&#x6807;&#x5BF9;&#x8C61;</span></li><li><span class="yiyi-st" id="yiyi-462"><span class="target" id="sqlalchemy.events.DDLEvents.after_parent_attach.params.parent"></span><strong>parent</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.events.DDLEvents.after_parent_attach.params.parent">&#xB6;</a> &#x2013; the parent to which the target is being attached.</span></li></ul></td></tr></tbody></table><p><span class="yiyi-st" id="yiyi-463"><a class="reference internal" href="event.html#sqlalchemy.event.listen" title="sqlalchemy.event.listen"><code class="xref py py-func docutils literal"><span class="pre">event.listen()</span></code></a>&#x4E5F;&#x63A5;&#x53D7;&#x8FD9;&#x4E2A;&#x4E8B;&#x4EF6;&#x7684;&#x4FEE;&#x9970;&#x7B26;&#xFF1A;</span></p><table class="docutils field-list" frame="void" rules="none"><tbody valign="top"><tr class="field-odd field"><th class="field-name"><span class="yiyi-st" id="yiyi-464">&#x53C2;&#x6570;&#xFF1A;</span></th><td class="field-body"><span class="yiyi-st" id="yiyi-465"><span class="target" id="sqlalchemy.events.DDLEvents.after_parent_attach.params.propagate"></span><strong>propagate=False</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.events.DDLEvents.after_parent_attach.params.propagate">&#xB6;</a> &#x2013; When True, the listener function will be established for any copies made of the target object, i.e. those copies that are generated when <a class="reference internal" href="metadata.html#sqlalchemy.schema.Table.tometadata" title="sqlalchemy.schema.Table.tometadata"><code class="xref py py-meth docutils literal"><span class="pre">Table.tometadata()</span></code></a> is used.</span></td></tr></tbody></table></dd></dl><dl class="method"><dt id="sqlalchemy.events.DDLEvents.before_create"><span class="yiyi-st" id="yiyi-466"><code class="descname">before_create</code> <span class="sig-paren">&#xFF08;</span> <em>target</em>&#xFF0C;<em>connection</em>&#xFF0C;<em>** kw</em> <span class="sig-paren">T5&gt; <a class="headerlink" href="#sqlalchemy.events.DDLEvents.before_create" title="Permalink to this definition">&#xB6; T6&gt;</a></span></span></dt><dd><p><span class="yiyi-st" id="yiyi-467">&#x5728;&#x53D1;&#x51FA;CREATE&#x8BED;&#x53E5;&#x4E4B;&#x524D;&#x8C03;&#x7528;&#x3002;</span></p><div class="event-signatures container"><p><span class="yiyi-st" id="yiyi-468">&#x793A;&#x4F8B;&#x53C2;&#x6570;&#x8868;&#x5355;&#xFF1A;</span></p><div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sqlalchemy</span> <span class="kn">import</span> <span class="n">event</span>

<span class="c1"># standard decorator style</span>
<span class="nd">@event.listens_for</span><span class="p">(</span><span class="n">SomeSchemaClassOrObject</span><span class="p">,</span> <span class="s1">&apos;before_create&apos;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">receive_before_create</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="n">connection</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">):</span>
    <span class="s2">&quot;listen for the &apos;before_create&apos; event&quot;</span>

    <span class="c1"># ... (event handling logic) ...</span></pre></div></div></div><table class="docutils field-list" frame="void" rules="none"><tbody valign="top"><tr class="field-odd field"><th class="field-name"><span class="yiyi-st" id="yiyi-469">&#x53C2;&#x6570;&#xFF1A;</span></th><td class="field-body"><ul class="first last simple"><li><span class="yiyi-st" id="yiyi-470"><span class="target" id="sqlalchemy.events.DDLEvents.before_create.params.target"></span><strong>target</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.events.DDLEvents.before_create.params.target">&#xB6;</a> &#x2013; the <a class="reference internal" href="metadata.html#sqlalchemy.schema.MetaData" title="sqlalchemy.schema.MetaData"><code class="xref py py-class docutils literal"><span class="pre">MetaData</span></code></a> or <a class="reference internal" href="metadata.html#sqlalchemy.schema.Table" title="sqlalchemy.schema.Table"><code class="xref py py-class docutils literal"><span class="pre">Table</span></code></a> object which is the target of the event.</span></li><li><span class="yiyi-st" id="yiyi-471"><span class="target" id="sqlalchemy.events.DDLEvents.before_create.params.connection"></span><strong>connection</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.events.DDLEvents.before_create.params.connection">&#xB6;</a> &#x2013; the <a class="reference internal" href="connections.html#sqlalchemy.engine.Connection" title="sqlalchemy.engine.Connection"><code class="xref py py-class docutils literal"><span class="pre">Connection</span></code></a> where the CREATE statement or statements will be emitted.</span></li><li><span class="yiyi-st" id="yiyi-472"><span class="target" id="sqlalchemy.events.DDLEvents.before_create.params.**kw"></span> <strong>** kw</strong> <a class="paramlink headerlink reference internal" href="#sqlalchemy.events.DDLEvents.before_create.params.**kw">&#xB6;</a>  - &#x4E0E;&#x4E8B;&#x4EF6;&#x76F8;&#x5173;&#x7684;&#x9644;&#x52A0;&#x5173;&#x952E;&#x5B57;&#x53C2;&#x6570;&#x3002;</span><span class="yiyi-st" id="yiyi-473">&#x8BE5;&#x5B57;&#x5178;&#x7684;&#x5185;&#x5BB9;&#x53EF;&#x80FD;&#x56E0;&#x53D1;&#x884C;&#x7248;&#x800C;&#x5F02;&#xFF0C;&#x5E76;&#x4E14;&#x5305;&#x62EC;&#x4E3A;&#x5143;&#x6570;&#x636E;&#x7EA7;&#x4E8B;&#x4EF6;&#x751F;&#x6210;&#x7684;&#x8868;&#x7684;&#x5217;&#x8868;&#xFF0C;checkfirst&#x6807;&#x5FD7;&#x4EE5;&#x53CA;&#x5185;&#x90E8;&#x4E8B;&#x4EF6;&#x4F7F;&#x7528;&#x7684;&#x5176;&#x4ED6;&#x5143;&#x7D20;&#x3002;</span></li></ul></td></tr></tbody></table></dd></dl><dl class="method"><dt id="sqlalchemy.events.DDLEvents.before_drop"><span class="yiyi-st" id="yiyi-474"><code class="descname">before_drop</code> <span class="sig-paren">&#xFF08;</span> <em>target</em>&#xFF0C;<em>connection</em>&#xFF0C;<em>** kw</em> <span class="sig-paren">T5&gt; <a class="headerlink" href="#sqlalchemy.events.DDLEvents.before_drop" title="Permalink to this definition">&#xB6; T6&gt;</a></span></span></dt><dd><p><span class="yiyi-st" id="yiyi-475">&#x5728;DROP&#x8BED;&#x53E5;&#x53D1;&#x51FA;&#x4E4B;&#x524D;&#x8C03;&#x7528;&#x3002;</span></p><div class="event-signatures container"><p><span class="yiyi-st" id="yiyi-476">&#x793A;&#x4F8B;&#x53C2;&#x6570;&#x8868;&#x5355;&#xFF1A;</span></p><div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sqlalchemy</span> <span class="kn">import</span> <span class="n">event</span>

<span class="c1"># standard decorator style</span>
<span class="nd">@event.listens_for</span><span class="p">(</span><span class="n">SomeSchemaClassOrObject</span><span class="p">,</span> <span class="s1">&apos;before_drop&apos;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">receive_before_drop</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="n">connection</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">):</span>
    <span class="s2">&quot;listen for the &apos;before_drop&apos; event&quot;</span>

    <span class="c1"># ... (event handling logic) ...</span></pre></div></div></div><table class="docutils field-list" frame="void" rules="none"><tbody valign="top"><tr class="field-odd field"><th class="field-name"><span class="yiyi-st" id="yiyi-477">&#x53C2;&#x6570;&#xFF1A;</span></th><td class="field-body"><ul class="first last simple"><li><span class="yiyi-st" id="yiyi-478"><span class="target" id="sqlalchemy.events.DDLEvents.before_drop.params.target"></span><strong>target</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.events.DDLEvents.before_drop.params.target">&#xB6;</a> &#x2013; the <a class="reference internal" href="metadata.html#sqlalchemy.schema.MetaData" title="sqlalchemy.schema.MetaData"><code class="xref py py-class docutils literal"><span class="pre">MetaData</span></code></a> or <a class="reference internal" href="metadata.html#sqlalchemy.schema.Table" title="sqlalchemy.schema.Table"><code class="xref py py-class docutils literal"><span class="pre">Table</span></code></a> object which is the target of the event.</span></li><li><span class="yiyi-st" id="yiyi-479"><span class="target" id="sqlalchemy.events.DDLEvents.before_drop.params.connection"></span><strong>connection</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.events.DDLEvents.before_drop.params.connection">&#xB6;</a> &#x2013; the <a class="reference internal" href="connections.html#sqlalchemy.engine.Connection" title="sqlalchemy.engine.Connection"><code class="xref py py-class docutils literal"><span class="pre">Connection</span></code></a> where the DROP statement or statements will be emitted.</span></li><li><span class="yiyi-st" id="yiyi-480"><span class="target" id="sqlalchemy.events.DDLEvents.before_drop.params.**kw"></span> <strong>** kw</strong> <a class="paramlink headerlink reference internal" href="#sqlalchemy.events.DDLEvents.before_drop.params.**kw">&#xB6;</a>  - &#x4E0E;&#x4E8B;&#x4EF6;&#x76F8;&#x5173;&#x7684;&#x9644;&#x52A0;&#x5173;&#x952E;&#x5B57;&#x53C2;&#x6570;&#x3002;</span><span class="yiyi-st" id="yiyi-481">&#x8BE5;&#x5B57;&#x5178;&#x7684;&#x5185;&#x5BB9;&#x53EF;&#x80FD;&#x56E0;&#x53D1;&#x884C;&#x7248;&#x800C;&#x5F02;&#xFF0C;&#x5E76;&#x4E14;&#x5305;&#x62EC;&#x4E3A;&#x5143;&#x6570;&#x636E;&#x7EA7;&#x4E8B;&#x4EF6;&#x751F;&#x6210;&#x7684;&#x8868;&#x7684;&#x5217;&#x8868;&#xFF0C;checkfirst&#x6807;&#x5FD7;&#x4EE5;&#x53CA;&#x5185;&#x90E8;&#x4E8B;&#x4EF6;&#x4F7F;&#x7528;&#x7684;&#x5176;&#x4ED6;&#x5143;&#x7D20;&#x3002;</span></li></ul></td></tr></tbody></table></dd></dl><dl class="method"><dt id="sqlalchemy.events.DDLEvents.before_parent_attach"><span class="yiyi-st" id="yiyi-482"><code class="descname">before_parent_attach</code> <span class="sig-paren">&#xFF08;</span> <em>target</em>&#xFF0C;<em>parent</em> <span class="sig-paren">&#xFF09;</span> <a class="headerlink" href="#sqlalchemy.events.DDLEvents.before_parent_attach" title="Permalink to this definition">&#xB6;</a></span></dt><dd><p><span class="yiyi-st" id="yiyi-483">&#x5728;<a class="reference internal" href="metadata.html#sqlalchemy.schema.SchemaItem" title="sqlalchemy.schema.SchemaItem"><code class="xref py py-class docutils literal"><span class="pre">SchemaItem</span></code></a>&#x4E0E;&#x7236;<a class="reference internal" href="metadata.html#sqlalchemy.schema.SchemaItem" title="sqlalchemy.schema.SchemaItem"><code class="xref py py-class docutils literal"><span class="pre">SchemaItem</span></code></a>&#x5173;&#x8054;&#x4E4B;&#x524D;&#x8C03;&#x7528;&#x3002;</span></p><div class="event-signatures container"><p><span class="yiyi-st" id="yiyi-484">&#x793A;&#x4F8B;&#x53C2;&#x6570;&#x8868;&#x5355;&#xFF1A;</span></p><div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sqlalchemy</span> <span class="kn">import</span> <span class="n">event</span>

<span class="c1"># standard decorator style</span>
<span class="nd">@event.listens_for</span><span class="p">(</span><span class="n">SomeSchemaClassOrObject</span><span class="p">,</span> <span class="s1">&apos;before_parent_attach&apos;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">receive_before_parent_attach</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="n">parent</span><span class="p">):</span>
    <span class="s2">&quot;listen for the &apos;before_parent_attach&apos; event&quot;</span>

    <span class="c1"># ... (event handling logic) ...</span></pre></div></div></div><table class="docutils field-list" frame="void" rules="none"><tbody valign="top"><tr class="field-odd field"><th class="field-name"><span class="yiyi-st" id="yiyi-485">&#x53C2;&#x6570;&#xFF1A;</span></th><td class="field-body"><ul class="first last simple"><li><span class="yiyi-st" id="yiyi-486"><span class="target" id="sqlalchemy.events.DDLEvents.before_parent_attach.params.target"></span> <strong>&#x76EE;&#x6807;</strong> <a class="paramlink headerlink reference internal" href="#sqlalchemy.events.DDLEvents.before_parent_attach.params.target">&#xB6;</a>  - &#x76EE;&#x6807;&#x5BF9;&#x8C61;</span></li><li><span class="yiyi-st" id="yiyi-487"><span class="target" id="sqlalchemy.events.DDLEvents.before_parent_attach.params.parent"></span><strong>parent</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.events.DDLEvents.before_parent_attach.params.parent">&#xB6;</a> &#x2013; the parent to which the target is being attached.</span></li></ul></td></tr></tbody></table><p><span class="yiyi-st" id="yiyi-488"><a class="reference internal" href="event.html#sqlalchemy.event.listen" title="sqlalchemy.event.listen"><code class="xref py py-func docutils literal"><span class="pre">event.listen()</span></code></a>&#x4E5F;&#x63A5;&#x53D7;&#x8FD9;&#x4E2A;&#x4E8B;&#x4EF6;&#x7684;&#x4FEE;&#x9970;&#x7B26;&#xFF1A;</span></p><table class="docutils field-list" frame="void" rules="none"><tbody valign="top"><tr class="field-odd field"><th class="field-name"><span class="yiyi-st" id="yiyi-489">&#x53C2;&#x6570;&#xFF1A;</span></th><td class="field-body"><span class="yiyi-st" id="yiyi-490"><span class="target" id="sqlalchemy.events.DDLEvents.before_parent_attach.params.propagate"></span><strong>propagate=False</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.events.DDLEvents.before_parent_attach.params.propagate">&#xB6;</a> &#x2013; When True, the listener function will be established for any copies made of the target object, i.e. those copies that are generated when <a class="reference internal" href="metadata.html#sqlalchemy.schema.Table.tometadata" title="sqlalchemy.schema.Table.tometadata"><code class="xref py py-meth docutils literal"><span class="pre">Table.tometadata()</span></code></a> is used.</span></td></tr></tbody></table></dd></dl><dl class="method"><dt id="sqlalchemy.events.DDLEvents.column_reflect"><span class="yiyi-st" id="yiyi-491"> <code class="descname">column_reflect</code><span class="sig-paren">(</span><em>inspector</em>, <em>table</em>, <em>column_info</em><span class="sig-paren">)</span><a class="headerlink" href="#sqlalchemy.events.DDLEvents.column_reflect" title="Permalink to this definition">&#xB6;</a></span></dt><dd><p><span class="yiyi-st" id="yiyi-492">&#x5F53;&#x53CD;&#x6620;<a class="reference internal" href="metadata.html#sqlalchemy.schema.Table" title="sqlalchemy.schema.Table"><code class="xref py py-class docutils literal"><span class="pre">Table</span></code></a>&#x65F6;&#x68C0;&#x7D22;&#x5230;&#x7684;&#x6BCF;&#x4E2A;&#x201C;&#x5217;&#x4FE1;&#x606F;&#x201D;&#x5355;&#x5143;&#x90FD;&#x88AB;&#x8C03;&#x7528;&#x3002;</span></p><div class="event-signatures container"><p><span class="yiyi-st" id="yiyi-493">&#x793A;&#x4F8B;&#x53C2;&#x6570;&#x8868;&#x5355;&#xFF1A;</span></p><div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sqlalchemy</span> <span class="kn">import</span> <span class="n">event</span>

<span class="c1"># standard decorator style</span>
<span class="nd">@event.listens_for</span><span class="p">(</span><span class="n">SomeSchemaClassOrObject</span><span class="p">,</span> <span class="s1">&apos;column_reflect&apos;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">receive_column_reflect</span><span class="p">(</span><span class="n">inspector</span><span class="p">,</span> <span class="n">table</span><span class="p">,</span> <span class="n">column_info</span><span class="p">):</span>
    <span class="s2">&quot;listen for the &apos;column_reflect&apos; event&quot;</span>

    <span class="c1"># ... (event handling logic) ...</span></pre></div></div></div><p><span class="yiyi-st" id="yiyi-494">&#x7531;&#x65B9;&#x8A00;&#x8FD4;&#x56DE;&#x7684;&#x5217;&#x4FE1;&#x606F;&#x7684;&#x5B57;&#x5178;&#x88AB;&#x4F20;&#x9012;&#xFF0C;&#x5E76;&#x4E14;&#x53EF;&#x4EE5;&#x88AB;&#x4FEE;&#x6539;&#x3002;</span><span class="yiyi-st" id="yiyi-495">&#x5B57;&#x5178;&#x662F;&#x5728;&#x7531;<a class="reference internal" href="reflection.html#sqlalchemy.engine.reflection.Inspector.get_columns" title="sqlalchemy.engine.reflection.Inspector.get_columns"><code class="xref py py-meth docutils literal"><span class="pre">reflection.Inspector.get_columns()</span></code></a>&#x8FD4;&#x56DE;&#x7684;&#x5217;&#x8868;&#x7684;&#x6BCF;&#x4E2A;&#x5143;&#x7D20;&#x4E2D;&#x8FD4;&#x56DE;&#x7684;&#x3002;</span></p><p><span class="yiyi-st" id="yiyi-496">&#x5728;&#x5BF9;&#x8BE5;&#x5B57;&#x5178;&#x91C7;&#x53D6;&#x4EFB;&#x4F55;&#x64CD;&#x4F5C;&#x4E4B;&#x524D;&#x8C03;&#x7528;&#x8BE5;&#x4E8B;&#x4EF6;&#xFF0C;&#x5E76;&#x4E14;&#x53EF;&#x4EE5;&#x4FEE;&#x6539;&#x5185;&#x5BB9;&#x3002;</span><span class="yiyi-st" id="yiyi-497"><a class="reference internal" href="metadata.html#sqlalchemy.schema.Column" title="sqlalchemy.schema.Column"><code class="xref py py-class docutils literal"><span class="pre">Column</span></code></a>&#x7279;&#x5B9A;&#x53C2;&#x6570;<code class="docutils literal"><span class="pre">info</span></code>&#xFF0C;<code class="docutils literal"><span class="pre">key</span></code>&#x548C;<code class="docutils literal"><span class="pre">quote</span></code>&#x4E5F;&#x53EF;&#x4EE5;&#x6DFB;&#x52A0;&#x5230;&#x5B57;&#x5178;&#x4E2D;&#xFF0C;&#x5E76;&#x5C06;&#x4F20;&#x9012;&#x7ED9;<a class="reference internal" href="metadata.html#sqlalchemy.schema.Column" title="sqlalchemy.schema.Column"><code class="xref py py-class docutils literal"><span class="pre">Column</span></code></a>&#x7684;&#x6784;&#x9020;&#x51FD;&#x6570;&#x3002;</span></p><p><span class="yiyi-st" id="yiyi-498">&#x8BF7;&#x6CE8;&#x610F;&#xFF0C;&#x6B64;&#x4E8B;&#x4EF6;&#x4EC5;&#x5728;&#x4E0E;&#x6574;&#x4E2A;&#x8463;&#x4E8B;&#x4F1A;&#x7684;<a class="reference internal" href="metadata.html#sqlalchemy.schema.Table" title="sqlalchemy.schema.Table"><code class="xref py py-class docutils literal"><span class="pre">Table</span></code></a>&#x7C7B;&#x5173;&#x8054;&#x65F6;&#x624D;&#x6709;&#x610F;&#x4E49;&#xFF0C;&#x4F8B;&#x5982;&#xFF1A;</span></p><div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sqlalchemy.schema</span> <span class="kn">import</span> <span class="n">Table</span>
<span class="kn">from</span> <span class="nn">sqlalchemy</span> <span class="kn">import</span> <span class="n">event</span>

<span class="k">def</span> <span class="nf">listen_for_reflect</span><span class="p">(</span><span class="n">inspector</span><span class="p">,</span> <span class="n">table</span><span class="p">,</span> <span class="n">column_info</span><span class="p">):</span>
    <span class="s2">&quot;receive a column_reflect event&quot;</span>
    <span class="c1"># ...</span>

<span class="n">event</span><span class="o">.</span><span class="n">listen</span><span class="p">(</span>
        <span class="n">Table</span><span class="p">,</span>
        <span class="s1">&apos;column_reflect&apos;</span><span class="p">,</span>
        <span class="n">listen_for_reflect</span><span class="p">)</span></pre></div></div><p><span class="yiyi-st" id="yiyi-499">...&#x6216;&#x4F7F;&#x7528;<code class="docutils literal"><span class="pre">listeners</span></code>&#x53C2;&#x6570;&#x4E0E;&#x7279;&#x5B9A;&#x7684;<a class="reference internal" href="metadata.html#sqlalchemy.schema.Table" title="sqlalchemy.schema.Table"><code class="xref py py-class docutils literal"><span class="pre">Table</span></code></a>&#x5B9E;&#x4F8B;&#x5173;&#x8054;&#xFF1A;</span></p><div class="highlight-python"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">listen_for_reflect</span><span class="p">(</span><span class="n">inspector</span><span class="p">,</span> <span class="n">table</span><span class="p">,</span> <span class="n">column_info</span><span class="p">):</span>
    <span class="s2">&quot;receive a column_reflect event&quot;</span>
    <span class="c1"># ...</span>

<span class="n">t</span> <span class="o">=</span> <span class="n">Table</span><span class="p">(</span>
    <span class="s1">&apos;sometable&apos;</span><span class="p">,</span>
    <span class="n">autoload</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
    <span class="n">listeners</span><span class="o">=</span><span class="p">[</span>
        <span class="p">(</span><span class="s1">&apos;column_reflect&apos;</span><span class="p">,</span> <span class="n">listen_for_reflect</span><span class="p">)</span>
    <span class="p">])</span></pre></div></div><p><span class="yiyi-st" id="yiyi-500">&#x8FD9;&#x662F;&#x56E0;&#x4E3A;&#x7531;<code class="docutils literal"><span class="pre">autoload=True</span></code>&#x542F;&#x52A8;&#x7684;&#x53CD;&#x5C04;&#x8FC7;&#x7A0B;&#x5728;<a class="reference internal" href="metadata.html#sqlalchemy.schema.Table" title="sqlalchemy.schema.Table"><code class="xref py py-class docutils literal"><span class="pre">Table</span></code></a>&#x7684;&#x6784;&#x9020;&#x51FD;&#x6570;&#x7684;&#x4F5C;&#x7528;&#x57DF;&#x5185;&#x5B8C;&#x6210;&#x3002;</span></p></dd></dl></dd></dl><dl class="class"><dt id="sqlalchemy.events.SchemaEventTarget"><span class="yiyi-st" id="yiyi-501"><em class="property">class</em> <code class="descclassname">sqlalchemy.events&#x3002;</code> <code class="descname">SchemaEventTarget</code> <a class="headerlink" href="#sqlalchemy.events.SchemaEventTarget" title="Permalink to this definition">&#xB6;</a></span></dt><dd><p><span class="yiyi-st" id="yiyi-502">&#x4F5C;&#x4E3A;<a class="reference internal" href="#sqlalchemy.events.DDLEvents" title="sqlalchemy.events.DDLEvents"><code class="xref py py-class docutils literal"><span class="pre">DDLEvents</span></code></a>&#x4E8B;&#x4EF6;&#x76EE;&#x6807;&#x7684;&#x5143;&#x7D20;&#x7684;&#x57FA;&#x7C7B;&#x3002;</span></p><p><span class="yiyi-st" id="yiyi-503">&#x8FD9;&#x5305;&#x62EC;<a class="reference internal" href="metadata.html#sqlalchemy.schema.SchemaItem" title="sqlalchemy.schema.SchemaItem"><code class="xref py py-class docutils literal"><span class="pre">SchemaItem</span></code></a>&#x4EE5;&#x53CA;<a class="reference internal" href="type_basics.html#sqlalchemy.types.SchemaType" title="sqlalchemy.types.SchemaType"><code class="xref py py-class docutils literal"><span class="pre">SchemaType</span></code></a>&#x3002;</span></p></dd></dl></div>