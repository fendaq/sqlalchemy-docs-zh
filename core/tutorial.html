<h1><span class="yiyi-st" id="yiyi-68">SQL&#x8868;&#x8FBE;&#x5F0F;&#x8BED;&#x8A00;&#x6559;&#x7A0B;<a class="headerlink" href="#sql-expression-language-tutorial" title="Permalink to this headline">&#xB6;</a></span></h1><p><span class="yiyi-st" id="yiyi-69">SQLAlchemy&#x8868;&#x8FBE;&#x5F0F;&#x8BED;&#x8A00;&#x63D0;&#x4F9B;&#x4E86;&#x4E00;&#x4E2A;&#x4F7F;&#x7528;Python&#x7ED3;&#x6784;&#x8868;&#x793A;&#x5173;&#x7CFB;&#x6570;&#x636E;&#x5E93;&#x7ED3;&#x6784;&#x548C;&#x8868;&#x8FBE;&#x5F0F;&#x7684;&#x7CFB;&#x7EDF;&#x3002;</span><span class="yiyi-st" id="yiyi-70">&#x8FD9;&#x4E9B;&#x7ED3;&#x6784;&#x88AB;&#x6A21;&#x62DF;&#x4E3A;&#x5C3D;&#x53EF;&#x80FD;&#x63A5;&#x8FD1;&#x5E95;&#x5C42;&#x6570;&#x636E;&#x5E93;&#x7684;&#x7ED3;&#x6784;&#xFF0C;&#x540C;&#x65F6;&#x63D0;&#x4F9B;&#x6570;&#x636E;&#x5E93;&#x540E;&#x7AEF;&#x4E4B;&#x95F4;&#x5404;&#x79CD;&#x5B9E;&#x73B0;&#x5DEE;&#x5F02;&#x7684;&#x4E00;&#x4E9B;&#x62BD;&#x8C61;&#x3002;</span><span class="yiyi-st" id="yiyi-71">&#x867D;&#x7136;&#x6784;&#x9020;&#x5C1D;&#x8BD5;&#x7528;&#x4E00;&#x81F4;&#x7684;&#x7ED3;&#x6784;&#x6765;&#x8868;&#x793A;&#x540E;&#x7AEF;&#x4E4B;&#x95F4;&#x7684;&#x7B49;&#x4EF7;&#x6982;&#x5FF5;&#xFF0C;&#x4F46;&#x5B83;&#x4EEC;&#x5E76;&#x4E0D;&#x9690;&#x85CF;&#x5BF9;&#x7279;&#x5B9A;&#x540E;&#x7AEF;&#x5B50;&#x96C6;&#x800C;&#x8A00;&#x552F;&#x4E00;&#x7684;&#x6709;&#x7528;&#x6982;&#x5FF5;&#x3002;</span><span class="yiyi-st" id="yiyi-72">&#x56E0;&#x6B64;&#xFF0C;&#x8868;&#x8FBE;&#x5F0F;&#x8BED;&#x8A00;&#x63D0;&#x4F9B;&#x4E86;&#x4E00;&#x79CD;&#x7F16;&#x5199;&#x540E;&#x7AEF;&#x4E2D;&#x7ACB;&#x7684;SQL&#x8868;&#x8FBE;&#x5F0F;&#x7684;&#x65B9;&#x6CD5;&#xFF0C;&#x4F46;&#x5E76;&#x4E0D;&#x8BD5;&#x56FE;&#x5F3A;&#x5236;&#x8BE5;&#x8868;&#x8FBE;&#x5F0F;&#x662F;&#x540E;&#x7AEF;&#x4E2D;&#x7ACB;&#x7684;&#x3002;</span></p><p><span class="yiyi-st" id="yiyi-73">&#x8868;&#x8FBE;&#x5F0F;&#x8BED;&#x8A00;&#x4E0E;&#x5BF9;&#x8C61;&#x5173;&#x7CFB;&#x6620;&#x5C04;&#x5668;&#x5F62;&#x6210;&#x5BF9;&#x6BD4;&#xFF0C;&#x5BF9;&#x8C61;&#x5173;&#x7CFB;&#x6620;&#x5C04;&#x5668;&#x662F;&#x4E00;&#x79CD;&#x5EFA;&#x7ACB;&#x5728;&#x8868;&#x8FBE;&#x5F0F;&#x8BED;&#x8A00;&#x4E4B;&#x4E0A;&#x7684;&#x72EC;&#x7279;API&#x3002;</span><span class="yiyi-st" id="yiyi-74">&#x800C;&#x5728;<a class="reference internal" href="orm_tutorial.html"><span>Object Relational Tutorial</span></a>&#x4E2D;&#x5F15;&#x5165;&#x7684;ORM&#x5448;&#x73B0;&#x9AD8;&#x5C42;&#x6B21;&#x548C;&#x62BD;&#x8C61;&#x7684;&#x4F7F;&#x7528;&#x6A21;&#x5F0F;&#xFF0C;&#x8FD9;&#x672C;&#x8EAB;&#x5C31;&#x662F;&#x8868;&#x8FBE;&#x5F0F;&#x8BED;&#x8A00;&#x7684;&#x5E94;&#x7528;&#x4F7F;&#x7528;&#x7684;&#x4E00;&#x4E2A;&#x4F8B;&#x5B50;&#xFF0C;&#x8868;&#x8FBE;&#x5F0F;&#x8BED;&#x8A00;&#x63D0;&#x4F9B;&#x4E86;&#x4E00;&#x4E2A;&#x8868;&#x793A;&#x57FA;&#x5143;&#x5173;&#x7CFB;&#x6570;&#x636E;&#x5E93;&#x7684;&#x6784;&#x9020;&#x76F4;&#x63A5;&#x6CA1;&#x6709;&#x610F;&#x89C1;&#x3002;</span></p><p><span class="yiyi-st" id="yiyi-75">&#x867D;&#x7136;ORM&#x548C;&#x8868;&#x8FBE;&#x5F0F;&#x8BED;&#x8A00;&#x7684;&#x4F7F;&#x7528;&#x6A21;&#x5F0F;&#x4E4B;&#x95F4;&#x5B58;&#x5728;&#x91CD;&#x53E0;&#xFF0C;&#x4F46;&#x5B83;&#x4EEC;&#x7684;&#x76F8;&#x4F3C;&#x4E4B;&#x5904;&#x5374;&#x6BD4;&#x6700;&#x521D;&#x51FA;&#x73B0;&#x65F6;&#x66F4;&#x4E3A;&#x80A4;&#x6D45;&#x3002;</span><span class="yiyi-st" id="yiyi-76">&#x4E00;&#x4E2A;&#x4ECE;&#x7528;&#x6237;&#x5B9A;&#x4E49;&#x7684;<a class="reference external" href="http://en.wikipedia.org/wiki/Domain_model">&#x57DF;&#x6A21;&#x578B;</a>&#x7684;&#x89D2;&#x5EA6;&#x63A5;&#x8FD1;&#x6570;&#x636E;&#x7684;&#x7ED3;&#x6784;&#x548C;&#x5185;&#x5BB9;&#xFF0C;&#x8BE5;&#x6A21;&#x578B;&#x900F;&#x660E;&#x5730;&#x4ECE;&#x5176;&#x5E95;&#x5C42;&#x5B58;&#x50A8;&#x6A21;&#x578B;&#x4E2D;&#x6301;&#x4E45;&#x4FDD;&#x7559;&#x5E76;&#x5237;&#x65B0;&#x3002;</span><span class="yiyi-st" id="yiyi-77">&#x53E6;&#x4E00;&#x79CD;&#x65B9;&#x6CD5;&#x4ECE;&#x6587;&#x5B57;&#x6A21;&#x5F0F;&#x548C;SQL&#x8868;&#x8FBE;&#x5F0F;&#x8868;&#x8FBE;&#x5F0F;&#x7684;&#x89D2;&#x5EA6;&#x6765;&#x770B;&#xFF0C;&#x5B83;&#x4EEC;&#x88AB;&#x663E;&#x5F0F;&#x5730;&#x7EC4;&#x5408;&#x6210;&#x6570;&#x636E;&#x5E93;&#x5355;&#x72EC;&#x6D88;&#x8D39;&#x7684;&#x6D88;&#x606F;&#x3002;</span></p><p><span class="yiyi-st" id="yiyi-78">&#x867D;&#x7136;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x9700;&#x8981;&#x5B9A;&#x4E49;&#x81EA;&#x5DF1;&#x7684;&#x7CFB;&#x7EDF;&#xFF0C;&#x5C06;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x6982;&#x5FF5;&#x8F6C;&#x6362;&#x4E3A;&#x5355;&#x72EC;&#x7684;&#x6570;&#x636E;&#x5E93;&#x6D88;&#x606F;&#x548C;&#x5355;&#x4E2A;&#x6570;&#x636E;&#x5E93;&#x7ED3;&#x679C;&#x96C6;&#xFF0C;&#x4F46;&#x662F;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;&#x8868;&#x8FBE;&#x5F0F;&#x8BED;&#x8A00;&#x4E13;&#x95E8;&#x6784;&#x5EFA;&#x6210;&#x529F;&#x7684;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x3002;</span><span class="yiyi-st" id="yiyi-79">&#x6216;&#x8005;&#xFF0C;&#x4F7F;&#x7528;ORM&#x6784;&#x5EFA;&#x7684;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x53EF;&#x4EE5;&#x5728;&#x9AD8;&#x7EA7;&#x65B9;&#x6848;&#x4E2D;&#x76F4;&#x63A5;&#x5728;&#x9700;&#x8981;&#x7279;&#x5B9A;&#x6570;&#x636E;&#x5E93;&#x4EA4;&#x4E92;&#x7684;&#x7279;&#x5B9A;&#x533A;&#x57DF;&#x4E2D;&#x5076;&#x5C14;&#x4F7F;&#x7528;&#x8868;&#x8FBE;&#x5F0F;&#x8BED;&#x8A00;&#x3002;</span></p><p><span class="yiyi-st" id="yiyi-80">The following tutorial is in doctest format, meaning each <code class="docutils literal"><span class="pre">&gt;&gt;&gt;</span></code> line represents something you can type at a Python command prompt, and the following text represents the expected return value.</span><span class="yiyi-st" id="yiyi-81">&#x672C;&#x6559;&#x7A0B;&#x6CA1;&#x6709;&#x5148;&#x51B3;&#x6761;&#x4EF6;&#x3002;</span></p><div class="section" id="version-check"><h2><span class="yiyi-st" id="yiyi-82">&#x7248;&#x672C;&#x68C0;&#x67E5;<a class="headerlink" href="#version-check" title="Permalink to this headline">&#xB6;</a></span></h2><p><span class="yiyi-st" id="yiyi-83">&#x5FEB;&#x901F;&#x68C0;&#x67E5;&#x4EE5;&#x786E;&#x8BA4;&#x6211;&#x4EEC;&#x81F3;&#x5C11;&#x5904;&#x4E8E;SQLAlchemy&#x7684;<strong>&#x7248;&#x672C;1.1</strong>&#xFF1A;</span></p><div class="highlight-pycon+sql"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">sqlalchemy</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sqlalchemy</span><span class="o">.</span><span class="n">__version__</span>  <span class="c1"># doctest: +SKIP</span>
<span class="go">1.1.0</span></pre></div></div></div><div class="section" id="connecting"><h2><span class="yiyi-st" id="yiyi-84">&#x8FDE;&#x63A5;<a class="headerlink" href="#connecting" title="Permalink to this headline">&#xB6; T0&gt;</a></span></h2><p><span class="yiyi-st" id="yiyi-85">&#x5BF9;&#x4E8E;&#x672C;&#x6559;&#x7A0B;&#xFF0C;&#x6211;&#x4EEC;&#x5C06;&#x4F7F;&#x7528;&#x4E00;&#x4E2A;&#x4EC5;&#x5185;&#x5B58;&#x7684;SQLite&#x6570;&#x636E;&#x5E93;&#x3002;</span><span class="yiyi-st" id="yiyi-86">&#x8FD9;&#x662F;&#x4E00;&#x79CD;&#x7B80;&#x5355;&#x7684;&#x6D4B;&#x8BD5;&#x65B9;&#x6CD5;&#xFF0C;&#x65E0;&#x9700;&#x5728;&#x4EFB;&#x4F55;&#x5730;&#x65B9;&#x5B9A;&#x4E49;&#x5B9E;&#x9645;&#x7684;&#x6570;&#x636E;&#x5E93;&#x3002;</span><span class="yiyi-st" id="yiyi-87">&#x8981;&#x8FDE;&#x63A5;&#xFF0C;&#x6211;&#x4EEC;&#x4F7F;&#x7528;<a class="reference internal" href="engines.html#sqlalchemy.create_engine" title="sqlalchemy.create_engine"><code class="xref py py-func docutils literal"><span class="pre">create_engine()</span></code></a>&#xFF1A;</span></p><div class="highlight-pycon+sql"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sqlalchemy</span> <span class="kn">import</span> <span class="n">create_engine</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">engine</span> <span class="o">=</span> <span class="n">create_engine</span><span class="p">(</span><span class="s1">&apos;sqlite:///:memory:&apos;</span><span class="p">,</span> <span class="n">echo</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span></pre></div></div><p><span class="yiyi-st" id="yiyi-88"><code class="docutils literal"><span class="pre">echo</span></code>&#x6807;&#x5FD7;&#x662F;&#x8BBE;&#x7F6E;SQLAlchemy&#x65E5;&#x5FD7;&#x8BB0;&#x5F55;&#x7684;&#x5FEB;&#x6377;&#x65B9;&#x5F0F;&#xFF0C;&#x5B83;&#x662F;&#x901A;&#x8FC7;Python&#x7684;&#x6807;&#x51C6;<code class="docutils literal"><span class="pre">&#x65E5;&#x5FD7;</span></code>&#x6A21;&#x5757;&#x5B8C;&#x6210;&#x7684;&#x3002;</span><span class="yiyi-st" id="yiyi-89">&#x542F;&#x7528;&#x5B83;&#xFF0C;&#x6211;&#x4EEC;&#x5C06;&#x770B;&#x5230;&#x751F;&#x6210;&#x7684;&#x6240;&#x6709;SQL&#x3002;</span><span class="yiyi-st" id="yiyi-90">&#x5982;&#x679C;&#x60A8;&#x6B63;&#x5728;&#x5B66;&#x4E60;&#x672C;&#x6559;&#x7A0B;&#x5E76;&#x5E0C;&#x671B;&#x4EA7;&#x751F;&#x66F4;&#x5C11;&#x7684;&#x8F93;&#x51FA;&#xFF0C;&#x8BF7;&#x5C06;&#x5176;&#x8BBE;&#x7F6E;&#x4E3A;<code class="docutils literal"><span class="pre">False</span></code>&#x3002;</span><span class="yiyi-st" id="yiyi-91">&#x672C;&#x6559;&#x7A0B;&#x5C06;&#x628A;SQL&#x683C;&#x5F0F;&#x5316;&#x4E3A;&#x4E00;&#x4E2A;&#x5F39;&#x51FA;&#x7A97;&#x53E3;&#xFF0C;&#x6240;&#x4EE5;&#x5B83;&#x4E0D;&#x4F1A;&#x59A8;&#x788D;&#x6211;&#x4EEC;&#xFF1B;&#x53EA;&#x9700;&#x70B9;&#x51FB;&#x201C;SQL&#x201D;&#x94FE;&#x63A5;&#x5373;&#x53EF;&#x67E5;&#x770B;&#x6B63;&#x5728;&#x751F;&#x6210;&#x7684;&#x5185;&#x5BB9;&#x3002;</span></p><p><span class="yiyi-st" id="yiyi-92"><a class="reference internal" href="engines.html#sqlalchemy.create_engine" title="sqlalchemy.create_engine"><code class="xref py py-func docutils literal"><span class="pre">create_engine()</span></code></a>&#x7684;&#x8FD4;&#x56DE;&#x503C;&#x662F;<a class="reference internal" href="connections.html#sqlalchemy.engine.Engine" title="sqlalchemy.engine.Engine"><code class="xref py py-class docutils literal"><span class="pre">Engine</span></code></a>&#x7684;&#x4E00;&#x4E2A;&#x5B9E;&#x4F8B;&#xFF0C;&#x5B83;&#x8868;&#x793A;&#x6570;&#x636E;&#x5E93;&#x7684;&#x6838;&#x5FC3;&#x63A5;&#x53E3;&#xFF0C;&#x901A;&#x8FC7;&#x5904;&#x7406;<span class="xref std std-term">&#x65B9;&#x8A00;</span>&#x6570;&#x636E;&#x5E93;&#x548C;<a class="reference internal" href="glossary.html#term-dbapi"><span class="xref std std-term">DBAPI</span></a>&#x7684;&#x4F7F;&#x7528;&#x7EC6;&#x8282;&#x3002;</span><span class="yiyi-st" id="yiyi-93">&#x5728;&#x8FD9;&#x79CD;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;SQLite&#x65B9;&#x8A00;&#x5C06;&#x5411;Python&#x5185;&#x7F6E;&#x7684;<code class="docutils literal"><span class="pre">sqlite3</span></code>&#x6A21;&#x5757;&#x89E3;&#x91CA;&#x6307;&#x4EE4;&#x3002;</span></p><div class="sidebar"><p class="first sidebar-title"><span class="yiyi-st" id="yiyi-94">&#x61D2;&#x60F0;&#x8FDE;&#x63A5;</span></p><p class="last"><span class="yiyi-st" id="yiyi-95">&#x5F53;<a class="reference internal" href="engines.html#sqlalchemy.create_engine" title="sqlalchemy.create_engine"><code class="xref py py-func docutils literal"><span class="pre">create_engine()</span></code></a>&#x9996;&#x6B21;&#x8FD4;&#x56DE;&#x65F6;&#xFF0C;<a class="reference internal" href="connections.html#sqlalchemy.engine.Engine" title="sqlalchemy.engine.Engine"><code class="xref py py-class docutils literal"><span class="pre">Engine</span></code></a>&#x5C1A;&#x672A;&#x5C1D;&#x8BD5;&#x8FDE;&#x63A5;&#x5230;&#x6570;&#x636E;&#x5E93;&#xFF1B;&#x8FD9;&#x53EA;&#x4F1A;&#x5728;&#x7B2C;&#x4E00;&#x6B21;&#x88AB;&#x8981;&#x6C42;&#x5BF9;&#x6570;&#x636E;&#x5E93;&#x6267;&#x884C;&#x4EFB;&#x52A1;&#x65F6;&#x53D1;&#x751F;&#x3002;</span></p></div><p><span class="yiyi-st" id="yiyi-96">The first time a method like <a class="reference internal" href="connections.html#sqlalchemy.engine.Engine.execute" title="sqlalchemy.engine.Engine.execute"><code class="xref py py-meth docutils literal"><span class="pre">Engine.execute()</span></code></a> or <a class="reference internal" href="connections.html#sqlalchemy.engine.Engine.connect" title="sqlalchemy.engine.Engine.connect"><code class="xref py py-meth docutils literal"><span class="pre">Engine.connect()</span></code></a> is called, the <a class="reference internal" href="connections.html#sqlalchemy.engine.Engine" title="sqlalchemy.engine.Engine"><code class="xref py py-class docutils literal"><span class="pre">Engine</span></code></a> establishes a real <a class="reference internal" href="glossary.html#term-dbapi"><span class="xref std std-term">DBAPI</span></a> connection to the database, which is then used to emit the SQL.</span></p><div class="admonition seealso"><p class="first admonition-title"><span class="yiyi-st" id="yiyi-97">&#x4E5F;&#x53EF;&#x4EE5;&#x770B;&#x770B;</span></p><p class="last"><span class="yiyi-st" id="yiyi-98"><a class="reference internal" href="engines.html#database-urls"><span>Database Urls</span></a>  - &#x5305;&#x542B;&#x8FDE;&#x63A5;&#x5230;&#x591A;&#x79CD;&#x6570;&#x636E;&#x5E93;&#x7684;<a class="reference internal" href="engines.html#sqlalchemy.create_engine" title="sqlalchemy.create_engine"><code class="xref py py-func docutils literal"><span class="pre">create_engine()</span></code></a>&#x793A;&#x4F8B;&#xFF0C;&#x5176;&#x4E2D;&#x5305;&#x542B;&#x66F4;&#x591A;&#x4FE1;&#x606F;&#x7684;&#x94FE;&#x63A5;&#x3002;</span></p></div></div><div class="section" id="define-and-create-tables"><h2><span class="yiyi-st" id="yiyi-99">&#x5B9A;&#x4E49;&#x548C;&#x521B;&#x5EFA;&#x8868;&#x683C;<a class="headerlink" href="#define-and-create-tables" title="Permalink to this headline">&#xB6;</a></span></h2><p><span class="yiyi-st" id="yiyi-100">SQL&#x8868;&#x8FBE;&#x5F0F;&#x8BED;&#x8A00;&#x5728;&#x5927;&#x591A;&#x6570;&#x60C5;&#x51B5;&#x4E0B;&#x9488;&#x5BF9;&#x8868;&#x5217;&#x6784;&#x9020;&#x8868;&#x8FBE;&#x5F0F;&#x3002;</span><span class="yiyi-st" id="yiyi-101">&#x5728;SQLAlchemy&#x4E2D;&#xFF0C;&#x4E00;&#x4E2A;&#x5217;&#x901A;&#x5E38;&#x7531;&#x4E00;&#x4E2A;&#x540D;&#x4E3A;<a class="reference internal" href="metadata.html#sqlalchemy.schema.Column" title="sqlalchemy.schema.Column"><code class="xref py py-class docutils literal"><span class="pre">Column</span></code></a>&#x7684;&#x5BF9;&#x8C61;&#x8868;&#x793A;&#xFF0C;&#x5E76;&#x4E14;&#x5728;&#x6240;&#x6709;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;&#x4E00;&#x4E2A;<a class="reference internal" href="metadata.html#sqlalchemy.schema.Column" title="sqlalchemy.schema.Column"><code class="xref py py-class docutils literal"><span class="pre">Column</span></code></a>&#x90FD;&#x4E0E;&#x4E00;&#x4E2A;<a class="reference internal" href="metadata.html#sqlalchemy.schema.Table" title="sqlalchemy.schema.Table"><code class="xref py py-class docutils literal"><span class="pre">Table</span></code></a>&#x5173;&#x8054;&#x3002;</span><span class="yiyi-st" id="yiyi-102"><a class="reference internal" href="metadata.html#sqlalchemy.schema.Table" title="sqlalchemy.schema.Table"><code class="xref py py-class docutils literal"><span class="pre">Table</span></code></a>&#x5BF9;&#x8C61;&#x53CA;&#x5176;&#x5173;&#x8054;&#x7684;&#x5B50;&#x5BF9;&#x8C61;&#x7684;&#x96C6;&#x5408;&#x79F0;&#x4E3A;<strong>&#x6570;&#x636E;&#x5E93;&#x5143;&#x6570;&#x636E;</strong>&#x3002;</span><span class="yiyi-st" id="yiyi-103">&#x5728;&#x672C;&#x6559;&#x7A0B;&#x4E2D;&#xFF0C;&#x6211;&#x4EEC;&#x5C06;&#x660E;&#x786E;&#x5730;&#x5217;&#x51FA;&#x51E0;&#x4E2A;<a class="reference internal" href="metadata.html#sqlalchemy.schema.Table" title="sqlalchemy.schema.Table"><code class="xref py py-class docutils literal"><span class="pre">Table</span></code></a>&#x5BF9;&#x8C61;&#xFF0C;&#x4F46;&#x662F;&#x8BF7;&#x6CE8;&#x610F;&#xFF0C;SA&#x8FD8;&#x53EF;&#x4EE5;&#x4ECE;&#x73B0;&#x6709;&#x6570;&#x636E;&#x5E93;&#x4E2D;&#x81EA;&#x52A8;&#x201C;&#x5BFC;&#x5165;&#x201D;&#x6574;&#x4E2A;<a class="reference internal" href="metadata.html#sqlalchemy.schema.Table" title="sqlalchemy.schema.Table"><code class="xref py py-class docutils literal"><span class="pre">Table</span></code></a>&#x5BF9;&#x8C61;&#x96C6;&#x5408;&#xFF08;&#x6B64;&#x8FC7;&#x7A0B;&#x79F0;&#x4E3A;<strong>&#x8868;&#x53CD;&#x5C04;</strong>&#xFF09;&#x3002;</span></p><p><span class="yiyi-st" id="yiyi-104">&#x6211;&#x4EEC;&#x4F7F;&#x7528;<a class="reference internal" href="metadata.html#sqlalchemy.schema.Table" title="sqlalchemy.schema.Table"><code class="xref py py-class docutils literal"><span class="pre">Table</span></code></a>&#x7ED3;&#x6784;&#x5C06;&#x6240;&#x6709;&#x8868;&#x5B9A;&#x4E49;&#x5728;&#x540D;&#x4E3A;<a class="reference internal" href="metadata.html#sqlalchemy.schema.MetaData" title="sqlalchemy.schema.MetaData"><code class="xref py py-class docutils literal"><span class="pre">MetaData</span></code></a>&#x7684;&#x76EE;&#x5F55;&#x4E2D;&#xFF0C;&#x7C7B;&#x4F3C;&#x4E8E;&#x5E38;&#x89C4;&#x7684;SQL CREATE TABLE&#x8BED;&#x53E5;&#x3002;</span><span class="yiyi-st" id="yiyi-105">&#x6211;&#x4EEC;&#x5C06;&#x521B;&#x5EFA;&#x4E24;&#x4E2A;&#x8868;&#xFF0C;&#x5176;&#x4E2D;&#x4E00;&#x4E2A;&#x8868;&#x793A;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x4E2D;&#x7684;&#x201C;&#x7528;&#x6237;&#x201D;&#xFF0C;&#x53E6;&#x4E00;&#x4E2A;&#x8868;&#x793A;&#x201C;users&#x201D;&#x8868;&#x4E2D;&#x6BCF;&#x884C;&#x7684;&#x96F6;&#x4E2A;&#x6216;&#x591A;&#x4E2A;&#x201C;&#x7535;&#x5B50;&#x90AE;&#x4EF6;&#x5730;&#x5740;&#x201D;&#xFF1A;</span></p><div class="highlight-pycon+sql"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sqlalchemy</span> <span class="kn">import</span> <span class="n">Table</span><span class="p">,</span> <span class="n">Column</span><span class="p">,</span> <span class="n">Integer</span><span class="p">,</span> <span class="n">String</span><span class="p">,</span> <span class="n">MetaData</span><span class="p">,</span> <span class="n">ForeignKey</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">metadata</span> <span class="o">=</span> <span class="n">MetaData</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">users</span> <span class="o">=</span> <span class="n">Table</span><span class="p">(</span><span class="s1">&apos;users&apos;</span><span class="p">,</span> <span class="n">metadata</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">Column</span><span class="p">(</span><span class="s1">&apos;id&apos;</span><span class="p">,</span> <span class="n">Integer</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="bp">True</span><span class="p">),</span>
<span class="gp">... </span>    <span class="n">Column</span><span class="p">(</span><span class="s1">&apos;name&apos;</span><span class="p">,</span> <span class="n">String</span><span class="p">),</span>
<span class="gp">... </span>    <span class="n">Column</span><span class="p">(</span><span class="s1">&apos;fullname&apos;</span><span class="p">,</span> <span class="n">String</span><span class="p">),</span>
<span class="gp">... </span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">addresses</span> <span class="o">=</span> <span class="n">Table</span><span class="p">(</span><span class="s1">&apos;addresses&apos;</span><span class="p">,</span> <span class="n">metadata</span><span class="p">,</span>
<span class="gp">... </span>  <span class="n">Column</span><span class="p">(</span><span class="s1">&apos;id&apos;</span><span class="p">,</span> <span class="n">Integer</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="bp">True</span><span class="p">),</span>
<span class="gp">... </span>  <span class="n">Column</span><span class="p">(</span><span class="s1">&apos;user_id&apos;</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="n">ForeignKey</span><span class="p">(</span><span class="s1">&apos;users.id&apos;</span><span class="p">)),</span>
<span class="gp">... </span>  <span class="n">Column</span><span class="p">(</span><span class="s1">&apos;email_address&apos;</span><span class="p">,</span> <span class="n">String</span><span class="p">,</span> <span class="n">nullable</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="gp">... </span> <span class="p">)</span></pre></div></div><p><span class="yiyi-st" id="yiyi-106">&#x6240;&#x6709;&#x5173;&#x4E8E;&#x5982;&#x4F55;&#x5B9A;&#x4E49;<a class="reference internal" href="metadata.html#sqlalchemy.schema.Table" title="sqlalchemy.schema.Table"><code class="xref py py-class docutils literal"><span class="pre">Table</span></code></a>&#x5BF9;&#x8C61;&#x4EE5;&#x53CA;&#x5982;&#x4F55;&#x4ECE;&#x73B0;&#x6709;&#x6570;&#x636E;&#x5E93;&#x81EA;&#x52A8;&#x521B;&#x5EFA;&#x5B83;&#x4EEC;&#x7684;&#x63CF;&#x8FF0;&#x5728;<a class="reference internal" href="metadata.html"><span>Describing Databases with MetaData</span></a>&#x4E2D;&#x63CF;&#x8FF0;&#x3002;</span></p><p><span class="yiyi-st" id="yiyi-107">&#x63A5;&#x4E0B;&#x6765;&#xFF0C;&#x4E3A;&#x4E86;&#x544A;&#x8BC9;<a class="reference internal" href="metadata.html#sqlalchemy.schema.MetaData" title="sqlalchemy.schema.MetaData"><code class="xref py py-class docutils literal"><span class="pre">MetaData</span></code></a>&#xFF0C;&#x6211;&#x4EEC;&#x5B9E;&#x9645;&#x4E0A;&#x5E0C;&#x671B;&#x5728;SQLite&#x6570;&#x636E;&#x5E93;&#x4E2D;&#x521B;&#x5EFA;&#x771F;&#x5B9E;&#x7684;&#x8868;&#x683C;&#x9009;&#x62E9;&#xFF0C;&#x6211;&#x4EEC;&#x4F7F;&#x7528;<a class="reference internal" href="metadata.html#sqlalchemy.schema.MetaData.create_all" title="sqlalchemy.schema.MetaData.create_all"><code class="xref py py-func docutils literal"><span class="pre">create_all()</span></code></a>&#xFF0C;&#x5E76;&#x5C06;<code class="docutils literal"><span class="pre">engine</span></code>&#x5B9E;&#x4F8B;&#x6307;&#x5411;&#x6211;&#x4EEC;&#x7684;&#x6570;&#x636E;&#x5E93;&#x3002;</span><span class="yiyi-st" id="yiyi-108">&#x8FD9;&#x5C06;&#x5728;&#x521B;&#x5EFA;&#x4E4B;&#x524D;&#x68C0;&#x67E5;&#x6BCF;&#x4E2A;&#x8868;&#x7684;&#x5B58;&#x5728;&#x60C5;&#x51B5;&#xFF0C;&#x56E0;&#x6B64;&#x53EF;&#x4EE5;&#x5B89;&#x5168;&#x5730;&#x8C03;&#x7528;&#x591A;&#x6B21;&#xFF1A;</span></p><div class="highlight-pycon+sql"><div class="highlight"><pre><span></span><a class="sql_link" href="#">sql</a><span class="gp">&gt;&gt;&gt; </span><span class="n">metadata</span><span class="o">.</span><span class="n">create_all</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span>
<span class="go">SE...</span>
<div class="popup_sql">CREATE TABLE users (
    id INTEGER NOT NULL,
    name VARCHAR,
    fullname VARCHAR,
    PRIMARY KEY (id)
)
()
COMMIT
CREATE TABLE addresses (
    id INTEGER NOT NULL,
    user_id INTEGER,
    email_address VARCHAR NOT NULL,
    PRIMARY KEY (id),
    FOREIGN KEY(user_id) REFERENCES users (id)
)
()
COMMIT</div></pre></div></div><div class="admonition note"><p class="first admonition-title"><span class="yiyi-st" id="yiyi-109">&#x6CE8;&#x610F;</span></p><p><span class="yiyi-st" id="yiyi-110">&#x719F;&#x6089;CREATE TABLE&#x8BED;&#x6CD5;&#x7684;&#x7528;&#x6237;&#x53EF;&#x80FD;&#x6CE8;&#x610F;&#x5230;VARCHAR&#x5217;&#x7684;&#x751F;&#x6210;&#x6CA1;&#x6709;&#x957F;&#x5EA6;&#xFF1B;&#x5728;SQLite&#x548C;Postgresql&#x4E0A;&#xFF0C;&#x8FD9;&#x662F;&#x4E00;&#x4E2A;&#x6709;&#x6548;&#x7684;&#x6570;&#x636E;&#x7C7B;&#x578B;&#xFF0C;&#x4F46;&#x662F;&#x5728;&#x5176;&#x4ED6;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;&#x5B83;&#x662F;&#x4E0D;&#x5141;&#x8BB8;&#x7684;&#x3002;</span><span class="yiyi-st" id="yiyi-111">&#x56E0;&#x6B64;&#xFF0C;&#x5982;&#x679C;&#x5728;&#x5176;&#x4E2D;&#x4E00;&#x4E2A;&#x6570;&#x636E;&#x5E93;&#x4E0A;&#x8FD0;&#x884C;&#x672C;&#x6559;&#x7A0B;&#xFF0C;&#x5E76;&#x4E14;&#x5E0C;&#x671B;&#x4F7F;&#x7528;SQLAlchemy&#x53D1;&#x51FA;CREATE TABLE&#xFF0C;&#x5219;&#x53EF;&#x4EE5;&#x4E3A;<a class="reference internal" href="type_basics.html#sqlalchemy.types.String" title="sqlalchemy.types.String"><code class="xref py py-class docutils literal"><span class="pre">String</span></code></a>&#x7C7B;&#x578B;&#x63D0;&#x4F9B;&#x201C;length&#x201D;&#xFF0C;&#x5982;&#x4E0B;&#x6240;&#x793A;&#xFF1A;</span></p><div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">Column</span><span class="p">(</span><span class="s1">&apos;name&apos;</span><span class="p">,</span> <span class="n">String</span><span class="p">(</span><span class="mi">50</span><span class="p">))</span></pre></div></div><p><span class="yiyi-st" id="yiyi-112"><a class="reference internal" href="type_basics.html#sqlalchemy.types.String" title="sqlalchemy.types.String"><code class="xref py py-class docutils literal"><span class="pre">String</span></code></a>&#x4E0A;&#x7684;&#x957F;&#x5EA6;&#x5B57;&#x6BB5;&#x4EE5;&#x53CA;<a class="reference internal" href="type_basics.html#sqlalchemy.types.Integer" title="sqlalchemy.types.Integer"><code class="xref py py-class docutils literal"><span class="pre">Integer</span></code></a>&#xFF0C;<a class="reference internal" href="type_basics.html#sqlalchemy.types.Numeric" title="sqlalchemy.types.Numeric"><code class="xref py py-class docutils literal"><span class="pre">Numeric</span></code></a>&#x7B49;&#x53EF;&#x7528;&#x7684;&#x7C7B;&#x4F3C;&#x7CBE;&#x5EA6;/&#x7F29;&#x653E;&#x5B57;&#x6BB5;&#x3002;</span><span class="yiyi-st" id="yiyi-113">&#x9664;&#x4E86;&#x521B;&#x5EFA;&#x8868;&#x683C;&#x65F6;&#xFF0C;&#x4E0D;&#x4F1A;&#x88AB;SQLAlchemy&#x5F15;&#x7528;&#x3002;</span></p><p><span class="yiyi-st" id="yiyi-114">&#x6B64;&#x5916;&#xFF0C;Firebird&#x548C;Oracle&#x9700;&#x8981;&#x5E8F;&#x5217;&#x6765;&#x751F;&#x6210;&#x65B0;&#x7684;&#x4E3B;&#x952E;&#x6807;&#x8BC6;&#x7B26;&#xFF0C;&#x5E76;&#x4E14;SQLAlchemy&#x4E0D;&#x4F1A;&#x5728;&#x672A;&#x7ECF;&#x6307;&#x793A;&#x7684;&#x60C5;&#x51B5;&#x4E0B;&#x751F;&#x6210;&#x6216;&#x91C7;&#x7528;&#x8FD9;&#x4E9B;&#x6807;&#x8BC6;&#x7B26;&#x3002;</span><span class="yiyi-st" id="yiyi-115">&#x4E3A;&#x6B64;&#xFF0C;&#x60A8;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;<a class="reference internal" href="defaults.html#sqlalchemy.schema.Sequence" title="sqlalchemy.schema.Sequence"><code class="xref py py-class docutils literal"><span class="pre">Sequence</span></code></a>&#x7ED3;&#x6784;&#xFF1A;</span></p><div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sqlalchemy</span> <span class="kn">import</span> <span class="n">Sequence</span>
<span class="n">Column</span><span class="p">(</span><span class="s1">&apos;id&apos;</span><span class="p">,</span> <span class="n">Integer</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">(</span><span class="s1">&apos;user_id_seq&apos;</span><span class="p">),</span> <span class="n">primary_key</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span></pre></div></div><p><span class="yiyi-st" id="yiyi-116">&#x4E00;&#x4E2A;&#x5B8C;&#x6574;&#x7684;&#xFF0C;&#x4E07;&#x65E0;&#x4E00;&#x5931;&#x7684;<a class="reference internal" href="metadata.html#sqlalchemy.schema.Table" title="sqlalchemy.schema.Table"><code class="xref py py-class docutils literal"><span class="pre">Table</span></code></a>&#x662F;&#xFF1A;</span></p><div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">users</span> <span class="o">=</span> <span class="n">Table</span><span class="p">(</span><span class="s1">&apos;users&apos;</span><span class="p">,</span> <span class="n">metadata</span><span class="p">,</span>
   <span class="n">Column</span><span class="p">(</span><span class="s1">&apos;id&apos;</span><span class="p">,</span> <span class="n">Integer</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">(</span><span class="s1">&apos;user_id_seq&apos;</span><span class="p">),</span> <span class="n">primary_key</span><span class="o">=</span><span class="bp">True</span><span class="p">),</span>
   <span class="n">Column</span><span class="p">(</span><span class="s1">&apos;name&apos;</span><span class="p">,</span> <span class="n">String</span><span class="p">(</span><span class="mi">50</span><span class="p">)),</span>
   <span class="n">Column</span><span class="p">(</span><span class="s1">&apos;fullname&apos;</span><span class="p">,</span> <span class="n">String</span><span class="p">(</span><span class="mi">50</span><span class="p">)),</span>
   <span class="n">Column</span><span class="p">(</span><span class="s1">&apos;password&apos;</span><span class="p">,</span> <span class="n">String</span><span class="p">(</span><span class="mi">12</span><span class="p">))</span>
<span class="p">)</span></pre></div></div><p class="last"><span class="yiyi-st" id="yiyi-117">&#x6211;&#x4EEC;&#x5206;&#x522B;&#x5305;&#x542B;&#x8FD9;&#x4E2A;&#x66F4;&#x8BE6;&#x7EC6;&#x7684;<a class="reference internal" href="metadata.html#sqlalchemy.schema.Table" title="sqlalchemy.schema.Table"><code class="xref py py-class docutils literal"><span class="pre">Table</span></code></a>&#x6784;&#x9020;&#xFF0C;&#x4EE5;&#x7A81;&#x51FA;&#x663E;&#x793A;&#x4E3B;&#x8981;&#x9488;&#x5BF9;Python&#x5185;&#x4F7F;&#x7528;&#x7684;&#x6700;&#x5C0F;&#x6784;&#x9020;&#x4E0E;&#x5C06;&#x7528;&#x4E8E;&#x5728;&#x7279;&#x5B9A;&#x7684;&#x540E;&#x7AEF;&#x4E0A;&#x53D1;&#x51FA;CREATE TABLE&#x8BED;&#x53E5;&#x7684;&#x6784;&#x9020;&#x4E4B;&#x95F4;&#x7684;&#x533A;&#x522B;&#x66F4;&#x4E25;&#x683C;&#x7684;&#x8981;&#x6C42;&#x3002;</span></p></div></div><div class="section" id="insert-expressions"><h2><span class="yiyi-st" id="yiyi-118">&#x63D2;&#x5165;&#x8868;&#x8FBE;&#x5F0F;<a class="headerlink" href="#insert-expressions" title="Permalink to this headline">&#xB6;</a></span></h2><p><span class="yiyi-st" id="yiyi-119">&#x6211;&#x4EEC;&#x8981;&#x521B;&#x5EFA;&#x7684;&#x7B2C;&#x4E00;&#x4E2A;SQL&#x8868;&#x8FBE;&#x5F0F;&#x662F;<a class="reference internal" href="dml.html#sqlalchemy.sql.expression.Insert" title="sqlalchemy.sql.expression.Insert"><code class="xref py py-class docutils literal"><span class="pre">Insert</span></code></a>&#x7ED3;&#x6784;&#xFF0C;&#x5B83;&#x8868;&#x793A;&#x4E00;&#x4E2A;INSERT&#x8BED;&#x53E5;&#x3002;</span><span class="yiyi-st" id="yiyi-120">&#x8FD9;&#x901A;&#x5E38;&#x662F;&#x76F8;&#x5BF9;&#x4E8E;&#x5176;&#x76EE;&#x6807;&#x8868;&#x521B;&#x5EFA;&#x7684;&#xFF1A;</span></p><div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ins</span> <span class="o">=</span> <span class="n">users</span><span class="o">.</span><span class="n">insert</span><span class="p">()</span></pre></div></div><p><span class="yiyi-st" id="yiyi-121">&#x8981;&#x67E5;&#x770B;&#x6B64;&#x6784;&#x9020;&#x4EA7;&#x751F;&#x7684;SQL&#x6837;&#x672C;&#xFF0C;&#x200B;&#x200B;&#x8BF7;&#x4F7F;&#x7528;<code class="docutils literal"><span class="pre">str()</span></code>&#x51FD;&#x6570;&#xFF1A;</span></p><div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">str</span><span class="p">(</span><span class="n">ins</span><span class="p">)</span>
<span class="go">&apos;INSERT INTO users (id, name, fullname) VALUES (:id, :name, :fullname)&apos;</span></pre></div></div><p><span class="yiyi-st" id="yiyi-122">&#x8BF7;&#x6CE8;&#x610F;&#xFF0C;INSERT&#x8BED;&#x53E5;&#x4E3A;<code class="docutils literal"><span class="pre">users</span></code>&#x8868;&#x4E2D;&#x7684;&#x6BCF;&#x4E2A;&#x5217;&#x547D;&#x540D;&#x3002;</span><span class="yiyi-st" id="yiyi-123">&#x8FD9;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x4F7F;&#x7528;<code class="docutils literal"><span class="pre">values()</span></code>&#x65B9;&#x6CD5;&#x6765;&#x9650;&#x5236;&#xFF0C;&#x8BE5;&#x65B9;&#x6CD5;&#x663E;&#x5F0F;&#x5730;&#x5EFA;&#x7ACB;INSERT&#x7684;VALUES&#x5B50;&#x53E5;&#xFF1A;</span></p><div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ins</span> <span class="o">=</span> <span class="n">users</span><span class="o">.</span><span class="n">insert</span><span class="p">()</span><span class="o">.</span><span class="n">values</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&apos;jack&apos;</span><span class="p">,</span> <span class="n">fullname</span><span class="o">=</span><span class="s1">&apos;Jack Jones&apos;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">str</span><span class="p">(</span><span class="n">ins</span><span class="p">)</span>
<span class="go">&apos;INSERT INTO users (name, fullname) VALUES (:name, :fullname)&apos;</span></pre></div></div><p><span class="yiyi-st" id="yiyi-124">&#x4E0A;&#x9762;&#xFF0C;&#x867D;&#x7136;<code class="docutils literal"><span class="pre">values</span></code>&#x65B9;&#x6CD5;&#x5C06;VALUES&#x5B50;&#x53E5;&#x9650;&#x5236;&#x4E3A;&#x4E24;&#x5217;&#xFF0C;&#x4F46;&#x6211;&#x4EEC;&#x653E;&#x7F6E;&#x5728;<code class="docutils literal"><span class="pre">values</span></code>&#x4E2D;&#x7684;&#x5B9E;&#x9645;&#x6570;&#x636E;&#x672A;&#x5448;&#x73B0;&#x5230;&#x5B57;&#x7B26;&#x4E32;&#x4E2D;&#xFF1B;&#x76F8;&#x53CD;&#xFF0C;&#x6211;&#x4EEC;&#x5F97;&#x5230;&#x4E86;&#x547D;&#x540D;&#x7ED1;&#x5B9A;&#x53C2;&#x6570;</span><span class="yiyi-st" id="yiyi-125">As it turns out, our data <em>is</em> stored within our <a class="reference internal" href="dml.html#sqlalchemy.sql.expression.Insert" title="sqlalchemy.sql.expression.Insert"><code class="xref py py-class docutils literal"><span class="pre">Insert</span></code></a> construct, but it typically only comes out when the statement is actually executed; since the data consists of literal values, SQLAlchemy automatically generates bind parameters for them. </span><span class="yiyi-st" id="yiyi-126">&#x6211;&#x4EEC;&#x73B0;&#x5728;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x67E5;&#x770B;&#x58F0;&#x660E;&#x7684;&#x7F16;&#x8BD1;&#x5F62;&#x5F0F;&#x6765;&#x67E5;&#x770B;&#x8FD9;&#x4E9B;&#x6570;&#x636E;&#xFF1A;</span></p><div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ins</span><span class="o">.</span><span class="n">compile</span><span class="p">()</span><span class="o">.</span><span class="n">params</span>  
<span class="go">{&apos;fullname&apos;: &apos;Jack Jones&apos;, &apos;name&apos;: &apos;jack&apos;}</span></pre></div></div></div><div class="section" id="executing"><h2><span class="yiyi-st" id="yiyi-127">&#x6267;&#x884C;<a class="headerlink" href="#executing" title="Permalink to this headline">&#xB6; T0&gt;</a></span></h2><p><span class="yiyi-st" id="yiyi-128"><a class="reference internal" href="dml.html#sqlalchemy.sql.expression.Insert" title="sqlalchemy.sql.expression.Insert"><code class="xref py py-class docutils literal"><span class="pre">Insert</span></code></a>&#x7684;&#x6709;&#x8DA3;&#x90E8;&#x5206;&#x6B63;&#x5728;&#x6267;&#x884C;&#x5B83;&#x3002;</span><span class="yiyi-st" id="yiyi-129">&#x5728;&#x672C;&#x6559;&#x7A0B;&#x4E2D;&#xFF0C;&#x6211;&#x4EEC;&#x5C06;&#x4E3B;&#x8981;&#x5173;&#x6CE8;&#x6267;&#x884C;SQL&#x6784;&#x9020;&#x7684;&#x6700;&#x660E;&#x786E;&#x7684;&#x65B9;&#x6CD5;&#xFF0C;&#x5E76;&#x7A0D;&#x540E;&#x4ECB;&#x7ECD;&#x4E00;&#x4E9B;&#x201C;&#x5FEB;&#x6377;&#x65B9;&#x5F0F;&#x201D;&#x3002;</span><span class="yiyi-st" id="yiyi-130">&#x6211;&#x4EEC;&#x521B;&#x5EFA;&#x7684;<code class="docutils literal"><span class="pre">engine</span></code>&#x5BF9;&#x8C61;&#x662F;&#x4E00;&#x4E2A;&#x80FD;&#x591F;&#x5411;&#x6570;&#x636E;&#x5E93;&#x53D1;&#x51FA;SQL&#x7684;&#x6570;&#x636E;&#x5E93;&#x8FDE;&#x63A5;&#x7684;&#x5B58;&#x50A8;&#x5E93;&#x3002;</span><span class="yiyi-st" id="yiyi-131">&#x8981;&#x83B7;&#x53D6;&#x8FDE;&#x63A5;&#xFF0C;&#x6211;&#x4EEC;&#x4F7F;&#x7528;<code class="docutils literal"><span class="pre">connect()</span></code>&#x65B9;&#x6CD5;&#xFF1A;</span></p><div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">conn</span> <span class="o">=</span> <span class="n">engine</span><span class="o">.</span><span class="n">connect</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">conn</span>
<span class="go">&lt;sqlalchemy.engine.base.Connection object at 0x...&gt;</span></pre></div></div><p><span class="yiyi-st" id="yiyi-132"><a class="reference internal" href="connections.html#sqlalchemy.engine.Connection" title="sqlalchemy.engine.Connection"><code class="xref py py-class docutils literal"><span class="pre">Connection</span></code></a>&#x5BF9;&#x8C61;&#x8868;&#x793A;&#x4E3B;&#x52A8;&#x68C0;&#x51FA;&#x7684;DBAPI&#x8FDE;&#x63A5;&#x8D44;&#x6E90;&#x3002;</span><span class="yiyi-st" id="yiyi-133">&#x8BA9;&#x6211;&#x4EEC;&#x5C06;<a class="reference internal" href="dml.html#sqlalchemy.sql.expression.Insert" title="sqlalchemy.sql.expression.Insert"><code class="xref py py-class docutils literal"><span class="pre">Insert</span></code></a>&#x5BF9;&#x8C61;&#x5E76;&#x770B;&#x770B;&#x4F1A;&#x53D1;&#x751F;&#x4EC0;&#x4E48;&#xFF1A;</span></p><div class="highlight-pycon+sql"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">conn</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">ins</span><span class="p">)</span>
<div class="show_sql">INSERT INTO users (name, fullname) VALUES (?, ?)
(&apos;jack&apos;, &apos;Jack Jones&apos;)
COMMIT</div></pre></div></div><p><span class="yiyi-st" id="yiyi-134">&#x6240;&#x4EE5;INSERT&#x8BED;&#x53E5;&#x73B0;&#x5728;&#x53D1;&#x5E03;&#x5230;&#x6570;&#x636E;&#x5E93;&#x4E2D;&#x3002;</span><span class="yiyi-st" id="yiyi-135">&#x5C3D;&#x7BA1;&#x6211;&#x4EEC;&#x5728;&#x8F93;&#x51FA;&#x4E2D;&#x83B7;&#x5F97;&#x4E86;&#x4F4D;&#x7F6E;&#x201C;qmark&#x201D;&#x7ED1;&#x5B9A;&#x53C2;&#x6570;&#xFF0C;&#x800C;&#x4E0D;&#x662F;&#x201C;&#x547D;&#x540D;&#x7684;&#x201D;&#x7ED1;&#x5B9A;&#x53C2;&#x6570;&#x3002;</span><span class="yiyi-st" id="yiyi-136">&#x600E;&#x4E48;&#x6765;&#x7684; &#xFF1F;</span><span class="yiyi-st" id="yiyi-137">&#x56E0;&#x4E3A;&#x6267;&#x884C;&#x65F6;&#xFF0C;<a class="reference internal" href="connections.html#sqlalchemy.engine.Connection" title="sqlalchemy.engine.Connection"><code class="xref py py-class docutils literal"><span class="pre">Connection</span></code></a>&#x4F7F;&#x7528;SQLite <strong>&#x65B9;&#x8A00;</strong>&#x6765;&#x5E2E;&#x52A9;&#x751F;&#x6210;&#x8BED;&#x53E5;&#xFF1B;&#x5F53;&#x6211;&#x4EEC;&#x4F7F;&#x7528;<code class="docutils literal"><span class="pre">str()</span></code>&#x51FD;&#x6570;&#x65F6;&#xFF0C;&#x8BED;&#x53E5;&#x4E0D;&#x77E5;&#x9053;&#x8FD9;&#x4E2A;&#x65B9;&#x8A00;&#xFF0C;&#x5E76;&#x56DE;&#x5230;&#x4F7F;&#x7528;&#x547D;&#x540D;&#x53C2;&#x6570;&#x7684;&#x9ED8;&#x8BA4;&#x503C;&#x3002;</span><span class="yiyi-st" id="yiyi-138">&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x624B;&#x52A8;&#x67E5;&#x770B;&#xFF0C;&#x5982;&#x4E0B;&#x6240;&#x793A;&#xFF1A;</span></p><div class="highlight-pycon+sql"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ins</span><span class="o">.</span><span class="n">bind</span> <span class="o">=</span> <span class="n">engine</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">str</span><span class="p">(</span><span class="n">ins</span><span class="p">)</span>
<span class="go">&apos;INSERT INTO users (name, fullname) VALUES (?, ?)&apos;</span></pre></div></div><p><span class="yiyi-st" id="yiyi-139">&#x5F53;&#x6211;&#x4EEC;&#x8C03;&#x7528;<code class="docutils literal"><span class="pre">execute()</span></code>&#x65F6;&#xFF0C;&#x6211;&#x4EEC;&#x5F97;&#x5230;&#x7684;<code class="docutils literal"><span class="pre">result</span></code>&#x53D8;&#x91CF;&#x200B;&#x200B;&#x600E;&#x4E48;&#x6837;&#xFF1F;</span><span class="yiyi-st" id="yiyi-140">&#x7531;&#x4E8E;SQLAlchemy <a class="reference internal" href="connections.html#sqlalchemy.engine.Connection" title="sqlalchemy.engine.Connection"><code class="xref py py-class docutils literal"><span class="pre">Connection</span></code></a>&#x5BF9;&#x8C61;&#x5F15;&#x7528;&#x4E86;DBAPI&#x8FDE;&#x63A5;&#xFF0C;&#x56E0;&#x6B64;&#x79F0;&#x4E3A;<a class="reference internal" href="connections.html#sqlalchemy.engine.ResultProxy" title="sqlalchemy.engine.ResultProxy"><code class="xref py py-class docutils literal"><span class="pre">ResultProxy</span></code></a>&#x5BF9;&#x8C61;&#x7684;&#x7ED3;&#x679C;&#x4E0E;DBAPI&#x6E38;&#x6807;&#x5BF9;&#x8C61;&#x7C7B;&#x4F3C;&#x3002;</span><span class="yiyi-st" id="yiyi-141">&#x5728;INSERT&#x7684;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x4ECE;&#x4E2D;&#x83B7;&#x53D6;&#x91CD;&#x8981;&#x4FE1;&#x606F;&#xFF0C;&#x4F8B;&#x5982;&#x4F7F;&#x7528;<a class="reference internal" href="connections.html#sqlalchemy.engine.ResultProxy.inserted_primary_key" title="sqlalchemy.engine.ResultProxy.inserted_primary_key"><code class="xref py py-attr docutils literal"><span class="pre">ResultProxy.inserted_primary_key</span></code></a>&#x4ECE;&#x6211;&#x4EEC;&#x7684;&#x8BED;&#x53E5;&#x4E2D;&#x751F;&#x6210;&#x7684;&#x4E3B;&#x952E;&#x503C;&#xFF1A;</span></p><div class="highlight-pycon+sql"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">result</span><span class="o">.</span><span class="n">inserted_primary_key</span>
<span class="go">[1]</span></pre></div></div><p><span class="yiyi-st" id="yiyi-142">SQLite&#x81EA;&#x52A8;&#x751F;&#x6210;<code class="docutils literal"><span class="pre">1</span></code>&#x7684;&#x503C;&#xFF0C;&#x4F46;&#x4EC5;&#x4EC5;&#x662F;&#x56E0;&#x4E3A;&#x6211;&#x4EEC;&#x6CA1;&#x6709;&#x5728;&#x6211;&#x4EEC;&#x7684;<a class="reference internal" href="dml.html#sqlalchemy.sql.expression.Insert" title="sqlalchemy.sql.expression.Insert"><code class="xref py py-class docutils literal"><span class="pre">Insert</span></code></a>&#x8BED;&#x53E5;&#x4E2D;&#x6307;&#x5B9A;<code class="docutils literal"><span class="pre">id</span></code>&#x5217;&#xFF1B;&#x5426;&#x5219;&#xFF0C;&#x6211;&#x4EEC;&#x7684;&#x663E;&#x6027;&#x4EF7;&#x503C;&#x5C06;&#x88AB;&#x4F7F;&#x7528;&#x3002;</span><span class="yiyi-st" id="yiyi-143">In either case, SQLAlchemy always knows how to get at a newly generated primary key value, even though the method of generating them is different across different databases; each database&#x2019;s <a class="reference internal" href="internals.html#sqlalchemy.engine.interfaces.Dialect" title="sqlalchemy.engine.interfaces.Dialect"><code class="xref py py-class docutils literal"><span class="pre">Dialect</span></code></a> knows the specific steps needed to determine the correct value (or values; note that <a class="reference internal" href="connections.html#sqlalchemy.engine.ResultProxy.inserted_primary_key" title="sqlalchemy.engine.ResultProxy.inserted_primary_key"><code class="xref py py-attr docutils literal"><span class="pre">ResultProxy.inserted_primary_key</span></code></a> returns a list so that it supports composite primary keys). </span><span class="yiyi-st" id="yiyi-144">&#x8FD9;&#x91CC;&#x7684;&#x65B9;&#x6CD5;&#x5305;&#x62EC;&#x4F7F;&#x7528;<code class="docutils literal"><span class="pre">cursor.lastrowid</span></code>&#xFF0C;&#x4ECE;&#x6570;&#x636E;&#x5E93;&#x7279;&#x5B9A;&#x7684;&#x51FD;&#x6570;&#x4E2D;&#x9009;&#x62E9;&#xFF0C;&#x4F7F;&#x7528;<code class="docutils literal"><span class="pre">INSERT..RETURNING</span></code>&#x8BED;&#x6CD5;&#xFF1B;&#x8FD9;&#x4E00;&#x5207;&#x90FD;&#x662F;&#x900F;&#x660E;&#x7684;&#x3002;</span></p></div><div class="section" id="executing-multiple-statements"><h2><span class="yiyi-st" id="yiyi-145">&#x6267;&#x884C;&#x591A;&#x4E2A;&#x8BED;&#x53E5;<a class="headerlink" href="#executing-multiple-statements" title="Permalink to this headline">&#xB6;</a></span></h2><p><span class="yiyi-st" id="yiyi-146">&#x6211;&#x4EEC;&#x4E0A;&#x9762;&#x7684;&#x63D2;&#x5165;&#x793A;&#x4F8B;&#x662F;&#x6545;&#x610F;&#x7A0D;&#x5FAE;&#x753B;&#x51FA;&#x6765;&#x5C55;&#x793A;&#x4E00;&#x4E9B;&#x8868;&#x8FBE;&#x5F0F;&#x8BED;&#x8A00;&#x7ED3;&#x6784;&#x7684;&#x5404;&#x79CD;&#x884C;&#x4E3A;&#x3002;</span><span class="yiyi-st" id="yiyi-147">&#x5728;&#x901A;&#x5E38;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;&#x901A;&#x5E38;&#x6839;&#x636E;&#x53D1;&#x9001;&#x7ED9;<a class="reference internal" href="connections.html#sqlalchemy.engine.Connection" title="sqlalchemy.engine.Connection"><code class="xref py py-class docutils literal"><span class="pre">Connection</span></code></a>&#x4E0A;&#x7684;<code class="docutils literal"><span class="pre">execute()</span></code>&#x65B9;&#x6CD5;&#x7684;&#x53C2;&#x6570;&#x7F16;&#x8BD1;<a class="reference internal" href="dml.html#sqlalchemy.sql.expression.Insert" title="sqlalchemy.sql.expression.Insert"><code class="xref py py-class docutils literal"><span class="pre">Insert</span></code></a>&#x8BED;&#x53E5;&#xFF0C;&#x4EE5;&#x4FBF;&#x4E0D;&#x9700;&#x8981;&#x5728;<a class="reference internal" href="dml.html#sqlalchemy.sql.expression.Insert" title="sqlalchemy.sql.expression.Insert"><code class="xref py py-class docutils literal"><span class="pre">Insert</span></code></a>&#x4E2D;&#x4F7F;&#x7528;<code class="docutils literal"><span class="pre">values</span></code>&#x5173;&#x952E;&#x5B57;&#x3002;</span><span class="yiyi-st" id="yiyi-148">&#x8BA9;&#x6211;&#x4EEC;&#x518D;&#x6B21;&#x521B;&#x5EFA;&#x4E00;&#x4E2A;&#x901A;&#x7528;&#x7684;<a class="reference internal" href="dml.html#sqlalchemy.sql.expression.Insert" title="sqlalchemy.sql.expression.Insert"><code class="xref py py-class docutils literal"><span class="pre">Insert</span></code></a>&#x8BED;&#x53E5;&#x5E76;&#x4EE5;&#x201C;&#x6B63;&#x5E38;&#x201D;&#x7684;&#x65B9;&#x5F0F;&#x4F7F;&#x7528;&#x5B83;&#xFF1A;</span></p><div class="highlight-pycon+sql"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ins</span> <span class="o">=</span> <span class="n">users</span><span class="o">.</span><span class="n">insert</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">conn</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">ins</span><span class="p">,</span> <span class="nb">id</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&apos;wendy&apos;</span><span class="p">,</span> <span class="n">fullname</span><span class="o">=</span><span class="s1">&apos;Wendy Williams&apos;</span><span class="p">)</span>
<div class="show_sql">INSERT INTO users (id, name, fullname) VALUES (?, ?, ?)
(2, &apos;wendy&apos;, &apos;Wendy Williams&apos;)
COMMIT
</div><span class="go">&lt;sqlalchemy.engine.result.ResultProxy object at 0x...&gt;</span></pre></div></div><p><span class="yiyi-st" id="yiyi-149">&#x4E0A;&#x9762;&#xFF0C;&#x56E0;&#x4E3A;&#x6211;&#x4EEC;&#x5728;<code class="docutils literal"><span class="pre">execute()</span></code>&#x65B9;&#x6CD5;&#x4E2D;&#x6307;&#x5B9A;&#x4E86;&#x6240;&#x6709;&#x4E09;&#x5217;&#xFF0C;&#x6240;&#x4EE5;&#x7F16;&#x8BD1;&#x7684;<a class="reference internal" href="dml.html#sqlalchemy.sql.expression.Insert" title="sqlalchemy.sql.expression.Insert"><code class="xref py py-class docutils literal"><span class="pre">Insert</span></code></a>&#x5305;&#x542B;&#x4E86;&#x6240;&#x6709;&#x4E09;&#x5217;&#x3002;</span><span class="yiyi-st" id="yiyi-150">&#x6839;&#x636E;&#x6211;&#x4EEC;&#x6307;&#x5B9A;&#x7684;&#x53C2;&#x6570;&#xFF0C;<a class="reference internal" href="dml.html#sqlalchemy.sql.expression.Insert" title="sqlalchemy.sql.expression.Insert"><code class="xref py py-class docutils literal"><span class="pre">Insert</span></code></a>&#x8BED;&#x53E5;&#x5728;&#x6267;&#x884C;&#x65F6;&#x7F16;&#x8BD1;&#xFF1B;&#x5982;&#x679C;&#x6211;&#x4EEC;&#x6307;&#x5B9A;&#x7684;&#x53C2;&#x6570;&#x8F83;&#x5C11;&#xFF0C;&#x90A3;&#x4E48;<a class="reference internal" href="dml.html#sqlalchemy.sql.expression.Insert" title="sqlalchemy.sql.expression.Insert"><code class="xref py py-class docutils literal"><span class="pre">Insert</span></code></a>&#x5728;&#x5176;VALUES&#x5B50;&#x53E5;&#x4E2D;&#x7684;&#x6761;&#x76EE;&#x8F83;&#x5C11;&#x3002;</span></p><p><span class="yiyi-st" id="yiyi-151">&#x8981;&#x4F7F;&#x7528;DBAPI&#x7684;<code class="docutils literal"><span class="pre">executemany()</span></code>&#x65B9;&#x6CD5;&#x53D1;&#x51FA;&#x5F88;&#x591A;&#x63D2;&#x5165;&#xFF0C;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x53D1;&#x9001;&#x4E00;&#x4E2A;&#x5B57;&#x5178;&#x5217;&#x8868;&#xFF0C;&#x6BCF;&#x4E2A;&#x5B57;&#x5178;&#x5305;&#x542B;&#x4E00;&#x7EC4;&#x4E0D;&#x540C;&#x7684;&#x8981;&#x63D2;&#x5165;&#x7684;&#x53C2;&#x6570;&#xFF0C;&#x5C31;&#x50CF;&#x6211;&#x4EEC;&#x5728;&#x8FD9;&#x91CC;&#x6DFB;&#x52A0;&#x4E00;&#x4E9B;&#x7535;&#x5B50;&#x90AE;&#x4EF6;&#x5730;&#x5740;&#x4E00;&#x6837;&#xFF1A;</span></p><div class="highlight-pycon+sql"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">conn</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">addresses</span><span class="o">.</span><span class="n">insert</span><span class="p">(),</span> <span class="p">[</span>
<span class="gp">... </span>   <span class="p">{</span><span class="s1">&apos;user_id&apos;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&apos;email_address&apos;</span> <span class="p">:</span> <span class="s1">&apos;jack@yahoo.com&apos;</span><span class="p">},</span>
<span class="gp">... </span>   <span class="p">{</span><span class="s1">&apos;user_id&apos;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&apos;email_address&apos;</span> <span class="p">:</span> <span class="s1">&apos;jack@msn.com&apos;</span><span class="p">},</span>
<span class="gp">... </span>   <span class="p">{</span><span class="s1">&apos;user_id&apos;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&apos;email_address&apos;</span> <span class="p">:</span> <span class="s1">&apos;www@www.org&apos;</span><span class="p">},</span>
<span class="gp">... </span>   <span class="p">{</span><span class="s1">&apos;user_id&apos;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&apos;email_address&apos;</span> <span class="p">:</span> <span class="s1">&apos;wendy@aol.com&apos;</span><span class="p">},</span>
<span class="gp">... </span><span class="p">])</span>
<div class="show_sql">INSERT INTO addresses (user_id, email_address) VALUES (?, ?)
((1, &apos;jack@yahoo.com&apos;), (1, &apos;jack@msn.com&apos;), (2, &apos;www@www.org&apos;), (2, &apos;wendy@aol.com&apos;))
COMMIT
</div><span class="go">&lt;sqlalchemy.engine.result.ResultProxy object at 0x...&gt;</span></pre></div></div><p><span class="yiyi-st" id="yiyi-152">&#x4E0A;&#x9762;&#xFF0C;&#x6211;&#x4EEC;&#x518D;&#x6B21;&#x4F9D;&#x8D56;SQLite&#x4E3A;&#x6BCF;&#x4E2A;<code class="docutils literal"><span class="pre">addresses</span></code>&#x884C;&#x81EA;&#x52A8;&#x751F;&#x6210;&#x4E3B;&#x952E;&#x6807;&#x8BC6;&#x7B26;&#x3002;</span></p><p><span class="yiyi-st" id="yiyi-153">&#x5F53;&#x6267;&#x884C;&#x591A;&#x7EC4;&#x53C2;&#x6570;&#x65F6;&#xFF0C;&#x6BCF;&#x4E2A;&#x5B57;&#x5178;&#x5FC5;&#x987B;&#x6709;<strong>&#x76F8;&#x540C;&#x7684;</strong>&#x7EC4;&#x952E;&#xFF1B;&#x5373;&#x4F60;&#x5728;&#x4E00;&#x4E9B;&#x5B57;&#x5178;&#x4E2D;&#x7684;&#x952E;&#x6BD4;&#x5176;&#x4ED6;&#x952E;&#x5C11;&#x3002;</span><span class="yiyi-st" id="yiyi-154">&#x8FD9;&#x662F;&#x56E0;&#x4E3A;<a class="reference internal" href="dml.html#sqlalchemy.sql.expression.Insert" title="sqlalchemy.sql.expression.Insert"><code class="xref py py-class docutils literal"><span class="pre">Insert</span></code></a>&#x8BED;&#x53E5;&#x662F;&#x9488;&#x5BF9;&#x5217;&#x8868;&#x4E2D;&#x7684;<strong>&#x7B2C;&#x4E00;&#x4E2A;</strong>&#x5B57;&#x5178;&#x7F16;&#x8BD1;&#x7684;&#xFF0C;&#x5E76;&#x4E14;&#x5047;&#x5B9A;&#x6240;&#x6709;&#x540E;&#x7EED;&#x7684;&#x53C2;&#x6570;&#x5B57;&#x5178;&#x90FD;&#x4E0E;&#x8BE5;&#x8BED;&#x53E5;&#x517C;&#x5BB9;&#x3002;</span></p><p><span class="yiyi-st" id="yiyi-155">&#x6BCF;&#x4E2A;<a class="reference internal" href="dialects_postgresql.html#sqlalchemy.dialects.postgresql.dml.insert" title="sqlalchemy.dialects.postgresql.dml.insert"><code class="xref py py-func docutils literal"><span class="pre">insert()</span></code></a>&#xFF0C;<a class="reference internal" href="dml.html#sqlalchemy.sql.expression.update" title="sqlalchemy.sql.expression.update"><code class="xref py py-func docutils literal"><span class="pre">update()</span></code></a>&#x548C;<a class="reference internal" href="dml.html#sqlalchemy.sql.expression.delete" title="sqlalchemy.sql.expression.delete"><code class="xref py py-func docutils literal"><span class="pre">delete()</span></code></a>&#x7ED3;&#x6784;&#x90FD;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;&#x201C;executemany&#x201D;&#x98CE;&#x683C;&#x7684;&#x8C03;&#x7528;&#x3002;</span></p></div><div class="section" id="selecting"><h2><span class="yiyi-st" id="yiyi-156">&#x9009;&#x62E9;<a class="headerlink" href="#selecting" title="Permalink to this headline">&#xB6; T0&gt;</a></span></h2><p><span class="yiyi-st" id="yiyi-157">&#x6211;&#x4EEC;&#x4ECE;&#x63D2;&#x5165;&#x5F00;&#x59CB;&#xFF0C;&#x4EE5;&#x4FBF;&#x6211;&#x4EEC;&#x7684;&#x6D4B;&#x8BD5;&#x6570;&#x636E;&#x5E93;&#x4E2D;&#x5305;&#x542B;&#x4E00;&#x4E9B;&#x6570;&#x636E;&#x3002;</span><span class="yiyi-st" id="yiyi-158">&#x6570;&#x636E;&#x4E2D;&#x66F4;&#x6709;&#x8DA3;&#x7684;&#x90E8;&#x5206;&#x662F;&#x9009;&#x62E9;&#x5B83;&#xFF01;</span><span class="yiyi-st" id="yiyi-159">&#x7A0D;&#x540E;&#x6211;&#x4EEC;&#x5C06;&#x4ECB;&#x7ECD;UPDATE&#x548C;DELETE&#x8BED;&#x53E5;&#x3002;</span><span class="yiyi-st" id="yiyi-160">&#x7528;&#x4E8E;&#x751F;&#x6210;SELECT&#x8BED;&#x53E5;&#x7684;&#x4E3B;&#x8981;&#x7ED3;&#x6784;&#x662F;<a class="reference internal" href="selectable.html#sqlalchemy.sql.expression.select" title="sqlalchemy.sql.expression.select"><code class="xref py py-func docutils literal"><span class="pre">select()</span></code></a>&#x51FD;&#x6570;&#xFF1A;</span></p><div class="highlight-pycon+sql"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sqlalchemy.sql</span> <span class="kn">import</span> <span class="n">select</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">select</span><span class="p">([</span><span class="n">users</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">conn</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
<div class="show_sql">SELECT users.id, users.name, users.fullname
FROM users
()</div></pre></div></div><p><span class="yiyi-st" id="yiyi-161">&#x5728;&#x4E0A;&#x9762;&#xFF0C;&#x6211;&#x4EEC;&#x53D1;&#x51FA;&#x4E86;&#x4E00;&#x4E2A;&#x57FA;&#x672C;&#x7684;<a class="reference internal" href="selectable.html#sqlalchemy.sql.expression.select" title="sqlalchemy.sql.expression.select"><code class="xref py py-func docutils literal"><span class="pre">select()</span></code></a>&#x8C03;&#x7528;&#xFF0C;&#x5C06;<code class="docutils literal"><span class="pre">users</span></code>&#x8868;&#x653E;&#x7F6E;&#x5728;select&#x7684;COLUMNS&#x5B50;&#x53E5;&#x4E2D;&#xFF0C;&#x7136;&#x540E;&#x6267;&#x884C;&#x3002;</span><span class="yiyi-st" id="yiyi-162">SQLAlchemy&#x5C06;<code class="docutils literal"><span class="pre">users</span></code>&#x8868;&#x6269;&#x5C55;&#x4E3A;&#x6BCF;&#x4E2A;&#x5217;&#x7684;&#x96C6;&#x5408;&#xFF0C;&#x5E76;&#x4E3A;&#x6211;&#x4EEC;&#x751F;&#x6210;&#x4E86;&#x4E00;&#x4E2A;FROM&#x5B50;&#x53E5;&#x3002;</span><span class="yiyi-st" id="yiyi-163">The result returned is again a <a class="reference internal" href="connections.html#sqlalchemy.engine.ResultProxy" title="sqlalchemy.engine.ResultProxy"><code class="xref py py-class docutils literal"><span class="pre">ResultProxy</span></code></a> object, which acts much like a DBAPI cursor, including methods such as <a class="reference internal" href="connections.html#sqlalchemy.engine.ResultProxy.fetchone" title="sqlalchemy.engine.ResultProxy.fetchone"><code class="xref py py-func docutils literal"><span class="pre">fetchone()</span></code></a> and <a class="reference internal" href="connections.html#sqlalchemy.engine.ResultProxy.fetchall" title="sqlalchemy.engine.ResultProxy.fetchall"><code class="xref py py-func docutils literal"><span class="pre">fetchall()</span></code></a>. </span><span class="yiyi-st" id="yiyi-164">&#x4ECE;&#x4E2D;&#x83B7;&#x53D6;&#x884C;&#x7684;&#x6700;&#x7B80;&#x5355;&#x65B9;&#x6CD5;&#x662F;&#x8FED;&#x4EE3;&#xFF1A;</span></p><div class="highlight-pycon+sql"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">result</span><span class="p">:</span>
<span class="gp">... </span>    <span class="k">print</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>
<span class="go">(1, u&apos;jack&apos;, u&apos;Jack Jones&apos;)</span>
<span class="go">(2, u&apos;wendy&apos;, u&apos;Wendy Williams&apos;)</span></pre></div></div><p><span class="yiyi-st" id="yiyi-165">&#x4E0A;&#x9762;&#xFF0C;&#x6211;&#x4EEC;&#x770B;&#x5230;&#x6253;&#x5370;&#x6BCF;&#x4E00;&#x884C;&#x4EA7;&#x751F;&#x4E86;&#x4E00;&#x4E2A;&#x7B80;&#x5355;&#x7684;&#x5143;&#x7EC4;&#x7ED3;&#x679C;&#x3002;</span><span class="yiyi-st" id="yiyi-166">&#x6211;&#x4EEC;&#x6709;&#x66F4;&#x591A;&#x7684;&#x9009;&#x62E9;&#x6765;&#x8BBF;&#x95EE;&#x6BCF;&#x4E00;&#x884C;&#x4E2D;&#x7684;&#x6570;&#x636E;&#x3002;</span><span class="yiyi-st" id="yiyi-167">&#x4E00;&#x79CD;&#x975E;&#x5E38;&#x5E38;&#x89C1;&#x7684;&#x65B9;&#x5F0F;&#x662F;&#x901A;&#x8FC7;&#x5B57;&#x5178;&#x8BBF;&#x95EE;&#xFF0C;&#x4F7F;&#x7528;&#x5B57;&#x7B26;&#x4E32;&#x540D;&#x79F0;&#x7684;&#x5217;&#xFF1A;</span></p><div class="highlight-pycon+sql"><div class="highlight"><pre><span></span><a class="sql_link" href="#">sql</a><span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">conn</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
<div class="popup_sql">SELECT users.id, users.name, users.fullname
FROM users
()

</div><span class="gp">&gt;&gt;&gt; </span><span class="n">row</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">fetchone</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="s2">&quot;name:&quot;</span><span class="p">,</span> <span class="n">row</span><span class="p">[</span><span class="s1">&apos;name&apos;</span><span class="p">],</span> <span class="s2">&quot;; fullname:&quot;</span><span class="p">,</span> <span class="n">row</span><span class="p">[</span><span class="s1">&apos;fullname&apos;</span><span class="p">])</span>
<span class="go">name: jack ; fullname: Jack Jones</span></pre></div></div><p><span class="yiyi-st" id="yiyi-168">&#x6574;&#x6570;&#x7D22;&#x5F15;&#x4E5F;&#x9002;&#x7528;&#xFF1A;</span></p><div class="highlight-pycon+sql"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">row</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">fetchone</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="s2">&quot;name:&quot;</span><span class="p">,</span> <span class="n">row</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s2">&quot;; fullname:&quot;</span><span class="p">,</span> <span class="n">row</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
<span class="go">name: wendy ; fullname: Wendy Williams</span></pre></div></div><p><span class="yiyi-st" id="yiyi-169">&#x4F46;&#x53E6;&#x4E00;&#x79CD;&#x65B9;&#x5F0F;&#xFF0C;&#x5176;&#x7528;&#x5904;&#x7A0D;&#x540E;&#x5C06;&#x53D8;&#x5F97;&#x660E;&#x663E;&#xFF0C;&#x5C31;&#x662F;&#x76F4;&#x63A5;&#x5C06;<a class="reference internal" href="metadata.html#sqlalchemy.schema.Column" title="sqlalchemy.schema.Column"><code class="xref py py-class docutils literal"><span class="pre">Column</span></code></a>&#x5BF9;&#x8C61;&#x7528;&#x4F5C;&#x5173;&#x952E;&#x5B57;&#xFF1A;</span></p><div class="highlight-pycon+sql"><div class="highlight"><pre><span></span><a class="sql_link" href="#">sql</a><span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">conn</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">print</span><span class="p">(</span><span class="s2">&quot;name:&quot;</span><span class="p">,</span> <span class="n">row</span><span class="p">[</span><span class="n">users</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">name</span><span class="p">],</span> <span class="s2">&quot;; fullname:&quot;</span><span class="p">,</span> <span class="n">row</span><span class="p">[</span><span class="n">users</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">fullname</span><span class="p">])</span>
<div class="popup_sql">SELECT users.id, users.name, users.fullname
FROM users
()
</div><span class="go">name: jack ; fullname: Jack Jones</span>
<span class="go">name: wendy ; fullname: Wendy Williams</span></pre></div></div><p><span class="yiyi-st" id="yiyi-170">&#x5269;&#x4F59;&#x5F85;&#x5904;&#x7406;&#x884C;&#x7684;&#x7ED3;&#x679C;&#x96C6;&#x5E94;&#x5728;&#x4E22;&#x5F03;&#x524D;&#x663E;&#x5F0F;&#x5173;&#x95ED;&#x3002;</span><span class="yiyi-st" id="yiyi-171">&#x5F53;&#x5BF9;&#x8C61;&#x88AB;&#x5783;&#x573E;&#x6536;&#x96C6;&#x65F6;&#xFF0C;&#x7531;<a class="reference internal" href="connections.html#sqlalchemy.engine.ResultProxy" title="sqlalchemy.engine.ResultProxy"><code class="xref py py-class docutils literal"><span class="pre">ResultProxy</span></code></a>&#x5F15;&#x7528;&#x7684;&#x6E38;&#x6807;&#x548C;&#x8FDE;&#x63A5;&#x8D44;&#x6E90;&#x5C06;&#x5206;&#x522B;&#x5173;&#x95ED;&#x5E76;&#x8FD4;&#x56DE;&#x5230;&#x8FDE;&#x63A5;&#x7F13;&#x51B2;&#x6C60;&#xFF0C;&#x4F46;&#x6700;&#x597D;&#x5C06;&#x5176;&#x660E;&#x786E;&#x5316;&#xFF0C;&#x56E0;&#x4E3A;&#x67D0;&#x4E9B;&#x6570;&#x636E;&#x5E93;API&#x5BF9;&#x8FD9;&#x4E9B;&#x4E8B;&#x60C5;&#x975E;&#x5E38;&#x6311;&#x5254;&#xFF1A;</span></p><div class="highlight-pycon+sql"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">result</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></pre></div></div><p><span class="yiyi-st" id="yiyi-172">&#x5982;&#x679C;&#x6211;&#x4EEC;&#x60F3;&#x66F4;&#x4ED4;&#x7EC6;&#x5730;&#x63A7;&#x5236;&#x653E;&#x7F6E;&#x5728;select&#x7684;COLUMNS&#x5B50;&#x53E5;&#x4E2D;&#x7684;&#x5217;&#xFF0C;&#x6211;&#x4EEC;&#x5F15;&#x7528;&#x6765;&#x81EA;<a class="reference internal" href="metadata.html#sqlalchemy.schema.Table" title="sqlalchemy.schema.Table"><code class="xref py py-class docutils literal"><span class="pre">Table</span></code></a>&#x7684;&#x5355;&#x4E2A;<a class="reference internal" href="metadata.html#sqlalchemy.schema.Column" title="sqlalchemy.schema.Column"><code class="xref py py-class docutils literal"><span class="pre">Column</span></code></a>&#x5BF9;&#x8C61;&#x3002;</span><span class="yiyi-st" id="yiyi-173">&#x5B83;&#x4EEC;&#x53EF;&#x4EE5;&#x4F5C;&#x4E3A;<a class="reference internal" href="metadata.html#sqlalchemy.schema.Table" title="sqlalchemy.schema.Table"><code class="xref py py-class docutils literal"><span class="pre">Table</span></code></a>&#x5BF9;&#x8C61;&#x7684;<code class="docutils literal"><span class="pre">c</span></code>&#x5C5E;&#x6027;&#x7684;&#x547D;&#x540D;&#x5C5E;&#x6027;&#x4F7F;&#x7528;&#xFF1A;</span></p><div class="highlight-pycon+sql"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">select</span><span class="p">([</span><span class="n">users</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">users</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">fullname</span><span class="p">])</span>
<a class="sql_link" href="#">sql</a><span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">conn</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
<div class="popup_sql">SELECT users.name, users.fullname
FROM users
()
</div><span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">result</span><span class="p">:</span>
<span class="gp">... </span>    <span class="k">print</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>
<span class="go">(u&apos;jack&apos;, u&apos;Jack Jones&apos;)</span>
<span class="go">(u&apos;wendy&apos;, u&apos;Wendy Williams&apos;)</span></pre></div></div><p><span class="yiyi-st" id="yiyi-174">&#x8BA9;&#x6211;&#x4EEC;&#x89C2;&#x5BDF;&#x5173;&#x4E8E;FROM&#x5B50;&#x53E5;&#x7684;&#x4E00;&#x4E9B;&#x6709;&#x8DA3;&#x7684;&#x4E8B;&#x60C5;&#x3002;</span><span class="yiyi-st" id="yiyi-175">&#x5C3D;&#x7BA1;&#x751F;&#x6210;&#x7684;&#x8BED;&#x53E5;&#x5305;&#x542B;&#x4E24;&#x4E2A;&#x4E0D;&#x540C;&#x7684;&#x90E8;&#x5206;&#xFF0C;&#x5373;&#x201C;SELECT&#x5217;&#x201D;&#x90E8;&#x5206;&#x548C;&#x201C;FROM&#x8868;&#x201D;&#x90E8;&#x5206;&#xFF0C;&#x4F46;&#x6211;&#x4EEC;&#x7684;<a class="reference internal" href="selectable.html#sqlalchemy.sql.expression.select" title="sqlalchemy.sql.expression.select"><code class="xref py py-func docutils literal"><span class="pre">select()</span></code></a>&#x7ED3;&#x6784;&#x53EA;&#x5305;&#x542B;&#x4E00;&#x4E2A;&#x5305;&#x542B;&#x5217;&#x7684;&#x5217;&#x8868;&#x3002;</span><span class="yiyi-st" id="yiyi-176">&#x8FD9;&#x4E2A;&#x600E;&#x4E48;&#x7528; &#xFF1F;</span><span class="yiyi-st" id="yiyi-177">&#x8BA9;&#x6211;&#x4EEC;&#x5C1D;&#x8BD5;&#x5C06;<em>&#x4E24;&#x4E2A;</em>&#x8868;&#x653E;&#x5165;&#x6211;&#x4EEC;&#x7684;<a class="reference internal" href="selectable.html#sqlalchemy.sql.expression.select" title="sqlalchemy.sql.expression.select"><code class="xref py py-func docutils literal"><span class="pre">select()</span></code></a>&#x8BED;&#x53E5;&#x4E2D;&#xFF1A;</span></p><div class="highlight-pycon+sql"><div class="highlight"><pre><span></span><a class="sql_link" href="#">sql</a><span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">conn</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">select</span><span class="p">([</span><span class="n">users</span><span class="p">,</span> <span class="n">addresses</span><span class="p">])):</span>
<span class="gp">... </span>    <span class="k">print</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>
<div class="popup_sql">SELECT users.id, users.name, users.fullname, addresses.id, addresses.user_id, addresses.email_address
FROM users, addresses
()
</div><span class="go">(1, u&apos;jack&apos;, u&apos;Jack Jones&apos;, 1, 1, u&apos;jack@yahoo.com&apos;)</span>
<span class="go">(1, u&apos;jack&apos;, u&apos;Jack Jones&apos;, 2, 1, u&apos;jack@msn.com&apos;)</span>
<span class="go">(1, u&apos;jack&apos;, u&apos;Jack Jones&apos;, 3, 2, u&apos;www@www.org&apos;)</span>
<span class="go">(1, u&apos;jack&apos;, u&apos;Jack Jones&apos;, 4, 2, u&apos;wendy@aol.com&apos;)</span>
<span class="go">(2, u&apos;wendy&apos;, u&apos;Wendy Williams&apos;, 1, 1, u&apos;jack@yahoo.com&apos;)</span>
<span class="go">(2, u&apos;wendy&apos;, u&apos;Wendy Williams&apos;, 2, 1, u&apos;jack@msn.com&apos;)</span>
<span class="go">(2, u&apos;wendy&apos;, u&apos;Wendy Williams&apos;, 3, 2, u&apos;www@www.org&apos;)</span>
<span class="go">(2, u&apos;wendy&apos;, u&apos;Wendy Williams&apos;, 4, 2, u&apos;wendy@aol.com&apos;)</span></pre></div></div><p><span class="yiyi-st" id="yiyi-178">&#x5B83;&#x5C06;<strong>&#x4E24;&#x4E2A;</strong>&#x8868;&#x653E;&#x5165;FROM&#x5B50;&#x53E5;&#x4E2D;&#x3002;</span><span class="yiyi-st" id="yiyi-179">&#x4F46;&#x662F;&#xFF0C;&#x5B83;&#x4E5F;&#x662F;&#x4E00;&#x56E2;&#x7CDF;&#x3002;</span><span class="yiyi-st" id="yiyi-180">&#x90A3;&#x4E9B;&#x719F;&#x6089;SQL&#x8FDE;&#x63A5;&#x7684;&#x4EBA;&#x77E5;&#x9053;&#x8FD9;&#x662F;&#x4E00;&#x4E2A;<strong>&#x7B1B;&#x5361;&#x5C14;&#x79EF;</strong>&#xFF1B;&#x6765;&#x81EA;<code class="docutils literal"><span class="pre">users</span></code>&#x8868;&#x7684;&#x6BCF;&#x884C;&#x90FD;&#x662F;&#x6839;&#x636E;<code class="docutils literal"><span class="pre">addresses</span></code>&#x8868;&#x4E2D;&#x7684;&#x6BCF;&#x884C;&#x751F;&#x6210;&#x7684;&#x3002;</span><span class="yiyi-st" id="yiyi-181">&#x6240;&#x4EE5;&#x4E3A;&#x4E86;&#x4F7F;&#x8FD9;&#x4E2A;&#x9648;&#x8FF0;&#x6709;&#x4E00;&#x4E9B;&#x7406;&#x667A;&#xFF0C;&#x6211;&#x4EEC;&#x9700;&#x8981;&#x4E00;&#x4E2A;WHERE&#x5B50;&#x53E5;&#x3002;</span><span class="yiyi-st" id="yiyi-182">&#x6211;&#x4EEC;&#x4F7F;&#x7528;<a class="reference internal" href="selectable.html#sqlalchemy.sql.expression.Select.where" title="sqlalchemy.sql.expression.Select.where"><code class="xref py py-meth docutils literal"><span class="pre">Select.where()</span></code></a>&#x6765;&#x505A;&#x5230;&#x8FD9;&#x4E00;&#x70B9;&#xFF1A;</span></p><div class="highlight-pycon+sql"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">select</span><span class="p">([</span><span class="n">users</span><span class="p">,</span> <span class="n">addresses</span><span class="p">])</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">users</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">id</span> <span class="o">==</span> <span class="n">addresses</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">user_id</span><span class="p">)</span>
<a class="sql_link" href="#">sql</a><span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">conn</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">print</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>
<div class="popup_sql">SELECT users.id, users.name, users.fullname, addresses.id,
   addresses.user_id, addresses.email_address
FROM users, addresses
WHERE users.id = addresses.user_id
()
</div><span class="go">(1, u&apos;jack&apos;, u&apos;Jack Jones&apos;, 1, 1, u&apos;jack@yahoo.com&apos;)</span>
<span class="go">(1, u&apos;jack&apos;, u&apos;Jack Jones&apos;, 2, 1, u&apos;jack@msn.com&apos;)</span>
<span class="go">(2, u&apos;wendy&apos;, u&apos;Wendy Williams&apos;, 3, 2, u&apos;www@www.org&apos;)</span>
<span class="go">(2, u&apos;wendy&apos;, u&apos;Wendy Williams&apos;, 4, 2, u&apos;wendy@aol.com&apos;)</span></pre></div></div><p><span class="yiyi-st" id="yiyi-183">So that looks a lot better, we added an expression to our <a class="reference internal" href="selectable.html#sqlalchemy.sql.expression.select" title="sqlalchemy.sql.expression.select"><code class="xref py py-func docutils literal"><span class="pre">select()</span></code></a> which had the effect of adding <code class="docutils literal"><span class="pre">WHERE</span> <span class="pre">users.id</span> <span class="pre">=</span> <span class="pre">addresses.user_id</span></code> to our statement, and our results were managed down so that the join of <code class="docutils literal"><span class="pre">users</span></code> and <code class="docutils literal"><span class="pre">addresses</span></code> rows made sense. </span><span class="yiyi-st" id="yiyi-184">&#x4F46;&#x8BA9;&#x6211;&#x4EEC;&#x770B;&#x770B;&#x90A3;&#x4E2A;&#x8868;&#x8FBE;&#xFF1F;</span><span class="yiyi-st" id="yiyi-185">&#x5B83;&#x53EA;&#x662F;&#x5728;&#x4E24;&#x4E2A;&#x4E0D;&#x540C;&#x7684;<a class="reference internal" href="metadata.html#sqlalchemy.schema.Column" title="sqlalchemy.schema.Column"><code class="xref py py-class docutils literal"><span class="pre">Column</span></code></a>&#x5BF9;&#x8C61;&#x4E4B;&#x95F4;&#x4F7F;&#x7528;Python&#x7B49;&#x53F7;&#x8FD0;&#x7B97;&#x7B26;&#x3002;</span><span class="yiyi-st" id="yiyi-186">&#x5E94;&#x8BE5;&#x6E05;&#x695A;&#xFF0C;&#x6709;&#x4E9B;&#x4E8B;&#x60C5;&#x5DF2;&#x7ECF;&#x5230;&#x6765;&#x3002;</span><span class="yiyi-st" id="yiyi-187">Saying <code class="docutils literal"><span class="pre">1</span> <span class="pre">==</span> <span class="pre">1</span></code> produces <code class="docutils literal"><span class="pre">True</span></code>, and <code class="docutils literal"><span class="pre">1</span> <span class="pre">==</span> <span class="pre">2</span></code> produces <code class="docutils literal"><span class="pre">False</span></code>, not a WHERE clause. </span><span class="yiyi-st" id="yiyi-188">&#x56E0;&#x6B64;&#xFF0C;&#x8BA9;&#x6211;&#x4EEC;&#x770B;&#x770B;&#x5230;&#x5E95;&#x8868;&#x8FBE;&#x7684;&#x662F;&#x4EC0;&#x4E48;&#xFF1A;</span></p><div class="highlight-pycon+sql"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">users</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">id</span> <span class="o">==</span> <span class="n">addresses</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">user_id</span>
<span class="go">&lt;sqlalchemy.sql.elements.BinaryExpression object at 0x...&gt;</span></pre></div></div><p><span class="yiyi-st" id="yiyi-189">&#x54C7;&#xFF0C;&#x60CA;&#x559C;&#xFF01;</span><span class="yiyi-st" id="yiyi-190">&#x8FD9;&#x65E2;&#x4E0D;&#x662F;<code class="docutils literal"><span class="pre">True</span></code>&#x4E5F;&#x4E0D;&#x662F;<code class="docutils literal"><span class="pre">False</span></code>&#x3002;</span><span class="yiyi-st" id="yiyi-191">&#x90A3;&#x4E48;&#x5B83;&#x662F;&#x4EC0;&#x4E48;&#xFF1F;</span></p><div class="highlight-pycon+sql"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">str</span><span class="p">(</span><span class="n">users</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">id</span> <span class="o">==</span> <span class="n">addresses</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">user_id</span><span class="p">)</span>
<span class="go">&apos;users.id = addresses.user_id&apos;</span></pre></div></div><p><span class="yiyi-st" id="yiyi-192">&#x6B63;&#x5982;&#x4F60;&#x6240;&#x770B;&#x5230;&#x7684;&#xFF0C;<code class="docutils literal"><span class="pre">==</span></code>&#x8FD0;&#x7B97;&#x7B26;&#x4EA7;&#x751F;&#x7684;&#x5BF9;&#x8C61;&#x975E;&#x5E38;&#x7C7B;&#x4F3C;&#x4E8E;&#x6211;&#x4EEC;&#x5236;&#x4F5C;&#x7684;<a class="reference internal" href="dml.html#sqlalchemy.sql.expression.Insert" title="sqlalchemy.sql.expression.Insert"><code class="xref py py-class docutils literal"><span class="pre">Insert</span></code></a>&#x548C;<a class="reference internal" href="selectable.html#sqlalchemy.sql.expression.select" title="sqlalchemy.sql.expression.select"><code class="xref py py-func docutils literal"><span class="pre">select()</span></code></a>&#x5BF9;&#x8C61;&#x5230;&#x76EE;&#x524D;&#x4E3A;&#x6B62;&#xFF0C;&#x8FD9;&#x8981;&#x5F52;&#x529F;&#x4E8E;Python&#x7684;<code class="docutils literal"><span class="pre">__eq__()</span></code>&#x5185;&#x7F6E;&#xFF1B;&#x4F60;&#x53EF;&#x4EE5;&#x8C03;&#x7528;<code class="docutils literal"><span class="pre">str()</span></code>&#x5E76;&#x4EA7;&#x751F;SQL&#x3002;</span><span class="yiyi-st" id="yiyi-193">&#x5230;&#x73B0;&#x5728;&#x4E3A;&#x6B62;&#xFF0C;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x770B;&#x5230;&#xFF0C;&#x6211;&#x4EEC;&#x6B63;&#x5728;&#x4F7F;&#x7528;&#x7684;&#x6240;&#x6709;&#x4E1C;&#x897F;&#x6700;&#x7EC8;&#x90FD;&#x662F;&#x540C;&#x4E00;&#x7C7B;&#x578B;&#x7684;&#x5BF9;&#x8C61;&#x3002;</span><span class="yiyi-st" id="yiyi-194">SQLAlchemy&#x5C06;&#x6240;&#x6709;&#x8FD9;&#x4E9B;&#x8868;&#x8FBE;&#x5F0F;&#x7684;&#x57FA;&#x7C7B;&#x79F0;&#x4E3A;<a class="reference internal" href="sqlelement.html#sqlalchemy.sql.expression.ColumnElement" title="sqlalchemy.sql.expression.ColumnElement"><code class="xref py py-class docutils literal"><span class="pre">ColumnElement</span></code></a>&#x3002;</span></p></div><div class="section" id="operators"><h2><span class="yiyi-st" id="yiyi-195">&#x7B97;<a class="headerlink" href="#operators" title="Permalink to this headline">&#xB6; T0&gt;</a></span></h2><p><span class="yiyi-st" id="yiyi-196">&#x7531;&#x4E8E;&#x6211;&#x4EEC;&#x5076;&#x7136;&#x53D1;&#x73B0;&#x4E86;SQLAlchemy&#x7684;&#x64CD;&#x4F5C;&#x7B26;&#x8303;&#x4F8B;&#xFF0C;&#x8BA9;&#x6211;&#x4EEC;&#x6765;&#x770B;&#x770B;&#x5B83;&#x7684;&#x4E00;&#x4E9B;&#x529F;&#x80FD;&#x3002;</span><span class="yiyi-st" id="yiyi-197">&#x6211;&#x4EEC;&#x5DF2;&#x7ECF;&#x770B;&#x5230;&#x5982;&#x4F55;&#x5C06;&#x4E24;&#x5217;&#x5F7C;&#x6B64;&#x7B49;&#x540C;&#x8D77;&#x6765;&#xFF1A;</span></p><div class="highlight-pycon+sql"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">users</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">id</span> <span class="o">==</span> <span class="n">addresses</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">user_id</span><span class="p">)</span>
<span class="go">users.id = addresses.user_id</span></pre></div></div><p><span class="yiyi-st" id="yiyi-198">&#x5982;&#x679C;&#x6211;&#x4EEC;&#x4F7F;&#x7528;&#x4E00;&#x4E2A;&#x5B57;&#x9762;&#x503C;&#xFF08;&#x4E00;&#x4E2A;&#x5B57;&#x9762;&#x610F;&#x601D;&#xFF0C;&#x800C;&#x4E0D;&#x662F;&#x4E00;&#x4E2A;SQLAlchemy&#x5B50;&#x53E5;&#x5BF9;&#x8C61;&#xFF09;&#xFF0C;&#x6211;&#x4EEC;&#x5F97;&#x5230;&#x4E00;&#x4E2A;&#x7ED1;&#x5B9A;&#x53C2;&#x6570;&#xFF1A;</span></p><div class="highlight-pycon+sql"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">users</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">id</span> <span class="o">==</span> <span class="mi">7</span><span class="p">)</span>
<span class="go">users.id = :id_1</span></pre></div></div><p><span class="yiyi-st" id="yiyi-199"><code class="docutils literal"><span class="pre">7</span></code>&#x6587;&#x5B57;&#x5D4C;&#x5165;&#x4E86;&#x751F;&#x6210;&#x7684;<a class="reference internal" href="sqlelement.html#sqlalchemy.sql.expression.ColumnElement" title="sqlalchemy.sql.expression.ColumnElement"><code class="xref py py-class docutils literal"><span class="pre">ColumnElement</span></code></a>&#xFF1B;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;&#x4E0E;<a class="reference internal" href="dml.html#sqlalchemy.sql.expression.Insert" title="sqlalchemy.sql.expression.Insert"><code class="xref py py-class docutils literal"><span class="pre">Insert</span></code></a>&#x5BF9;&#x8C61;&#x76F8;&#x540C;&#x7684;&#x6280;&#x5DE7;&#x6765;&#x67E5;&#x770B;&#x5B83;&#xFF1A;</span></p><div class="highlight-pycon+sql"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">users</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">id</span> <span class="o">==</span> <span class="mi">7</span><span class="p">)</span><span class="o">.</span><span class="n">compile</span><span class="p">()</span><span class="o">.</span><span class="n">params</span>
<span class="go">{u&apos;id_1&apos;: 7}</span></pre></div></div><p><span class="yiyi-st" id="yiyi-200">&#x4E8B;&#x5B9E;&#x8BC1;&#x660E;&#xFF0C;&#x5927;&#x591A;&#x6570;Python&#x64CD;&#x4F5C;&#x7B26;&#x5728;&#x8FD9;&#x91CC;&#x751F;&#x6210;&#x4E00;&#x4E2A;SQL&#x8868;&#x8FBE;&#x5F0F;&#xFF0C;&#x5982;equals&#xFF0C;not equals&#x7B49;&#x3002;</span><span class="yiyi-st" id="yiyi-201">:</span></p><div class="highlight-pycon+sql"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">users</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">id</span> <span class="o">!=</span> <span class="mi">7</span><span class="p">)</span>
<span class="go">users.id != :id_1</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c1"># None converts to IS NULL</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">users</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="bp">None</span><span class="p">)</span>
<span class="go">users.name IS NULL</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c1"># reverse works too</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="s1">&apos;fred&apos;</span> <span class="o">&gt;</span> <span class="n">users</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
<span class="go">users.name &lt; :name_1</span></pre></div></div><p><span class="yiyi-st" id="yiyi-202">&#x5982;&#x679C;&#x6211;&#x4EEC;&#x5C06;&#x4E24;&#x4E2A;&#x6574;&#x6570;&#x5217;&#x52A0;&#x5728;&#x4E00;&#x8D77;&#xFF0C;&#x6211;&#x4EEC;&#x5F97;&#x5230;&#x4E00;&#x4E2A;&#x52A0;&#x6CD5;&#x8868;&#x8FBE;&#x5F0F;&#xFF1A;</span></p><div class="highlight-pycon+sql"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">users</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">id</span> <span class="o">+</span> <span class="n">addresses</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>
<span class="go">users.id + addresses.id</span></pre></div></div><p><span class="yiyi-st" id="yiyi-203">&#x6709;&#x8DA3;&#x7684;&#x662F;&#xFF0C;<a class="reference internal" href="metadata.html#sqlalchemy.schema.Column" title="sqlalchemy.schema.Column"><code class="xref py py-class docutils literal"><span class="pre">Column</span></code></a>&#x7684;&#x7C7B;&#x578B;&#x5F88;&#x91CD;&#x8981;&#xFF01;</span><span class="yiyi-st" id="yiyi-204">&#x5982;&#x679C;&#x6211;&#x4EEC;&#x5728;&#x4E24;&#x4E2A;&#x57FA;&#x4E8E;&#x5B57;&#x7B26;&#x4E32;&#x7684;&#x5217;&#x4E0A;&#x4F7F;&#x7528;<code class="docutils literal"><span class="pre">+</span></code>&#xFF08;&#x56DE;&#x60F3;&#x4E00;&#x4E0B;&#xFF0C;&#x6211;&#x4EEC;&#x5728;<a class="reference internal" href="metadata.html#sqlalchemy.schema.Column" title="sqlalchemy.schema.Column"><code class="xref py py-class docutils literal"><span class="pre">Column</span></code></a>&#x5BF9;&#x8C61;&#x4E2D;&#x653E;&#x7F6E;&#x4E86;<a class="reference internal" href="type_basics.html#sqlalchemy.types.Integer" title="sqlalchemy.types.Integer"><code class="xref py py-class docutils literal"><span class="pre">Integer</span></code></a>&#x548C;<a class="reference internal" href="type_basics.html#sqlalchemy.types.String" title="sqlalchemy.types.String"><code class="xref py py-class docutils literal"><span class="pre">String</span></code></a></span></p><div class="highlight-pycon+sql"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">users</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="n">users</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">fullname</span><span class="p">)</span>
<span class="go">users.name || users.fullname</span></pre></div></div><p><span class="yiyi-st" id="yiyi-205">&#x5176;&#x4E2D;<code class="docutils literal"><span class="pre">||</span></code>&#x662F;&#x5927;&#x591A;&#x6570;&#x6570;&#x636E;&#x5E93;&#x4E0A;&#x4F7F;&#x7528;&#x7684;&#x5B57;&#x7B26;&#x4E32;&#x8FDE;&#x63A5;&#x8FD0;&#x7B97;&#x7B26;&#x3002;</span><span class="yiyi-st" id="yiyi-206">&#x4F46;&#x4E0D;&#x662F;&#x5168;&#x90E8;&#x3002;</span><span class="yiyi-st" id="yiyi-207">MySQL&#x7528;&#x6237;&#xFF0C;&#x4E0D;&#x8981;&#x5BB3;&#x6015;&#xFF1A;</span></p><div class="highlight-pycon+sql"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">((</span><span class="n">users</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="n">users</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">fullname</span><span class="p">)</span><span class="o">.</span>
<span class="gp">... </span>     <span class="nb">compile</span><span class="p">(</span><span class="n">bind</span><span class="o">=</span><span class="n">create_engine</span><span class="p">(</span><span class="s1">&apos;mysql://&apos;</span><span class="p">)))</span> <span class="c1"># doctest: +SKIP</span>
<span class="go">concat(users.name, users.fullname)</span></pre></div></div><p><span class="yiyi-st" id="yiyi-208">&#x4EE5;&#x4E0A;&#x8BF4;&#x660E;&#x4E86;&#x4E3A;&#x8FDE;&#x63A5;&#x5230;MySQL&#x6570;&#x636E;&#x5E93;&#x7684;<a class="reference internal" href="connections.html#sqlalchemy.engine.Engine" title="sqlalchemy.engine.Engine"><code class="xref py py-class docutils literal"><span class="pre">Engine</span></code></a>&#x751F;&#x6210;&#x7684;SQL&#xFF1B; <code class="docutils literal"><span class="pre">||</span></code>&#x8FD0;&#x7B97;&#x7B26;&#x73B0;&#x5728;&#x7F16;&#x8BD1;&#x4E3A;MySQL&#x7684;<code class="docutils literal"><span class="pre">concat()</span></code>&#x51FD;&#x6570;&#x3002;</span></p><p><span class="yiyi-st" id="yiyi-209">&#x5982;&#x679C;&#x9047;&#x5230;&#x771F;&#x6B63;&#x4E0D;&#x53EF;&#x7528;&#x7684;&#x64CD;&#x4F5C;&#x7B26;&#xFF0C;&#x53EF;&#x4EE5;&#x59CB;&#x7EC8;&#x4F7F;&#x7528;<a class="reference internal" href="sqlelement.html#sqlalchemy.sql.operators.ColumnOperators.op" title="sqlalchemy.sql.operators.ColumnOperators.op"><code class="xref py py-meth docutils literal"><span class="pre">ColumnOperators.op()</span></code></a>&#x65B9;&#x6CD5;&#xFF1B;&#x8FD9;&#x4F1A;&#x4EA7;&#x751F;&#x4F60;&#x9700;&#x8981;&#x7684;&#x4EFB;&#x4F55;&#x64CD;&#x4F5C;&#x7B26;&#xFF1A;</span></p><div class="highlight-pycon+sql"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">users</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">op</span><span class="p">(</span><span class="s1">&apos;tiddlywinks&apos;</span><span class="p">)(</span><span class="s1">&apos;foo&apos;</span><span class="p">))</span>
<span class="go">users.name tiddlywinks :name_1</span></pre></div></div><p><span class="yiyi-st" id="yiyi-210">&#x8BE5;&#x51FD;&#x6570;&#x4E5F;&#x53EF;&#x7528;&#x4E8E;&#x4F7F;&#x6309;&#x4F4D;&#x8FD0;&#x7B97;&#x7B26;&#x660E;&#x786E;&#x3002;</span><span class="yiyi-st" id="yiyi-211">&#x4F8B;&#x5982;&#xFF1A;</span></p><div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">somecolumn</span><span class="o">.</span><span class="n">op</span><span class="p">(</span><span class="s1">&apos;&amp;&apos;</span><span class="p">)(</span><span class="mh">0xff</span><span class="p">)</span></pre></div></div><p><span class="yiyi-st" id="yiyi-212">&#x662F;<cite>somecolumn</cite>&#x4E2D;&#x7684;&#x503C;&#x7684;&#x6309;&#x4F4D;&#x4E0E;&#x3002;</span></p><div class="section" id="operator-customization"><h3><span class="yiyi-st" id="yiyi-213">&#x64CD;&#x4F5C;&#x5458;&#x5B9A;&#x5236;<a class="headerlink" href="#operator-customization" title="Permalink to this headline">&#xB6;</a></span></h3><p><span class="yiyi-st" id="yiyi-214">While <a class="reference internal" href="sqlelement.html#sqlalchemy.sql.operators.ColumnOperators.op" title="sqlalchemy.sql.operators.ColumnOperators.op"><code class="xref py py-meth docutils literal"><span class="pre">ColumnOperators.op()</span></code></a> is handy to get at a custom operator in a hurry, the Core supports fundamental customization and extension of the operator system at the type level. </span><span class="yiyi-st" id="yiyi-215">&#x73B0;&#x6709;&#x64CD;&#x4F5C;&#x7B26;&#x7684;&#x884C;&#x4E3A;&#x53EF;&#x4EE5;&#x5728;&#x6BCF;&#x4E2A;&#x7C7B;&#x578B;&#x7684;&#x57FA;&#x7840;&#x4E0A;&#x8FDB;&#x884C;&#x4FEE;&#x6539;&#xFF0C;&#x5E76;&#x4E14;&#x53EF;&#x4EE5;&#x5B9A;&#x4E49;&#x65B0;&#x7684;&#x64CD;&#x4F5C;&#xFF0C;&#x8FD9;&#x4E9B;&#x64CD;&#x4F5C;&#x53EF;&#x7528;&#x4E8E;&#x5C5E;&#x4E8E;&#x8BE5;&#x7279;&#x5B9A;&#x7C7B;&#x578B;&#x7684;&#x6240;&#x6709;&#x5217;&#x8868;&#x8FBE;&#x5F0F;&#x3002;</span><span class="yiyi-st" id="yiyi-216">&#x6709;&#x5173;&#x8BF4;&#x660E;&#xFF0C;&#x8BF7;&#x53C2;&#x9605;<a class="reference internal" href="custom_types.html#types-operators"><span>Redefining and Creating New Operators</span></a>&#x90E8;&#x5206;&#x3002;</span></p></div></div><div class="section" id="conjunctions"><h2><span class="yiyi-st" id="yiyi-217">&#x8FDE;&#x8BCD;<a class="headerlink" href="#conjunctions" title="Permalink to this headline">&#xB6; T0&gt;</a></span></h2><p><span class="yiyi-st" id="yiyi-218">&#x6211;&#x4EEC;&#x5E0C;&#x671B;&#x5728;<a class="reference internal" href="selectable.html#sqlalchemy.sql.expression.select" title="sqlalchemy.sql.expression.select"><code class="xref py py-func docutils literal"><span class="pre">select()</span></code></a>&#x7ED3;&#x6784;&#x4E2D;&#x5C55;&#x793A;&#x4E00;&#x4E9B;&#x6211;&#x4EEC;&#x7684;&#x8FD0;&#x7B97;&#x7B26;&#x3002;</span><span class="yiyi-st" id="yiyi-219">&#x4F46;&#x662F;&#x6211;&#x4EEC;&#x9700;&#x8981;&#x628A;&#x5B83;&#x4EEC;&#x518D;&#x52A0;&#x4E00;&#x70B9;&#xFF0C;&#x6240;&#x4EE5;&#x6211;&#x4EEC;&#x5148;&#x6765;&#x4ECB;&#x7ECD;&#x4E00;&#x4E9B;&#x8FDE;&#x8BCD;&#x3002;</span><span class="yiyi-st" id="yiyi-220">&#x8FDE;&#x8BCD;&#x662F;AND&#x548C;OR&#x8FD9;&#x4E9B;&#x5C0F;&#x8BCD;&#x6C47;&#xFF0C;&#x5B83;&#x4EEC;&#x628A;&#x4E8B;&#x7269;&#x653E;&#x5728;&#x4E00;&#x8D77;&#x3002;</span><span class="yiyi-st" id="yiyi-221">&#x6211;&#x4EEC;&#x4E5F;&#x4F1A;&#x78B0;&#x5230;NOT&#x3002;</span><span class="yiyi-st" id="yiyi-222"><a class="reference internal" href="sqlelement.html#sqlalchemy.sql.expression.and_" title="sqlalchemy.sql.expression.and_"><code class="xref py py-func docutils literal"><span class="pre">and_()</span></code></a>&#xFF0C;<a class="reference internal" href="sqlelement.html#sqlalchemy.sql.expression.or_" title="sqlalchemy.sql.expression.or_"><code class="xref py py-func docutils literal"><span class="pre">or_()</span></code></a>&#x548C;<a class="reference internal" href="sqlelement.html#sqlalchemy.sql.expression.not_" title="sqlalchemy.sql.expression.not_"><code class="xref py py-func docutils literal"><span class="pre">not_()</span></code></a>&#x53EF;&#x4EE5;&#x4ECE;SQLAlchemy&#x63D0;&#x4F9B;&#x7684;&#x76F8;&#x5E94;&#x51FD;&#x6570;&#x4E2D;&#x5DE5;&#x4F5C;&#xFF08;&#x6CE8;&#x610F;&#xFF0C;&#x6211;&#x4EEC;&#x4E5F;&#x4F1A;&#x5728;<a class="reference internal" href="sqlelement.html#sqlalchemy.sql.operators.ColumnOperators.like" title="sqlalchemy.sql.operators.ColumnOperators.like"><code class="xref py py-meth docutils literal"><span class="pre">like()</span></code></a></span></p><div class="highlight-pycon+sql"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sqlalchemy.sql</span> <span class="kn">import</span> <span class="n">and_</span><span class="p">,</span> <span class="n">or_</span><span class="p">,</span> <span class="n">not_</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">and_</span><span class="p">(</span>
<span class="gp">... </span>        <span class="n">users</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">like</span><span class="p">(</span><span class="s1">&apos;j%&apos;</span><span class="p">),</span>
<span class="gp">... </span>        <span class="n">users</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">id</span> <span class="o">==</span> <span class="n">addresses</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">user_id</span><span class="p">,</span>
<span class="gp">... </span>        <span class="n">or_</span><span class="p">(</span>
<span class="gp">... </span>             <span class="n">addresses</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">email_address</span> <span class="o">==</span> <span class="s1">&apos;wendy@aol.com&apos;</span><span class="p">,</span>
<span class="gp">... </span>             <span class="n">addresses</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">email_address</span> <span class="o">==</span> <span class="s1">&apos;jack@yahoo.com&apos;</span>
<span class="gp">... </span>        <span class="p">),</span>
<span class="gp">... </span>        <span class="n">not_</span><span class="p">(</span><span class="n">users</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">id</span> <span class="o">&gt;</span> <span class="mi">5</span><span class="p">)</span>
<span class="gp">... </span>      <span class="p">)</span>
<span class="gp">... </span> <span class="p">)</span>
<span class="go">users.name LIKE :name_1 AND users.id = addresses.user_id AND</span>
<span class="go">(addresses.email_address = :email_address_1</span>
<span class="go">   OR addresses.email_address = :email_address_2)</span>
<span class="go">AND users.id &lt;= :id_1</span></pre></div></div><p><span class="yiyi-st" id="yiyi-223">&#x4F60;&#x4E5F;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;&#x91CD;&#x65B0;&#x4F9D;&#x5B58;&#x7684;AND&#xFF0C;OR&#x548C;NOT&#x8FD0;&#x7B97;&#x7B26;&#xFF0C;&#x5C3D;&#x7BA1;&#x7531;&#x4E8E;Python&#x8FD0;&#x7B97;&#x7B26;&#x7684;&#x4F18;&#x5148;&#x7EA7;&#xFF0C;&#x4F60;&#x5FC5;&#x987B;&#x6CE8;&#x610F;&#x62EC;&#x53F7;&#xFF1A;</span></p><div class="highlight-pycon+sql"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">users</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">like</span><span class="p">(</span><span class="s1">&apos;j%&apos;</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">users</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">id</span> <span class="o">==</span> <span class="n">addresses</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">user_id</span><span class="p">)</span> <span class="o">&amp;</span>
<span class="gp">... </span>    <span class="p">(</span>
<span class="gp">... </span>      <span class="p">(</span><span class="n">addresses</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">email_address</span> <span class="o">==</span> <span class="s1">&apos;wendy@aol.com&apos;</span><span class="p">)</span> <span class="o">|</span> \
<span class="gp">... </span>      <span class="p">(</span><span class="n">addresses</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">email_address</span> <span class="o">==</span> <span class="s1">&apos;jack@yahoo.com&apos;</span><span class="p">)</span>
<span class="gp">... </span>    <span class="p">)</span> \
<span class="gp">... </span>    <span class="o">&amp;</span> <span class="o">~</span><span class="p">(</span><span class="n">users</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">id</span><span class="o">&gt;</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">... </span><span class="p">)</span>
<span class="go">users.name LIKE :name_1 AND users.id = addresses.user_id AND</span>
<span class="go">(addresses.email_address = :email_address_1</span>
<span class="go">    OR addresses.email_address = :email_address_2)</span>
<span class="go">AND users.id &lt;= :id_1</span></pre></div></div><p><span class="yiyi-st" id="yiyi-224">&#x56E0;&#x6B64;&#xFF0C;&#x5BF9;&#x4E8E;&#x6240;&#x6709;&#x8FD9;&#x4E9B;&#x8BCD;&#x6C47;&#x8868;&#xFF0C;&#x6211;&#x4EEC;&#x9009;&#x62E9;&#x5728;AOL&#x6216;MSN&#x4E0A;&#x6709;&#x7535;&#x5B50;&#x90AE;&#x4EF6;&#x5730;&#x5740;&#x7684;&#x6240;&#x6709;&#x7528;&#x6237;&#xFF0C;&#x5176;&#x540D;&#x79F0;&#x4EE5;&#x201C;m&#x201D;&#x548C;&#x201C;z&#x201D;&#x4E4B;&#x95F4;&#x7684;&#x5B57;&#x6BCD;&#x5F00;&#x5934;&#xFF0C;&#x6211;&#x4EEC;&#x8FD8;&#x4F1A;&#x751F;&#x6210;&#x4E00;&#x4E2A;&#x5305;&#x542B;&#x5168;&#x540D;&#x7684;&#x5217;&#x4ED6;&#x4EEC;&#x7684;&#x7535;&#x90AE;&#x5730;&#x5740;&#x3002;</span><span class="yiyi-st" id="yiyi-225">We will add two new constructs to this statement, <a class="reference internal" href="sqlelement.html#sqlalchemy.sql.operators.ColumnOperators.between" title="sqlalchemy.sql.operators.ColumnOperators.between"><code class="xref py py-meth docutils literal"><span class="pre">between()</span></code></a> and <a class="reference internal" href="sqlelement.html#sqlalchemy.sql.expression.ColumnElement.label" title="sqlalchemy.sql.expression.ColumnElement.label"><code class="xref py py-meth docutils literal"><span class="pre">label()</span></code></a>. </span><span class="yiyi-st" id="yiyi-226"><a class="reference internal" href="sqlelement.html#sqlalchemy.sql.operators.ColumnOperators.between" title="sqlalchemy.sql.operators.ColumnOperators.between"><code class="xref py py-meth docutils literal"><span class="pre">between()</span></code></a> produces a BETWEEN clause, and <a class="reference internal" href="sqlelement.html#sqlalchemy.sql.expression.ColumnElement.label" title="sqlalchemy.sql.expression.ColumnElement.label"><code class="xref py py-meth docutils literal"><span class="pre">label()</span></code></a> is used in a column expression to produce labels using the <code class="docutils literal"><span class="pre">AS</span></code> keyword; it&#x2019;s recommended when selecting from expressions that otherwise would not have a name:</span></p><div class="highlight-pycon+sql"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">select</span><span class="p">([(</span><span class="n">users</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">fullname</span> <span class="o">+</span>
<span class="gp">... </span>              <span class="s2">&quot;, &quot;</span> <span class="o">+</span> <span class="n">addresses</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">email_address</span><span class="p">)</span><span class="o">.</span>
<span class="gp">... </span>               <span class="n">label</span><span class="p">(</span><span class="s1">&apos;title&apos;</span><span class="p">)])</span><span class="o">.</span>\
<span class="gp">... </span>       <span class="n">where</span><span class="p">(</span>
<span class="gp">... </span>          <span class="n">and_</span><span class="p">(</span>
<span class="gp">... </span>              <span class="n">users</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">id</span> <span class="o">==</span> <span class="n">addresses</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">user_id</span><span class="p">,</span>
<span class="gp">... </span>              <span class="n">users</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">between</span><span class="p">(</span><span class="s1">&apos;m&apos;</span><span class="p">,</span> <span class="s1">&apos;z&apos;</span><span class="p">),</span>
<span class="gp">... </span>              <span class="n">or_</span><span class="p">(</span>
<span class="gp">... </span>                 <span class="n">addresses</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">email_address</span><span class="o">.</span><span class="n">like</span><span class="p">(</span><span class="s1">&apos;%@aol.com&apos;</span><span class="p">),</span>
<span class="gp">... </span>                 <span class="n">addresses</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">email_address</span><span class="o">.</span><span class="n">like</span><span class="p">(</span><span class="s1">&apos;%@msn.com&apos;</span><span class="p">)</span>
<span class="gp">... </span>              <span class="p">)</span>
<span class="gp">... </span>          <span class="p">)</span>
<span class="gp">... </span>       <span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">conn</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">s</span><span class="p">)</span><span class="o">.</span><span class="n">fetchall</span><span class="p">()</span>
<span class="go">SELECT users.fullname || ? || addresses.email_address AS title</span>
<span class="go">FROM users, addresses</span>
<span class="go">WHERE users.id = addresses.user_id AND users.name BETWEEN ? AND ? AND</span>
<span class="go">(addresses.email_address LIKE ? OR addresses.email_address LIKE ?)</span>
<span class="go">(&apos;, &apos;, &apos;m&apos;, &apos;z&apos;, &apos;%@aol.com&apos;, &apos;%@msn.com&apos;)</span>
<span class="go">[(u&apos;Wendy Williams, wendy@aol.com&apos;,)]</span></pre></div></div><p><span class="yiyi-st" id="yiyi-227">SQLAlchemy&#x518D;&#x4E00;&#x6B21;&#x4E3A;&#x6211;&#x4EEC;&#x7684;&#x8BED;&#x53E5;&#x627E;&#x51FA;&#x4E86;FROM&#x5B50;&#x53E5;&#x3002;</span><span class="yiyi-st" id="yiyi-228">&#x5B9E;&#x9645;&#x4E0A;&#xFF0C;&#x5B83;&#x4F1A;&#x6839;&#x636E;&#x6240;&#x6709;&#x5176;&#x4ED6;&#x4F4D;&#x51B3;&#x5B9A;FROM&#x5B50;&#x53E5;&#xFF1B; column&#x5B50;&#x53E5;&#xFF0C;where&#x5B50;&#x53E5;&#xFF0C;&#x8FD8;&#x6709;&#x4E00;&#x4E9B;&#x6211;&#x4EEC;&#x8FD8;&#x6CA1;&#x6709;&#x6D89;&#x53CA;&#x7684;&#x5143;&#x7D20;&#xFF0C;&#x5305;&#x62EC;ORDER BY&#xFF0C;GROUP BY&#x548C;HAVING&#x3002;</span></p><p><span class="yiyi-st" id="yiyi-229">&#x4F7F;&#x7528;<a class="reference internal" href="sqlelement.html#sqlalchemy.sql.expression.and_" title="sqlalchemy.sql.expression.and_"><code class="xref py py-func docutils literal"><span class="pre">and_()</span></code></a>&#x7684;&#x5FEB;&#x6377;&#x65B9;&#x5F0F;&#x662F;&#x5C06;&#x591A;&#x4E2A;<a class="reference internal" href="selectable.html#sqlalchemy.sql.expression.Select.where" title="sqlalchemy.sql.expression.Select.where"><code class="xref py py-meth docutils literal"><span class="pre">where()</span></code></a>&#x5B50;&#x53E5;&#x94FE;&#x63A5;&#x5728;&#x4E00;&#x8D77;&#x3002;</span><span class="yiyi-st" id="yiyi-230">&#x4EE5;&#x4E0A;&#x5185;&#x5BB9;&#x4E5F;&#x53EF;&#x4EE5;&#x5199;&#x6210;&#xFF1A;</span></p><div class="highlight-pycon+sql"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">select</span><span class="p">([(</span><span class="n">users</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">fullname</span> <span class="o">+</span>
<span class="gp">... </span>              <span class="s2">&quot;, &quot;</span> <span class="o">+</span> <span class="n">addresses</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">email_address</span><span class="p">)</span><span class="o">.</span>
<span class="gp">... </span>               <span class="n">label</span><span class="p">(</span><span class="s1">&apos;title&apos;</span><span class="p">)])</span><span class="o">.</span>\
<span class="gp">... </span>       <span class="n">where</span><span class="p">(</span><span class="n">users</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">id</span> <span class="o">==</span> <span class="n">addresses</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">user_id</span><span class="p">)</span><span class="o">.</span>\
<span class="gp">... </span>       <span class="n">where</span><span class="p">(</span><span class="n">users</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">between</span><span class="p">(</span><span class="s1">&apos;m&apos;</span><span class="p">,</span> <span class="s1">&apos;z&apos;</span><span class="p">))</span><span class="o">.</span>\
<span class="gp">... </span>       <span class="n">where</span><span class="p">(</span>
<span class="gp">... </span>              <span class="n">or_</span><span class="p">(</span>
<span class="gp">... </span>                 <span class="n">addresses</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">email_address</span><span class="o">.</span><span class="n">like</span><span class="p">(</span><span class="s1">&apos;%@aol.com&apos;</span><span class="p">),</span>
<span class="gp">... </span>                 <span class="n">addresses</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">email_address</span><span class="o">.</span><span class="n">like</span><span class="p">(</span><span class="s1">&apos;%@msn.com&apos;</span><span class="p">)</span>
<span class="gp">... </span>              <span class="p">)</span>
<span class="gp">... </span>       <span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">conn</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">s</span><span class="p">)</span><span class="o">.</span><span class="n">fetchall</span><span class="p">()</span>
<span class="go">SELECT users.fullname || ? || addresses.email_address AS title</span>
<span class="go">FROM users, addresses</span>
<span class="go">WHERE users.id = addresses.user_id AND users.name BETWEEN ? AND ? AND</span>
<span class="go">(addresses.email_address LIKE ? OR addresses.email_address LIKE ?)</span>
<span class="go">(&apos;, &apos;, &apos;m&apos;, &apos;z&apos;, &apos;%@aol.com&apos;, &apos;%@msn.com&apos;)</span>
<span class="go">[(u&apos;Wendy Williams, wendy@aol.com&apos;,)]</span></pre></div></div><p><span class="yiyi-st" id="yiyi-231">&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x8FDE;&#x7EED;&#x7684;&#x65B9;&#x6CD5;&#x8C03;&#x7528;&#x5EFA;&#x7ACB;<a class="reference internal" href="selectable.html#sqlalchemy.sql.expression.select" title="sqlalchemy.sql.expression.select"><code class="xref py py-func docutils literal"><span class="pre">select()</span></code></a>&#x7ED3;&#x6784;&#x7684;&#x65B9;&#x5F0F;&#x79F0;&#x4E3A;<a class="reference internal" href="glossary.html#term-method-chaining"><span class="xref std std-term">method chaining</span></a>&#x3002;</span></p></div><div class="section" id="using-textual-sql"><h2><span class="yiyi-st" id="yiyi-232">&#x4F7F;&#x7528;&#x6587;&#x672C;SQL <a class="headerlink" href="#using-textual-sql" title="Permalink to this headline">&#xB6;</a></span></h2><p><span class="yiyi-st" id="yiyi-233">&#x6211;&#x4EEC;&#x7684;&#x6700;&#x540E;&#x4E00;&#x4E2A;&#x4F8B;&#x5B50;&#x786E;&#x5B9E;&#x6210;&#x4E3A;&#x4E86;&#x4E00;&#x5C0F;&#x90E8;&#x5206;&#x3002;</span><span class="yiyi-st" id="yiyi-234">&#x4ECE;&#x4E00;&#x4E2A;&#x4EBA;&#x6240;&#x7406;&#x89E3;&#x7684;&#x6587;&#x672C;SQL&#x8868;&#x8FBE;&#x5F0F;&#x53D8;&#x6210;&#x4E00;&#x4E2A;Python&#x6784;&#x9020;&#xFF0C;&#x5B83;&#x5C06;&#x7A0B;&#x5E8F;&#x5316;&#x98CE;&#x683C;&#x4E2D;&#x7684;&#x7EC4;&#x4EF6;&#x7EC4;&#x5408;&#x5728;&#x4E00;&#x8D77;&#x53EF;&#x80FD;&#x5F88;&#x96BE;&#x3002;</span><span class="yiyi-st" id="yiyi-235">&#x8FD9;&#x5C31;&#x662F;&#x4E3A;&#x4EC0;&#x4E48;SQLAlchemy&#x53EA;&#x5141;&#x8BB8;&#x4F60;&#x4F7F;&#x7528;&#x5B57;&#x7B26;&#x4E32;&#x7684;&#x539F;&#x56E0;&#xFF0C;&#x5BF9;&#x4E8E;&#x90A3;&#x4E9B;SQL&#x5DF2;&#x7ECF;&#x77E5;&#x9053;&#x5E76;&#x4E14;&#x6CA1;&#x6709;&#x5F3A;&#x70C8;&#x9700;&#x8981;&#x652F;&#x6301;&#x52A8;&#x6001;&#x7279;&#x6027;&#x7684;&#x8BED;&#x53E5;&#x7684;&#x60C5;&#x51B5;&#x3002;</span><span class="yiyi-st" id="yiyi-236"><a class="reference internal" href="sqlelement.html#sqlalchemy.sql.expression.text" title="sqlalchemy.sql.expression.text"><code class="xref py py-func docutils literal"><span class="pre">text()</span></code></a>&#x7ED3;&#x6784;&#x7528;&#x4E8E;&#x7EC4;&#x6210;&#x4E00;&#x4E2A;&#x5927;&#x90E8;&#x5206;&#x4E0D;&#x53D8;&#x7684;&#x4F20;&#x9012;&#x7ED9;&#x6570;&#x636E;&#x5E93;&#x7684;&#x6587;&#x672C;&#x8BED;&#x53E5;&#x3002;</span><span class="yiyi-st" id="yiyi-237">&#x4E0B;&#x9762;&#xFF0C;&#x6211;&#x4EEC;&#x521B;&#x5EFA;&#x4E00;&#x4E2A;<a class="reference internal" href="sqlelement.html#sqlalchemy.sql.expression.text" title="sqlalchemy.sql.expression.text"><code class="xref py py-func docutils literal"><span class="pre">text()</span></code></a>&#x5BF9;&#x8C61;&#x5E76;&#x6267;&#x884C;&#x5B83;&#xFF1A;</span></p><div class="highlight-pycon+sql"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sqlalchemy.sql</span> <span class="kn">import</span> <span class="n">text</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">text</span><span class="p">(</span>
<span class="gp">... </span>    <span class="s2">&quot;SELECT users.fullname || &apos;, &apos; || addresses.email_address AS title &quot;</span>
<span class="gp">... </span>        <span class="s2">&quot;FROM users, addresses &quot;</span>
<span class="gp">... </span>        <span class="s2">&quot;WHERE users.id = addresses.user_id &quot;</span>
<span class="gp">... </span>        <span class="s2">&quot;AND users.name BETWEEN :x AND :y &quot;</span>
<span class="gp">... </span>        <span class="s2">&quot;AND (addresses.email_address LIKE :e1 &quot;</span>
<span class="gp">... </span>            <span class="s2">&quot;OR addresses.email_address LIKE :e2)&quot;</span><span class="p">)</span>
<a class="sql_link" href="#">sql</a><span class="gp">&gt;&gt;&gt; </span><span class="n">conn</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&apos;m&apos;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&apos;z&apos;</span><span class="p">,</span> <span class="n">e1</span><span class="o">=</span><span class="s1">&apos;%@aol.com&apos;</span><span class="p">,</span> <span class="n">e2</span><span class="o">=</span><span class="s1">&apos;%@msn.com&apos;</span><span class="p">)</span><span class="o">.</span><span class="n">fetchall</span><span class="p">()</span>
<div class="popup_sql">SELECT users.fullname || &apos;, &apos; || addresses.email_address AS title
FROM users, addresses
WHERE users.id = addresses.user_id AND users.name BETWEEN ? AND ? AND
(addresses.email_address LIKE ? OR addresses.email_address LIKE ?)
(&apos;m&apos;, &apos;z&apos;, &apos;%@aol.com&apos;, &apos;%@msn.com&apos;)
</div><span class="go">[(u&apos;Wendy Williams, wendy@aol.com&apos;,)]</span></pre></div></div><p><span class="yiyi-st" id="yiyi-238">&#x5728;&#x4E0A;&#x9762;&#xFF0C;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x770B;&#x5230;&#x4F7F;&#x7528;&#x547D;&#x540D;&#x7684;&#x5192;&#x53F7;&#x683C;&#x5F0F;&#x5728;<a class="reference internal" href="sqlelement.html#sqlalchemy.sql.expression.text" title="sqlalchemy.sql.expression.text"><code class="xref py py-func docutils literal"><span class="pre">text()</span></code></a>&#x4E2D;&#x6307;&#x5B9A;&#x4E86;&#x7ED1;&#x5B9A;&#x53C2;&#x6570;&#xFF1B;&#x4E0D;&#x7BA1;&#x6570;&#x636E;&#x5E93;&#x540E;&#x7AEF;&#x5982;&#x4F55;&#xFF0C;&#x8FD9;&#x79CD;&#x683C;&#x5F0F;&#x90FD;&#x662F;&#x4E00;&#x81F4;&#x7684;&#x3002;</span><span class="yiyi-st" id="yiyi-239">&#x4E3A;&#x4E86;&#x53D1;&#x9001;&#x53C2;&#x6570;&#x503C;&#xFF0C;&#x6211;&#x4EEC;&#x5C06;&#x5B83;&#x4EEC;&#x4F5C;&#x4E3A;&#x9644;&#x52A0;&#x53C2;&#x6570;&#x4F20;&#x9012;&#x7ED9;<a class="reference internal" href="connections.html#sqlalchemy.engine.Connection.execute" title="sqlalchemy.engine.Connection.execute"><code class="xref py py-meth docutils literal"><span class="pre">execute()</span></code></a>&#x65B9;&#x6CD5;&#x3002;</span></p><div class="section" id="specifying-bound-parameter-behaviors"><h3><span class="yiyi-st" id="yiyi-240">&#x6307;&#x5B9A;&#x7ED1;&#x5B9A;&#x53C2;&#x6570;&#x884C;&#x4E3A;<a class="headerlink" href="#specifying-bound-parameter-behaviors" title="Permalink to this headline">&#xB6;</a></span></h3><p><span class="yiyi-st" id="yiyi-241"><a class="reference internal" href="sqlelement.html#sqlalchemy.sql.expression.text" title="sqlalchemy.sql.expression.text"><code class="xref py py-func docutils literal"><span class="pre">text()</span></code></a>&#x7ED3;&#x6784;&#x4F7F;&#x7528;<a class="reference internal" href="sqlelement.html#sqlalchemy.sql.expression.TextClause.bindparams" title="sqlalchemy.sql.expression.TextClause.bindparams"><code class="xref py py-meth docutils literal"><span class="pre">TextClause.bindparams()</span></code></a>&#x65B9;&#x6CD5;&#x652F;&#x6301;&#x9884;&#x5148;&#x5EFA;&#x7ACB;&#x7684;&#x7ED1;&#x5B9A;&#x503C;&#xFF1A;</span></p><div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">stmt</span> <span class="o">=</span> <span class="n">text</span><span class="p">(</span><span class="s2">&quot;SELECT * FROM users WHERE users.name BETWEEN :x AND :y&quot;</span><span class="p">)</span>
<span class="n">stmt</span> <span class="o">=</span> <span class="n">stmt</span><span class="o">.</span><span class="n">bindparams</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s2">&quot;m&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;z&quot;</span><span class="p">)</span></pre></div></div><p><span class="yiyi-st" id="yiyi-242">&#x53C2;&#x6570;&#x4E5F;&#x53EF;&#x4EE5;&#x663E;&#x5F0F;&#x8F93;&#x5165;&#xFF1A;</span></p><div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">stmt</span> <span class="o">=</span> <span class="n">stmt</span><span class="o">.</span><span class="n">bindparams</span><span class="p">(</span><span class="n">bindparam</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="n">String</span><span class="p">),</span> <span class="n">bindparam</span><span class="p">(</span><span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="n">String</span><span class="p">))</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">conn</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">stmt</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;x&quot;</span><span class="p">:</span> <span class="s2">&quot;m&quot;</span><span class="p">,</span> <span class="s2">&quot;y&quot;</span><span class="p">:</span> <span class="s2">&quot;z&quot;</span><span class="p">})</span></pre></div></div><p><span class="yiyi-st" id="yiyi-243">&#x5F53;&#x7C7B;&#x578B;&#x9700;&#x8981;&#x6570;&#x636E;&#x7C7B;&#x578B;&#x63D0;&#x4F9B;&#x7684;Python&#x7AEF;&#x6216;&#x7279;&#x6B8A;&#x7684;SQL&#x7AEF;&#x5904;&#x7406;&#x65F6;&#xFF0C;&#x952E;&#x5165;&#x7ED1;&#x5B9A;&#x53C2;&#x6570;&#x662F;&#x5FC5;&#x8981;&#x7684;&#x3002;</span></p><div class="admonition seealso"><p class="first admonition-title"><span class="yiyi-st" id="yiyi-244">&#x4E5F;&#x53EF;&#x4EE5;&#x770B;&#x770B;</span></p><p class="last"><span class="yiyi-st" id="yiyi-245"><a class="reference internal" href="sqlelement.html#sqlalchemy.sql.expression.TextClause.bindparams" title="sqlalchemy.sql.expression.TextClause.bindparams"><code class="xref py py-meth docutils literal"><span class="pre">TextClause.bindparams()</span></code></a> - full method description</span></p></div></div><div class="section" id="specifying-result-column-behaviors"><h3><span class="yiyi-st" id="yiyi-246">&#x6307;&#x5B9A;&#x7ED3;&#x679C;&#x5217;&#x884C;&#x4E3A;<a class="headerlink" href="#specifying-result-column-behaviors" title="Permalink to this headline">&#xB6;</a></span></h3><p><span class="yiyi-st" id="yiyi-247">&#x6211;&#x4EEC;&#x4E5F;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;<a class="reference internal" href="sqlelement.html#sqlalchemy.sql.expression.TextClause.columns" title="sqlalchemy.sql.expression.TextClause.columns"><code class="xref py py-meth docutils literal"><span class="pre">TextClause.columns()</span></code></a>&#x65B9;&#x6CD5;&#x6307;&#x5B9A;&#x5173;&#x4E8E;&#x7ED3;&#x679C;&#x5217;&#x7684;&#x4FE1;&#x606F;&#xFF1B;&#x6B64;&#x65B9;&#x6CD5;&#x53EF;&#x7528;&#x4E8E;&#x6839;&#x636E;&#x540D;&#x79F0;&#x6307;&#x5B9A;&#x8FD4;&#x56DE;&#x7C7B;&#x578B;&#xFF1A;</span></p><div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">stmt</span> <span class="o">=</span> <span class="n">stmt</span><span class="o">.</span><span class="n">columns</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">Integer</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">String</span><span class="p">)</span></pre></div></div><p><span class="yiyi-st" id="yiyi-248">&#x6216;&#x8005;&#x53EF;&#x4EE5;&#x5728;&#x4F4D;&#x7F6E;&#x4E0A;&#x4F20;&#x9012;&#x5B8C;&#x6574;&#x7684;&#x5217;&#x8868;&#x8FBE;&#x5F0F;&#xFF0C;&#x65E0;&#x8BBA;&#x662F;&#x952E;&#x5165;&#x8FD8;&#x662F;&#x672A;&#x5B9A;&#x4E49;&#x3002;</span><span class="yiyi-st" id="yiyi-249">&#x5728;&#x8FD9;&#x79CD;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;&#x6700;&#x597D;&#x5728;&#x6211;&#x4EEC;&#x7684;&#x6587;&#x672C;SQL&#x4E2D;&#x660E;&#x786E;&#x5217;&#x51FA;&#x5217;&#xFF0C;&#x56E0;&#x4E3A;&#x6211;&#x4EEC;&#x7684;&#x5217;&#x8868;&#x8FBE;&#x5F0F;&#x4E0E;SQL&#x7684;&#x76F8;&#x5173;&#x6027;&#x5C06;&#x5728;&#x4F4D;&#x7F6E;&#x4E0A;&#x5B8C;&#x6210;&#xFF1A;</span></p><div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">stmt</span> <span class="o">=</span> <span class="n">text</span><span class="p">(</span><span class="s2">&quot;SELECT id, name FROM users&quot;</span><span class="p">)</span>
<span class="n">stmt</span> <span class="o">=</span> <span class="n">stmt</span><span class="o">.</span><span class="n">columns</span><span class="p">(</span><span class="n">users</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">users</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">name</span><span class="p">)</span></pre></div></div><p><span class="yiyi-st" id="yiyi-250">&#x5F53;&#x6211;&#x4EEC;&#x8C03;&#x7528;<a class="reference internal" href="sqlelement.html#sqlalchemy.sql.expression.TextClause.columns" title="sqlalchemy.sql.expression.TextClause.columns"><code class="xref py py-meth docutils literal"><span class="pre">TextClause.columns()</span></code></a>&#x65B9;&#x6CD5;&#x65F6;&#xFF0C;&#x6211;&#x4EEC;&#x5F97;&#x5230;&#x4E00;&#x4E2A;<a class="reference internal" href="selectable.html#sqlalchemy.sql.expression.TextAsFrom" title="sqlalchemy.sql.expression.TextAsFrom"><code class="xref py py-class docutils literal"><span class="pre">TextAsFrom</span></code></a>&#x5BF9;&#x8C61;&#xFF0C;&#x8BE5;&#x5BF9;&#x8C61;&#x652F;&#x6301;&#x5B8C;&#x6574;&#x7684;<a class="reference internal" href="selectable.html#sqlalchemy.sql.expression.TextAsFrom.c" title="sqlalchemy.sql.expression.TextAsFrom.c"><code class="xref py py-attr docutils literal"><span class="pre">TextAsFrom.c</span></code></a>&#x548C;&#x5176;&#x4ED6;&#x201C;&#x53EF;&#x9009;&#x201C;&#x64CD;&#x4F5C;&#xFF1A;</span></p><div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">j</span> <span class="o">=</span> <span class="n">stmt</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">addresses</span><span class="p">,</span> <span class="n">stmt</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">id</span> <span class="o">==</span> <span class="n">addresses</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">user_id</span><span class="p">)</span>

<span class="n">new_stmt</span> <span class="o">=</span> <span class="n">select</span><span class="p">([</span><span class="n">stmt</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">addresses</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">id</span><span class="p">])</span><span class="o">.</span>\
    <span class="n">select_from</span><span class="p">(</span><span class="n">j</span><span class="p">)</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">stmt</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s1">&apos;x&apos;</span><span class="p">)</span></pre></div></div><p><span class="yiyi-st" id="yiyi-251">&#x5F53;&#x5C06;&#x6587;&#x672C;SQL&#x4E0E;&#x73B0;&#x6709;&#x7684;Core&#x6216;ORM&#x6A21;&#x578B;&#x76F8;&#x5173;&#x8054;&#x65F6;&#xFF0C;<a class="reference internal" href="sqlelement.html#sqlalchemy.sql.expression.TextClause.columns" title="sqlalchemy.sql.expression.TextClause.columns"><code class="xref py py-meth docutils literal"><span class="pre">TextClause.columns()</span></code></a>&#x7684;&#x4F4D;&#x7F6E;&#x5F62;&#x5F0F;&#x7279;&#x522B;&#x6709;&#x7528;&#xFF0C;&#x56E0;&#x4E3A;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x76F4;&#x63A5;&#x4F7F;&#x7528;&#x5217;&#x8868;&#x8FBE;&#x5F0F;&#xFF0C;&#x800C;&#x4E0D;&#x5FC5;&#x62C5;&#x5FC3;&#x540D;&#x79F0;&#x51B2;&#x7A81;&#x6216;&#x5176;&#x4ED6;&#x7ED3;&#x679C;&#x5217;&#x540D;&#x79F0;&#x95EE;&#x9898;&#x5728;&#x6587;&#x672C;SQL&#x4E2D;&#xFF1A;</span></p><div class="highlight-pycon+sql"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">stmt</span> <span class="o">=</span> <span class="n">text</span><span class="p">(</span><span class="s2">&quot;SELECT users.id, addresses.id, users.id, &quot;</span>
<span class="gp">... </span>    <span class="s2">&quot;users.name, addresses.email_address AS email &quot;</span>
<span class="gp">... </span>    <span class="s2">&quot;FROM users JOIN addresses ON users.id=addresses.user_id &quot;</span>
<span class="gp">... </span>    <span class="s2">&quot;WHERE users.id = 1&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">columns</span><span class="p">(</span>
<span class="gp">... </span>       <span class="n">users</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">id</span><span class="p">,</span>
<span class="gp">... </span>       <span class="n">addresses</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">id</span><span class="p">,</span>
<span class="gp">... </span>       <span class="n">addresses</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">user_id</span><span class="p">,</span>
<span class="gp">... </span>       <span class="n">users</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
<span class="gp">... </span>       <span class="n">addresses</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">email_address</span>
<span class="gp">... </span>    <span class="p">)</span>
<a class="sql_link" href="#">sql</a><span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">conn</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">stmt</span><span class="p">)</span>
<div class="popup_sql">SELECT users.id, addresses.id, users.id, users.name,
    addresses.email_address AS email
FROM users JOIN addresses ON users.id=addresses.user_id WHERE users.id = 1
()
</div></pre></div></div><p><span class="yiyi-st" id="yiyi-252">&#x4E0A;&#x9762;&#x7684;&#x7ED3;&#x679C;&#x4E2D;&#x6709;&#x4E09;&#x5217;&#x540D;&#x4E3A;&#x201C;id&#x201D;&#xFF0C;&#x4F46;&#x7531;&#x4E8E;&#x6211;&#x4EEC;&#x5DF2;&#x7ECF;&#x5728;&#x5217;&#x8868;&#x8868;&#x8FBE;&#x5F0F;&#x4E2D;&#x5B9A;&#x4F4D;&#x4E86;&#x8FD9;&#x4E9B;&#x5217;&#xFF0C;&#x56E0;&#x6B64;&#x5F53;&#x4F7F;&#x7528;&#x5B9E;&#x9645;&#x5217;&#x5BF9;&#x8C61;&#x4F5C;&#x4E3A;&#x5173;&#x952E;&#x5B57;&#x83B7;&#x53D6;&#x7ED3;&#x679C;&#x5217;&#x65F6;&#xFF0C;&#x540D;&#x79F0;&#x4E0D;&#x662F;&#x95EE;&#x9898;&#x3002;</span><span class="yiyi-st" id="yiyi-253">&#x83B7;&#x53D6;<code class="docutils literal"><span class="pre">email_address</span></code>&#x5217;&#x5C06;&#x662F;&#xFF1A;</span></p><div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">row</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">fetchone</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">row</span><span class="p">[</span><span class="n">addresses</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">email_address</span><span class="p">]</span>
<span class="go">&apos;jack@yahoo.com&apos;</span></pre></div></div><p><span class="yiyi-st" id="yiyi-254">&#x53E6;&#x4E00;&#x65B9;&#x9762;&#xFF0C;&#x5982;&#x679C;&#x6211;&#x4EEC;&#x4F7F;&#x7528;&#x4E86;&#x4E00;&#x4E2A;&#x5B57;&#x7B26;&#x4E32;&#x5217;&#x952E;&#xFF0C;&#x901A;&#x5E38;&#x7684;&#x57FA;&#x4E8E;&#x540D;&#x79F0;&#x7684;&#x5339;&#x914D;&#x89C4;&#x5219;&#x4ECD;&#x7136;&#x9002;&#x7528;&#xFF0C;&#x5E76;&#x4E14;&#x6211;&#x4EEC;&#x4F1A;&#x4E3A;<code class="docutils literal"><span class="pre">id</span></code>&#x503C;&#x5F97;&#x5230;&#x4E00;&#x4E2A;&#x6A21;&#x7CCA;&#x7684;&#x5217;&#x9519;&#x8BEF;&#xFF1A;</span></p><div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">row</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">]</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">InvalidRequestError</span>: <span class="n">Ambiguous column name &apos;id&apos; in result set column descriptions</span></pre></div></div><p><span class="yiyi-st" id="yiyi-255">It&#x2019;s important to note that while accessing columns from a result set using <a class="reference internal" href="metadata.html#sqlalchemy.schema.Column" title="sqlalchemy.schema.Column"><code class="xref py py-class docutils literal"><span class="pre">Column</span></code></a> objects may seem unusual, it is in fact the only system used by the ORM, which occurs transparently beneath the facade of the <a class="reference internal" href="orm_query.html#sqlalchemy.orm.query.Query" title="sqlalchemy.orm.query.Query"><code class="xref py py-class docutils literal"><span class="pre">Query</span></code></a> object; in this way, the <a class="reference internal" href="sqlelement.html#sqlalchemy.sql.expression.TextClause.columns" title="sqlalchemy.sql.expression.TextClause.columns"><code class="xref py py-meth docutils literal"><span class="pre">TextClause.columns()</span></code></a> method is typically very applicable to textual statements to be used in an ORM context. </span><span class="yiyi-st" id="yiyi-256"><a class="reference internal" href="orm_tutorial.html#orm-tutorial-literal-sql"><span>Using Textual SQL</span></a>&#x4E2D;&#x7684;&#x793A;&#x4F8B;&#x8BF4;&#x660E;&#x4E86;&#x4E00;&#x4E2A;&#x7B80;&#x5355;&#x7684;&#x7528;&#x6CD5;&#x3002;</span></p><div class="versionadded"><p><span class="yiyi-st" id="yiyi-257"><span class="versionmodified">&#x7248;&#x672C;1.1&#x4E2D;&#x7684;&#x65B0;&#x529F;&#x80FD;&#xFF1A;</span> <a class="reference internal" href="sqlelement.html#sqlalchemy.sql.expression.TextClause.columns" title="sqlalchemy.sql.expression.TextClause.columns"><code class="xref py py-meth docutils literal"><span class="pre">TextClause.columns()</span></code></a>&#x65B9;&#x6CD5;&#x73B0;&#x5728;&#x63A5;&#x53D7;&#x5217;&#x8868;&#x8FBE;&#x5F0F;&#xFF0C;&#x8FD9;&#x4E9B;&#x5217;&#x8868;&#x8FBE;&#x5F0F;&#x5C06;&#x5728;&#x4F4D;&#x7F6E;&#x4E0A;&#x4E0E;&#x7EAF;&#x6587;&#x672C;SQL&#x7ED3;&#x679C;&#x96C6;&#x76F8;&#x5339;&#x914D;&#xFF0C;&#x4ECE;&#x800C;&#x4E0D;&#x9700;&#x8981;&#x5217;&#x540D;&#x5339;&#x914D;&#x6216;&#x751A;&#x81F3;&#x5728;&#x5C06;&#x8868;&#x5143;&#x6570;&#x636E;&#x6216;ORM&#x6A21;&#x578B;&#x4E0E;&#x6587;&#x672C;SQL&#x5339;&#x914D;&#x65F6;&#x5728;SQL&#x8BED;&#x53E5;&#x4E2D;&#x662F;&#x552F;&#x4E00;&#x7684;&#x3002;</span></p></div><div class="admonition seealso"><p class="first admonition-title"><span class="yiyi-st" id="yiyi-258">&#x4E5F;&#x53EF;&#x4EE5;&#x770B;&#x770B;</span></p><p><span class="yiyi-st" id="yiyi-259"><a class="reference internal" href="sqlelement.html#sqlalchemy.sql.expression.TextClause.columns" title="sqlalchemy.sql.expression.TextClause.columns"><code class="xref py py-meth docutils literal"><span class="pre">TextClause.columns()</span></code></a> - full method description</span></p><p class="last"><span class="yiyi-st" id="yiyi-260"><a class="reference internal" href="orm_tutorial.html#orm-tutorial-literal-sql"><span>Using Textual SQL</span></a>  - &#x5C06;ORM&#x7EA7;&#x67E5;&#x8BE2;&#x4E0E;<a class="reference internal" href="sqlelement.html#sqlalchemy.sql.expression.text" title="sqlalchemy.sql.expression.text"><code class="xref py py-func docutils literal"><span class="pre">text()</span></code></a>&#x76F8;&#x96C6;&#x6210;</span></p></div></div><div class="section" id="using-text-fragments-inside-bigger-statements"><h3><span class="yiyi-st" id="yiyi-261">&#x5728;&#x8F83;&#x5927;&#x7684;&#x8BED;&#x53E5;&#x4E2D;&#x4F7F;&#x7528;text()&#x7247;&#x6BB5;<a class="headerlink" href="#using-text-fragments-inside-bigger-statements" title="Permalink to this headline">&#xB6;</a></span></h3><p><span class="yiyi-st" id="yiyi-262"><a class="reference internal" href="sqlelement.html#sqlalchemy.sql.expression.text" title="sqlalchemy.sql.expression.text"><code class="xref py py-func docutils literal"><span class="pre">text()</span></code></a>&#x4E5F;&#x53EF;&#x7528;&#x4E8E;&#x751F;&#x6210;&#x53EF;&#x5728;<a class="reference internal" href="selectable.html#sqlalchemy.sql.expression.select" title="sqlalchemy.sql.expression.select"><code class="xref py py-func docutils literal"><span class="pre">select()</span></code></a>&#x5BF9;&#x8C61;&#x4E2D;&#x81EA;&#x7531;&#x8FD0;&#x884C;&#x7684;SQL&#x7247;&#x6BB5;&#xFF0C;&#x8BE5;&#x5BF9;&#x8C61;&#x63A5;&#x53D7;<a class="reference internal" href="sqlelement.html#sqlalchemy.sql.expression.text" title="sqlalchemy.sql.expression.text"><code class="xref py py-func docutils literal"><span class="pre">text()</span></code></a>&#x5BF9;&#x8C61;&#x4F5C;&#x4E3A;&#x5176;&#x5EFA;&#x8BBE;&#x8005;&#x804C;&#x80FD;&#x7684;&#x5927;&#x90E8;&#x5206;&#x53C2;&#x6570;&#x3002;</span><span class="yiyi-st" id="yiyi-263">&#x4E0B;&#x9762;&#xFF0C;&#x6211;&#x4EEC;&#x7ED3;&#x5408;<a class="reference internal" href="selectable.html#sqlalchemy.sql.expression.select" title="sqlalchemy.sql.expression.select"><code class="xref py py-func docutils literal"><span class="pre">select()</span></code></a>&#x5BF9;&#x8C61;&#x4E2D;<a class="reference internal" href="sqlelement.html#sqlalchemy.sql.expression.text" title="sqlalchemy.sql.expression.text"><code class="xref py py-func docutils literal"><span class="pre">text()</span></code></a>&#x7684;&#x7528;&#x6CD5;&#x3002;</span><span class="yiyi-st" id="yiyi-264"><a class="reference internal" href="selectable.html#sqlalchemy.sql.expression.select" title="sqlalchemy.sql.expression.select"><code class="xref py py-func docutils literal"><span class="pre">select()</span></code></a>&#x7ED3;&#x6784;&#x63D0;&#x4F9B;&#x4E86;&#x8BED;&#x53E5;&#x7684;&#x201C;&#x51E0;&#x4F55;&#x7ED3;&#x6784;&#x201D;&#xFF0C;&#x800C;<a class="reference internal" href="sqlelement.html#sqlalchemy.sql.expression.text" title="sqlalchemy.sql.expression.text"><code class="xref py py-func docutils literal"><span class="pre">text()</span></code></a>&#x7ED3;&#x6784;&#x63D0;&#x4F9B;&#x4E86;&#x6B64;&#x8868;&#x5355;&#x4E2D;&#x7684;&#x6587;&#x672C;&#x5185;&#x5BB9;&#x3002;</span><span class="yiyi-st" id="yiyi-265">&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x5EFA;&#x7ACB;&#x4E00;&#x4E2A;&#x58F0;&#x660E;&#xFF0C;&#x800C;&#x65E0;&#x9700;&#x53C2;&#x8003;&#x4EFB;&#x4F55;&#x9884;&#x5148;&#x5EFA;&#x7ACB;&#x7684;<a class="reference internal" href="metadata.html#sqlalchemy.schema.Table" title="sqlalchemy.schema.Table"><code class="xref py py-class docutils literal"><span class="pre">Table</span></code></a>&#x5143;&#x6570;&#x636E;&#xFF1A;</span></p><div class="highlight-pycon+sql"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">select</span><span class="p">([</span>
<span class="gp">... </span>       <span class="n">text</span><span class="p">(</span><span class="s2">&quot;users.fullname || &apos;, &apos; || addresses.email_address AS title&quot;</span><span class="p">)</span>
<span class="gp">... </span>    <span class="p">])</span><span class="o">.</span>\
<span class="gp">... </span>        <span class="n">where</span><span class="p">(</span>
<span class="gp">... </span>            <span class="n">and_</span><span class="p">(</span>
<span class="gp">... </span>                <span class="n">text</span><span class="p">(</span><span class="s2">&quot;users.id = addresses.user_id&quot;</span><span class="p">),</span>
<span class="gp">... </span>                <span class="n">text</span><span class="p">(</span><span class="s2">&quot;users.name BETWEEN &apos;m&apos; AND &apos;z&apos;&quot;</span><span class="p">),</span>
<span class="gp">... </span>                <span class="n">text</span><span class="p">(</span>
<span class="gp">... </span>                    <span class="s2">&quot;(addresses.email_address LIKE :x &quot;</span>
<span class="gp">... </span>                    <span class="s2">&quot;OR addresses.email_address LIKE :y)&quot;</span><span class="p">)</span>
<span class="gp">... </span>            <span class="p">)</span>
<span class="gp">... </span>        <span class="p">)</span><span class="o">.</span><span class="n">select_from</span><span class="p">(</span><span class="n">text</span><span class="p">(</span><span class="s1">&apos;users, addresses&apos;</span><span class="p">))</span>
<a class="sql_link" href="#">sql</a><span class="gp">&gt;&gt;&gt; </span><span class="n">conn</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&apos;%@aol.com&apos;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&apos;%@msn.com&apos;</span><span class="p">)</span><span class="o">.</span><span class="n">fetchall</span><span class="p">()</span>
<div class="popup_sql">SELECT users.fullname || &apos;, &apos; || addresses.email_address AS title
FROM users, addresses
WHERE users.id = addresses.user_id AND users.name BETWEEN &apos;m&apos; AND &apos;z&apos;
AND (addresses.email_address LIKE ? OR addresses.email_address LIKE ?)
(&apos;%@aol.com&apos;, &apos;%@msn.com&apos;)
</div><span class="go">[(u&apos;Wendy Williams, wendy@aol.com&apos;,)]</span></pre></div></div><div class="versionchanged"><p><span class="yiyi-st" id="yiyi-266"><span class="versionmodified">Changed in version 1.0.0: </span>The <a class="reference internal" href="selectable.html#sqlalchemy.sql.expression.select" title="sqlalchemy.sql.expression.select"><code class="xref py py-func docutils literal"><span class="pre">select()</span></code></a> construct emits warnings when string SQL fragments are coerced to <a class="reference internal" href="sqlelement.html#sqlalchemy.sql.expression.text" title="sqlalchemy.sql.expression.text"><code class="xref py py-func docutils literal"><span class="pre">text()</span></code></a>, and <a class="reference internal" href="sqlelement.html#sqlalchemy.sql.expression.text" title="sqlalchemy.sql.expression.text"><code class="xref py py-func docutils literal"><span class="pre">text()</span></code></a> should be used explicitly. </span><span class="yiyi-st" id="yiyi-267">&#x8BF7;&#x53C2;&#x9605;<a class="reference internal" href="changelog_migration_10.html#migration-2992"><span>Warnings emitted when coercing full SQL fragments into text()</span></a>&#x4F5C;&#x4E3A;&#x80CC;&#x666F;&#x3002;</span></p></div></div><div class="section" id="using-more-specific-text-with-table-literal-column-and-column"><h3><span class="yiyi-st" id="yiyi-268"><a class="reference internal" href="selectable.html#sqlalchemy.sql.expression.table" title="sqlalchemy.sql.expression.table"><code class="xref py py-func docutils literal"><span class="pre">table()</span></code></a>&#xFF0C;<a class="reference internal" href="sqlelement.html#sqlalchemy.sql.expression.literal_column" title="sqlalchemy.sql.expression.literal_column"><code class="xref py py-func docutils literal"><span class="pre">literal_column()</span></code></a>&#x548C;<a class="reference internal" href="sqlelement.html#sqlalchemy.sql.expression.column" title="sqlalchemy.sql.expression.column"><code class="xref py py-func docutils literal"><span class="pre">column()</span></code></a> <a class="headerlink" href="#using-more-specific-text-with-table-literal-column-and-column" title="Permalink to this headline">&#x4F7F;&#x7528;&#x66F4;&#x5177;&#x4F53;&#x7684;&#x6587;&#x672C;</a></span></h3><p><span class="yiyi-st" id="yiyi-269">&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x4F7F;&#x7528;<a class="reference internal" href="sqlelement.html#sqlalchemy.sql.expression.column" title="sqlalchemy.sql.expression.column"><code class="xref py py-func docutils literal"><span class="pre">column()</span></code></a>&#xFF0C;<a class="reference internal" href="sqlelement.html#sqlalchemy.sql.expression.literal_column" title="sqlalchemy.sql.expression.literal_column"><code class="xref py py-func docutils literal"><span class="pre">literal_column()</span></code></a>&#x548C;<a class="reference internal" href="selectable.html#sqlalchemy.sql.expression.table" title="sqlalchemy.sql.expression.table"><code class="xref py py-func docutils literal"><span class="pre">table()</span></code></a>&#x6765;&#x5C06;&#x6211;&#x4EEC;&#x7684;&#x7ED3;&#x6784;&#x7EA7;&#x522B;&#x5411;&#x53E6;&#x4E00;&#x4E2A;&#x65B9;&#x5411;&#x79FB;&#x56DE;&#x6211;&#x4EEC;&#x58F0;&#x660E;&#x7684;&#x4E00;&#x4E9B;&#x5173;&#x952E;&#x8981;&#x7D20;&#x3002;</span><span class="yiyi-st" id="yiyi-270">Using these constructs, we can get some more expression capabilities than if we used <a class="reference internal" href="sqlelement.html#sqlalchemy.sql.expression.text" title="sqlalchemy.sql.expression.text"><code class="xref py py-func docutils literal"><span class="pre">text()</span></code></a> directly, as they provide to the Core more information about how the strings they store are to be used, but still without the need to get into full <a class="reference internal" href="metadata.html#sqlalchemy.schema.Table" title="sqlalchemy.schema.Table"><code class="xref py py-class docutils literal"><span class="pre">Table</span></code></a> based metadata. </span><span class="yiyi-st" id="yiyi-271">&#x5728;&#x4E0B;&#x9762;&#xFF0C;&#x6211;&#x4EEC;&#x8FD8;&#x4E3A;key <a class="reference internal" href="sqlelement.html#sqlalchemy.sql.expression.literal_column" title="sqlalchemy.sql.expression.literal_column"><code class="xref py py-func docutils literal"><span class="pre">literal_column()</span></code></a>&#x5BF9;&#x8C61;&#x4E2D;&#x7684;&#x4E24;&#x4E2A;&#x6307;&#x5B9A;&#x4E86;<a class="reference internal" href="type_basics.html#sqlalchemy.types.String" title="sqlalchemy.types.String"><code class="xref py py-class docutils literal"><span class="pre">String</span></code></a>&#x6570;&#x636E;&#x7C7B;&#x578B;&#xFF0C;&#x4EE5;&#x4FBF;&#x7279;&#x5B9A;&#x4E8E;&#x5B57;&#x7B26;&#x4E32;&#x7684;&#x8FDE;&#x63A5;&#x8FD0;&#x7B97;&#x7B26;&#x53D8;&#x4E3A;&#x53EF;&#x7528;&#x3002;</span><span class="yiyi-st" id="yiyi-272">&#x6211;&#x4EEC;&#x8FD8;&#x4F7F;&#x7528;<a class="reference internal" href="sqlelement.html#sqlalchemy.sql.expression.literal_column" title="sqlalchemy.sql.expression.literal_column"><code class="xref py py-func docutils literal"><span class="pre">literal_column()</span></code></a>&#x6765;&#x4F7F;&#x7528;&#x9650;&#x5B9A;&#x8868;&#x7684;&#x8868;&#x8FBE;&#x5F0F;&#xFF0C;&#x4F8B;&#x5982;<code class="docutils literal"><span class="pre">users.fullname</span></code>&#xFF0C;&#x5C06;&#x6309;&#x539F;&#x6837;&#x5448;&#x73B0;&#xFF1B;&#x4F7F;&#x7528;<a class="reference internal" href="sqlelement.html#sqlalchemy.sql.expression.column" title="sqlalchemy.sql.expression.column"><code class="xref py py-func docutils literal"><span class="pre">column()</span></code></a>&#x8868;&#x793A;&#x53EF;&#x80FD;&#x5F15;&#x7528;&#x7684;&#x5355;&#x4E2A;&#x5217;&#x540D;&#x79F0;&#xFF1A;</span></p><div class="highlight-pycon+sql"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sqlalchemy</span> <span class="kn">import</span> <span class="n">select</span><span class="p">,</span> <span class="n">and_</span><span class="p">,</span> <span class="n">text</span><span class="p">,</span> <span class="n">String</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sqlalchemy.sql</span> <span class="kn">import</span> <span class="n">table</span><span class="p">,</span> <span class="n">literal_column</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">select</span><span class="p">([</span>
<span class="gp">... </span>   <span class="n">literal_column</span><span class="p">(</span><span class="s2">&quot;users.fullname&quot;</span><span class="p">,</span> <span class="n">String</span><span class="p">)</span> <span class="o">+</span>
<span class="gp">... </span>   <span class="s1">&apos;, &apos;</span> <span class="o">+</span>
<span class="gp">... </span>   <span class="n">literal_column</span><span class="p">(</span><span class="s2">&quot;addresses.email_address&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">label</span><span class="p">(</span><span class="s2">&quot;title&quot;</span><span class="p">)</span>
<span class="gp">... </span><span class="p">])</span><span class="o">.</span>\
<span class="gp">... </span>   <span class="n">where</span><span class="p">(</span>
<span class="gp">... </span>       <span class="n">and_</span><span class="p">(</span>
<span class="gp">... </span>           <span class="n">literal_column</span><span class="p">(</span><span class="s2">&quot;users.id&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="n">literal_column</span><span class="p">(</span><span class="s2">&quot;addresses.user_id&quot;</span><span class="p">),</span>
<span class="gp">... </span>           <span class="n">text</span><span class="p">(</span><span class="s2">&quot;users.name BETWEEN &apos;m&apos; AND &apos;z&apos;&quot;</span><span class="p">),</span>
<span class="gp">... </span>           <span class="n">text</span><span class="p">(</span>
<span class="gp">... </span>               <span class="s2">&quot;(addresses.email_address LIKE :x OR &quot;</span>
<span class="gp">... </span>               <span class="s2">&quot;addresses.email_address LIKE :y)&quot;</span><span class="p">)</span>
<span class="gp">... </span>       <span class="p">)</span>
<span class="gp">... </span>   <span class="p">)</span><span class="o">.</span><span class="n">select_from</span><span class="p">(</span><span class="n">table</span><span class="p">(</span><span class="s1">&apos;users&apos;</span><span class="p">))</span><span class="o">.</span><span class="n">select_from</span><span class="p">(</span><span class="n">table</span><span class="p">(</span><span class="s1">&apos;addresses&apos;</span><span class="p">))</span>

<a class="sql_link" href="#">sql</a><span class="gp">&gt;&gt;&gt; </span><span class="n">conn</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&apos;%@aol.com&apos;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&apos;%@msn.com&apos;</span><span class="p">)</span><span class="o">.</span><span class="n">fetchall</span><span class="p">()</span>
<div class="popup_sql">SELECT users.fullname || ? || addresses.email_address AS anon_1
FROM users, addresses
WHERE users.id = addresses.user_id
AND users.name BETWEEN &apos;m&apos; AND &apos;z&apos;
AND (addresses.email_address LIKE ? OR addresses.email_address LIKE ?)
(&apos;, &apos;, &apos;%@aol.com&apos;, &apos;%@msn.com&apos;)
</div><span class="go">[(u&apos;Wendy Williams, wendy@aol.com&apos;,)]</span></pre></div></div></div><div class="section" id="ordering-or-grouping-by-a-label"><h3><span class="yiyi-st" id="yiyi-273">&#x6309;&#x6807;&#x7B7E;&#x6392;&#x5E8F;&#x6216;&#x5206;&#x7EC4;<a class="headerlink" href="#ordering-or-grouping-by-a-label" title="Permalink to this headline">&#xB6;</a></span></h3><p><span class="yiyi-st" id="yiyi-274">&#x6211;&#x4EEC;&#x6709;&#x65F6;&#x5E0C;&#x671B;&#x4F7F;&#x7528;&#x5B57;&#x7B26;&#x4E32;&#x4F5C;&#x4E3A;&#x5FEB;&#x6377;&#x65B9;&#x5F0F;&#x7684;&#x4E00;&#x4E2A;&#x5730;&#x65B9;&#x662F;&#xFF0C;&#x5F53;&#x6211;&#x4EEC;&#x7684;&#x8BED;&#x53E5;&#x6709;&#x4E00;&#x4E9B;&#x6211;&#x4EEC;&#x60F3;&#x8981;&#x5728;&#x8BF8;&#x5982;&#x201C;ORDER BY&#x201D;&#x6216;&#x201C;GROUP BY&#x201D;&#x5B50;&#x53E5;&#x7684;&#x5730;&#x65B9;&#x5F15;&#x7528;&#x7684;&#x6807;&#x7B7E;&#x5217;&#x5143;&#x7D20;&#x65F6;&#xFF1B;&#x5176;&#x4ED6;&#x5019;&#x9009;&#x4EBA;&#x5305;&#x62EC;&#x201C;OVER&#x201D;&#x6216;&#x201C;DISTINCT&#x201D;&#x6761;&#x6B3E;&#x4E2D;&#x7684;&#x5B57;&#x6BB5;&#x3002;</span><span class="yiyi-st" id="yiyi-275">&#x5982;&#x679C;&#x6211;&#x4EEC;&#x7684;<a class="reference internal" href="selectable.html#sqlalchemy.sql.expression.select" title="sqlalchemy.sql.expression.select"><code class="xref py py-func docutils literal"><span class="pre">select()</span></code></a>&#x7ED3;&#x6784;&#x4E2D;&#x6709;&#x8FD9;&#x6837;&#x7684;&#x6807;&#x7B7E;&#xFF0C;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x76F4;&#x63A5;&#x901A;&#x8FC7;&#x5C06;&#x5B57;&#x7B26;&#x4E32;&#x76F4;&#x63A5;&#x4F20;&#x9012;&#x7ED9;<code class="xref py py-meth docutils literal"><span class="pre">select.order_by()</span></code>&#x6216;<code class="xref py py-meth docutils literal"><span class="pre">select.group_by()</span></code>&#x7B49;&#x7B49;&#x3002;</span><span class="yiyi-st" id="yiyi-276">&#x8FD9;&#x5C06;&#x5F15;&#x7528;&#x6307;&#x5B9A;&#x7684;&#x6807;&#x7B7E;&#x5E76;&#x9632;&#x6B62;&#x8868;&#x8FBE;&#x5F0F;&#x88AB;&#x6E32;&#x67D3;&#x4E24;&#x6B21;&#xFF1A;</span></p><div class="highlight-pycon+sql"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sqlalchemy</span> <span class="kn">import</span> <span class="n">func</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">stmt</span> <span class="o">=</span> <span class="n">select</span><span class="p">([</span>
<span class="gp">... </span>        <span class="n">addresses</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">user_id</span><span class="p">,</span>
<span class="gp">... </span>        <span class="n">func</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="n">addresses</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">id</span><span class="p">)</span><span class="o">.</span><span class="n">label</span><span class="p">(</span><span class="s1">&apos;num_addresses&apos;</span><span class="p">)])</span><span class="o">.</span>\
<span class="gp">... </span>        <span class="n">order_by</span><span class="p">(</span><span class="s2">&quot;num_addresses&quot;</span><span class="p">)</span>

<a class="sql_link" href="#">sql</a><span class="gp">&gt;&gt;&gt; </span><span class="n">conn</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">stmt</span><span class="p">)</span><span class="o">.</span><span class="n">fetchall</span><span class="p">()</span>
<div class="popup_sql">SELECT addresses.user_id, count(addresses.id) AS num_addresses
FROM addresses ORDER BY num_addresses
()
</div><span class="go">[(2, 4)]</span></pre></div></div><p><span class="yiyi-st" id="yiyi-277">&#x901A;&#x8FC7;&#x4F20;&#x9012;&#x5B57;&#x7B26;&#x4E32;&#x540D;&#x79F0;&#xFF0C;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;<a class="reference internal" href="sqlelement.html#sqlalchemy.sql.expression.asc" title="sqlalchemy.sql.expression.asc"><code class="xref py py-func docutils literal"><span class="pre">asc()</span></code></a>&#x6216;<a class="reference internal" href="sqlelement.html#sqlalchemy.sql.expression.desc" title="sqlalchemy.sql.expression.desc"><code class="xref py py-func docutils literal"><span class="pre">desc()</span></code></a>&#x7B49;&#x4FEE;&#x9970;&#x7B26;&#xFF1A;</span></p><div class="highlight-pycon+sql"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sqlalchemy</span> <span class="kn">import</span> <span class="n">func</span><span class="p">,</span> <span class="n">desc</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">stmt</span> <span class="o">=</span> <span class="n">select</span><span class="p">([</span>
<span class="gp">... </span>        <span class="n">addresses</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">user_id</span><span class="p">,</span>
<span class="gp">... </span>        <span class="n">func</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="n">addresses</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">id</span><span class="p">)</span><span class="o">.</span><span class="n">label</span><span class="p">(</span><span class="s1">&apos;num_addresses&apos;</span><span class="p">)])</span><span class="o">.</span>\
<span class="gp">... </span>        <span class="n">order_by</span><span class="p">(</span><span class="n">desc</span><span class="p">(</span><span class="s2">&quot;num_addresses&quot;</span><span class="p">))</span>

<a class="sql_link" href="#">sql</a><span class="gp">&gt;&gt;&gt; </span><span class="n">conn</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">stmt</span><span class="p">)</span><span class="o">.</span><span class="n">fetchall</span><span class="p">()</span>
<div class="popup_sql">SELECT addresses.user_id, count(addresses.id) AS num_addresses
FROM addresses ORDER BY num_addresses DESC
()
</div><span class="go">[(2, 4)]</span></pre></div></div><p><span class="yiyi-st" id="yiyi-278">&#x8BF7;&#x6CE8;&#x610F;&#xFF0C;&#x6B64;&#x5904;&#x7684;&#x5B57;&#x7B26;&#x4E32;&#x529F;&#x80FD;&#x975E;&#x5E38;&#x9002;&#x5408;&#x4E8E;&#x6211;&#x4EEC;&#x5DF2;&#x7ECF;&#x4F7F;&#x7528;<a class="reference internal" href="sqlelement.html#sqlalchemy.sql.expression.ColumnElement.label" title="sqlalchemy.sql.expression.ColumnElement.label"><code class="xref py py-meth docutils literal"><span class="pre">label()</span></code></a>&#x65B9;&#x6CD5;&#x521B;&#x5EFA;&#x7279;&#x5B9A;&#x547D;&#x540D;&#x6807;&#x7B7E;&#x7684;&#x60C5;&#x51B5;&#x3002;</span><span class="yiyi-st" id="yiyi-279">&#x5728;&#x5176;&#x4ED6;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;&#x6211;&#x4EEC;&#x603B;&#x662F;&#x5E0C;&#x671B;&#x76F4;&#x63A5;&#x5F15;&#x7528;<a class="reference internal" href="sqlelement.html#sqlalchemy.sql.expression.ColumnElement" title="sqlalchemy.sql.expression.ColumnElement"><code class="xref py py-class docutils literal"><span class="pre">ColumnElement</span></code></a>&#x5BF9;&#x8C61;&#xFF0C;&#x4EE5;&#x4FBF;&#x8868;&#x8FBE;&#x5F0F;&#x7CFB;&#x7EDF;&#x53EF;&#x4EE5;&#x4E3A;&#x6E32;&#x67D3;&#x63D0;&#x4F9B;&#x6700;&#x6709;&#x6548;&#x7684;&#x9009;&#x62E9;&#x3002;</span><span class="yiyi-st" id="yiyi-280">&#x4E0B;&#x9762;&#xFF0C;&#x6211;&#x4EEC;&#x5C06;&#x8BF4;&#x660E;&#x5982;&#x4F55;&#x4F7F;&#x7528;<a class="reference internal" href="sqlelement.html#sqlalchemy.sql.expression.ColumnElement" title="sqlalchemy.sql.expression.ColumnElement"><code class="xref py py-class docutils literal"><span class="pre">ColumnElement</span></code></a>&#x6D88;&#x9664;&#x6211;&#x4EEC;&#x60F3;&#x8981;&#x6309;&#x591A;&#x6B21;&#x51FA;&#x73B0;&#x7684;&#x5217;&#x540D;&#x8FDB;&#x884C;&#x6392;&#x5E8F;&#x65F6;&#x7684;&#x4E0D;&#x660E;&#x786E;&#x6027;&#xFF1A;</span></p><div class="highlight-pycon+sql"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">u1a</span><span class="p">,</span> <span class="n">u1b</span> <span class="o">=</span> <span class="n">users</span><span class="o">.</span><span class="n">alias</span><span class="p">(),</span> <span class="n">users</span><span class="o">.</span><span class="n">alias</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">stmt</span> <span class="o">=</span> <span class="n">select</span><span class="p">([</span><span class="n">u1a</span><span class="p">,</span> <span class="n">u1b</span><span class="p">])</span><span class="o">.</span>\
<span class="gp">... </span>            <span class="n">where</span><span class="p">(</span><span class="n">u1a</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">name</span> <span class="o">&gt;</span> <span class="n">u1b</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">name</span><span class="p">)</span><span class="o">.</span>\
<span class="gp">... </span>            <span class="n">order_by</span><span class="p">(</span><span class="n">u1a</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>  <span class="c1"># using &quot;name&quot; here would be ambiguous</span>

<a class="sql_link" href="#">sql</a><span class="gp">&gt;&gt;&gt; </span><span class="n">conn</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">stmt</span><span class="p">)</span><span class="o">.</span><span class="n">fetchall</span><span class="p">()</span>
<div class="popup_sql">SELECT users_1.id, users_1.name, users_1.fullname, users_2.id,
users_2.name, users_2.fullname
FROM users AS users_1, users AS users_2
WHERE users_1.name &gt; users_2.name ORDER BY users_1.name
()
</div><span class="go">[(2, u&apos;wendy&apos;, u&apos;Wendy Williams&apos;, 1, u&apos;jack&apos;, u&apos;Jack Jones&apos;)]</span></pre></div></div></div></div><div class="section" id="using-aliases"><h2><span class="yiyi-st" id="yiyi-281">&#x4F7F;&#x7528;&#x522B;&#x540D;<a class="headerlink" href="#using-aliases" title="Permalink to this headline">&#xB6;</a></span></h2><p><span class="yiyi-st" id="yiyi-282">SQL&#x4E2D;&#x7684;&#x522B;&#x540D;&#x5BF9;&#x5E94;&#x4E8E;&#x8868;&#x6216;SELECT&#x8BED;&#x53E5;&#x7684;&#x201C;&#x91CD;&#x547D;&#x540D;&#x201D;&#x7248;&#x672C;&#xFF0C;&#x53EA;&#x8981;&#x60A8;&#x8BF4;&#x201C;SELECT .. FROM sometable AS someothername&#x201D;&#x5C31;&#x4F1A;&#x53D1;&#x751F;&#x8FD9;&#x79CD;&#x60C5;&#x51B5;&#x3002;</span><span class="yiyi-st" id="yiyi-283"><code class="docutils literal"><span class="pre">AS</span></code>&#x4E3A;&#x8868;&#x683C;&#x521B;&#x5EFA;&#x4E00;&#x4E2A;&#x65B0;&#x540D;&#x79F0;&#x3002;</span><span class="yiyi-st" id="yiyi-284">&#x522B;&#x540D;&#x662F;&#x4E00;&#x4E2A;&#x5173;&#x952E;&#x7ED3;&#x6784;&#xFF0C;&#x56E0;&#x4E3A;&#x5B83;&#x4EEC;&#x5141;&#x8BB8;&#x901A;&#x8FC7;&#x552F;&#x4E00;&#x540D;&#x79F0;&#x5F15;&#x7528;&#x4EFB;&#x4F55;&#x8868;&#x6216;&#x5B50;&#x67E5;&#x8BE2;&#x3002;</span><span class="yiyi-st" id="yiyi-285">&#x5728;&#x8868;&#x683C;&#x7684;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;&#x8FD9;&#x5141;&#x8BB8;&#x591A;&#x6B21;&#x5728;FROM&#x5B50;&#x53E5;&#x4E2D;&#x547D;&#x540D;&#x76F8;&#x540C;&#x7684;&#x8868;&#x683C;&#x3002;</span><span class="yiyi-st" id="yiyi-286">&#x5728;SELECT&#x8BED;&#x53E5;&#x7684;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;&#x5B83;&#x4E3A;&#x7531;&#x8BED;&#x53E5;&#x8868;&#x793A;&#x7684;&#x5217;&#x63D0;&#x4F9B;&#x7236;&#x540D;&#x79F0;&#xFF0C;&#x4ECE;&#x800C;&#x5141;&#x8BB8;&#x5B83;&#x4EEC;&#x76F8;&#x5BF9;&#x4E8E;&#x8BE5;&#x540D;&#x79F0;&#x88AB;&#x5F15;&#x7528;&#x3002;</span></p><p><span class="yiyi-st" id="yiyi-287">In SQLAlchemy, any <a class="reference internal" href="metadata.html#sqlalchemy.schema.Table" title="sqlalchemy.schema.Table"><code class="xref py py-class docutils literal"><span class="pre">Table</span></code></a>, <a class="reference internal" href="selectable.html#sqlalchemy.sql.expression.select" title="sqlalchemy.sql.expression.select"><code class="xref py py-func docutils literal"><span class="pre">select()</span></code></a> construct, or other selectable can be turned into an alias using the <a class="reference internal" href="selectable.html#sqlalchemy.sql.expression.FromClause.alias" title="sqlalchemy.sql.expression.FromClause.alias"><code class="xref py py-meth docutils literal"><span class="pre">FromClause.alias()</span></code></a> method, which produces a <a class="reference internal" href="selectable.html#sqlalchemy.sql.expression.Alias" title="sqlalchemy.sql.expression.Alias"><code class="xref py py-class docutils literal"><span class="pre">Alias</span></code></a> construct. </span><span class="yiyi-st" id="yiyi-288">&#x4E3E;&#x4E00;&#x4E2A;&#x4F8B;&#x5B50;&#xFF0C;&#x5047;&#x8BBE;&#x6211;&#x4EEC;&#x77E5;&#x9053;&#x6211;&#x4EEC;&#x7684;&#x7528;&#x6237;<code class="docutils literal"><span class="pre">jack</span></code>&#x6709;&#x4E24;&#x4E2A;&#x7279;&#x5B9A;&#x7684;&#x7535;&#x5B50;&#x90AE;&#x4EF6;&#x5730;&#x5740;&#x3002;</span><span class="yiyi-st" id="yiyi-289">&#x6211;&#x4EEC;&#x5982;&#x4F55;&#x6839;&#x636E;&#x8FD9;&#x4E24;&#x4E2A;&#x5730;&#x5740;&#x7684;&#x7EC4;&#x5408;&#x6765;&#x5B9A;&#x4F4D;&#x63D2;&#x5B54;&#xFF1F;</span><span class="yiyi-st" id="yiyi-290">&#x4E3A;&#x4E86;&#x8FBE;&#x5230;&#x8FD9;&#x4E2A;&#x76EE;&#x7684;&#xFF0C;&#x6211;&#x4EEC;&#x4F7F;&#x7528;<code class="docutils literal"><span class="pre">addresses</span></code>&#x8868;&#x7684;&#x4E00;&#x4E2A;&#x8FDE;&#x63A5;&#xFF0C;&#x6BCF;&#x4E2A;&#x5730;&#x5740;&#x4E00;&#x6B21;&#x3002;</span><span class="yiyi-st" id="yiyi-291">&#x6211;&#x4EEC;&#x6839;&#x636E;<code class="docutils literal"><span class="pre">addresses</span></code>&#x521B;&#x5EFA;&#x4E24;&#x4E2A;<a class="reference internal" href="selectable.html#sqlalchemy.sql.expression.Alias" title="sqlalchemy.sql.expression.Alias"><code class="xref py py-class docutils literal"><span class="pre">Alias</span></code></a>&#x7ED3;&#x6784;&#xFF0C;&#x7136;&#x540E;&#x5728;<a class="reference internal" href="selectable.html#sqlalchemy.sql.expression.select" title="sqlalchemy.sql.expression.select"><code class="xref py py-func docutils literal"><span class="pre">select()</span></code></a>&#x7ED3;&#x6784;&#x4E2D;&#x4F7F;&#x7528;&#x5B83;&#x4EEC;&#xFF1A;</span></p><div class="highlight-pycon+sql"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a1</span> <span class="o">=</span> <span class="n">addresses</span><span class="o">.</span><span class="n">alias</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a2</span> <span class="o">=</span> <span class="n">addresses</span><span class="o">.</span><span class="n">alias</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">select</span><span class="p">([</span><span class="n">users</span><span class="p">])</span><span class="o">.</span>\
<span class="gp">... </span>       <span class="n">where</span><span class="p">(</span><span class="n">and_</span><span class="p">(</span>
<span class="gp">... </span>           <span class="n">users</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">id</span> <span class="o">==</span> <span class="n">a1</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">user_id</span><span class="p">,</span>
<span class="gp">... </span>           <span class="n">users</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">id</span> <span class="o">==</span> <span class="n">a2</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">user_id</span><span class="p">,</span>
<span class="gp">... </span>           <span class="n">a1</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">email_address</span> <span class="o">==</span> <span class="s1">&apos;jack@msn.com&apos;</span><span class="p">,</span>
<span class="gp">... </span>           <span class="n">a2</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">email_address</span> <span class="o">==</span> <span class="s1">&apos;jack@yahoo.com&apos;</span>
<span class="gp">... </span>       <span class="p">))</span>
<a class="sql_link" href="#">sql</a><span class="gp">&gt;&gt;&gt; </span><span class="n">conn</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">s</span><span class="p">)</span><span class="o">.</span><span class="n">fetchall</span><span class="p">()</span>
<div class="popup_sql">SELECT users.id, users.name, users.fullname
FROM users, addresses AS addresses_1, addresses AS addresses_2
WHERE users.id = addresses_1.user_id
    AND users.id = addresses_2.user_id
    AND addresses_1.email_address = ?
    AND addresses_2.email_address = ?
(&apos;jack@msn.com&apos;, &apos;jack@yahoo.com&apos;)
</div><span class="go">[(1, u&apos;jack&apos;, u&apos;Jack Jones&apos;)]</span></pre></div></div><p><span class="yiyi-st" id="yiyi-292">&#x8BF7;&#x6CE8;&#x610F;&#xFF0C;<a class="reference internal" href="selectable.html#sqlalchemy.sql.expression.Alias" title="sqlalchemy.sql.expression.Alias"><code class="xref py py-class docutils literal"><span class="pre">Alias</span></code></a>&#x7ED3;&#x6784;&#x5728;&#x6700;&#x7EC8;&#x7684;SQL&#x7ED3;&#x679C;&#x4E2D;&#x751F;&#x6210;&#x4E86;&#x540D;&#x79F0;<code class="docutils literal"><span class="pre">addresses_1</span></code>&#x548C;<code class="docutils literal"><span class="pre">addresses_2</span></code>&#x3002;</span><span class="yiyi-st" id="yiyi-293">&#x8FD9;&#x4E9B;&#x540D;&#x79F0;&#x7684;&#x751F;&#x6210;&#x7531;&#x7ED3;&#x6784;&#x5728;&#x8BED;&#x53E5;&#x4E2D;&#x7684;&#x4F4D;&#x7F6E;&#x51B3;&#x5B9A;&#x3002;</span><span class="yiyi-st" id="yiyi-294">&#x5982;&#x679C;&#x6211;&#x4EEC;&#x4EC5;&#x4F7F;&#x7528;&#x7B2C;&#x4E8C;&#x4E2A;<code class="docutils literal"><span class="pre">a2</span></code>&#x522B;&#x540D;&#x521B;&#x5EFA;&#x67E5;&#x8BE2;&#xFF0C;&#x5219;&#x540D;&#x79F0;&#x5C06;&#x4EE5;<code class="docutils literal"><span class="pre">addresses_1</span></code>&#x51FA;&#x73B0;&#x3002;</span><span class="yiyi-st" id="yiyi-295">The generation of the names is also <em>deterministic</em>, meaning the same SQLAlchemy statement construct will produce the identical SQL string each time it is rendered for a particular dialect.</span></p><p><span class="yiyi-st" id="yiyi-296">&#x7531;&#x4E8E;&#x5728;&#x5916;&#x90E8;&#xFF0C;&#x6211;&#x4EEC;&#x4F7F;&#x7528;<a class="reference internal" href="selectable.html#sqlalchemy.sql.expression.Alias" title="sqlalchemy.sql.expression.Alias"><code class="xref py py-class docutils literal"><span class="pre">Alias</span></code></a>&#x6784;&#x9020;&#x672C;&#x8EAB;&#x6765;&#x5F15;&#x7528;&#x522B;&#x540D;&#xFF0C;&#x6240;&#x4EE5;&#x6211;&#x4EEC;&#x4E0D;&#x9700;&#x8981;&#x5173;&#x5FC3;&#x751F;&#x6210;&#x7684;&#x540D;&#x79F0;&#x3002;</span><span class="yiyi-st" id="yiyi-297">&#x4F46;&#x662F;&#xFF0C;&#x51FA;&#x4E8E;&#x8C03;&#x8BD5;&#x7684;&#x76EE;&#x7684;&#xFF0C;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x5C06;&#x5B57;&#x7B26;&#x4E32;&#x540D;&#x79F0;&#x4F20;&#x9012;&#x7ED9;<a class="reference internal" href="selectable.html#sqlalchemy.sql.expression.FromClause.alias" title="sqlalchemy.sql.expression.FromClause.alias"><code class="xref py py-meth docutils literal"><span class="pre">FromClause.alias()</span></code></a>&#x65B9;&#x6CD5;&#x6765;&#x6307;&#x5B9A;&#x5B83;&#xFF1A;</span></p><div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a1</span> <span class="o">=</span> <span class="n">addresses</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s1">&apos;a1&apos;</span><span class="p">)</span></pre></div></div><p><span class="yiyi-st" id="yiyi-298">&#x522B;&#x540D;&#x5F53;&#x7136;&#x53EF;&#x4EE5;&#x7528;&#x4E8E;&#x60A8;&#x53EF;&#x4EE5;&#x4ECE;&#x4E2D;&#x8FDB;&#x884C;&#x9009;&#x62E9;&#x7684;&#x4EFB;&#x4F55;&#x5185;&#x5BB9;&#xFF0C;&#x5305;&#x62EC;SELECT&#x8BED;&#x53E5;&#x672C;&#x8EAB;&#x3002;</span><span class="yiyi-st" id="yiyi-299">&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x5236;&#x4F5C;&#x6574;&#x4E2A;&#x8BED;&#x53E5;&#x7684;&#x522B;&#x540D;&#xFF0C;&#x5C06;<code class="docutils literal"><span class="pre">users</span></code>&#x8868;&#x81EA;&#x56DE;&#x5F52;&#x5230;&#x6211;&#x4EEC;&#x521B;&#x5EFA;&#x7684;<a class="reference internal" href="selectable.html#sqlalchemy.sql.expression.select" title="sqlalchemy.sql.expression.select"><code class="xref py py-func docutils literal"><span class="pre">select()</span></code></a>&#x3002;</span><span class="yiyi-st" id="yiyi-300"><code class="docutils literal"><span class="pre">correlate(None)</span></code>&#x6307;&#x4EE4;&#x662F;&#x4E3A;&#x4E86;&#x907F;&#x514D;SQLAlchemy&#x8BD5;&#x56FE;&#x5C06;&#x5185;&#x90E8;<code class="docutils literal"><span class="pre">users</span></code>&#x8868;&#x4E0E;&#x5916;&#x90E8;&#x8868;&#x76F8;&#x5173;&#x8054;&#xFF1A;</span></p><div class="highlight-pycon+sql"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a1</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">correlate</span><span class="p">(</span><span class="bp">None</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">select</span><span class="p">([</span><span class="n">users</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">name</span><span class="p">])</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">users</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">id</span> <span class="o">==</span> <span class="n">a1</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>
<a class="sql_link" href="#">sql</a><span class="gp">&gt;&gt;&gt; </span><span class="n">conn</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">s</span><span class="p">)</span><span class="o">.</span><span class="n">fetchall</span><span class="p">()</span>
<div class="popup_sql">SELECT users.name
FROM users,
    (SELECT users.id AS id, users.name AS name, users.fullname AS fullname
        FROM users, addresses AS addresses_1, addresses AS addresses_2
        WHERE users.id = addresses_1.user_id AND users.id = addresses_2.user_id
        AND addresses_1.email_address = ?
        AND addresses_2.email_address = ?) AS anon_1
WHERE users.id = anon_1.id
(&apos;jack@msn.com&apos;, &apos;jack@yahoo.com&apos;)
</div><span class="go">[(u&apos;jack&apos;,)]</span></pre></div></div></div><div class="section" id="using-joins"><h2><span class="yiyi-st" id="yiyi-301">&#x4F7F;&#x7528;&#x8FDE;&#x63A5;<a class="headerlink" href="#using-joins" title="Permalink to this headline">&#xB6;</a></span></h2><p><span class="yiyi-st" id="yiyi-302">&#x6211;&#x4EEC;&#x5DF2;&#x7ECF;&#x80FD;&#x591F;&#x6784;&#x5EFA;&#x4EFB;&#x4F55;SELECT&#x8868;&#x8FBE;&#x5F0F;&#x4E86;&#x3002;</span><span class="yiyi-st" id="yiyi-303">SELECT&#x7684;&#x4E0B;&#x4E00;&#x4E2A;&#x57FA;&#x77F3;&#x662F;JOIN&#x8868;&#x8FBE;&#x5F0F;&#x3002;</span><span class="yiyi-st" id="yiyi-304">&#x6211;&#x4EEC;&#x5DF2;&#x7ECF;&#x5728;&#x6211;&#x4EEC;&#x7684;&#x793A;&#x4F8B;&#x4E2D;&#x8FDB;&#x884C;&#x4E86;&#x8FDE;&#x63A5;&#xFF0C;&#x53EA;&#x9700;&#x5C06;&#x4E24;&#x4E2A;&#x8868;&#x653E;&#x5165;<a class="reference internal" href="selectable.html#sqlalchemy.sql.expression.select" title="sqlalchemy.sql.expression.select"><code class="xref py py-func docutils literal"><span class="pre">select()</span></code></a>&#x6784;&#x9020;&#x7684;columns&#x5B50;&#x53E5;&#x6216;where&#x5B50;&#x53E5;&#x4E2D;&#x5373;&#x53EF;&#x3002;</span><span class="yiyi-st" id="yiyi-305">&#x4F46;&#x662F;&#xFF0C;&#x5982;&#x679C;&#x6211;&#x4EEC;&#x60F3;&#x8981;&#x521B;&#x5EFA;&#x4E00;&#x4E2A;&#x771F;&#x6B63;&#x7684;&#x201C;JOIN&#x201D;&#x6216;&#x201C;OUTERJOIN&#x201D;&#x6784;&#x9020;&#xFF0C;&#x6211;&#x4EEC;&#x4F7F;&#x7528;<a class="reference internal" href="selectable.html#sqlalchemy.sql.expression.FromClause.join" title="sqlalchemy.sql.expression.FromClause.join"><code class="xref py py-meth docutils literal"><span class="pre">join()</span></code></a>&#x548C;<a class="reference internal" href="selectable.html#sqlalchemy.sql.expression.FromClause.outerjoin" title="sqlalchemy.sql.expression.FromClause.outerjoin"><code class="xref py py-meth docutils literal"><span class="pre">outerjoin()</span></code></a>&#x65B9;&#x6CD5;&#xFF0C;&#x8FD9;&#x4E9B;&#x65B9;&#x6CD5;&#x901A;&#x5E38;&#x4ECE;&#x5DE6;&#x8868;&#x8BBF;&#x95EE;&#x5728;&#x52A0;&#x5165;&#xFF1A;</span></p><div class="highlight-pycon+sql"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">users</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">addresses</span><span class="p">))</span>
<span class="go">users JOIN addresses ON users.id = addresses.user_id</span></pre></div></div><p><span class="yiyi-st" id="yiyi-306">&#x8B66;&#x62A5;&#x8BFB;&#x8005;&#x4F1A;&#x770B;&#x5230;&#x66F4;&#x591A;&#x60CA;&#x559C;&#xFF1B; SQLAlchemy&#x60F3;&#x51FA;&#x4E86;&#x5982;&#x4F55;&#x52A0;&#x5165;&#x4E24;&#x4E2A;&#x8868;&#xFF01;</span><span class="yiyi-st" id="yiyi-307">&#x8FD9;&#x4E2A;&#x8FDE;&#x63A5;&#x7684;ON&#x6761;&#x4EF6;&#x662F;&#x6839;&#x636E;&#x6211;&#x4EEC;&#x5728;&#x672C;&#x6559;&#x7A0B;&#x5F00;&#x59CB;&#x7684;<code class="docutils literal"><span class="pre">addresses</span></code>&#x8868;&#x683C;&#x8DEF;&#x4E0A;&#x653E;&#x7F6E;&#x7684;<a class="reference internal" href="constraints.html#sqlalchemy.schema.ForeignKey" title="sqlalchemy.schema.ForeignKey"><code class="xref py py-class docutils literal"><span class="pre">ForeignKey</span></code></a>&#x5BF9;&#x8C61;&#x81EA;&#x52A8;&#x751F;&#x6210;&#x7684;&#x3002;</span><span class="yiyi-st" id="yiyi-308">&#x5DF2;&#x7ECF;<code class="docutils literal"><span class="pre">join()</span></code>&#x7ED3;&#x6784;&#x770B;&#x8D77;&#x6765;&#x597D;&#x50CF;&#x662F;&#x8FDE;&#x63A5;&#x8868;&#x7684;&#x66F4;&#x597D;&#x65B9;&#x6CD5;&#x3002;</span></p><p><span class="yiyi-st" id="yiyi-309">&#x5F53;&#x7136;&#xFF0C;&#x60A8;&#x53EF;&#x4EE5;&#x52A0;&#x5165;&#x4EFB;&#x4F55;&#x60A8;&#x60F3;&#x8981;&#x7684;&#x8868;&#x8FBE;&#x65B9;&#x5F0F;&#xFF0C;&#x4F8B;&#x5982;&#xFF0C;&#x5982;&#x679C;&#x6211;&#x4EEC;&#x60F3;&#x52A0;&#x5165;&#x6240;&#x6709;&#x5728;&#x5176;&#x7535;&#x5B50;&#x90AE;&#x4EF6;&#x5730;&#x5740;&#x4E2D;&#x4F7F;&#x7528;&#x76F8;&#x540C;&#x540D;&#x79F0;&#x7684;&#x7528;&#x6237;&#x540D;&#x4F5C;&#x4E3A;&#x7528;&#x6237;&#x540D;&#xFF1A;</span></p><div class="highlight-pycon+sql"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">users</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">addresses</span><span class="p">,</span>
<span class="gp">... </span>                <span class="n">addresses</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">email_address</span><span class="o">.</span><span class="n">like</span><span class="p">(</span><span class="n">users</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="s1">&apos;%&apos;</span><span class="p">)</span>
<span class="gp">... </span>            <span class="p">)</span>
<span class="gp">... </span> <span class="p">)</span>
<span class="go">users JOIN addresses ON addresses.email_address LIKE (users.name || :name_1)</span></pre></div></div><p><span class="yiyi-st" id="yiyi-310">&#x5F53;&#x6211;&#x4EEC;&#x521B;&#x5EFA;&#x4E00;&#x4E2A;<a class="reference internal" href="selectable.html#sqlalchemy.sql.expression.select" title="sqlalchemy.sql.expression.select"><code class="xref py py-func docutils literal"><span class="pre">select()</span></code></a>&#x6784;&#x9020;&#x65F6;&#xFF0C;SQLAlchemy&#x4F1A;&#x67E5;&#x770B;&#x6211;&#x4EEC;&#x63D0;&#x5230;&#x7684;&#x8868;&#xFF0C;&#x7136;&#x540E;&#x5C06;&#x5B83;&#x4EEC;&#x653E;&#x5728;&#x8BED;&#x53E5;&#x7684;FROM&#x5B50;&#x53E5;&#x4E2D;&#x3002;</span><span class="yiyi-st" id="yiyi-311">&#x4F46;&#x662F;&#xFF0C;&#x5F53;&#x6211;&#x4EEC;&#x4F7F;&#x7528;JOIN&#x65F6;&#xFF0C;&#x6211;&#x4EEC;&#x77E5;&#x9053;&#x6211;&#x4EEC;&#x9700;&#x8981;&#x4EC0;&#x4E48;FROM&#x5B50;&#x53E5;&#xFF0C;&#x6240;&#x4EE5;&#x6211;&#x4EEC;&#x5728;&#x8FD9;&#x91CC;&#x4F7F;&#x7528;<a class="reference internal" href="selectable.html#sqlalchemy.sql.expression.Select.select_from" title="sqlalchemy.sql.expression.Select.select_from"><code class="xref py py-meth docutils literal"><span class="pre">select_from()</span></code></a>&#x65B9;&#x6CD5;&#xFF1A;</span></p><div class="highlight-pycon+sql"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">select</span><span class="p">([</span><span class="n">users</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">fullname</span><span class="p">])</span><span class="o">.</span><span class="n">select_from</span><span class="p">(</span>
<span class="gp">... </span>   <span class="n">users</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">addresses</span><span class="p">,</span>
<span class="gp">... </span>            <span class="n">addresses</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">email_address</span><span class="o">.</span><span class="n">like</span><span class="p">(</span><span class="n">users</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="s1">&apos;%&apos;</span><span class="p">))</span>
<span class="gp">... </span>   <span class="p">)</span>
<a class="sql_link" href="#">sql</a><span class="gp">&gt;&gt;&gt; </span><span class="n">conn</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">s</span><span class="p">)</span><span class="o">.</span><span class="n">fetchall</span><span class="p">()</span>
<div class="popup_sql">SELECT users.fullname
FROM users JOIN addresses ON addresses.email_address LIKE (users.name || ?)
(&apos;%&apos;,)
</div><span class="go">[(u&apos;Jack Jones&apos;,), (u&apos;Jack Jones&apos;,), (u&apos;Wendy Williams&apos;,)]</span></pre></div></div><p><span class="yiyi-st" id="yiyi-312">The <a class="reference internal" href="selectable.html#sqlalchemy.sql.expression.FromClause.outerjoin" title="sqlalchemy.sql.expression.FromClause.outerjoin"><code class="xref py py-meth docutils literal"><span class="pre">outerjoin()</span></code></a> method creates <code class="docutils literal"><span class="pre">LEFT</span> <span class="pre">OUTER</span> <span class="pre">JOIN</span></code> constructs, and is used in the same way as <a class="reference internal" href="selectable.html#sqlalchemy.sql.expression.FromClause.join" title="sqlalchemy.sql.expression.FromClause.join"><code class="xref py py-meth docutils literal"><span class="pre">join()</span></code></a>:</span></p><div class="highlight-pycon+sql"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">select</span><span class="p">([</span><span class="n">users</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">fullname</span><span class="p">])</span><span class="o">.</span><span class="n">select_from</span><span class="p">(</span><span class="n">users</span><span class="o">.</span><span class="n">outerjoin</span><span class="p">(</span><span class="n">addresses</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
<span class="go">SELECT users.fullname</span>
<span class="go">    FROM users</span>
<span class="go">    LEFT OUTER JOIN addresses ON users.id = addresses.user_id</span></pre></div></div><p><span class="yiyi-st" id="yiyi-313">&#x8FD9;&#x5C31;&#x662F;&#x8F93;&#x51FA;<code class="docutils literal"><span class="pre">outerjoin()</span></code>&#x4EA7;&#x751F;&#x7684;&#x7ED3;&#x679C;&#xFF0C;&#x5F53;&#x7136;&#xFF0C;&#x9664;&#x975E;&#x4F60;&#x5728;&#x7B2C;9&#x7248;&#x4E4B;&#x524D;&#x4F7F;&#x7528;Oracle&#x505C;&#x7559;&#x5728;&#x4E00;&#x4E2A;gig&#x4E2D;&#xFF0C;&#x5E76;&#x4E14;&#x4F60;&#x5DF2;&#x7ECF;&#x8BBE;&#x7F6E;&#x4E86;&#x5F15;&#x64CE;&#xFF08;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;<code class="docutils literal"><span class="pre">OracleDialect</span></code>&#xFF09;&#x4F7F;&#x7528;Oracle&#x7279;&#x5B9A;&#x7684;SQL&#xFF1A;</span></p><div class="highlight-pycon+sql"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sqlalchemy.dialects.oracle</span> <span class="kn">import</span> <span class="n">dialect</span> <span class="k">as</span> <span class="n">OracleDialect</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">dialect</span><span class="o">=</span><span class="n">OracleDialect</span><span class="p">(</span><span class="n">use_ansi</span><span class="o">=</span><span class="bp">False</span><span class="p">)))</span>
<span class="go">SELECT users.fullname</span>
<span class="go">FROM users, addresses</span>
<span class="go">WHERE users.id = addresses.user_id(+)</span></pre></div></div><p><span class="yiyi-st" id="yiyi-314">&#x5982;&#x679C;&#x60A8;&#x4E0D;&#x77E5;&#x9053;SQL&#x7684;&#x542B;&#x4E49;&#xFF0C;&#x8BF7;&#x4E0D;&#x8981;&#x62C5;&#x5FC3;&#xFF01;</span><span class="yiyi-st" id="yiyi-315">Oracle DBA&#x7684;&#x79D8;&#x5BC6;&#x90E8;&#x843D;&#x4E0D;&#x5E0C;&#x671B;&#x4ED6;&#x4EEC;&#x53D1;&#x73B0;&#x9ED1;&#x9B54;&#x6CD5;&#xFF1B;&#xFF09;&#x3002;</span></p><div class="admonition seealso"><p class="first admonition-title"><span class="yiyi-st" id="yiyi-316">&#x4E5F;&#x53EF;&#x4EE5;&#x770B;&#x770B;</span></p><p><span class="yiyi-st" id="yiyi-317"><a class="reference internal" href="selectable.html#sqlalchemy.sql.expression.join" title="sqlalchemy.sql.expression.join"><code class="xref py py-func docutils literal"><span class="pre">expression.join()</span></code></a></span></p><p><span class="yiyi-st" id="yiyi-318"><a class="reference internal" href="selectable.html#sqlalchemy.sql.expression.outerjoin" title="sqlalchemy.sql.expression.outerjoin"><code class="xref py py-func docutils literal"><span class="pre">expression.outerjoin()</span></code></a></span></p><p class="last"><span class="yiyi-st" id="yiyi-319"><a class="reference internal" href="selectable.html#sqlalchemy.sql.expression.Join" title="sqlalchemy.sql.expression.Join"><code class="xref py py-class docutils literal"><span class="pre">Join</span></code></a></span></p></div></div><div class="section" id="everything-else"><h2><span class="yiyi-st" id="yiyi-320">&#x5176;&#x4ED6;&#x7684;&#x4E1C;&#x897F;<a class="headerlink" href="#everything-else" title="Permalink to this headline">&#xB6;</a></span></h2><p><span class="yiyi-st" id="yiyi-321">&#x5F15;&#x5165;&#x4E86;&#x521B;&#x5EFA;SQL&#x8868;&#x8FBE;&#x5F0F;&#x7684;&#x6982;&#x5FF5;&#x3002;</span><span class="yiyi-st" id="yiyi-322">&#x5269;&#x4E0B;&#x7684;&#x662F;&#x76F8;&#x540C;&#x4E3B;&#x9898;&#x7684;&#x66F4;&#x591A;&#x53D8;&#x4F53;&#x3002;</span><span class="yiyi-st" id="yiyi-323">&#x6240;&#x4EE5;&#x73B0;&#x5728;&#x6211;&#x4EEC;&#x5C06;&#x5217;&#x51FA;&#x6211;&#x4EEC;&#x9700;&#x8981;&#x77E5;&#x9053;&#x7684;&#x5176;&#x4ED6;&#x91CD;&#x8981;&#x4E8B;&#x60C5;&#x3002;</span></p><div class="section" id="bind-parameter-objects"><h3><span class="yiyi-st" id="yiyi-324">&#x7ED1;&#x5B9A;&#x53C2;&#x6570;&#x5BF9;&#x8C61;<a class="headerlink" href="#bind-parameter-objects" title="Permalink to this headline">&#xB6;</a></span></h3><p><span class="yiyi-st" id="yiyi-325">&#x5728;&#x6240;&#x6709;&#x8FD9;&#x4E9B;&#x4F8B;&#x5B50;&#x4E2D;&#xFF0C;&#x65E0;&#x8BBA;&#x6587;&#x5B57;&#x8868;&#x8FBE;&#x5F0F;&#x51FA;&#x73B0;&#x5728;&#x54EA;&#x91CC;&#xFF0C;SQLAlchemy&#x90FD;&#x5FD9;&#x4E8E;&#x521B;&#x5EFA;&#x7ED1;&#x5B9A;&#x53C2;&#x6570;&#x3002;</span><span class="yiyi-st" id="yiyi-326">&#x60A8;&#x4E5F;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;&#x81EA;&#x5DF1;&#x7684;&#x540D;&#x79F0;&#x6307;&#x5B9A;&#x81EA;&#x5DF1;&#x7684;&#x7ED1;&#x5B9A;&#x53C2;&#x6570;&#xFF0C;&#x5E76;&#x91CD;&#x590D;&#x4F7F;&#x7528;&#x76F8;&#x540C;&#x7684;&#x8BED;&#x53E5;&#x3002;</span><span class="yiyi-st" id="yiyi-327"><a class="reference internal" href="sqlelement.html#sqlalchemy.sql.expression.bindparam" title="sqlalchemy.sql.expression.bindparam"><code class="xref py py-func docutils literal"><span class="pre">bindparam()</span></code></a>&#x7ED3;&#x6784;&#x7528;&#x4E8E;&#x4EA7;&#x751F;&#x5177;&#x6709;&#x7ED9;&#x5B9A;&#x540D;&#x79F0;&#x7684;&#x7ED1;&#x5B9A;&#x53C2;&#x6570;&#x3002;</span><span class="yiyi-st" id="yiyi-328">&#x5C3D;&#x7BA1;SQLAlchemy&#x603B;&#x662F;&#x5728;API&#x7AEF;&#x901A;&#x8FC7;&#x540D;&#x79F0;&#x5F15;&#x7528;&#x7ED1;&#x5B9A;&#x53C2;&#x6570;&#xFF0C;&#x4F46;&#x6570;&#x636E;&#x5E93;&#x65B9;&#x8A00;&#x5728;&#x6267;&#x884C;&#x65F6;&#x4F1A;&#x8F6C;&#x6362;&#x4E3A;&#x9002;&#x5F53;&#x7684;&#x540D;&#x79F0;&#x6216;&#x4F4D;&#x7F6E;&#x6837;&#x5F0F;&#xFF0C;&#x56E0;&#x4E3A;&#x5728;&#x8FD9;&#x91CC;&#x5B83;&#x5C06;&#x8F6C;&#x6362;&#x4E3A;SQLite&#x7684;&#x4F4D;&#x7F6E;&#xFF1A;</span></p><div class="highlight-pycon+sql"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sqlalchemy.sql</span> <span class="kn">import</span> <span class="n">bindparam</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">users</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">users</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="n">bindparam</span><span class="p">(</span><span class="s1">&apos;username&apos;</span><span class="p">))</span>
<a class="sql_link" href="#">sql</a><span class="gp">&gt;&gt;&gt; </span><span class="n">conn</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">username</span><span class="o">=</span><span class="s1">&apos;wendy&apos;</span><span class="p">)</span><span class="o">.</span><span class="n">fetchall</span><span class="p">()</span>
<div class="popup_sql">SELECT users.id, users.name, users.fullname
FROM users
WHERE users.name = ?
(&apos;wendy&apos;,)
</div><span class="go">[(2, u&apos;wendy&apos;, u&apos;Wendy Williams&apos;)]</span></pre></div></div><p><span class="yiyi-st" id="yiyi-329"><a class="reference internal" href="sqlelement.html#sqlalchemy.sql.expression.bindparam" title="sqlalchemy.sql.expression.bindparam"><code class="xref py py-func docutils literal"><span class="pre">bindparam()</span></code></a>&#x7684;&#x53E6;&#x4E00;&#x4E2A;&#x91CD;&#x8981;&#x65B9;&#x9762;&#x662F;&#x5B83;&#x53EF;&#x4EE5;&#x88AB;&#x5206;&#x914D;&#x4E00;&#x4E2A;&#x7C7B;&#x578B;&#x3002;</span><span class="yiyi-st" id="yiyi-330">bind&#x53C2;&#x6570;&#x7684;&#x7C7B;&#x578B;&#x5C06;&#x51B3;&#x5B9A;&#x5B83;&#x5728;&#x8868;&#x8FBE;&#x5F0F;&#x4E2D;&#x7684;&#x884C;&#x4E3A;&#xFF0C;&#x4EE5;&#x53CA;&#x7ED1;&#x5B9A;&#x5230;&#x5B83;&#x7684;&#x6570;&#x636E;&#x5728;&#x88AB;&#x53D1;&#x9001;&#x5230;&#x6570;&#x636E;&#x5E93;&#x4E4B;&#x524D;&#x5982;&#x4F55;&#x5904;&#x7406;&#xFF1A;</span></p><div class="highlight-pycon+sql"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">users</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">users</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">like</span><span class="p">(</span><span class="n">bindparam</span><span class="p">(</span><span class="s1">&apos;username&apos;</span><span class="p">,</span> <span class="n">type_</span><span class="o">=</span><span class="n">String</span><span class="p">)</span> <span class="o">+</span> <span class="n">text</span><span class="p">(</span><span class="s2">&quot;&apos;%&apos;&quot;</span><span class="p">)))</span>
<a class="sql_link" href="#">sql</a><span class="gp">&gt;&gt;&gt; </span><span class="n">conn</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">username</span><span class="o">=</span><span class="s1">&apos;wendy&apos;</span><span class="p">)</span><span class="o">.</span><span class="n">fetchall</span><span class="p">()</span>
<div class="popup_sql">SELECT users.id, users.name, users.fullname
FROM users
WHERE users.name LIKE (? || &apos;%&apos;)
(&apos;wendy&apos;,)
</div><span class="go">[(2, u&apos;wendy&apos;, u&apos;Wendy Williams&apos;)]</span></pre></div></div><p><span class="yiyi-st" id="yiyi-331"><a class="reference internal" href="sqlelement.html#sqlalchemy.sql.expression.bindparam" title="sqlalchemy.sql.expression.bindparam"><code class="xref py py-func docutils literal"><span class="pre">bindparam()</span></code></a>&#x7ED3;&#x6784;&#x4E5F;&#x53EF;&#x4EE5;&#x591A;&#x6B21;&#x4F7F;&#x7528;&#xFF0C;&#x5176;&#x4E2D;execute&#x53C2;&#x6570;&#x4E2D;&#x53EA;&#x9700;&#x8981;&#x4E00;&#x4E2A;&#x547D;&#x540D;&#x503C;&#xFF1A;</span></p><div class="highlight-pycon+sql"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">select</span><span class="p">([</span><span class="n">users</span><span class="p">,</span> <span class="n">addresses</span><span class="p">])</span><span class="o">.</span>\
<span class="gp">... </span>    <span class="n">where</span><span class="p">(</span>
<span class="gp">... </span>       <span class="n">or_</span><span class="p">(</span>
<span class="gp">... </span>         <span class="n">users</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">like</span><span class="p">(</span>
<span class="gp">... </span>                <span class="n">bindparam</span><span class="p">(</span><span class="s1">&apos;name&apos;</span><span class="p">,</span> <span class="n">type_</span><span class="o">=</span><span class="n">String</span><span class="p">)</span> <span class="o">+</span> <span class="n">text</span><span class="p">(</span><span class="s2">&quot;&apos;%&apos;&quot;</span><span class="p">)),</span>
<span class="gp">... </span>         <span class="n">addresses</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">email_address</span><span class="o">.</span><span class="n">like</span><span class="p">(</span>
<span class="gp">... </span>                <span class="n">bindparam</span><span class="p">(</span><span class="s1">&apos;name&apos;</span><span class="p">,</span> <span class="n">type_</span><span class="o">=</span><span class="n">String</span><span class="p">)</span> <span class="o">+</span> <span class="n">text</span><span class="p">(</span><span class="s2">&quot;&apos;@%&apos;&quot;</span><span class="p">))</span>
<span class="gp">... </span>       <span class="p">)</span>
<span class="gp">... </span>    <span class="p">)</span><span class="o">.</span>\
<span class="gp">... </span>    <span class="n">select_from</span><span class="p">(</span><span class="n">users</span><span class="o">.</span><span class="n">outerjoin</span><span class="p">(</span><span class="n">addresses</span><span class="p">))</span><span class="o">.</span>\
<span class="gp">... </span>    <span class="n">order_by</span><span class="p">(</span><span class="n">addresses</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>
<a class="sql_link" href="#">sql</a><span class="gp">&gt;&gt;&gt; </span><span class="n">conn</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&apos;jack&apos;</span><span class="p">)</span><span class="o">.</span><span class="n">fetchall</span><span class="p">()</span>
<div class="popup_sql">SELECT users.id, users.name, users.fullname, addresses.id,
    addresses.user_id, addresses.email_address
FROM users LEFT OUTER JOIN addresses ON users.id = addresses.user_id
WHERE users.name LIKE (? || &apos;%&apos;) OR addresses.email_address LIKE (? || &apos;@%&apos;)
ORDER BY addresses.id
(&apos;jack&apos;, &apos;jack&apos;)
</div><span class="go">[(1, u&apos;jack&apos;, u&apos;Jack Jones&apos;, 1, 1, u&apos;jack@yahoo.com&apos;), (1, u&apos;jack&apos;, u&apos;Jack Jones&apos;, 2, 1, u&apos;jack@msn.com&apos;)]</span></pre></div></div><div class="admonition seealso"><p class="first admonition-title"><span class="yiyi-st" id="yiyi-332">&#x4E5F;&#x53EF;&#x4EE5;&#x770B;&#x770B;</span></p><p class="last"><span class="yiyi-st" id="yiyi-333"><a class="reference internal" href="sqlelement.html#sqlalchemy.sql.expression.bindparam" title="sqlalchemy.sql.expression.bindparam"><code class="xref py py-func docutils literal"><span class="pre">bindparam()</span></code></a></span></p></div></div><div class="section" id="functions"><h3><span class="yiyi-st" id="yiyi-334">&#x529F;&#x80FD;<a class="headerlink" href="#functions" title="Permalink to this headline">&#xB6; T0&gt;</a></span></h3><p><span class="yiyi-st" id="yiyi-335">SQL&#x51FD;&#x6570;&#x4F7F;&#x7528;<a class="reference internal" href="sqlelement.html#sqlalchemy.sql.expression.func" title="sqlalchemy.sql.expression.func"><code class="xref py py-data docutils literal"><span class="pre">func</span></code></a>&#x5173;&#x952E;&#x5B57;&#x521B;&#x5EFA;&#xFF0C;&#x8BE5;&#x5173;&#x952E;&#x5B57;&#x4F7F;&#x7528;&#x5C5E;&#x6027;&#x8BBF;&#x95EE;&#x751F;&#x6210;&#x51FD;&#x6570;&#xFF1A;</span></p><div class="highlight-pycon+sql"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sqlalchemy.sql</span> <span class="kn">import</span> <span class="n">func</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">func</span><span class="o">.</span><span class="n">now</span><span class="p">())</span>
<span class="go">now()</span>

<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">func</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="s1">&apos;x&apos;</span><span class="p">,</span> <span class="s1">&apos;y&apos;</span><span class="p">))</span>
<span class="go">concat(:concat_1, :concat_2)</span></pre></div></div><p><span class="yiyi-st" id="yiyi-336">By &#x201C;generates&#x201D;, we mean that <strong>any</strong> SQL function is created based on the word you choose:</span></p><div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">func</span><span class="o">.</span><span class="n">xyz_my_goofy_function</span><span class="p">())</span>
<span class="go">xyz_my_goofy_function()</span></pre></div></div><p><span class="yiyi-st" id="yiyi-337">&#x67D0;&#x4E9B;&#x51FD;&#x6570;&#x540D;&#x7531;SQLAlchemy&#x77E5;&#x9053;&#xFF0C;&#x5141;&#x8BB8;&#x5E94;&#x7528;&#x7279;&#x6B8A;&#x7684;&#x884C;&#x4E3A;&#x89C4;&#x5219;&#x3002;</span><span class="yiyi-st" id="yiyi-338">&#x4E00;&#x4E9B;&#x4F8B;&#x5982;&#x662F;&#x201C;ANSI&#x201D;&#x51FD;&#x6570;&#xFF0C;&#x8FD9;&#x610F;&#x5473;&#x7740;&#x5B83;&#x4EEC;&#x4E0D;&#x4F1A;&#x5728;&#x5B83;&#x4EEC;&#x540E;&#x9762;&#x6DFB;&#x52A0;&#x62EC;&#x53F7;&#xFF0C;&#x4F8B;&#x5982;CURRENT_TIMESTAMP&#xFF1A;</span></p><div class="highlight-pycon+sql"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">func</span><span class="o">.</span><span class="n">current_timestamp</span><span class="p">())</span>
<span class="go">CURRENT_TIMESTAMP</span></pre></div></div><p><span class="yiyi-st" id="yiyi-339">&#x51FD;&#x6570;&#x901A;&#x5E38;&#x7528;&#x5728;select&#x8BED;&#x53E5;&#x7684;columns&#x5B50;&#x53E5;&#x4E2D;&#xFF0C;&#x4E5F;&#x53EF;&#x4EE5;&#x6807;&#x8BB0;&#x4EE5;&#x53CA;&#x7ED9;&#x5B9A;&#x7C7B;&#x578B;&#x3002;</span><span class="yiyi-st" id="yiyi-340">&#x5EFA;&#x8BAE;&#x6807;&#x8BB0;&#x51FD;&#x6570;&#xFF0C;&#x4EE5;&#x4FBF;&#x53EF;&#x4EE5;&#x6839;&#x636E;&#x5B57;&#x7B26;&#x4E32;&#x540D;&#x79F0;&#x5C06;&#x7ED3;&#x679C;&#x5B9A;&#x4F4D;&#x5230;&#x7ED3;&#x679C;&#x884C;&#x4E2D;&#xFF0C;&#x5E76;&#x4E14;&#x5728;&#x9700;&#x8981;&#x6267;&#x884C;&#x7ED3;&#x679C;&#x96C6;&#x5904;&#x7406;&#xFF08;&#x4F8B;&#x5982;Unicode&#x8F6C;&#x6362;&#x548C;&#x65E5;&#x671F;&#x8F6C;&#x6362;&#xFF09;&#x65F6;&#x9700;&#x8981;&#x4E3A;&#x5176;&#x5206;&#x914D;&#x7C7B;&#x578B;&#x3002;</span><span class="yiyi-st" id="yiyi-341">&#x4E0B;&#x9762;&#xFF0C;&#x6211;&#x4EEC;&#x4F7F;&#x7528;&#x7ED3;&#x679C;&#x51FD;&#x6570;<code class="docutils literal"><span class="pre">scalar()</span></code>&#x6765;&#x8BFB;&#x53D6;&#x7B2C;&#x4E00;&#x884C;&#x7684;&#x7B2C;&#x4E00;&#x5217;&#xFF0C;&#x7136;&#x540E;&#x5173;&#x95ED;&#x7ED3;&#x679C;&#xFF1B;&#x5373;&#x4F7F;&#x5B58;&#x5728;&#xFF0C;&#x6807;&#x7B7E;&#x5728;&#x8FD9;&#x79CD;&#x60C5;&#x51B5;&#x4E0B;&#x5E76;&#x4E0D;&#x91CD;&#x8981;&#xFF1A;</span></p><div class="highlight-pycon+sql"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">conn</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">select</span><span class="p">([</span>
<span class="gp">... </span>           <span class="n">func</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">addresses</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">email_address</span><span class="p">,</span> <span class="n">type_</span><span class="o">=</span><span class="n">String</span><span class="p">)</span><span class="o">.</span>
<span class="gp">... </span>               <span class="n">label</span><span class="p">(</span><span class="s1">&apos;maxemail&apos;</span><span class="p">)</span>
<span class="gp">... </span>          <span class="p">])</span>
<span class="gp">... </span>    <span class="p">)</span><span class="o">.</span><span class="n">scalar</span><span class="p">()</span>
<div class="show_sql">SELECT max(addresses.email_address) AS maxemail
FROM addresses
()
</div><span class="go">u&apos;www@www.org&apos;</span></pre></div></div><p><span class="yiyi-st" id="yiyi-342">&#x652F;&#x6301;&#x8FD4;&#x56DE;&#x6574;&#x4E2A;&#x7ED3;&#x679C;&#x96C6;&#x7684;&#x51FD;&#x6570;&#x7684;PostgreSQL&#x548C;Oracle&#x7B49;&#x6570;&#x636E;&#x5E93;&#x53EF;&#x4EE5;&#x7EC4;&#x5408;&#x6210;&#x53EF;&#x9009;&#x5355;&#x4F4D;&#xFF0C;&#x53EF;&#x7528;&#x4E8E;&#x8BED;&#x53E5;&#x4E2D;&#x3002;</span><span class="yiyi-st" id="yiyi-343">Such as, a database function <code class="docutils literal"><span class="pre">calculate()</span></code> which takes the parameters <code class="docutils literal"><span class="pre">x</span></code> and <code class="docutils literal"><span class="pre">y</span></code>, and returns three columns which we&#x2019;d like to name <code class="docutils literal"><span class="pre">q</span></code>, <code class="docutils literal"><span class="pre">z</span></code> and <code class="docutils literal"><span class="pre">r</span></code>, we can construct using &#x201C;lexical&#x201D; column objects as well as bind parameters:</span></p><div class="highlight-pycon+sql"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sqlalchemy.sql</span> <span class="kn">import</span> <span class="n">column</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">calculate</span> <span class="o">=</span> <span class="n">select</span><span class="p">([</span><span class="n">column</span><span class="p">(</span><span class="s1">&apos;q&apos;</span><span class="p">),</span> <span class="n">column</span><span class="p">(</span><span class="s1">&apos;z&apos;</span><span class="p">),</span> <span class="n">column</span><span class="p">(</span><span class="s1">&apos;r&apos;</span><span class="p">)])</span><span class="o">.</span>\
<span class="gp">... </span>       <span class="n">select_from</span><span class="p">(</span>
<span class="gp">... </span>            <span class="n">func</span><span class="o">.</span><span class="n">calculate</span><span class="p">(</span>
<span class="gp">... </span>                   <span class="n">bindparam</span><span class="p">(</span><span class="s1">&apos;x&apos;</span><span class="p">),</span>
<span class="gp">... </span>                   <span class="n">bindparam</span><span class="p">(</span><span class="s1">&apos;y&apos;</span><span class="p">)</span>
<span class="gp">... </span>               <span class="p">)</span>
<span class="gp">... </span>            <span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">calc</span> <span class="o">=</span> <span class="n">calculate</span><span class="o">.</span><span class="n">alias</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">select</span><span class="p">([</span><span class="n">users</span><span class="p">])</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">users</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">id</span> <span class="o">&gt;</span> <span class="n">calc</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">z</span><span class="p">))</span>
<span class="go">SELECT users.id, users.name, users.fullname</span>
<span class="go">FROM users, (SELECT q, z, r</span>
<span class="go">FROM calculate(:x, :y)) AS anon_1</span>
<span class="go">WHERE users.id &gt; anon_1.z</span></pre></div></div><p><span class="yiyi-st" id="yiyi-344">&#x5982;&#x679C;&#x6211;&#x4EEC;&#x60F3;&#x8981;&#x7528;&#x4E0D;&#x540C;&#x7684;&#x7ED1;&#x5B9A;&#x53C2;&#x6570;&#x4E24;&#x6B21;&#x4F7F;&#x7528;&#x6211;&#x4EEC;&#x7684;<code class="docutils literal"><span class="pre">calculate</span></code>&#x8BED;&#x53E5;&#xFF0C;<a class="reference internal" href="sqlelement.html#sqlalchemy.sql.expression.ClauseElement.unique_params" title="sqlalchemy.sql.expression.ClauseElement.unique_params"><code class="xref py py-func docutils literal"><span class="pre">unique_params()</span></code></a>&#x51FD;&#x6570;&#x5C06;&#x4E3A;&#x6211;&#x4EEC;&#x521B;&#x5EFA;&#x526F;&#x672C;&#xFF0C;&#x5E76;&#x5C06;&#x7ED1;&#x5B9A;&#x53C2;&#x6570;&#x6807;&#x8BB0;&#x4E3A;&#x201C;unique&#x201D;&#x76F8;&#x4E92;&#x51B2;&#x7A81;&#x7684;&#x540D;&#x5B57;&#x662F;&#x5B64;&#x7ACB;&#x7684;&#x3002;</span><span class="yiyi-st" id="yiyi-345">&#x8BF7;&#x6CE8;&#x610F;&#xFF0C;&#x6211;&#x4EEC;&#x4E5F;&#x53EF;&#x4EE5;&#x9009;&#x62E9;&#x4E24;&#x4E2A;&#x5355;&#x72EC;&#x7684;&#x522B;&#x540D;&#xFF1A;</span></p><div class="highlight-pycon+sql"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">calc1</span> <span class="o">=</span> <span class="n">calculate</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s1">&apos;c1&apos;</span><span class="p">)</span><span class="o">.</span><span class="n">unique_params</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mi">17</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mi">45</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">calc2</span> <span class="o">=</span> <span class="n">calculate</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s1">&apos;c2&apos;</span><span class="p">)</span><span class="o">.</span><span class="n">unique_params</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">select</span><span class="p">([</span><span class="n">users</span><span class="p">])</span><span class="o">.</span>\
<span class="gp">... </span>        <span class="n">where</span><span class="p">(</span><span class="n">users</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">id</span><span class="o">.</span><span class="n">between</span><span class="p">(</span><span class="n">calc1</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">z</span><span class="p">,</span> <span class="n">calc2</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">z</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
<span class="go">SELECT users.id, users.name, users.fullname</span>
<span class="go">FROM users,</span>
<span class="go">    (SELECT q, z, r FROM calculate(:x_1, :y_1)) AS c1,</span>
<span class="go">    (SELECT q, z, r FROM calculate(:x_2, :y_2)) AS c2</span>
<span class="go">WHERE users.id BETWEEN c1.z AND c2.z</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">compile</span><span class="p">()</span><span class="o">.</span><span class="n">params</span> <span class="c1"># doctest: +SKIP</span>
<span class="go">{u&apos;x_2&apos;: 5, u&apos;y_2&apos;: 12, u&apos;y_1&apos;: 45, u&apos;x_1&apos;: 17}</span></pre></div></div><div class="admonition seealso"><p class="first admonition-title"><span class="yiyi-st" id="yiyi-346">&#x4E5F;&#x53EF;&#x4EE5;&#x770B;&#x770B;</span></p><p class="last"><span class="yiyi-st" id="yiyi-347"><a class="reference internal" href="sqlelement.html#sqlalchemy.sql.expression.func" title="sqlalchemy.sql.expression.func"><code class="xref py py-data docutils literal"><span class="pre">func</span></code></a></span></p></div></div><div class="section" id="window-functions"><h3><span class="yiyi-st" id="yiyi-348">&#x7A97;&#x53E3;&#x51FD;&#x6570;<a class="headerlink" href="#window-functions" title="Permalink to this headline">&#xB6;</a></span></h3><p><span class="yiyi-st" id="yiyi-349">&#x4EFB;&#x4F55;<a class="reference internal" href="functions.html#sqlalchemy.sql.functions.FunctionElement" title="sqlalchemy.sql.functions.FunctionElement"><code class="xref py py-class docutils literal"><span class="pre">FunctionElement</span></code></a>&#xFF0C;&#x5305;&#x62EC;&#x7531;<a class="reference internal" href="sqlelement.html#sqlalchemy.sql.expression.func" title="sqlalchemy.sql.expression.func"><code class="xref py py-data docutils literal"><span class="pre">func</span></code></a>&#x751F;&#x6210;&#x7684;&#x51FD;&#x6570;&#x90FD;&#x53EF;&#x4EE5;&#x8F6C;&#x6362;&#x6210;&#x4E00;&#x4E2A;&#x201C;&#x7A97;&#x53E3;&#x51FD;&#x6570;&#x201D;&#xFF0C;&#x5373;OVER&#x5B50;&#x53E5;&#xFF0C;&#x4F7F;&#x7528;<a class="reference internal" href="functions.html#sqlalchemy.sql.functions.FunctionElement.over" title="sqlalchemy.sql.functions.FunctionElement.over"><code class="xref py py-meth docutils literal"><span class="pre">FunctionElement.over()</span></code></a></span></p><div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">select</span><span class="p">([</span>
<span class="gp">... </span>        <span class="n">users</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">id</span><span class="p">,</span>
<span class="gp">... </span>        <span class="n">func</span><span class="o">.</span><span class="n">row_number</span><span class="p">()</span><span class="o">.</span><span class="n">over</span><span class="p">(</span><span class="n">order_by</span><span class="o">=</span><span class="n">users</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
<span class="gp">... </span>    <span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
<span class="go">SELECT users.id, row_number() OVER (ORDER BY users.name) AS anon_1</span>
<span class="go">FROM users</span></pre></div></div><p><span class="yiyi-st" id="yiyi-350"><a class="reference internal" href="functions.html#sqlalchemy.sql.functions.FunctionElement.over" title="sqlalchemy.sql.functions.FunctionElement.over"><code class="xref py py-meth docutils literal"><span class="pre">FunctionElement.over()</span></code></a>&#x8FD8;&#x652F;&#x6301;&#x4F7F;&#x7528;<a class="reference internal" href="sqlelement.html#sqlalchemy.sql.expression.over.params.rows" title="sqlalchemy.sql.expression.over"><code class="xref py py-paramref docutils literal"><span class="pre">expression.over.rows</span></code></a>&#x6216;<a class="reference internal" href="sqlelement.html#sqlalchemy.sql.expression.over.params.range" title="sqlalchemy.sql.expression.over"><code class="xref py py-paramref docutils literal"><span class="pre">expression.over.range</span></code></a>&#x53C2;&#x6570;&#x8FDB;&#x884C;&#x8303;&#x56F4;&#x89C4;&#x5B9A;&#xFF1A;</span></p><div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">select</span><span class="p">([</span>
<span class="gp">... </span>        <span class="n">users</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">id</span><span class="p">,</span>
<span class="gp">... </span>        <span class="n">func</span><span class="o">.</span><span class="n">row_number</span><span class="p">()</span><span class="o">.</span><span class="n">over</span><span class="p">(</span>
<span class="gp">... </span>                <span class="n">order_by</span><span class="o">=</span><span class="n">users</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
<span class="gp">... </span>                <span class="n">rows</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="bp">None</span><span class="p">))</span>
<span class="gp">... </span>    <span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
<span class="go">SELECT users.id, row_number() OVER</span>
<span class="go">(ORDER BY users.name ROWS BETWEEN :param_1 PRECEDING AND UNBOUNDED FOLLOWING) AS anon_1</span>
<span class="go">FROM users</span></pre></div></div><p><span class="yiyi-st" id="yiyi-351"><a class="reference internal" href="sqlelement.html#sqlalchemy.sql.expression.over.params.rows" title="sqlalchemy.sql.expression.over"><code class="xref py py-paramref docutils literal"><span class="pre">expression.over.rows</span></code></a>&#x548C;<a class="reference internal" href="sqlelement.html#sqlalchemy.sql.expression.over.params.range" title="sqlalchemy.sql.expression.over"><code class="xref py py-paramref docutils literal"><span class="pre">expression.over.range</span></code></a>&#x5747;&#x63A5;&#x53D7;&#x4E00;&#x4E2A;&#x4E8C;&#x5143;&#x7EC4;&#xFF0C;&#x5176;&#x4E2D;&#x5305;&#x542B;&#x8303;&#x56F4;&#x7684;&#x8D1F;&#x6574;&#x6570;&#x548C;&#x6B63;&#x6574;&#x6570;&#x7684;&#x7EC4;&#x5408;&#xFF0C;&#x96F6;&#x8868;&#x793A;&#x201C;CURRENT ROW&#x201D;&#x548C;<code class="docutils literal"><span class="pre">None</span></code>&#x4EE5;&#x6307;&#x793A;&#x201C;UNBOUNDED&#x201D;&#x3002;</span><span class="yiyi-st" id="yiyi-352">&#x6709;&#x5173;&#x66F4;&#x591A;&#x8BE6;&#x7EC6;&#x4FE1;&#x606F;&#xFF0C;&#x8BF7;&#x53C2;&#x9605;<a class="reference internal" href="sqlelement.html#sqlalchemy.sql.expression.over" title="sqlalchemy.sql.expression.over"><code class="xref py py-func docutils literal"><span class="pre">over()</span></code></a>&#x4E0A;&#x7684;&#x793A;&#x4F8B;&#x3002;</span></p><div class="versionadded"><p><span class="yiyi-st" id="yiyi-353"><span class="versionmodified">&#x7248;&#x672C;1.1&#x4E2D;&#x7684;&#x65B0;&#x529F;&#x80FD;&#xFF1A;</span>&#x652F;&#x6301;&#x7A97;&#x53E3;&#x51FD;&#x6570;&#x7684;&#x201C;&#x884C;&#x201D;&#x548C;&#x201C;&#x8303;&#x56F4;&#x201D;&#x89C4;&#x8303;</span></p></div><div class="admonition seealso"><p class="first admonition-title"><span class="yiyi-st" id="yiyi-354">&#x4E5F;&#x53EF;&#x4EE5;&#x770B;&#x770B;</span></p><p><span class="yiyi-st" id="yiyi-355"><a class="reference internal" href="sqlelement.html#sqlalchemy.sql.expression.over" title="sqlalchemy.sql.expression.over"><code class="xref py py-func docutils literal"><span class="pre">over()</span></code></a></span></p><p class="last"><span class="yiyi-st" id="yiyi-356"><a class="reference internal" href="functions.html#sqlalchemy.sql.functions.FunctionElement.over" title="sqlalchemy.sql.functions.FunctionElement.over"><code class="xref py py-meth docutils literal"><span class="pre">FunctionElement.over()</span></code></a></span></p></div></div><div class="section" id="unions-and-other-set-operations"><h3><span class="yiyi-st" id="yiyi-357">&#x8054;&#x5408;&#x548C;&#x5176;&#x4ED6;&#x96C6;&#x5408;&#x64CD;&#x4F5C;<a class="headerlink" href="#unions-and-other-set-operations" title="Permalink to this headline">&#xB6;</a></span></h3><p><span class="yiyi-st" id="yiyi-358">&#x8054;&#x5408;&#x4F53;&#x6709;&#x4E24;&#x79CD;&#x98CE;&#x683C;&#xFF0C;UNION&#x548C;UNION ALL&#xFF0C;&#x5B83;&#x4EEC;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x6A21;&#x5757;&#x7EA7;&#x51FD;&#x6570;<a class="reference internal" href="selectable.html#sqlalchemy.sql.expression.union" title="sqlalchemy.sql.expression.union"><code class="xref py py-func docutils literal"><span class="pre">union()</span></code></a>&#x548C;<a class="reference internal" href="selectable.html#sqlalchemy.sql.expression.union_all" title="sqlalchemy.sql.expression.union_all"><code class="xref py py-func docutils literal"><span class="pre">union_all()</span></code></a>&#x4F7F;&#x7528;&#xFF1A;</span></p><div class="highlight-pycon+sql"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sqlalchemy.sql</span> <span class="kn">import</span> <span class="n">union</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">u</span> <span class="o">=</span> <span class="n">union</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">addresses</span><span class="o">.</span><span class="n">select</span><span class="p">()</span><span class="o">.</span>
<span class="gp">... </span>            <span class="n">where</span><span class="p">(</span><span class="n">addresses</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">email_address</span> <span class="o">==</span> <span class="s1">&apos;foo@bar.com&apos;</span><span class="p">),</span>
<span class="gp">... </span>   <span class="n">addresses</span><span class="o">.</span><span class="n">select</span><span class="p">()</span><span class="o">.</span>
<span class="gp">... </span>            <span class="n">where</span><span class="p">(</span><span class="n">addresses</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">email_address</span><span class="o">.</span><span class="n">like</span><span class="p">(</span><span class="s1">&apos;%@yahoo.com&apos;</span><span class="p">)),</span>
<span class="gp">... </span><span class="p">)</span><span class="o">.</span><span class="n">order_by</span><span class="p">(</span><span class="n">addresses</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">email_address</span><span class="p">)</span>

<a class="sql_link" href="#">sql</a><span class="gp">&gt;&gt;&gt; </span><span class="n">conn</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">u</span><span class="p">)</span><span class="o">.</span><span class="n">fetchall</span><span class="p">()</span>
<div class="popup_sql">SELECT addresses.id, addresses.user_id, addresses.email_address
FROM addresses
WHERE addresses.email_address = ?
UNION
SELECT addresses.id, addresses.user_id, addresses.email_address
FROM addresses
WHERE addresses.email_address LIKE ? ORDER BY addresses.email_address
(&apos;foo@bar.com&apos;, &apos;%@yahoo.com&apos;)
</div><span class="go">[(1, 1, u&apos;jack@yahoo.com&apos;)]</span></pre></div></div><p><span class="yiyi-st" id="yiyi-359">Also available, though not supported on all databases, are <a class="reference internal" href="selectable.html#sqlalchemy.sql.expression.intersect" title="sqlalchemy.sql.expression.intersect"><code class="xref py py-func docutils literal"><span class="pre">intersect()</span></code></a>, <a class="reference internal" href="selectable.html#sqlalchemy.sql.expression.intersect_all" title="sqlalchemy.sql.expression.intersect_all"><code class="xref py py-func docutils literal"><span class="pre">intersect_all()</span></code></a>, <a class="reference internal" href="selectable.html#sqlalchemy.sql.expression.except_" title="sqlalchemy.sql.expression.except_"><code class="xref py py-func docutils literal"><span class="pre">except_()</span></code></a>, and <a class="reference internal" href="selectable.html#sqlalchemy.sql.expression.except_all" title="sqlalchemy.sql.expression.except_all"><code class="xref py py-func docutils literal"><span class="pre">except_all()</span></code></a>:</span></p><div class="highlight-pycon+sql"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sqlalchemy.sql</span> <span class="kn">import</span> <span class="n">except_</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">u</span> <span class="o">=</span> <span class="n">except_</span><span class="p">(</span>
<span class="gp">... </span>   <span class="n">addresses</span><span class="o">.</span><span class="n">select</span><span class="p">()</span><span class="o">.</span>
<span class="gp">... </span>            <span class="n">where</span><span class="p">(</span><span class="n">addresses</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">email_address</span><span class="o">.</span><span class="n">like</span><span class="p">(</span><span class="s1">&apos;%@%.com&apos;</span><span class="p">)),</span>
<span class="gp">... </span>   <span class="n">addresses</span><span class="o">.</span><span class="n">select</span><span class="p">()</span><span class="o">.</span>
<span class="gp">... </span>            <span class="n">where</span><span class="p">(</span><span class="n">addresses</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">email_address</span><span class="o">.</span><span class="n">like</span><span class="p">(</span><span class="s1">&apos;%@msn.com&apos;</span><span class="p">))</span>
<span class="gp">... </span><span class="p">)</span>

<a class="sql_link" href="#">sql</a><span class="gp">&gt;&gt;&gt; </span><span class="n">conn</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">u</span><span class="p">)</span><span class="o">.</span><span class="n">fetchall</span><span class="p">()</span>
<div class="popup_sql">SELECT addresses.id, addresses.user_id, addresses.email_address
FROM addresses
WHERE addresses.email_address LIKE ?
EXCEPT
SELECT addresses.id, addresses.user_id, addresses.email_address
FROM addresses
WHERE addresses.email_address LIKE ?
(&apos;%@%.com&apos;, &apos;%@msn.com&apos;)
</div><span class="go">[(1, 1, u&apos;jack@yahoo.com&apos;), (4, 2, u&apos;wendy@aol.com&apos;)]</span></pre></div></div><p><span class="yiyi-st" id="yiyi-360">&#x6240;&#x8C13;&#x7684;&#x201C;&#x590D;&#x5408;&#x201D;&#x53EF;&#x9009;&#x9879;&#x7684;&#x4E00;&#x4E2A;&#x5E38;&#x89C1;&#x95EE;&#x9898;&#x662F;&#x7531;&#x4E8E;&#x5B83;&#x4EEC;&#x4E0E;&#x62EC;&#x53F7;&#x5D4C;&#x5957;&#x7684;&#x4E8B;&#x5B9E;&#x800C;&#x4EA7;&#x751F;&#x7684;&#x3002;</span><span class="yiyi-st" id="yiyi-361">&#x7279;&#x522B;&#x662F;SQLite&#x4E0D;&#x559C;&#x6B22;&#x4EE5;&#x62EC;&#x53F7;&#x5F00;&#x5934;&#x7684;&#x8BED;&#x53E5;&#x3002;</span><span class="yiyi-st" id="yiyi-362">&#x56E0;&#x6B64;&#xFF0C;&#x5728;&#x201C;&#x5316;&#x5408;&#x7269;&#x201D;&#x4E2D;&#x5D4C;&#x5957;&#x201C;&#x5316;&#x5408;&#x7269;&#x201D;&#x65F6;&#xFF0C;&#x5982;&#x679C;&#x8BE5;&#x5316;&#x5408;&#x7269;&#x4E5F;&#x662F;&#x5316;&#x5408;&#x7269;&#xFF0C;&#x901A;&#x5E38;&#x9700;&#x8981;&#x5C06;<code class="docutils literal"><span class="pre">.alias().select()</span></code>&#x5E94;&#x7528;&#x4E8E;&#x6700;&#x5916;&#x5C42;&#x5316;&#x5408;&#x7269;&#x7684;&#x7B2C;&#x4E00;&#x4E2A;&#x5143;&#x7D20;&#x3002;</span><span class="yiyi-st" id="yiyi-363">&#x4F8B;&#x5982;&#xFF0C;&#x8981;&#x5728;&#x201C;except_&#x201D;&#x4E2D;&#x5D4C;&#x5957;&#x201C;union&#x201D;&#x548C;&#x201C;select&#x201D;&#xFF0C;SQLite&#x4F1A;&#x5E0C;&#x671B;&#x5C06;&#x201C;union&#x201D;&#x58F0;&#x660E;&#x4E3A;&#x5B50;&#x67E5;&#x8BE2;&#xFF1A;</span></p><div class="highlight-pycon+sql"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">u</span> <span class="o">=</span> <span class="n">except_</span><span class="p">(</span>
<span class="gp">... </span>   <span class="n">union</span><span class="p">(</span>
<span class="gp">... </span>        <span class="n">addresses</span><span class="o">.</span><span class="n">select</span><span class="p">()</span><span class="o">.</span>
<span class="gp">... </span>            <span class="n">where</span><span class="p">(</span><span class="n">addresses</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">email_address</span><span class="o">.</span><span class="n">like</span><span class="p">(</span><span class="s1">&apos;%@yahoo.com&apos;</span><span class="p">)),</span>
<span class="gp">... </span>        <span class="n">addresses</span><span class="o">.</span><span class="n">select</span><span class="p">()</span><span class="o">.</span>
<span class="gp">... </span>            <span class="n">where</span><span class="p">(</span><span class="n">addresses</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">email_address</span><span class="o">.</span><span class="n">like</span><span class="p">(</span><span class="s1">&apos;%@msn.com&apos;</span><span class="p">))</span>
<span class="gp">... </span>    <span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">()</span><span class="o">.</span><span class="n">select</span><span class="p">(),</span>   <span class="c1"># apply subquery here</span>
<span class="gp">... </span>   <span class="n">addresses</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">addresses</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">email_address</span><span class="o">.</span><span class="n">like</span><span class="p">(</span><span class="s1">&apos;%@msn.com&apos;</span><span class="p">))</span>
<span class="gp">... </span><span class="p">)</span>
<a class="sql_link" href="#">sql</a><span class="gp">&gt;&gt;&gt; </span><span class="n">conn</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">u</span><span class="p">)</span><span class="o">.</span><span class="n">fetchall</span><span class="p">()</span>
<div class="popup_sql">SELECT anon_1.id, anon_1.user_id, anon_1.email_address
FROM (SELECT addresses.id AS id, addresses.user_id AS user_id,
    addresses.email_address AS email_address
    FROM addresses
    WHERE addresses.email_address LIKE ?
    UNION
    SELECT addresses.id AS id,
        addresses.user_id AS user_id,
        addresses.email_address AS email_address
    FROM addresses
    WHERE addresses.email_address LIKE ?) AS anon_1
EXCEPT
SELECT addresses.id, addresses.user_id, addresses.email_address
FROM addresses
WHERE addresses.email_address LIKE ?
(&apos;%@yahoo.com&apos;, &apos;%@msn.com&apos;, &apos;%@msn.com&apos;)
</div><span class="go">[(1, 1, u&apos;jack@yahoo.com&apos;)]</span></pre></div></div><div class="admonition seealso"><p class="first admonition-title"><span class="yiyi-st" id="yiyi-364">&#x4E5F;&#x53EF;&#x4EE5;&#x770B;&#x770B;</span></p><p><span class="yiyi-st" id="yiyi-365"><a class="reference internal" href="selectable.html#sqlalchemy.sql.expression.union" title="sqlalchemy.sql.expression.union"><code class="xref py py-func docutils literal"><span class="pre">union()</span></code></a></span></p><p><span class="yiyi-st" id="yiyi-366"><a class="reference internal" href="selectable.html#sqlalchemy.sql.expression.union_all" title="sqlalchemy.sql.expression.union_all"><code class="xref py py-func docutils literal"><span class="pre">union_all()</span></code></a></span></p><p><span class="yiyi-st" id="yiyi-367"><a class="reference internal" href="selectable.html#sqlalchemy.sql.expression.intersect" title="sqlalchemy.sql.expression.intersect"><code class="xref py py-func docutils literal"><span class="pre">intersect()</span></code></a></span></p><p><span class="yiyi-st" id="yiyi-368"><a class="reference internal" href="selectable.html#sqlalchemy.sql.expression.intersect_all" title="sqlalchemy.sql.expression.intersect_all"><code class="xref py py-func docutils literal"><span class="pre">intersect_all()</span></code></a></span></p><p><span class="yiyi-st" id="yiyi-369"><a class="reference internal" href="selectable.html#sqlalchemy.sql.expression.except_" title="sqlalchemy.sql.expression.except_"><code class="xref py py-func docutils literal"><span class="pre">except_()</span></code></a></span></p><p class="last"><span class="yiyi-st" id="yiyi-370"><a class="reference internal" href="selectable.html#sqlalchemy.sql.expression.except_all" title="sqlalchemy.sql.expression.except_all"><code class="xref py py-func docutils literal"><span class="pre">except_all()</span></code></a></span></p></div></div><div class="section" id="scalar-selects"><h3><span class="yiyi-st" id="yiyi-371">&#x6807;&#x91CF;&#x9009;&#x62E9;<a class="headerlink" href="#scalar-selects" title="Permalink to this headline">&#xB6;</a></span></h3><p><span class="yiyi-st" id="yiyi-372">&#x6807;&#x91CF;&#x9009;&#x62E9;&#x662F;&#x4E00;&#x4E2A;&#x53EA;&#x8FD4;&#x56DE;&#x4E00;&#x884C;&#x548C;&#x4E00;&#x5217;&#x7684;SELECT&#x3002;</span><span class="yiyi-st" id="yiyi-373">&#x7136;&#x540E;&#x5B83;&#x53EF;&#x4EE5;&#x7528;&#x4F5C;&#x5217;&#x8868;&#x8FBE;&#x5F0F;&#x3002;</span><span class="yiyi-st" id="yiyi-374">A scalar select is often a <a class="reference internal" href="glossary.html#term-correlated-subquery"><span class="xref std std-term">correlated subquery</span></a>, which relies upon the enclosing SELECT statement in order to acquire at least one of its FROM clauses.</span></p><p><span class="yiyi-st" id="yiyi-375">&#x901A;&#x8FC7;&#x8C03;&#x7528;<a class="reference internal" href="selectable.html#sqlalchemy.sql.expression.SelectBase.as_scalar" title="sqlalchemy.sql.expression.SelectBase.as_scalar"><code class="xref py py-meth docutils literal"><span class="pre">as_scalar()</span></code></a>&#x6216;<a class="reference internal" href="selectable.html#sqlalchemy.sql.expression.SelectBase.label" title="sqlalchemy.sql.expression.SelectBase.label"><code class="xref py py-meth docutils literal"><span class="pre">label()</span></code></a>&#x65B9;&#x6CD5;&#xFF0C;&#x53EF;&#x4EE5;&#x4FEE;&#x6539;<a class="reference internal" href="selectable.html#sqlalchemy.sql.expression.select" title="sqlalchemy.sql.expression.select"><code class="xref py py-func docutils literal"><span class="pre">select()</span></code></a>&#x7ED3;&#x6784;&#x4EE5;&#x5145;&#x5F53;&#x5217;&#x8868;&#x8FBE;&#x5F0F;&#xFF1A;</span></p><div class="highlight-pycon+sql"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">stmt</span> <span class="o">=</span> <span class="n">select</span><span class="p">([</span><span class="n">func</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="n">addresses</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">id</span><span class="p">)])</span><span class="o">.</span>\
<span class="gp">... </span>            <span class="n">where</span><span class="p">(</span><span class="n">users</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">id</span> <span class="o">==</span> <span class="n">addresses</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">user_id</span><span class="p">)</span><span class="o">.</span>\
<span class="gp">... </span>            <span class="n">as_scalar</span><span class="p">()</span></pre></div></div><p><span class="yiyi-st" id="yiyi-376">The above construct is now a <a class="reference internal" href="selectable.html#sqlalchemy.sql.expression.ScalarSelect" title="sqlalchemy.sql.expression.ScalarSelect"><code class="xref py py-class docutils literal"><span class="pre">ScalarSelect</span></code></a> object, and is no longer part of the <a class="reference internal" href="selectable.html#sqlalchemy.sql.expression.FromClause" title="sqlalchemy.sql.expression.FromClause"><code class="xref py py-class docutils literal"><span class="pre">FromClause</span></code></a> hierarchy; it instead is within the <a class="reference internal" href="sqlelement.html#sqlalchemy.sql.expression.ColumnElement" title="sqlalchemy.sql.expression.ColumnElement"><code class="xref py py-class docutils literal"><span class="pre">ColumnElement</span></code></a> family of expression constructs. </span><span class="yiyi-st" id="yiyi-377">&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x5C06;&#x8FD9;&#x4E2A;&#x7ED3;&#x6784;&#x653E;&#x5728;&#x53E6;&#x4E00;&#x4E2A;&#x5217;&#x7684;&#x53E6;&#x4E00;&#x4E2A;&#x5217;&#x4E2D;&#x3002;<a class="reference internal" href="selectable.html#sqlalchemy.sql.expression.select" title="sqlalchemy.sql.expression.select"><code class="xref py py-func docutils literal"><span class="pre">select()</span></code></a>&#xFF1A;</span></p><div class="highlight-pycon+sql"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">conn</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">select</span><span class="p">([</span><span class="n">users</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">stmt</span><span class="p">]))</span><span class="o">.</span><span class="n">fetchall</span><span class="p">()</span>
<div class="show_sql">SELECT users.name, (SELECT count(addresses.id) AS count_1
FROM addresses
WHERE users.id = addresses.user_id) AS anon_1
FROM users
()
</div><span class="go">[(u&apos;jack&apos;, 2), (u&apos;wendy&apos;, 2)]</span></pre></div></div><p><span class="yiyi-st" id="yiyi-378">&#x8981;&#x5C06;&#x975E;&#x533F;&#x540D;&#x5217;&#x540D;&#x5E94;&#x7528;&#x4E8E;&#x6211;&#x4EEC;&#x7684;&#x6807;&#x91CF;&#x9009;&#x62E9;&#xFF0C;&#x6211;&#x4EEC;&#x4F7F;&#x7528;<a class="reference internal" href="selectable.html#sqlalchemy.sql.expression.SelectBase.label" title="sqlalchemy.sql.expression.SelectBase.label"><code class="xref py py-meth docutils literal"><span class="pre">SelectBase.label()</span></code></a>&#x6765;&#x521B;&#x5EFA;&#x5B83;&#xFF1A;</span></p><div class="highlight-pycon+sql"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">stmt</span> <span class="o">=</span> <span class="n">select</span><span class="p">([</span><span class="n">func</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="n">addresses</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">id</span><span class="p">)])</span><span class="o">.</span>\
<span class="gp">... </span>            <span class="n">where</span><span class="p">(</span><span class="n">users</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">id</span> <span class="o">==</span> <span class="n">addresses</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">user_id</span><span class="p">)</span><span class="o">.</span>\
<span class="gp">... </span>            <span class="n">label</span><span class="p">(</span><span class="s2">&quot;address_count&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">conn</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">select</span><span class="p">([</span><span class="n">users</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">stmt</span><span class="p">]))</span><span class="o">.</span><span class="n">fetchall</span><span class="p">()</span>
<div class="show_sql">SELECT users.name, (SELECT count(addresses.id) AS count_1
FROM addresses
WHERE users.id = addresses.user_id) AS address_count
FROM users
()
</div><span class="go">[(u&apos;jack&apos;, 2), (u&apos;wendy&apos;, 2)]</span></pre></div></div><div class="admonition seealso"><p class="first admonition-title"><span class="yiyi-st" id="yiyi-379">&#x4E5F;&#x53EF;&#x4EE5;&#x770B;&#x770B;</span></p><p><span class="yiyi-st" id="yiyi-380"><a class="reference internal" href="selectable.html#sqlalchemy.sql.expression.Select.as_scalar" title="sqlalchemy.sql.expression.Select.as_scalar"><code class="xref py py-meth docutils literal"><span class="pre">Select.as_scalar()</span></code></a></span></p><p class="last"><span class="yiyi-st" id="yiyi-381"><a class="reference internal" href="selectable.html#sqlalchemy.sql.expression.Select.label" title="sqlalchemy.sql.expression.Select.label"><code class="xref py py-meth docutils literal"><span class="pre">Select.label()</span></code></a></span></p></div></div><div class="section" id="correlated-subqueries"><h3><span class="yiyi-st" id="yiyi-382">&#x76F8;&#x5173;&#x5B50;&#x67E5;&#x8BE2;<a class="headerlink" href="#correlated-subqueries" title="Permalink to this headline">&#xB6;</a></span></h3><p><span class="yiyi-st" id="yiyi-383">&#x8BF7;&#x6CE8;&#x610F;&#xFF0C;&#x5728;<a class="reference internal" href="#scalar-selects"><span>Scalar Selects</span></a>&#x7684;&#x793A;&#x4F8B;&#x4E2D;&#xFF0C;&#x6BCF;&#x4E2A;&#x5D4C;&#x5165;&#x5F0F;&#x9009;&#x62E9;&#x7684;FROM&#x5B50;&#x53E5;&#x5728;&#x5176;FROM&#x5B50;&#x53E5;&#x4E2D;&#x90FD;&#x4E0D;&#x5305;&#x542B;<code class="docutils literal"><span class="pre">users</span></code>&#x8868;&#x3002;</span><span class="yiyi-st" id="yiyi-384">&#x8FD9;&#x662F;&#x56E0;&#x4E3A;SQLAlchemy&#x81EA;&#x52A8;&#x5C06;<a class="reference internal" href="glossary.html#term-correlates"><span class="xref std std-term">correlates</span></a></span><span class="yiyi-st" id="yiyi-385">&#x4F8B;&#x5982;&#xFF1A;</span></p><div class="highlight-pycon+sql"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">stmt</span> <span class="o">=</span> <span class="n">select</span><span class="p">([</span><span class="n">addresses</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">user_id</span><span class="p">])</span><span class="o">.</span>\
<span class="gp">... </span>            <span class="n">where</span><span class="p">(</span><span class="n">addresses</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">user_id</span> <span class="o">==</span> <span class="n">users</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">id</span><span class="p">)</span><span class="o">.</span>\
<span class="gp">... </span>            <span class="n">where</span><span class="p">(</span><span class="n">addresses</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">email_address</span> <span class="o">==</span> <span class="s1">&apos;jack@yahoo.com&apos;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">enclosing_stmt</span> <span class="o">=</span> <span class="n">select</span><span class="p">([</span><span class="n">users</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">name</span><span class="p">])</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">users</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">id</span> <span class="o">==</span> <span class="n">stmt</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">conn</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">enclosing_stmt</span><span class="p">)</span><span class="o">.</span><span class="n">fetchall</span><span class="p">()</span>
<div class="show_sql">SELECT users.name
FROM users
WHERE users.id = (SELECT addresses.user_id
    FROM addresses
    WHERE addresses.user_id = users.id
    AND addresses.email_address = ?)
(&apos;jack@yahoo.com&apos;,)
</div><span class="go">[(u&apos;jack&apos;,)]</span></pre></div></div><p><span class="yiyi-st" id="yiyi-386">&#x81EA;&#x52A8;&#x5173;&#x8054;&#x901A;&#x5E38;&#x4F1A;&#x505A;&#x9884;&#x671F;&#x7684;&#x4E8B;&#x60C5;&#xFF0C;&#x4F46;&#x5B83;&#x4E5F;&#x53EF;&#x4EE5;&#x88AB;&#x63A7;&#x5236;&#x3002;</span><span class="yiyi-st" id="yiyi-387">&#x4F8B;&#x5982;&#xFF0C;&#x5982;&#x679C;&#x6211;&#x4EEC;&#x60F3;&#x8981;&#x4E00;&#x6761;&#x8BED;&#x53E5;&#x53EA;&#x5173;&#x8054;<code class="docutils literal"><span class="pre">addresses</span></code>&#x8868;&#x800C;&#x4E0D;&#x5173;&#x8054;<code class="docutils literal"><span class="pre">users</span></code>&#x8868;&#xFF0C;&#x5373;&#x4F7F;&#x4E24;&#x8005;&#x90FD;&#x51FA;&#x73B0;&#x5728;&#x5C01;&#x95ED;&#x7684;SELECT&#x4E2D;&#xFF0C;&#x6211;&#x4EEC;&#x4E5F;&#x4F7F;&#x7528;<a class="reference internal" href="selectable.html#sqlalchemy.sql.expression.Select.correlate" title="sqlalchemy.sql.expression.Select.correlate"><code class="xref py py-meth docutils literal"><span class="pre">correlate()</span></code></a>&#x65B9;&#x6CD5;&#x6765;&#x6307;&#x5B9A;&#x90A3;&#x4E9B;&#x53EF;&#x80FD;&#x76F8;&#x5173;&#x7684;FROM&#x5B50;&#x53E5;&#xFF1A;</span></p><div class="highlight-pycon+sql"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">stmt</span> <span class="o">=</span> <span class="n">select</span><span class="p">([</span><span class="n">users</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">id</span><span class="p">])</span><span class="o">.</span>\
<span class="gp">... </span>            <span class="n">where</span><span class="p">(</span><span class="n">users</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">id</span> <span class="o">==</span> <span class="n">addresses</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">user_id</span><span class="p">)</span><span class="o">.</span>\
<span class="gp">... </span>            <span class="n">where</span><span class="p">(</span><span class="n">users</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s1">&apos;jack&apos;</span><span class="p">)</span><span class="o">.</span>\
<span class="gp">... </span>            <span class="n">correlate</span><span class="p">(</span><span class="n">addresses</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">enclosing_stmt</span> <span class="o">=</span> <span class="n">select</span><span class="p">(</span>
<span class="gp">... </span>        <span class="p">[</span><span class="n">users</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">addresses</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">email_address</span><span class="p">])</span><span class="o">.</span>\
<span class="gp">... </span>    <span class="n">select_from</span><span class="p">(</span><span class="n">users</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">addresses</span><span class="p">))</span><span class="o">.</span>\
<span class="gp">... </span>    <span class="n">where</span><span class="p">(</span><span class="n">users</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">id</span> <span class="o">==</span> <span class="n">stmt</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">conn</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">enclosing_stmt</span><span class="p">)</span><span class="o">.</span><span class="n">fetchall</span><span class="p">()</span>
<div class="show_sql">SELECT users.name, addresses.email_address
 FROM users JOIN addresses ON users.id = addresses.user_id
 WHERE users.id = (SELECT users.id
 FROM users
 WHERE users.id = addresses.user_id AND users.name = ?)
 (&apos;jack&apos;,)
 </div><span class="go">[(u&apos;jack&apos;, u&apos;jack@yahoo.com&apos;), (u&apos;jack&apos;, u&apos;jack@msn.com&apos;)]</span></pre></div></div><p><span class="yiyi-st" id="yiyi-388">&#x8981;&#x5B8C;&#x5168;&#x7981;&#x7528;&#x76F8;&#x5173;&#x7684;&#x8BED;&#x53E5;&#xFF0C;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x4F20;&#x9012;<code class="docutils literal"><span class="pre">None</span></code>&#x4F5C;&#x4E3A;&#x53C2;&#x6570;&#xFF1A;</span></p><div class="highlight-pycon+sql"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">stmt</span> <span class="o">=</span> <span class="n">select</span><span class="p">([</span><span class="n">users</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">id</span><span class="p">])</span><span class="o">.</span>\
<span class="gp">... </span>            <span class="n">where</span><span class="p">(</span><span class="n">users</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s1">&apos;wendy&apos;</span><span class="p">)</span><span class="o">.</span>\
<span class="gp">... </span>            <span class="n">correlate</span><span class="p">(</span><span class="bp">None</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">enclosing_stmt</span> <span class="o">=</span> <span class="n">select</span><span class="p">([</span><span class="n">users</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">name</span><span class="p">])</span><span class="o">.</span>\
<span class="gp">... </span>    <span class="n">where</span><span class="p">(</span><span class="n">users</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">id</span> <span class="o">==</span> <span class="n">stmt</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">conn</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">enclosing_stmt</span><span class="p">)</span><span class="o">.</span><span class="n">fetchall</span><span class="p">()</span>
<div class="show_sql">SELECT users.name
 FROM users
 WHERE users.id = (SELECT users.id
  FROM users
  WHERE users.name = ?)
(&apos;wendy&apos;,)
</div><span class="go">[(u&apos;wendy&apos;,)]</span></pre></div></div><p><span class="yiyi-st" id="yiyi-389">&#x6211;&#x4EEC;&#x8FD8;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;<a class="reference internal" href="selectable.html#sqlalchemy.sql.expression.Select.correlate_except" title="sqlalchemy.sql.expression.Select.correlate_except"><code class="xref py py-meth docutils literal"><span class="pre">Select.correlate_except()</span></code></a>&#x65B9;&#x6CD5;&#x901A;&#x8FC7;&#x6392;&#x9664;&#x6765;&#x63A7;&#x5236;&#x5173;&#x8054;&#x3002;</span><span class="yiyi-st" id="yiyi-390">&#x6BD4;&#x5982;&#xFF0C;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x544A;&#x8BC9;&#x5B83;&#x5173;&#x8054;&#x9664;<code class="docutils literal"><span class="pre">users</span></code>&#x4E4B;&#x5916;&#x7684;&#x6240;&#x6709;FROM&#x5B50;&#x53E5;&#x6765;&#x4E3A;<code class="docutils literal"><span class="pre">users</span></code>&#x8868;&#x5199;&#x5165;&#x6211;&#x4EEC;&#x7684;SELECT&#xFF1A;</span></p><div class="highlight-pycon+sql"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">stmt</span> <span class="o">=</span> <span class="n">select</span><span class="p">([</span><span class="n">users</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">id</span><span class="p">])</span><span class="o">.</span>\
<span class="gp">... </span>            <span class="n">where</span><span class="p">(</span><span class="n">users</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">id</span> <span class="o">==</span> <span class="n">addresses</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">user_id</span><span class="p">)</span><span class="o">.</span>\
<span class="gp">... </span>            <span class="n">where</span><span class="p">(</span><span class="n">users</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s1">&apos;jack&apos;</span><span class="p">)</span><span class="o">.</span>\
<span class="gp">... </span>            <span class="n">correlate_except</span><span class="p">(</span><span class="n">users</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">enclosing_stmt</span> <span class="o">=</span> <span class="n">select</span><span class="p">(</span>
<span class="gp">... </span>        <span class="p">[</span><span class="n">users</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">addresses</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">email_address</span><span class="p">])</span><span class="o">.</span>\
<span class="gp">... </span>    <span class="n">select_from</span><span class="p">(</span><span class="n">users</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">addresses</span><span class="p">))</span><span class="o">.</span>\
<span class="gp">... </span>    <span class="n">where</span><span class="p">(</span><span class="n">users</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">id</span> <span class="o">==</span> <span class="n">stmt</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">conn</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">enclosing_stmt</span><span class="p">)</span><span class="o">.</span><span class="n">fetchall</span><span class="p">()</span>
<div class="show_sql">SELECT users.name, addresses.email_address
 FROM users JOIN addresses ON users.id = addresses.user_id
 WHERE users.id = (SELECT users.id
 FROM users
 WHERE users.id = addresses.user_id AND users.name = ?)
 (&apos;jack&apos;,)
 </div><span class="go">[(u&apos;jack&apos;, u&apos;jack@yahoo.com&apos;), (u&apos;jack&apos;, u&apos;jack@msn.com&apos;)]</span></pre></div></div><div class="section" id="lateral-correlation"><h4><span class="yiyi-st" id="yiyi-391">&#x6A2A;&#x5411;&#x5173;&#x8054;<a class="headerlink" href="#lateral-correlation" title="Permalink to this headline">&#xB6;</a></span></h4><p><span class="yiyi-st" id="yiyi-392">LATERAL&#x5173;&#x8054;&#x662F;SQL&#x5173;&#x8054;&#x7684;&#x4E00;&#x4E2A;&#x7279;&#x6B8A;&#x5B50;&#x7C7B;&#x522B;&#xFF0C;&#x5B83;&#x5141;&#x8BB8;&#x53EF;&#x9009;&#x5355;&#x5143;&#x5728;&#x5355;&#x4E2A;FROM&#x5B50;&#x53E5;&#x4E2D;&#x5F15;&#x7528;&#x53E6;&#x4E00;&#x4E2A;&#x53EF;&#x9009;&#x5355;&#x5143;&#x3002;</span><span class="yiyi-st" id="yiyi-393">&#x8FD9;&#x662F;&#x4E00;&#x4E2A;&#x975E;&#x5E38;&#x7279;&#x6B8A;&#x7684;&#x7528;&#x4F8B;&#xFF0C;&#x867D;&#x7136;&#x5B83;&#x662F;SQL&#x6807;&#x51C6;&#x7684;&#x4E00;&#x90E8;&#x5206;&#xFF0C;&#x4F46;&#x53EA;&#x6709;&#x6700;&#x65B0;&#x7248;&#x672C;&#x7684;Postgresql&#x624D;&#x652F;&#x6301;&#x5B83;&#x3002;</span></p><p><span class="yiyi-st" id="yiyi-394">Normally, if a SELECT statement refers to <code class="docutils literal"><span class="pre">table1</span> <span class="pre">JOIN</span> <span class="pre">(some</span> <span class="pre">SELECT)</span> <span class="pre">AS</span> <span class="pre">subquery</span></code> in its FROM clause, the subquery on the right side may not refer to the &#x201C;table1&#x201D; expression from the left side; correlation may only refer to a table that is part of another SELECT that entirely encloses this SELECT. </span><span class="yiyi-st" id="yiyi-395">LATERAL&#x5173;&#x952E;&#x5B57;&#x5141;&#x8BB8;&#x6211;&#x4EEC;&#x7ED5;&#x8FC7;&#x8FD9;&#x79CD;&#x884C;&#x4E3A;&#xFF0C;&#x5141;&#x8BB8;&#x8868;&#x8FBE;&#x5F0F;&#x5982;&#x4E0B;&#xFF1A;</span></p><div class="highlight-sql"><div class="highlight"><pre><span></span><span class="k">SELECT</span> <span class="n">people</span><span class="p">.</span><span class="n">people_id</span><span class="p">,</span> <span class="n">people</span><span class="p">.</span><span class="n">age</span><span class="p">,</span> <span class="n">people</span><span class="p">.</span><span class="n">name</span>
<span class="k">FROM</span> <span class="n">people</span> <span class="k">JOIN</span> <span class="k">LATERAL</span> <span class="p">(</span><span class="k">SELECT</span> <span class="n">books</span><span class="p">.</span><span class="n">book_id</span> <span class="k">AS</span> <span class="n">book_id</span>
<span class="k">FROM</span> <span class="n">books</span> <span class="k">WHERE</span> <span class="n">books</span><span class="p">.</span><span class="n">owner_id</span> <span class="o">=</span> <span class="n">people</span><span class="p">.</span><span class="n">people_id</span><span class="p">)</span>
<span class="k">AS</span> <span class="n">book_subq</span> <span class="k">ON</span> <span class="k">true</span></pre></div></div><p><span class="yiyi-st" id="yiyi-396">&#x5728;&#x4E0A;&#x9762;&#xFF0C;JOIN&#x7684;&#x53F3;&#x4FA7;&#x5305;&#x542B;&#x4E00;&#x4E2A;&#x5B50;&#x67E5;&#x8BE2;&#xFF0C;&#x5B83;&#x4E0D;&#x4EC5;&#x5F15;&#x7528;&#x201C;books&#x201D;&#x8868;&#xFF0C;&#x800C;&#x4E14;&#x8FD8;&#x5F15;&#x7528;&#x201C;JOIN&#x201D;&#x5DE6;&#x4FA7;&#x7684;&#x201C;people&#x201D;&#x8868;&#x3002;</span><span class="yiyi-st" id="yiyi-397">SQLAlchemy Core&#x652F;&#x6301;&#x4F7F;&#x7528;<a class="reference internal" href="selectable.html#sqlalchemy.sql.expression.Select.lateral" title="sqlalchemy.sql.expression.Select.lateral"><code class="xref py py-meth docutils literal"><span class="pre">Select.lateral()</span></code></a>&#x65B9;&#x6CD5;&#x7684;&#x4E0A;&#x8FF0;&#x8BED;&#x53E5;&#xFF0C;&#x5982;&#x4E0B;&#x6240;&#x793A;&#xFF1A;</span></p><div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sqlalchemy</span> <span class="kn">import</span> <span class="n">table</span><span class="p">,</span> <span class="n">column</span><span class="p">,</span> <span class="n">select</span><span class="p">,</span> <span class="n">true</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">people</span> <span class="o">=</span> <span class="n">table</span><span class="p">(</span><span class="s1">&apos;people&apos;</span><span class="p">,</span> <span class="n">column</span><span class="p">(</span><span class="s1">&apos;people_id&apos;</span><span class="p">),</span> <span class="n">column</span><span class="p">(</span><span class="s1">&apos;age&apos;</span><span class="p">),</span> <span class="n">column</span><span class="p">(</span><span class="s1">&apos;name&apos;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">books</span> <span class="o">=</span> <span class="n">table</span><span class="p">(</span><span class="s1">&apos;books&apos;</span><span class="p">,</span> <span class="n">column</span><span class="p">(</span><span class="s1">&apos;book_id&apos;</span><span class="p">),</span> <span class="n">column</span><span class="p">(</span><span class="s1">&apos;owner_id&apos;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">subq</span> <span class="o">=</span> <span class="n">select</span><span class="p">([</span><span class="n">books</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">book_id</span><span class="p">])</span><span class="o">.</span>\
<span class="gp">... </span>     <span class="n">where</span><span class="p">(</span><span class="n">books</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">owner_id</span> <span class="o">==</span> <span class="n">people</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">people_id</span><span class="p">)</span><span class="o">.</span><span class="n">lateral</span><span class="p">(</span><span class="s2">&quot;book_subq&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">select</span><span class="p">([</span><span class="n">people</span><span class="p">])</span><span class="o">.</span><span class="n">select_from</span><span class="p">(</span><span class="n">people</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">subq</span><span class="p">,</span> <span class="n">true</span><span class="p">())))</span>
<span class="go">SELECT people.people_id, people.age, people.name</span>
<span class="go">FROM people JOIN LATERAL (SELECT books.book_id AS book_id</span>
<span class="go">FROM books WHERE books.owner_id = people.people_id)</span>
<span class="go">AS book_subq ON true</span></pre></div></div><p><span class="yiyi-st" id="yiyi-398">&#x5728;&#x4E0A;&#x9762;&#xFF0C;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x770B;&#x5230;<a class="reference internal" href="selectable.html#sqlalchemy.sql.expression.Select.lateral" title="sqlalchemy.sql.expression.Select.lateral"><code class="xref py py-meth docutils literal"><span class="pre">Select.lateral()</span></code></a>&#x65B9;&#x6CD5;&#x4E0E;<a class="reference internal" href="selectable.html#sqlalchemy.sql.expression.Select.alias" title="sqlalchemy.sql.expression.Select.alias"><code class="xref py py-meth docutils literal"><span class="pre">Select.alias()</span></code></a>&#x65B9;&#x6CD5;&#x975E;&#x5E38;&#x76F8;&#x4F3C;&#xFF0C;&#x5305;&#x62EC;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x6307;&#x5B9A;&#x4E00;&#x4E2A;&#x53EF;&#x9009;&#x540D;&#x79F0;&#x3002;</span><span class="yiyi-st" id="yiyi-399">&#x7136;&#x800C;&#xFF0C;&#x6784;&#x9020;&#x662F;<a class="reference internal" href="selectable.html#sqlalchemy.sql.expression.Lateral" title="sqlalchemy.sql.expression.Lateral"><code class="xref py py-class docutils literal"><span class="pre">Lateral</span></code></a>&#x6784;&#x9020;&#x800C;&#x4E0D;&#x662F;<a class="reference internal" href="selectable.html#sqlalchemy.sql.expression.Alias" title="sqlalchemy.sql.expression.Alias"><code class="xref py py-class docutils literal"><span class="pre">Alias</span></code></a>&#xFF0C;&#x5B83;&#x63D0;&#x4F9B;&#x4E86;LATERAL&#x5173;&#x952E;&#x5B57;&#x4EE5;&#x53CA;&#x7279;&#x6B8A;&#x7684;&#x6307;&#x4EE4;&#xFF0C;&#x4EE5;&#x5141;&#x8BB8;&#x4ECE;&#x5305;&#x542B;&#x8BED;&#x53E5;&#x7684;FROM&#x5B50;&#x53E5;&#x4E2D;&#x8FDB;&#x884C;&#x5173;&#x8054;&#x3002;</span></p><p><span class="yiyi-st" id="yiyi-400"><a class="reference internal" href="selectable.html#sqlalchemy.sql.expression.Select.lateral" title="sqlalchemy.sql.expression.Select.lateral"><code class="xref py py-meth docutils literal"><span class="pre">Select.lateral()</span></code></a>&#x65B9;&#x6CD5;&#x901A;&#x5E38;&#x4E0E;<a class="reference internal" href="selectable.html#sqlalchemy.sql.expression.Select.correlate" title="sqlalchemy.sql.expression.Select.correlate"><code class="xref py py-meth docutils literal"><span class="pre">Select.correlate()</span></code></a>&#x548C;<a class="reference internal" href="selectable.html#sqlalchemy.sql.expression.Select.correlate_except" title="sqlalchemy.sql.expression.Select.correlate_except"><code class="xref py py-meth docutils literal"><span class="pre">Select.correlate_except()</span></code></a>&#x65B9;&#x6CD5;&#x4EA4;&#x4E92;&#xFF0C;&#x9664;&#x4E86;&#x76F8;&#x5173;&#x89C4;&#x5219;&#x4E5F;&#x9002;&#x7528;&#x4E8E;&#x5305;&#x542B;&#x8BED;&#x53E5;&#x7684;FROM&#x5B50;&#x53E5;&#x4E2D;&#x7684;&#x4EFB;&#x4F55;&#x5176;&#x4ED6;&#x8868;&#x3002;</span><span class="yiyi-st" id="yiyi-401">&#x5982;&#x679C;&#x8868;&#x88AB;&#x6307;&#x5B9A;&#x4E3A;<a class="reference internal" href="selectable.html#sqlalchemy.sql.expression.Select.correlate" title="sqlalchemy.sql.expression.Select.correlate"><code class="xref py py-meth docutils literal"><span class="pre">Select.correlate()</span></code></a>&#xFF0C;&#x5E76;&#x4E14;&#x5BF9;&#x9664;<a class="reference internal" href="selectable.html#sqlalchemy.sql.expression.Select.correlate_except" title="sqlalchemy.sql.expression.Select.correlate_except"><code class="xref py py-meth docutils literal"><span class="pre">Select.correlate_except()</span></code></a></span></p><div class="versionadded"><p><span class="yiyi-st" id="yiyi-402"><span class="versionmodified">&#x7248;&#x672C;1.1&#x4E2D;&#x7684;&#x65B0;&#x529F;&#x80FD;&#xFF1A;</span>&#x652F;&#x6301;LATERAL&#x5173;&#x952E;&#x5B57;&#x548C;&#x6A2A;&#x5411;&#x5173;&#x8054;&#x3002;</span></p></div><div class="admonition seealso"><p class="first admonition-title"><span class="yiyi-st" id="yiyi-403">&#x4E5F;&#x53EF;&#x4EE5;&#x770B;&#x770B;</span></p><p><span class="yiyi-st" id="yiyi-404"><a class="reference internal" href="selectable.html#sqlalchemy.sql.expression.Lateral" title="sqlalchemy.sql.expression.Lateral"><code class="xref py py-class docutils literal"><span class="pre">Lateral</span></code></a></span></p><p class="last"><span class="yiyi-st" id="yiyi-405"><a class="reference internal" href="selectable.html#sqlalchemy.sql.expression.Select.lateral" title="sqlalchemy.sql.expression.Select.lateral"><code class="xref py py-meth docutils literal"><span class="pre">Select.lateral()</span></code></a></span></p></div></div></div><div class="section" id="ordering-grouping-limiting-offset-ing"><h3><span class="yiyi-st" id="yiyi-406">&#x8BA2;&#x8D2D;&#xFF0C;&#x5206;&#x7EC4;&#xFF0C;&#x9650;&#x5236;&#xFF0C;&#x504F;&#x79FB;...... <a class="headerlink" href="#ordering-grouping-limiting-offset-ing" title="Permalink to this headline">&#xB6;</a></span></h3><p><span class="yiyi-st" id="yiyi-407">&#x901A;&#x8FC7;&#x5C06;&#x5217;&#x8868;&#x8FBE;&#x5F0F;&#x4F20;&#x9012;&#x7ED9;<code class="xref py py-meth docutils literal"><span class="pre">order_by()</span></code>&#x65B9;&#x6CD5;&#x6765;&#x5B8C;&#x6210;&#x6392;&#x5E8F;&#xFF1A;</span></p><div class="highlight-pycon+sql"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">stmt</span> <span class="o">=</span> <span class="n">select</span><span class="p">([</span><span class="n">users</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">name</span><span class="p">])</span><span class="o">.</span><span class="n">order_by</span><span class="p">(</span><span class="n">users</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">conn</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">stmt</span><span class="p">)</span><span class="o">.</span><span class="n">fetchall</span><span class="p">()</span>
<div class="show_sql">SELECT users.name
FROM users ORDER BY users.name
()
</div><span class="go">[(u&apos;jack&apos;,), (u&apos;wendy&apos;,)]</span></pre></div></div><p><span class="yiyi-st" id="yiyi-408">&#x53EF;&#x4EE5;&#x4F7F;&#x7528;<a class="reference internal" href="sqlelement.html#sqlalchemy.sql.expression.ColumnElement.asc" title="sqlalchemy.sql.expression.ColumnElement.asc"><code class="xref py py-meth docutils literal"><span class="pre">asc()</span></code></a>&#x548C;<a class="reference internal" href="sqlelement.html#sqlalchemy.sql.expression.ColumnElement.desc" title="sqlalchemy.sql.expression.ColumnElement.desc"><code class="xref py py-meth docutils literal"><span class="pre">desc()</span></code></a>&#x4FEE;&#x9970;&#x7B26;&#x6765;&#x63A7;&#x5236;&#x5347;&#x5E8F;&#x6216;&#x964D;&#x5E8F;&#xFF1A;</span></p><div class="highlight-pycon+sql"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">stmt</span> <span class="o">=</span> <span class="n">select</span><span class="p">([</span><span class="n">users</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">name</span><span class="p">])</span><span class="o">.</span><span class="n">order_by</span><span class="p">(</span><span class="n">users</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">desc</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">conn</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">stmt</span><span class="p">)</span><span class="o">.</span><span class="n">fetchall</span><span class="p">()</span>
<div class="show_sql">SELECT users.name
FROM users ORDER BY users.name DESC
()
</div><span class="go">[(u&apos;wendy&apos;,), (u&apos;jack&apos;,)]</span></pre></div></div><p><span class="yiyi-st" id="yiyi-409">&#x5206;&#x7EC4;&#x662F;&#x6307;GROUP BY&#x5B50;&#x53E5;&#xFF0C;&#x901A;&#x5E38;&#x4E0E;&#x805A;&#x5408;&#x51FD;&#x6570;&#x7ED3;&#x5408;&#x4F7F;&#x7528;&#x4EE5;&#x5EFA;&#x7ACB;&#x8981;&#x805A;&#x5408;&#x7684;&#x884C;&#x7EC4;&#x3002;</span><span class="yiyi-st" id="yiyi-410">&#x8FD9;&#x662F;&#x901A;&#x8FC7;<code class="xref py py-meth docutils literal"><span class="pre">group_by()</span></code>&#x65B9;&#x6CD5;&#x63D0;&#x4F9B;&#x7684;&#xFF1A;</span></p><div class="highlight-pycon+sql"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">stmt</span> <span class="o">=</span> <span class="n">select</span><span class="p">([</span><span class="n">users</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">func</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="n">addresses</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">id</span><span class="p">)])</span><span class="o">.</span>\
<span class="gp">... </span>            <span class="n">select_from</span><span class="p">(</span><span class="n">users</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">addresses</span><span class="p">))</span><span class="o">.</span>\
<span class="gp">... </span>            <span class="n">group_by</span><span class="p">(</span><span class="n">users</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">conn</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">stmt</span><span class="p">)</span><span class="o">.</span><span class="n">fetchall</span><span class="p">()</span>
<div class="show_sql">SELECT users.name, count(addresses.id) AS count_1
FROM users JOIN addresses
    ON users.id = addresses.user_id
GROUP BY users.name
()
</div><span class="go">[(u&apos;jack&apos;, 2), (u&apos;wendy&apos;, 2)]</span></pre></div></div><p><span class="yiyi-st" id="yiyi-411">&#x5728;&#x5E94;&#x7528;GROUP BY&#x4E4B;&#x540E;&#xFF0C;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;HAVING&#x8FC7;&#x6EE4;&#x805A;&#x5408;&#x503C;&#x4E0A;&#x7684;&#x7ED3;&#x679C;&#x3002;</span><span class="yiyi-st" id="yiyi-412">&#x5B83;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;<a class="reference internal" href="selectable.html#sqlalchemy.sql.expression.Select.having" title="sqlalchemy.sql.expression.Select.having"><code class="xref py py-meth docutils literal"><span class="pre">having()</span></code></a>&#x65B9;&#x6CD5;&#x83B7;&#x5F97;&#xFF1A;</span></p><div class="highlight-pycon+sql"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">stmt</span> <span class="o">=</span> <span class="n">select</span><span class="p">([</span><span class="n">users</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">func</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="n">addresses</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">id</span><span class="p">)])</span><span class="o">.</span>\
<span class="gp">... </span>            <span class="n">select_from</span><span class="p">(</span><span class="n">users</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">addresses</span><span class="p">))</span><span class="o">.</span>\
<span class="gp">... </span>            <span class="n">group_by</span><span class="p">(</span><span class="n">users</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">name</span><span class="p">)</span><span class="o">.</span>\
<span class="gp">... </span>            <span class="n">having</span><span class="p">(</span><span class="n">func</span><span class="o">.</span><span class="n">length</span><span class="p">(</span><span class="n">users</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">name</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">4</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">conn</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">stmt</span><span class="p">)</span><span class="o">.</span><span class="n">fetchall</span><span class="p">()</span>
<div class="show_sql">SELECT users.name, count(addresses.id) AS count_1
FROM users JOIN addresses
    ON users.id = addresses.user_id
GROUP BY users.name
HAVING length(users.name) &gt; ?
(4,)
</div><span class="go">[(u&apos;wendy&apos;, 2)]</span></pre></div></div><p><span class="yiyi-st" id="yiyi-413">&#x5728;&#x7EC4;&#x5408;&#x7684;SELECT&#x8BED;&#x53E5;&#x4E2D;&#x5904;&#x7406;&#x91CD;&#x590D;&#x7684;&#x5E38;&#x89C1;&#x7CFB;&#x7EDF;&#x662F;DISTINCT&#x4FEE;&#x9970;&#x7B26;&#x3002;</span><span class="yiyi-st" id="yiyi-414">&#x53EF;&#x4EE5;&#x4F7F;&#x7528;<a class="reference internal" href="selectable.html#sqlalchemy.sql.expression.Select.distinct" title="sqlalchemy.sql.expression.Select.distinct"><code class="xref py py-meth docutils literal"><span class="pre">Select.distinct()</span></code></a>&#x65B9;&#x6CD5;&#x6DFB;&#x52A0;&#x4E00;&#x4E2A;&#x7B80;&#x5355;&#x7684;DISTINCT&#x5B50;&#x53E5;&#xFF1A;</span></p><div class="highlight-pycon+sql"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">stmt</span> <span class="o">=</span> <span class="n">select</span><span class="p">([</span><span class="n">users</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">name</span><span class="p">])</span><span class="o">.</span>\
<span class="gp">... </span>            <span class="n">where</span><span class="p">(</span><span class="n">addresses</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">email_address</span><span class="o">.</span>
<span class="gp">... </span>                   <span class="n">contains</span><span class="p">(</span><span class="n">users</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">name</span><span class="p">))</span><span class="o">.</span>\
<span class="gp">... </span>            <span class="n">distinct</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">conn</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">stmt</span><span class="p">)</span><span class="o">.</span><span class="n">fetchall</span><span class="p">()</span>
<div class="show_sql">SELECT DISTINCT users.name
FROM users, addresses
WHERE (addresses.email_address LIKE &apos;%%&apos; || users.name || &apos;%%&apos;)
()
</div><span class="go">[(u&apos;jack&apos;,), (u&apos;wendy&apos;,)]</span></pre></div></div><p><span class="yiyi-st" id="yiyi-415">&#x5927;&#x591A;&#x6570;&#x6570;&#x636E;&#x5E93;&#x540E;&#x7AEF;&#x652F;&#x6301;&#x9650;&#x5236;&#x8FD4;&#x56DE;&#x884C;&#x6570;&#x7684;&#x7CFB;&#x7EDF;&#xFF0C;&#x5927;&#x591A;&#x6570;&#x6570;&#x636E;&#x5E93;&#x540E;&#x7AEF;&#x8FD8;&#x5177;&#x6709;&#x5728;&#x7ED9;&#x5B9A;&#x201C;&#x504F;&#x79FB;&#x91CF;&#x201D;&#x4E4B;&#x540E;&#x5F00;&#x59CB;&#x8FD4;&#x56DE;&#x884C;&#x7684;&#x65B9;&#x6CD5;&#x3002;</span><span class="yiyi-st" id="yiyi-416">&#x5C3D;&#x7BA1;Postgresql&#xFF0C;MySQL&#x548C;SQLite&#x7B49;&#x516C;&#x5171;&#x540E;&#x7AEF;&#x652F;&#x6301;LIMIT&#x548C;OFFSET&#x5173;&#x952E;&#x5B57;&#xFF0C;&#x4F46;&#x5176;&#x4ED6;&#x540E;&#x7AEF;&#x9700;&#x8981;&#x5F15;&#x7528;&#x66F4;&#x591A;&#x6DF1;&#x5965;&#x7684;&#x529F;&#x80FD;&#xFF0C;&#x4F8B;&#x5982;&#x201C;&#x7A97;&#x53E3;&#x51FD;&#x6570;&#x201D;&#x548C;&#x884C;ID&#x4EE5;&#x8FBE;&#x5230;&#x76F8;&#x540C;&#x7684;&#x6548;&#x679C;&#x3002;</span><span class="yiyi-st" id="yiyi-417"><a class="reference internal" href="selectable.html#sqlalchemy.sql.expression.Select.limit" title="sqlalchemy.sql.expression.Select.limit"><code class="xref py py-meth docutils literal"><span class="pre">limit()</span></code></a>&#x548C;<a class="reference internal" href="selectable.html#sqlalchemy.sql.expression.Select.offset" title="sqlalchemy.sql.expression.Select.offset"><code class="xref py py-meth docutils literal"><span class="pre">offset()</span></code></a>&#x65B9;&#x6CD5;&#x4E3A;&#x5F53;&#x524D;&#x540E;&#x7AEF;&#x7684;&#x65B9;&#x6CD5;&#x63D0;&#x4F9B;&#x4E86;&#x4E00;&#x4E2A;&#x7B80;&#x5355;&#x7684;&#x62BD;&#x8C61;&#xFF1A;</span></p><div class="highlight-pycon+sql"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">stmt</span> <span class="o">=</span> <span class="n">select</span><span class="p">([</span><span class="n">users</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">addresses</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">email_address</span><span class="p">])</span><span class="o">.</span>\
<span class="gp">... </span>            <span class="n">select_from</span><span class="p">(</span><span class="n">users</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">addresses</span><span class="p">))</span><span class="o">.</span>\
<span class="gp">... </span>            <span class="n">limit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">offset</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">conn</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">stmt</span><span class="p">)</span><span class="o">.</span><span class="n">fetchall</span><span class="p">()</span>
<div class="show_sql">SELECT users.name, addresses.email_address
FROM users JOIN addresses ON users.id = addresses.user_id
 LIMIT ? OFFSET ?
(1, 1)
</div><span class="go">[(u&apos;jack&apos;, u&apos;jack@msn.com&apos;)]</span></pre></div></div></div></div><div class="section" id="inserts-updates-and-deletes"><h2><span class="yiyi-st" id="yiyi-418">&#x63D2;&#x5165;&#xFF0C;&#x66F4;&#x65B0;&#x548C;&#x5220;&#x9664;<a class="headerlink" href="#inserts-updates-and-deletes" title="Permalink to this headline">&#xB6;</a></span></h2><p><span class="yiyi-st" id="yiyi-419">&#x6211;&#x4EEC;&#x5DF2;&#x7ECF;&#x770B;&#x5230;&#x672C;&#x6559;&#x7A0B;&#x524D;&#x9762;&#x4ECB;&#x7ECD;&#x7684;<a class="reference internal" href="selectable.html#sqlalchemy.sql.expression.TableClause.insert" title="sqlalchemy.sql.expression.TableClause.insert"><code class="xref py py-meth docutils literal"><span class="pre">insert()</span></code></a>&#x3002;</span><span class="yiyi-st" id="yiyi-420">&#x5176;&#x4E2D;<a class="reference internal" href="selectable.html#sqlalchemy.sql.expression.TableClause.insert" title="sqlalchemy.sql.expression.TableClause.insert"><code class="xref py py-meth docutils literal"><span class="pre">insert()</span></code></a>&#x4EA7;&#x751F;INSERT&#xFF0C;<a class="reference internal" href="selectable.html#sqlalchemy.sql.expression.TableClause.update" title="sqlalchemy.sql.expression.TableClause.update"><code class="xref py py-meth docutils literal"><span class="pre">update()</span></code></a>&#x65B9;&#x6CD5;&#x4EA7;&#x751F;UPDATE&#x3002;</span><span class="yiyi-st" id="yiyi-421">&#x8FD9;&#x4E24;&#x79CD;&#x7ED3;&#x6784;&#x90FD;&#x6709;&#x4E00;&#x4E2A;&#x540D;&#x4E3A;<a class="reference internal" href="dml.html#sqlalchemy.sql.expression.ValuesBase.values" title="sqlalchemy.sql.expression.ValuesBase.values"><code class="xref py py-meth docutils literal"><span class="pre">values()</span></code></a>&#x7684;&#x65B9;&#x6CD5;&#xFF0C;&#x5B83;&#x6307;&#x5B9A;&#x8BED;&#x53E5;&#x7684;VALUES&#x6216;SET&#x5B50;&#x53E5;&#x3002;</span></p><p><span class="yiyi-st" id="yiyi-422"><a class="reference internal" href="dml.html#sqlalchemy.sql.expression.ValuesBase.values" title="sqlalchemy.sql.expression.ValuesBase.values"><code class="xref py py-meth docutils literal"><span class="pre">values()</span></code></a>&#x65B9;&#x6CD5;&#x5BB9;&#x7EB3;&#x4EFB;&#x4F55;&#x5217;&#x8868;&#x8FBE;&#x5F0F;&#x4F5C;&#x4E3A;&#x503C;&#xFF1A;</span></p><div class="highlight-pycon+sql"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">stmt</span> <span class="o">=</span> <span class="n">users</span><span class="o">.</span><span class="n">update</span><span class="p">()</span><span class="o">.</span>\
<span class="gp">... </span>            <span class="n">values</span><span class="p">(</span><span class="n">fullname</span><span class="o">=</span><span class="s2">&quot;Fullname: &quot;</span> <span class="o">+</span> <span class="n">users</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">conn</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">stmt</span><span class="p">)</span>
<div class="show_sql">UPDATE users SET fullname=(? || users.name)
(&apos;Fullname: &apos;,)
COMMIT
</div><span class="go">&lt;sqlalchemy.engine.result.ResultProxy object at 0x...&gt;</span></pre></div></div><p><span class="yiyi-st" id="yiyi-423">&#x5728;&#x201C;execute many&#x201D;&#x4E0A;&#x4E0B;&#x6587;&#x4E2D;&#x4F7F;&#x7528;<a class="reference internal" href="selectable.html#sqlalchemy.sql.expression.TableClause.insert" title="sqlalchemy.sql.expression.TableClause.insert"><code class="xref py py-meth docutils literal"><span class="pre">insert()</span></code></a>&#x6216;<a class="reference internal" href="selectable.html#sqlalchemy.sql.expression.TableClause.update" title="sqlalchemy.sql.expression.TableClause.update"><code class="xref py py-meth docutils literal"><span class="pre">update()</span></code></a>&#x65F6;&#xFF0C;&#x6211;&#x4EEC;&#x53EF;&#x80FD;&#x8FD8;&#x60F3;&#x6307;&#x5B9A;&#x5728;&#x53C2;&#x6570;&#x5217;&#x8868;&#x4E2D;&#x53EF;&#x4EE5;&#x5F15;&#x7528;&#x7684;&#x547D;&#x540D;&#x7ED1;&#x5B9A;&#x53C2;&#x6570;&#x3002;</span><span class="yiyi-st" id="yiyi-424">&#x8FD9;&#x4E24;&#x4E2A;&#x6784;&#x9020;&#x4F1A;&#x81EA;&#x52A8;&#x4E3A;&#x6267;&#x884C;&#x65F6;&#x53D1;&#x9001;&#x7ED9;<a class="reference internal" href="connections.html#sqlalchemy.engine.Connection.execute" title="sqlalchemy.engine.Connection.execute"><code class="xref py py-meth docutils literal"><span class="pre">execute()</span></code></a>&#x7684;&#x5B57;&#x5178;&#x4E2D;&#x4F20;&#x9012;&#x7684;&#x4EFB;&#x4F55;&#x5217;&#x540D;&#x751F;&#x6210;&#x7ED1;&#x5B9A;&#x5360;&#x4F4D;&#x7B26;&#x3002;</span><span class="yiyi-st" id="yiyi-425">&#x4F46;&#x662F;&#xFF0C;&#x5982;&#x679C;&#x6211;&#x4EEC;&#x5E0C;&#x671B;&#x4F7F;&#x7528;&#x7EC4;&#x5408;&#x8868;&#x8FBE;&#x5F0F;&#x7684;&#x663E;&#x5F0F;&#x76EE;&#x6807;&#x547D;&#x540D;&#x53C2;&#x6570;&#xFF0C;&#x5219;&#x9700;&#x8981;&#x4F7F;&#x7528;<a class="reference internal" href="sqlelement.html#sqlalchemy.sql.expression.bindparam" title="sqlalchemy.sql.expression.bindparam"><code class="xref py py-func docutils literal"><span class="pre">bindparam()</span></code></a>&#x7ED3;&#x6784;&#x3002;</span><span class="yiyi-st" id="yiyi-426">&#x5F53;&#x5C06;<a class="reference internal" href="sqlelement.html#sqlalchemy.sql.expression.bindparam" title="sqlalchemy.sql.expression.bindparam"><code class="xref py py-func docutils literal"><span class="pre">bindparam()</span></code></a>&#x4E0E;<a class="reference internal" href="selectable.html#sqlalchemy.sql.expression.TableClause.insert" title="sqlalchemy.sql.expression.TableClause.insert"><code class="xref py py-meth docutils literal"><span class="pre">insert()</span></code></a>&#x6216;<a class="reference internal" href="selectable.html#sqlalchemy.sql.expression.TableClause.update" title="sqlalchemy.sql.expression.TableClause.update"><code class="xref py py-meth docutils literal"><span class="pre">update()</span></code></a>&#x7ED3;&#x5408;&#x4F7F;&#x7528;&#x65F6;&#xFF0C;&#x8868;&#x683C;&#x5217;&#x7684;&#x540D;&#x79F0;&#x672C;&#x8EAB;&#x4E3A;&#x201C;&#x81EA;&#x52A8;&#x201D;&#x7ED1;&#x5B9A;&#x540D;&#x79F0;&#x3002;</span><span class="yiyi-st" id="yiyi-427">&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x7ED3;&#x5408;&#x4F7F;&#x7528;&#x9690;&#x5F0F;&#x53EF;&#x7528;&#x7684;&#x7ED1;&#x5B9A;&#x540D;&#x79F0;&#x548C;&#x660E;&#x786E;&#x547D;&#x540D;&#x7684;&#x53C2;&#x6570;&#xFF0C;&#x5982;&#x4E0B;&#x4F8B;&#x6240;&#x793A;&#xFF1A;</span></p><div class="highlight-pycon+sql"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">stmt</span> <span class="o">=</span> <span class="n">users</span><span class="o">.</span><span class="n">insert</span><span class="p">()</span><span class="o">.</span>\
<span class="gp">... </span>        <span class="n">values</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">bindparam</span><span class="p">(</span><span class="s1">&apos;_name&apos;</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot; .. name&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">conn</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">stmt</span><span class="p">,</span> <span class="p">[</span>
<span class="gp">... </span>       <span class="p">{</span><span class="s1">&apos;id&apos;</span><span class="p">:</span><span class="mi">4</span><span class="p">,</span> <span class="s1">&apos;_name&apos;</span><span class="p">:</span><span class="s1">&apos;name1&apos;</span><span class="p">},</span>
<span class="gp">... </span>       <span class="p">{</span><span class="s1">&apos;id&apos;</span><span class="p">:</span><span class="mi">5</span><span class="p">,</span> <span class="s1">&apos;_name&apos;</span><span class="p">:</span><span class="s1">&apos;name2&apos;</span><span class="p">},</span>
<span class="gp">... </span>       <span class="p">{</span><span class="s1">&apos;id&apos;</span><span class="p">:</span><span class="mi">6</span><span class="p">,</span> <span class="s1">&apos;_name&apos;</span><span class="p">:</span><span class="s1">&apos;name3&apos;</span><span class="p">},</span>
<span class="gp">... </span>    <span class="p">])</span>
<div class="show_sql">INSERT INTO users (id, name) VALUES (?, (? || ?))
((4, &apos;name1&apos;, &apos; .. name&apos;), (5, &apos;name2&apos;, &apos; .. name&apos;), (6, &apos;name3&apos;, &apos; .. name&apos;))
COMMIT
&lt;sqlalchemy.engine.result.ResultProxy object at 0x...&gt;</div></pre></div></div><p><span class="yiyi-st" id="yiyi-428">&#x4F7F;&#x7528;<a class="reference internal" href="selectable.html#sqlalchemy.sql.expression.TableClause.update" title="sqlalchemy.sql.expression.TableClause.update"><code class="xref py py-meth docutils literal"><span class="pre">update()</span></code></a>&#x7ED3;&#x6784;&#x53D1;&#x51FA;UPDATE&#x8BED;&#x53E5;&#x3002;</span><span class="yiyi-st" id="yiyi-429">&#x8FD9;&#x5F88;&#x50CF;INSERT&#xFF0C;&#x9664;&#x4E86;&#x53EF;&#x4EE5;&#x6307;&#x5B9A;&#x4E00;&#x4E2A;&#x989D;&#x5916;&#x7684;WHERE&#x5B50;&#x53E5;&#xFF1A;</span></p><div class="highlight-pycon+sql"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">stmt</span> <span class="o">=</span> <span class="n">users</span><span class="o">.</span><span class="n">update</span><span class="p">()</span><span class="o">.</span>\
<span class="gp">... </span>            <span class="n">where</span><span class="p">(</span><span class="n">users</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s1">&apos;jack&apos;</span><span class="p">)</span><span class="o">.</span>\
<span class="gp">... </span>            <span class="n">values</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&apos;ed&apos;</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">conn</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">stmt</span><span class="p">)</span>
<div class="show_sql">UPDATE users SET name=? WHERE users.name = ?
(&apos;ed&apos;, &apos;jack&apos;)
COMMIT
</div><span class="go">&lt;sqlalchemy.engine.result.ResultProxy object at 0x...&gt;</span></pre></div></div><p><span class="yiyi-st" id="yiyi-430">&#x5728;&#x201C;executemany&#x201D;&#x4E0A;&#x4E0B;&#x6587;&#x4E2D;&#x4F7F;&#x7528;<a class="reference internal" href="selectable.html#sqlalchemy.sql.expression.TableClause.update" title="sqlalchemy.sql.expression.TableClause.update"><code class="xref py py-meth docutils literal"><span class="pre">update()</span></code></a>&#x65F6;&#xFF0C;&#x6211;&#x4EEC;&#x53EF;&#x80FD;&#x5E0C;&#x671B;&#x5728;WHERE&#x5B50;&#x53E5;&#x4E2D;&#x4F7F;&#x7528;&#x663E;&#x5F0F;&#x547D;&#x540D;&#x7684;&#x7ED1;&#x5B9A;&#x53C2;&#x6570;&#x3002;</span><span class="yiyi-st" id="yiyi-431">&#x540C;&#x6837;&#xFF0C;<a class="reference internal" href="sqlelement.html#sqlalchemy.sql.expression.bindparam" title="sqlalchemy.sql.expression.bindparam"><code class="xref py py-func docutils literal"><span class="pre">bindparam()</span></code></a>&#x662F;&#x7528;&#x4E8E;&#x5B9E;&#x73B0;&#x6B64;&#x76EE;&#x7684;&#x7684;&#x6784;&#x9020;&#xFF1A;</span></p><div class="highlight-pycon+sql"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">stmt</span> <span class="o">=</span> <span class="n">users</span><span class="o">.</span><span class="n">update</span><span class="p">()</span><span class="o">.</span>\
<span class="gp">... </span>            <span class="n">where</span><span class="p">(</span><span class="n">users</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="n">bindparam</span><span class="p">(</span><span class="s1">&apos;oldname&apos;</span><span class="p">))</span><span class="o">.</span>\
<span class="gp">... </span>            <span class="n">values</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">bindparam</span><span class="p">(</span><span class="s1">&apos;newname&apos;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">conn</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">stmt</span><span class="p">,</span> <span class="p">[</span>
<span class="gp">... </span>    <span class="p">{</span><span class="s1">&apos;oldname&apos;</span><span class="p">:</span><span class="s1">&apos;jack&apos;</span><span class="p">,</span> <span class="s1">&apos;newname&apos;</span><span class="p">:</span><span class="s1">&apos;ed&apos;</span><span class="p">},</span>
<span class="gp">... </span>    <span class="p">{</span><span class="s1">&apos;oldname&apos;</span><span class="p">:</span><span class="s1">&apos;wendy&apos;</span><span class="p">,</span> <span class="s1">&apos;newname&apos;</span><span class="p">:</span><span class="s1">&apos;mary&apos;</span><span class="p">},</span>
<span class="gp">... </span>    <span class="p">{</span><span class="s1">&apos;oldname&apos;</span><span class="p">:</span><span class="s1">&apos;jim&apos;</span><span class="p">,</span> <span class="s1">&apos;newname&apos;</span><span class="p">:</span><span class="s1">&apos;jake&apos;</span><span class="p">},</span>
<span class="gp">... </span>    <span class="p">])</span>
<div class="show_sql">UPDATE users SET name=? WHERE users.name = ?
((&apos;ed&apos;, &apos;jack&apos;), (&apos;mary&apos;, &apos;wendy&apos;), (&apos;jake&apos;, &apos;jim&apos;))
COMMIT
</div><span class="go">&lt;sqlalchemy.engine.result.ResultProxy object at 0x...&gt;</span></pre></div></div><div class="section" id="correlated-updates"><h3><span class="yiyi-st" id="yiyi-432">&#x76F8;&#x5173;&#x66F4;&#x65B0;<a class="headerlink" href="#correlated-updates" title="Permalink to this headline">&#xB6;</a></span></h3><p><span class="yiyi-st" id="yiyi-433">&#x901A;&#x8FC7;&#x5173;&#x8054;&#x7684;&#x66F4;&#x65B0;&#xFF0C;&#x60A8;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;&#x53E6;&#x4E00;&#x4E2A;&#x8868;&#x6216;&#x540C;&#x4E00;&#x4E2A;&#x8868;&#x4E2D;&#x7684;&#x9009;&#x62E9;&#x6765;&#x66F4;&#x65B0;&#x8868;&#xFF1A;</span></p><div class="highlight-pycon+sql"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">stmt</span> <span class="o">=</span> <span class="n">select</span><span class="p">([</span><span class="n">addresses</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">email_address</span><span class="p">])</span><span class="o">.</span>\
<span class="gp">... </span>            <span class="n">where</span><span class="p">(</span><span class="n">addresses</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">user_id</span> <span class="o">==</span> <span class="n">users</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">id</span><span class="p">)</span><span class="o">.</span>\
<span class="gp">... </span>            <span class="n">limit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">conn</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">users</span><span class="o">.</span><span class="n">update</span><span class="p">()</span><span class="o">.</span><span class="n">values</span><span class="p">(</span><span class="n">fullname</span><span class="o">=</span><span class="n">stmt</span><span class="p">))</span>
<div class="show_sql">UPDATE users SET fullname=(SELECT addresses.email_address
    FROM addresses
    WHERE addresses.user_id = users.id
    LIMIT ? OFFSET ?)
(1, 0)
COMMIT
</div><span class="go">&lt;sqlalchemy.engine.result.ResultProxy object at 0x...&gt;</span></pre></div></div></div><div class="section" id="multiple-table-updates"><h3><span class="yiyi-st" id="yiyi-434">&#x591A;&#x8868;&#x66F4;&#x65B0;<a class="headerlink" href="#multiple-table-updates" title="Permalink to this headline">&#xB6;</a></span></h3><div class="versionadded"><p><span class="yiyi-st" id="yiyi-435"><span class="versionmodified">New in version 0.7.4.</span></span></p></div><p><span class="yiyi-st" id="yiyi-436">Postgresql&#xFF0C;Microsoft SQL Server&#x548C;MySQL&#x540E;&#x7AEF;&#x90FD;&#x652F;&#x6301;&#x5F15;&#x7528;&#x591A;&#x4E2A;&#x8868;&#x7684;UPDATE&#x8BED;&#x53E5;&#x3002;</span><span class="yiyi-st" id="yiyi-437">&#x5BF9;&#x4E8E;PG&#x548C;MSSQL&#xFF0C;&#x8FD9;&#x662F;&#x201C;UPDATE FROM&#x201D;&#x8BED;&#x6CD5;&#xFF0C;&#x5B83;&#x4E00;&#x6B21;&#x66F4;&#x65B0;&#x4E00;&#x4E2A;&#x8868;&#xFF0C;&#x4F46;&#x53EF;&#x4EE5;&#x5728;&#x989D;&#x5916;&#x7684;&#x201C;FROM&#x201D;&#x5B50;&#x53E5;&#x4E2D;&#x5F15;&#x7528;&#x9644;&#x52A0;&#x8868;&#xFF0C;&#x7136;&#x540E;&#x53EF;&#x4EE5;&#x76F4;&#x63A5;&#x5728;WHERE&#x5B50;&#x53E5;&#x4E2D;&#x5F15;&#x7528;&#x8BE5;&#x5B50;&#x53E5;&#x3002;</span><span class="yiyi-st" id="yiyi-438">&#x5728;MySQL&#x4E0A;&#xFF0C;&#x53EF;&#x4EE5;&#x5C06;&#x591A;&#x4E2A;&#x8868;&#x5D4C;&#x5165;&#x5230;&#x7531;&#x9017;&#x53F7;&#x5206;&#x9694;&#x7684;&#x5355;&#x4E2A;UPDATE&#x8BED;&#x53E5;&#x4E2D;&#x3002;</span><span class="yiyi-st" id="yiyi-439">&#x901A;&#x8FC7;&#x5728;WHERE&#x5B50;&#x53E5;&#x4E2D;&#x6307;&#x5B9A;&#x591A;&#x4E2A;&#x8868;&#xFF0C;SQLAlchemy <a class="reference internal" href="dml.html#sqlalchemy.sql.expression.update" title="sqlalchemy.sql.expression.update"><code class="xref py py-func docutils literal"><span class="pre">update()</span></code></a>&#x6784;&#x9020;&#x9690;&#x5F0F;&#x652F;&#x6301;&#x8FD9;&#x4E24;&#x79CD;&#x6A21;&#x5F0F;&#xFF1A;</span></p><div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">stmt</span> <span class="o">=</span> <span class="n">users</span><span class="o">.</span><span class="n">update</span><span class="p">()</span><span class="o">.</span>\
        <span class="n">values</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&apos;ed wood&apos;</span><span class="p">)</span><span class="o">.</span>\
        <span class="n">where</span><span class="p">(</span><span class="n">users</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">id</span> <span class="o">==</span> <span class="n">addresses</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">id</span><span class="p">)</span><span class="o">.</span>\
        <span class="n">where</span><span class="p">(</span><span class="n">addresses</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">email_address</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&apos;ed%&apos;</span><span class="p">))</span>
<span class="n">conn</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">stmt</span><span class="p">)</span></pre></div></div><p><span class="yiyi-st" id="yiyi-440">&#x6765;&#x81EA;&#x4E0A;&#x8FF0;&#x8BED;&#x53E5;&#x7684;&#x7ED3;&#x679C;SQL&#x5C06;&#x5448;&#x73B0;&#x4E3A;&#xFF1A;</span></p><div class="highlight-python"><div class="highlight"><pre><span></span>UPDATE users SET name=:name FROM addresses
WHERE users.id = addresses.id AND
addresses.email_address LIKE :email_address_1 || &apos;%%&apos;</pre></div></div><p><span class="yiyi-st" id="yiyi-441">&#x4F7F;&#x7528;MySQL&#x65F6;&#xFF0C;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;&#x4F20;&#x9012;&#x7ED9;<a class="reference internal" href="dml.html#sqlalchemy.sql.expression.Update.values" title="sqlalchemy.sql.expression.Update.values"><code class="xref py py-meth docutils literal"><span class="pre">Update.values()</span></code></a>&#x7684;&#x5B57;&#x5178;&#x5F62;&#x5F0F;&#xFF0C;&#x76F4;&#x63A5;&#x5728;SET&#x5B50;&#x53E5;&#x4E2D;&#x4E3A;&#x6BCF;&#x4E2A;&#x8868;&#x5206;&#x914D;&#x5217;&#xFF1A;</span></p><div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">stmt</span> <span class="o">=</span> <span class="n">users</span><span class="o">.</span><span class="n">update</span><span class="p">()</span><span class="o">.</span>\
        <span class="n">values</span><span class="p">({</span>
            <span class="n">users</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">name</span><span class="p">:</span><span class="s1">&apos;ed wood&apos;</span><span class="p">,</span>
            <span class="n">addresses</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">email_address</span><span class="p">:</span><span class="s1">&apos;ed.wood@foo.com&apos;</span>
        <span class="p">})</span><span class="o">.</span>\
        <span class="n">where</span><span class="p">(</span><span class="n">users</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">id</span> <span class="o">==</span> <span class="n">addresses</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">id</span><span class="p">)</span><span class="o">.</span>\
        <span class="n">where</span><span class="p">(</span><span class="n">addresses</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">email_address</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&apos;ed%&apos;</span><span class="p">))</span></pre></div></div><p><span class="yiyi-st" id="yiyi-442">&#x8FD9;&#x4E9B;&#x8868;&#x5728;SET&#x5B50;&#x53E5;&#x4E2D;&#x663E;&#x5F0F;&#x5F15;&#x7528;&#xFF1A;</span></p><div class="highlight-python"><div class="highlight"><pre><span></span>UPDATE users, addresses SET addresses.email_address=%s,
        users.name=%s WHERE users.id = addresses.id
        AND addresses.email_address LIKE concat(%s, &apos;%%&apos;)</pre></div></div><p><span class="yiyi-st" id="yiyi-443">&#x5F53;&#x8FD9;&#x4E9B;&#x7ED3;&#x6784;&#x7528;&#x4E8E;&#x4E0D;&#x652F;&#x6301;&#x7684;&#x6570;&#x636E;&#x5E93;&#x65F6;&#xFF0C;SQLAlchemy&#x4E0D;&#x4F1A;&#x505A;&#x4EFB;&#x4F55;&#x7279;&#x6B8A;&#x7684;&#x4E8B;&#x60C5;&#x3002;</span><span class="yiyi-st" id="yiyi-444">&#x5F53;&#x5B58;&#x5728;&#x591A;&#x4E2A;&#x8868;&#x65F6;&#xFF0C;&#x9ED8;&#x8BA4;&#x60C5;&#x51B5;&#x4E0B;&#x4F1A;&#x751F;&#x6210;<code class="docutils literal"><span class="pre">UPDATE</span> <span class="pre">FROM</span></code>&#x8BED;&#x6CD5;&#xFF0C;&#x5982;&#x679C;&#x4E0D;&#x652F;&#x6301;&#x6B64;&#x8BED;&#x6CD5;&#xFF0C;&#x5219;&#x8BE5;&#x8BED;&#x53E5;&#x5C06;&#x88AB;&#x6570;&#x636E;&#x5E93;&#x62D2;&#x7EDD;&#x3002;</span></p></div><div class="section" id="parameter-ordered-updates"><h3><span class="yiyi-st" id="yiyi-445">&#x53C2;&#x6570;&#x6709;&#x5E8F;&#x66F4;&#x65B0;<a class="headerlink" href="#parameter-ordered-updates" title="Permalink to this headline">&#xB6;</a></span></h3><p><span class="yiyi-st" id="yiyi-446">&#x5448;&#x73B0;SET&#x5B50;&#x53E5;&#x65F6;&#xFF0C;<a class="reference internal" href="dml.html#sqlalchemy.sql.expression.update" title="sqlalchemy.sql.expression.update"><code class="xref py py-func docutils literal"><span class="pre">update()</span></code></a>&#x6784;&#x9020;&#x7684;&#x9ED8;&#x8BA4;&#x884C;&#x4E3A;&#x662F;&#x4F7F;&#x7528;&#x539F;&#x59CB;<a class="reference internal" href="metadata.html#sqlalchemy.schema.Table" title="sqlalchemy.schema.Table"><code class="xref py py-class docutils literal"><span class="pre">Table</span></code></a>&#x5BF9;&#x8C61;&#x4E2D;&#x7ED9;&#x51FA;&#x7684;&#x5217;&#x987A;&#x5E8F;&#x6765;&#x5448;&#x73B0;&#x5B83;&#x4EEC;&#x3002;</span><span class="yiyi-st" id="yiyi-447">&#x8FD9;&#x662F;&#x4E00;&#x4E2A;&#x91CD;&#x8981;&#x7684;&#x884C;&#x4E3A;&#xFF0C;&#x56E0;&#x4E3A;&#x5B83;&#x610F;&#x5473;&#x7740;&#x5177;&#x6709;&#x7279;&#x5B9A;&#x5217;&#x7684;&#x7279;&#x5B9A;UPDATE&#x8BED;&#x53E5;&#x7684;&#x5448;&#x73B0;&#x6BCF;&#x6B21;&#x90FD;&#x4F1A;&#x5448;&#x73B0;&#x76F8;&#x540C;&#xFF0C;&#x8FD9;&#x4F1A;&#x5BF9;&#x4F9D;&#x8D56;&#x4E8E;&#x8BED;&#x53E5;&#x5F62;&#x5F0F;&#x7684;&#x67E5;&#x8BE2;&#x7F13;&#x5B58;&#x7CFB;&#x7EDF;&#x4EA7;&#x751F;&#x5F71;&#x54CD;&#xFF0C;&#x5BA2;&#x6237;&#x7AEF;&#x6216;&#x670D;&#x52A1;&#x5668;&#x4FA7;&#x3002;</span><span class="yiyi-st" id="yiyi-448">&#x7531;&#x4E8E;&#x53C2;&#x6570;&#x672C;&#x8EAB;&#x4F5C;&#x4E3A;Python&#x5B57;&#x5178;&#x952E;&#x4F20;&#x9012;&#x7ED9;<a class="reference internal" href="dml.html#sqlalchemy.sql.expression.Update.values" title="sqlalchemy.sql.expression.Update.values"><code class="xref py py-meth docutils literal"><span class="pre">Update.values()</span></code></a>&#x65B9;&#x6CD5;&#xFF0C;&#x56E0;&#x6B64;&#x6CA1;&#x6709;&#x5176;&#x4ED6;&#x53EF;&#x7528;&#x7684;&#x56FA;&#x5B9A;&#x6392;&#x5E8F;&#x3002;</span></p><p><span class="yiyi-st" id="yiyi-449">&#x4F46;&#x662F;&#xFF0C;&#x5728;&#x67D0;&#x4E9B;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;UPDATE&#x8BED;&#x53E5;&#x7684;SET&#x5B50;&#x53E5;&#x4E2D;&#x5448;&#x73B0;&#x7684;&#x53C2;&#x6570;&#x987A;&#x5E8F;&#x53EF;&#x80FD;&#x5F88;&#x91CD;&#x8981;&#x3002;</span><span class="yiyi-st" id="yiyi-450">&#x8FD9;&#x4E2A;&#x7684;&#x4E3B;&#x8981;&#x4F8B;&#x5B50;&#x662F;&#x4F7F;&#x7528;MySQL&#x5E76;&#x63D0;&#x4F9B;&#x57FA;&#x4E8E;&#x5176;&#x4ED6;&#x5217;&#x503C;&#x7684;&#x5217;&#x503C;&#x7684;&#x66F4;&#x65B0;&#x3002;</span><span class="yiyi-st" id="yiyi-451">&#x4EE5;&#x4E0B;&#x58F0;&#x660E;&#x7684;&#x6700;&#x7EC8;&#x7ED3;&#x679C;&#xFF1A;</span></p><div class="highlight-python"><div class="highlight"><pre><span></span>UPDATE some_table SET x = y + 10, y = 20</pre></div></div><p><span class="yiyi-st" id="yiyi-452">&#x5C06;&#x6709;&#x4E0D;&#x540C;&#x7684;&#x7ED3;&#x679C;&#x6BD4;&#xFF1A;</span></p><div class="highlight-python"><div class="highlight"><pre><span></span>UPDATE some_table SET y = 20, x = y + 10</pre></div></div><p><span class="yiyi-st" id="yiyi-453">&#x8FD9;&#x662F;&#x56E0;&#x4E3A;&#x5728;MySQL&#x4E0A;&#xFF0C;&#x5355;&#x72EC;&#x7684;SET&#x5B50;&#x53E5;&#x5728;&#x6BCF;&#x4E2A;&#x503C;&#x7684;&#x57FA;&#x7840;&#x4E0A;&#x88AB;&#x5B8C;&#x5168;&#x8BC4;&#x4F30;&#xFF0C;&#x800C;&#x4E0D;&#x662F;&#x57FA;&#x4E8E;&#x6BCF;&#x884C;&#xFF0C;&#x5E76;&#x4E14;&#x6BCF;&#x4E2A;SET&#x5B50;&#x53E5;&#x88AB;&#x8BC4;&#x4F30;&#xFF0C;&#x5D4C;&#x5165;&#x5728;&#x8BE5;&#x884C;&#x4E2D;&#x7684;&#x503C;&#x90FD;&#x5728;&#x53D8;&#x5316;&#x3002;</span></p><p><span class="yiyi-st" id="yiyi-454">&#x4E3A;&#x4E86;&#x9002;&#x5E94;&#x8FD9;&#x4E2A;&#x7279;&#x5B9A;&#x7684;&#x7528;&#x4F8B;&#xFF0C;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;<a class="reference internal" href="dml.html#sqlalchemy.sql.expression.update.params.preserve_parameter_order" title="sqlalchemy.sql.expression.update"><code class="xref py py-paramref docutils literal"><span class="pre">preserve_parameter_order</span></code></a>&#x6807;&#x5FD7;&#x3002;</span><span class="yiyi-st" id="yiyi-455">&#x5F53;&#x4F7F;&#x7528;&#x8FD9;&#x4E2A;&#x6807;&#x5FD7;&#x65F6;&#xFF0C;&#x6211;&#x4EEC;&#x4E3A;<a class="reference internal" href="dml.html#sqlalchemy.sql.expression.Update.values" title="sqlalchemy.sql.expression.Update.values"><code class="xref py py-meth docutils literal"><span class="pre">Update.values()</span></code></a>&#x65B9;&#x6CD5;&#x63D0;&#x4F9B;&#x4E00;&#x4E2A;<strong>2&#x5143;&#x7EC4;&#x7684;Python&#x5217;&#x8868;</strong>&#x4F5C;&#x4E3A;&#x53C2;&#x6570;&#x3002;</span></p><div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">stmt</span> <span class="o">=</span> <span class="n">some_table</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">preserve_parameter_order</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span><span class="o">.</span>\
    <span class="n">values</span><span class="p">([(</span><span class="n">some_table</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="mi">20</span><span class="p">),</span> <span class="p">(</span><span class="n">some_table</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">some_table</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">y</span> <span class="o">+</span> <span class="mi">10</span><span class="p">)])</span></pre></div></div><p><span class="yiyi-st" id="yiyi-456">&#x9664;&#x4E86;&#x5B83;&#x88AB;&#x6392;&#x5E8F;&#x4E4B;&#x5916;&#xFF0C;2&#x5143;&#x7EC4;&#x5217;&#x8868;&#x672C;&#x8D28;&#x4E0A;&#x4E0E;Python&#x5B57;&#x5178;&#x7ED3;&#x6784;&#x76F8;&#x540C;&#x3002;</span><span class="yiyi-st" id="yiyi-457">&#x4F7F;&#x7528;&#x4E0A;&#x9762;&#x7684;&#x8868;&#x683C;&#xFF0C;&#x6211;&#x4EEC;&#x786E;&#x4FE1;&#xFF0C;&#x201C;y&#x201D;&#x5217;&#x7684;SET&#x5B50;&#x53E5;&#x5C06;&#x9996;&#x5148;&#x5448;&#x73B0;&#xFF0C;&#x7136;&#x540E;&#x662F;&#x201C;x&#x201D;&#x5217;&#x7684;SET&#x5B50;&#x53E5;&#x3002;</span></p><div class="versionadded"><p><span class="yiyi-st" id="yiyi-458"><span class="versionmodified">&#x7248;&#x672C;1.0.10&#x4E2D;&#x7684;&#x65B0;&#x589E;&#x529F;&#x80FD;&#xFF1A;</span>&#x4F7F;&#x7528;<a class="reference internal" href="dml.html#sqlalchemy.sql.expression.update.params.preserve_parameter_order" title="sqlalchemy.sql.expression.update"><code class="xref py py-paramref docutils literal"><span class="pre">preserve_parameter_order</span></code></a>&#x6807;&#x5FD7;&#x589E;&#x52A0;&#x4E86;&#x5BF9;&#x663E;&#x5F0F;&#x6392;&#x5E8F;UPDATE&#x53C2;&#x6570;&#x7684;&#x652F;&#x6301;&#x3002;</span></p></div></div><div class="section" id="deletes"><h3><span class="yiyi-st" id="yiyi-459">&#x5220;&#x9664;<a class="headerlink" href="#deletes" title="Permalink to this headline">&#xB6; T0&gt;</a></span></h3><p><span class="yiyi-st" id="yiyi-460">&#x6700;&#x540E;&#xFF0C;&#x5220;&#x9664;&#x3002;</span><span class="yiyi-st" id="yiyi-461">&#x8FD9;&#x5F88;&#x5BB9;&#x6613;&#x4F7F;&#x7528;<a class="reference internal" href="selectable.html#sqlalchemy.sql.expression.TableClause.delete" title="sqlalchemy.sql.expression.TableClause.delete"><code class="xref py py-meth docutils literal"><span class="pre">delete()</span></code></a>&#x7ED3;&#x6784;&#x5B8C;&#x6210;&#xFF1A;</span></p><div class="highlight-pycon+sql"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">conn</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">addresses</span><span class="o">.</span><span class="n">delete</span><span class="p">())</span>
<div class="show_sql">DELETE FROM addresses
()
COMMIT
</div><span class="go">&lt;sqlalchemy.engine.result.ResultProxy object at 0x...&gt;</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">conn</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">users</span><span class="o">.</span><span class="n">delete</span><span class="p">()</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">users</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">name</span> <span class="o">&gt;</span> <span class="s1">&apos;m&apos;</span><span class="p">))</span>
<div class="show_sql">DELETE FROM users WHERE users.name &gt; ?
(&apos;m&apos;,)
COMMIT
</div><span class="go">&lt;sqlalchemy.engine.result.ResultProxy object at 0x...&gt;</span></pre></div></div></div><div class="section" id="matched-row-counts"><h3><span class="yiyi-st" id="yiyi-462">&#x5339;&#x914D;&#x884C;&#x8BA1;&#x6570;<a class="headerlink" href="#matched-row-counts" title="Permalink to this headline">&#xB6;</a></span></h3><p><span class="yiyi-st" id="yiyi-463"><a class="reference internal" href="selectable.html#sqlalchemy.sql.expression.TableClause.update" title="sqlalchemy.sql.expression.TableClause.update"><code class="xref py py-meth docutils literal"><span class="pre">update()</span></code></a>&#x548C;<a class="reference internal" href="selectable.html#sqlalchemy.sql.expression.TableClause.delete" title="sqlalchemy.sql.expression.TableClause.delete"><code class="xref py py-meth docutils literal"><span class="pre">delete()</span></code></a>&#x90FD;&#x4E0E;<em>&#x5339;&#x914D;&#x884C;&#x8BA1;&#x6570;</em>&#x5173;&#x8054;&#x3002;</span><span class="yiyi-st" id="yiyi-464">&#x8FD9;&#x662F;&#x4E00;&#x4E2A;&#x6570;&#x5B57;&#xFF0C;&#x8868;&#x793A;WHERE&#x5B50;&#x53E5;&#x5339;&#x914D;&#x7684;&#x884C;&#x6570;&#x3002;</span><span class="yiyi-st" id="yiyi-465">&#x8BF7;&#x6CE8;&#x610F;&#xFF0C;&#x901A;&#x8FC7;&#x201C;&#x5339;&#x914D;&#x201D;&#xFF0C;&#x8FD9;&#x5305;&#x62EC;&#x6CA1;&#x6709;&#x5B9E;&#x9645;&#x53D1;&#x751F;UPDATE&#x7684;&#x884C;&#x3002;</span><span class="yiyi-st" id="yiyi-466">&#x8BE5;&#x503C;&#x53EF;&#x7528;&#x4E8E;<a class="reference internal" href="connections.html#sqlalchemy.engine.ResultProxy.rowcount" title="sqlalchemy.engine.ResultProxy.rowcount"><code class="xref py py-attr docutils literal"><span class="pre">rowcount</span></code></a>&#xFF1A;</span></p><div class="highlight-pycon+sql"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">conn</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">users</span><span class="o">.</span><span class="n">delete</span><span class="p">())</span>
<div class="show_sql">DELETE FROM users
()
COMMIT
</div><span class="gp">&gt;&gt;&gt; </span><span class="n">result</span><span class="o">.</span><span class="n">rowcount</span>
<span class="go">1</span></pre></div></div></div></div><div class="section" id="further-reference"><h2><span class="yiyi-st" id="yiyi-467">&#x8FDB;&#x4E00;&#x6B65;&#x53C2;&#x8003;<a class="headerlink" href="#further-reference" title="Permalink to this headline">&#xB6;</a></span></h2><p><span class="yiyi-st" id="yiyi-468">&#x8868;&#x8FBE;&#x5F0F;&#x8BED;&#x8A00;&#x53C2;&#x8003;&#xFF1A;<a class="reference internal" href="expression_api.html"><span>SQL Statements and Expressions API</span></a></span></p><p><span class="yiyi-st" id="yiyi-469">&#x6570;&#x636E;&#x5E93;&#x5143;&#x6570;&#x636E;&#x53C2;&#x8003;&#xFF1A;<a class="reference internal" href="metadata.html"><span>Describing Databases with MetaData</span></a></span></p><p><span class="yiyi-st" id="yiyi-470">&#x5F15;&#x64CE;&#x53C2;&#x8003;&#xFF1A;<a class="reference internal" href="engines.html"><em>Engine Configuration</em></a></span></p><p><span class="yiyi-st" id="yiyi-471">&#x8FDE;&#x63A5;&#x53C2;&#x8003;&#xFF1A;<a class="reference internal" href="connections.html"><span>Working with Engines and Connections</span></a></span></p><p><span class="yiyi-st" id="yiyi-472">&#x7C7B;&#x578B;&#x53C2;&#x8003;&#xFF1A;<a class="reference internal" href="types.html"><span>Column and Data Types</span></a></span></p></div>